import"./DsnmJJEf.js";import{p as Fe,e as S,g as ye,l as we,h as l,f as y,c as b,s as k,i as a,u as V,r as m,t as g,b as f,d as We,a as be,x as je,aw as ke,ax as Ge}from"./CaHRSXkO.js";import{s as U}from"./CrFq4NBa.js";import{i as C}from"./BLuAT40e.js";import{e as Je,i as Qe}from"./cG-FGtBW.js";import{h as xe}from"./CwQGQ51v.js";import{s as c,d as Xe,c as p,b as Ye}from"./ZZ_SO04P.js";import{d as Ze,e as z}from"./EZdBy8tr.js";import{b as Se}from"./D1kHjzM_.js";import{p as h}from"./DdsaxoiY.js";import{i as $e,h as et}from"./Qs3Znu_W.js";import{t as tt}from"./DP6SISrU.js";import{C as Ce}from"./6ShiOQ4x.js";import{s as x}from"./BMRmn4k7.js";import{S as it}from"./4If3JN7J.js";var at=y("<div><div></div></div> <div> <!></div> <div><div></div></div> <div><div></div></div>",1),nt=y("<div><div></div></div>"),ot=y("<input/>"),lt=y('<div class="fs15 mt-2 _10 svelte-1m1yl0c"> </div>'),rt=y('<div role="button" tabindex="0"><div class="h100 w100 flex items-center"><!></div></div>'),st=y("<div>Cargando...</div>"),vt=y("<div><i></i></div>"),dt=y("<span> </span>"),ct=y('<div role="button" tabindex="0"><div></div></div>'),ft=y('<div role="button" tabindex="0"><!></div>'),ut=y("<div><!> <div><!> <!> <!></div> <!> <!> <!></div>");function Nt(pe,i){Fe(i,!0);const P=h(i,"saveOn",15),Y=h(i,"css",3,""),D=h(i,"options",19,()=>[]);h(i,"max",3,100);const De=h(i,"notEmpty",3,!1),Le=h(i,"required",3,!1),Z=h(i,"disabled",3,!1),$=h(i,"clearOnSelect",3,!1),ee=h(i,"avoidIDs",19,()=>[]),te=h(i,"inputCss",3,""),A=h(i,"showLoading",3,!1);let L=S(!1),w=S(ye([...D()])),s=S(-1),N=S(!1),I=S(0),H=S(""),O=!1,ie=S(!1),u,R,K=S(ye([]));const ae=V(()=>Ce.deviceType===3),F=V(()=>a(ae)),ne=V(()=>Z()||A());function Pe(){if(u){const e=u.getBoundingClientRect(),t=window.innerHeight;l(ie,e.top>t/2)}}function T(e){a(F)?l(H,e,!0):u&&(u.value=e)}function oe(){let e=i.selected;typeof e>"u"&&i.save&&P()&&(e=P()[i.save]);let t;return e&&(t=D().find(n=>n[i.keyId]===e)),t}function le(){return Le()&&!Z()}let re=Date.now();const se=(e,t)=>{const n=Date.now();if(n-re<80)return;re=n,De()&&!e&&(e=oe()),e&&!$()?T(e[i.keyName]):T("");const r=e?e[i.keyId]:null;le()&&l(I,r?2:1,!0),$()?i.onChange&&i.onChange(e):P()&&i.save?(P()[i.save]||null)!==r&&(P(P()[i.save]=r,!0),i.onChange&&i.onChange(e)):typeof i.selected<"u"&&(i.selected||null)!==r&&i.onChange&&i.onChange(e)},W=e=>{if(console.log("options filtered::",i.label,D()),!e&&(ee()?.length||0)===0)return[...D()];const t=new Set(ee()||[]),n=[],r=e.toLowerCase().split(" ").filter(v=>v.length>1);for(const v of D())if(!(t.size>0&&t.has(v[i.keyId])))if(r.length===0)n.push(v);else{const d=v[i.keyName];typeof d=="string"&&$e(d.toLowerCase(),r)&&n.push(v)}return console.log("options filtered 2::",i.label,D(),n),n};function j(e){e.stopPropagation();const t=e.target,n=String(t.value||"").toLowerCase();tt(()=>{l(K,String(u.value).toLowerCase().split(" "),!0),l(w,W(n),!0),l(s,-1)},120)}function Ne(e){console.log("avoid hover:: ",a(N)),e.stopPropagation(),!(!a(L)||a(w).length===0)&&(e.key==="ArrowUp"?(e.preventDefault(),l(s,a(s)<=0?a(w).length-1:a(s)-1,!0),l(N,!0),R?.scrollToIndex(a(s),{align:"auto"})):e.key==="ArrowDown"?(e.preventDefault(),l(s,a(s)>=a(w).length-1?0:a(s)+1,!0),l(N,!0),R?.scrollToIndex(a(s),{align:"auto"})):e.key==="Enter"&&a(s)>=0&&(e.preventDefault(),G(a(w)[a(s)])))}function G(e){se(e),u&&u.blur(),l(L,!1)}let Ve=V(()=>`${x.input} p-rel${Y()?` ${Y()}`:""}${i.label?"":" no-label"}`);function ve(){return a(I)?a(I)===2?'<i class="v-icon icon-ok c-green"></i>':a(I)===1?'<i class="v-icon icon-attention c-red"></i>':null:null}we(()=>{const e=oe();T(e?e[i.keyName]:""),le()&&l(I,e?2:1,!0)}),we(()=>{l(w,W(""),!0),l(s,-1)});const de=()=>{Ce.showMobileSearchLayer={options:a(w),keyName:i.keyName,keyID:i.keyId,onSelect:e=>{G(e)},onRemove:e=>{}}};var q=ut(),ce=b(q);{var Ie=e=>{var t=at(),n=be(t),r=k(n,2),v=b(r,!0),d=k(v);xe(d,()=>ve()||""),m(r);var o=k(r,2),_=k(o,2);g(()=>{c(n,1,p(x.input_lab_cell_left),"svelte-1m1yl0c"),c(r,1,p(x.input_lab),"svelte-1m1yl0c"),U(v,i.label),c(o,1,p(x.input_lab_cell_right),"svelte-1m1yl0c"),c(_,1,p(x.input_shadow_layer),"svelte-1m1yl0c")}),f(e,t)};C(ce,e=>{i.label&&e(Ie)})}var B=k(ce,2),fe=b(B);{var Oe=e=>{var t=nt();g(()=>c(t,1,p(x.input_div_1),"svelte-1m1yl0c")),f(e,t)};C(fe,e=>{i.label&&e(Oe)})}var ue=k(fe,2);{var Ee=e=>{var t=ot();t.__keyup=j,t.__keydown=n=>{n.stopPropagation(),console.log(n),Ne(n)},Se(t,n=>u=n,()=>u),g(()=>{c(t,1,`w-full ${x.input_inp} ${te()}`,"svelte-1m1yl0c"),Ye(t,"placeholder",A()?"":i.placeholder||":: seleccione ::"),t.disabled=a(ne)||a(ae)}),z("paste",t,j),z("cut",t,j),z("focus",t,n=>{n.stopPropagation(),a(L)||(Pe(),l(K,[],!0),l(w,W(""),!0),l(L,!0))}),z("blur",t,n=>{if(n.stopPropagation(),console.log("avoidBlur 2",O),O){O=!1,u.focus();return}let r=String(u.value||"").toLowerCase();const v=D().find(d=>String(d[i.keyName]||"").toLowerCase()===r);se(v),l(L,!1)}),f(e,t)},Re=e=>{var t=rt();t.__keydown=o=>{(o.key==="Enter"||o.key===" ")&&de()},t.__click=o=>{o.stopPropagation(),de()};var n=b(t),r=b(n);{var v=o=>{var _=Ge();g(()=>U(_,a(H))),f(o,_)},d=o=>{var _=lt(),J=b(_,!0);m(_),g(()=>U(J,i.placeholder||"")),f(o,_)};C(r,o=>{a(H)?o(v):o(d,!1)})}m(n),m(t),g(()=>c(t,1,`w-full flex items-center ${x.input_inp} ${te()}`,"svelte-1m1yl0c")),f(e,t)};C(ue,e=>{a(F)?e(Re,!1):e(Ee)})}var Te=k(ue,2);{var qe=e=>{var t=je(),n=be(t);xe(n,()=>ve()||""),f(e,t)};C(Te,e=>{i.label||e(qe)})}m(B);var _e=k(B,2);{var Be=e=>{var t=st();f(e,t)};C(_e,e=>{A()&&e(Be)})}var me=k(_e,2);{var Me=e=>{var t=vt(),n=b(t);m(t),g(()=>{c(t,1,`absolute bottom-8 right-6 pointer-events-none ${a(L)&&!i.icon?"show":""}`),c(n,1,p(i.icon||"icon-down-open-1"),"svelte-1m1yl0c")}),f(e,t)};C(me,e=>{a(ne)||e(Me)})}var Ue=k(me,2);{var ze=e=>{var t=ft();let n;t.__mousedown=d=>{d.stopPropagation(),O=!0,console.log("avoidBlur 1",O)},t.__mousemove=function(...d){(a(N)?o=>{console.log("hover aqui:: ",a(s)),o.stopPropagation(),a(N)&&(l(s,-1),l(N,!1))}:void 0)?.apply(this,d)};let r;var v=b(t);Se(it(v,{get items(){return a(w)},renderItem:(o,_=ke,J=ke)=>{const Ae=V(()=>String(_()[i.keyName])),He=V(()=>et(a(Ae),a(K)));var E=ct();E.__click=Q=>{Q.stopPropagation(),G(_())};var ge=b(E);Je(ge,21,()=>a(He),Qe,(Q,X)=>{var M=dt();let he;var Ke=b(M,!0);m(M),g(()=>{he=c(M,1,p(a(X).highl?"_8":""),"svelte-1m1yl0c",he,{"mr-4":a(X).isEnd}),U(Ke,a(X).text)}),f(Q,M)}),m(ge),m(E),g(()=>c(E,1,`flex ai-center _highlight${a(s)===J()?" _selected":""}`,"svelte-1m1yl0c")),f(o,E)},$$slots:{renderItem:!0}}),o=>R=o,()=>R),m(t),g(d=>{n=c(t,1,`_1 p-4 left-0 z-320 ${a(s)>=0?" on-arrow":""} ${(i.optionsCss||"w-full")??""}`,"svelte-1m1yl0c",n,{"open-up":a(ie)}),r=Xe(t,"",r,d)},[()=>({height:Math.min(a(w).length*36+10,300)+"px"})]),f(e,t)};C(Ue,e=>{a(L)&&!a(F)&&e(ze)})}m(q),g(()=>{c(q,1,p(a(Ve)),"svelte-1m1yl0c"),c(B,1,`${x.input_div} flex w-full`,"svelte-1m1yl0c")}),f(pe,q),We()}Ze(["keyup","keydown","click","mousedown","mousemove"]);export{Nt as S};
