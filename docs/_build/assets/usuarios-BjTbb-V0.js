import{a as I,c as i,d as B,g as w,b as l,i as n,r as N,t as C}from"./web-n9SrCLWm.js";import{t as G,f as Y,I as u,g as J,P as K,N as v,L as x}from"./app-CxTCLAtU.js";import{s as S,M as W}from"./Modals-BV2PqnYn.js";import{Q as X}from"./QTable-BpZD-x6b.js";import{a as Z,b as ee,e as se,h as re}from"./empresas-BJmgJAZ8.js";var ae=C('<div class=h100><div class="flex ai-center jc-between mb-06"><div class="search-c4 mr-16 w16rem"><div><i class=icon-search></i></div><input class=w100 autocomplete=off type=text></div><div class="flex ai-center"><button class="bn1 b-green"><i class=icon-plus></i></button></div></div><!$><!/>'),te=C('<div class="flex-wrap ai-start w100-10"><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/><!$><!/>'),ie=C('<button class="bnr2 b-blue b-card-1"><i class=icon-pencil>');function ge(){Z();const[m,k]=ee(),[V]=se(),[le,L]=I(""),[a,y]=I({}),P=async r=>{const e=a();if((e.usuario?.length||0)<4||(e.nombres?.length||0)<4){v.failure("El usuario y el nombre deben tener al menos 4 caracteres.");return}if(e.password1&&(e.password1=e.password1.trim()),e.password2&&(e.password2=e.password2.trim()),!e.id||e.password1){let t="";if((e.password1.length||0)<6?t="El password tiene menos de 6 caracteres.":e.password1!==e.password2&&(t="Los password no coinciden."),t){v.failure(t);return}}x.standard("Creando /Actualizando Usuario...");try{var c=await re(e)}catch(t){v.failure(t),x.remove();return}let o=[...m().usuarios];if(e.id){const t=m().usuarios.find(d=>d.id===e.id);t&&Object.assign(t,e),r&&(o=o.filter(d=>d.id!==e.id))}else e.id=c.id,o.unshift(e);x.remove(),k({...m(),usuarios:o}),S([])};return i(K,{title:"Usuarios",fetchLoading:!0,get children(){return[(()=>{var r=w(ae),e=r.firstChild,c=e.firstChild,o=c.firstChild,t=o.nextSibling,d=c.nextSibling,p=d.firstChild,$=e.nextSibling,[b,f]=l($.nextSibling);return t.$$keyup=s=>{s.stopPropagation(),G(()=>{L((s.target.value||"").toLowerCase().trim())},150)},p.$$click=s=>{s.stopPropagation(),y({ss:1}),S([1])},n(r,i(X,{get data(){return m()?.usuarios||[]},css:"w100",maxHeight:"calc(80vh - 13rem)",style:{height:"100%"},columns:[{header:"ID",headerStyle:{width:"3.4rem"},css:"c",getValue:s=>s.id},{header:"Usuario",cardCss:"h3 ff-bold c-purple",getValue:s=>s.usuario,cardColumn:[1,1]},{header:"Nombres",cardColumn:[2,1],getValue:s=>s.nombres+" "+s.apellidos},{header:"Email",cardColumn:[3,1],cardCss:"h5 c-steel",getValue:s=>s.email},{header:"Estado",cardColumn:[3,2],getValue:s=>s.ss,cardCss:"h5 c-steel"},{header:"Actualizado",headerStyle:{width:"9rem"},css:"nowrap",getValue:s=>Y(s.upd,"Y-m-d h:n")},{header:"...",headerStyle:{width:"2.6rem"},css:"t-c",cardColumn:[1,2],render:(s,_)=>{const h=g=>{g.stopPropagation(),S([1]),y({...s})};return(()=>{var g=w(ie);return g.$$click=h,N(),g})()}}]}),b,f),N(),r})(),i(W,{id:1,css:"w56-78 in-s2",get title(){return(a()?.id>0?"Actualizar":"Guardar")+" Usuario"},onSave:()=>{console.log("usuario a guardar::",a()),P()},onDelete:()=>{P(!0)},get children(){var r=w(te),e=r.firstChild,[c,o]=l(e.nextSibling),t=c.nextSibling,[d,p]=l(t.nextSibling),$=d.nextSibling,[b,f]=l($.nextSibling),s=b.nextSibling,[_,h]=l(s.nextSibling),g=_.nextSibling,[O,M]=l(g.nextSibling),q=O.nextSibling,[U,D]=l(q.nextSibling),T=U.nextSibling,[A,z]=l(T.nextSibling),F=A.nextSibling,[E,j]=l(F.nextSibling),H=E.nextSibling,[Q,R]=l(H.nextSibling);return n(r,i(u,{get saveOn(){return a()},save:"usuario",css:"w-12x mb-10",label:"Usuario",required:!0,get disabled(){return a()?.id>0}}),c,o),n(r,i(u,{get saveOn(){return a()},save:"nombres",css:"w-12x mb-10",label:"Nombres",required:!0}),d,p),n(r,i(u,{get saveOn(){return a()},save:"apellidos",css:"w-12x mb-10",label:"Apellidos"}),b,f),n(r,i(u,{get saveOn(){return a()},save:"documentoNro",css:"w-12x mb-10",label:"NÂº Documento"}),_,h),n(r,i(u,{get saveOn(){return a()},save:"cargo",css:"w-12x mb-10",label:"Cargo"}),O,M),n(r,i(u,{get saveOn(){return a()},save:"email",css:"w-12x mb-10",label:"Email"}),U,D),n(r,i(J,{get saveOn(){return a()},save:"perfilesIDs",css:"w100 mb-10 ai-start",label:"",placeholder:"Perfiles",get options(){return V().perfiles},keys:"id.nombre",inputCss:"w-07x"}),A,z),n(r,i(u,{get saveOn(){return a()},save:"password1",css:"w-12x mb-10",label:"Password",type:"password",get required(){return!a().id},get placeholder(){return a().id>0?"SIN CAMBIAR":""}}),E,j),n(r,i(u,{get saveOn(){return a()},save:"password2",get required(){return!a().id},css:"w-12x mb-10",label:"Password (Repetir)",type:"password"}),Q,R),r}})]}})}B(["keyup","click"]);export{ge as default};
