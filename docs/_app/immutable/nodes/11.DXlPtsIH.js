import"../chunks/DsnmJJEf.js";import{p as It,a2 as Q,at as qe,g as nt,h as Yn,a3 as F,f as X,d as z,k as m,au as ye,r as I,s as D,t as ne,b as j,c as Bt,a as Ct,aq as Gs,av as fi,b5 as Ks,a4 as wf}from"../chunks/CoEcz8eb.js";import{d as Ht,e as Gr,s as Zn}from"../chunks/CIpRkWH_.js";import{b as Ha,s as Mt,a as Vt,I as je}from"../chunks/CysHyBII.js";import{i as le}from"../chunks/CZCr84qS.js";import{e as vt,i as ct}from"../chunks/MjN7i789.js";import{b as jt}from"../chunks/D7eQMbNi.js";import{s as Le}from"../chunks/C1K6KTtW.js";import{s as Z,b as wr,r as za,f as kf,a as Lo,c as Lt}from"../chunks/BxqDrd8s.js";import{p as Ce}from"../chunks/B7OHwWN5.js";import{a as _f}from"../chunks/Dxj41lBf.js";import{h as Mf,C as Ae,E as Ro,W as xa,o as Df,j as Ws,i as Fo,k as Of,l as Po,b as Ao}from"../chunks/CwZvhMPn.js";import{i as Lf,N as qr,L as yt,C as Rf}from"../chunks/C6iZXTXK.js";import{G as Vs,a as Oi}from"../chunks/B2GziuOo.js";import{I as Un}from"../chunks/gFbNI_3o.js";import{P as Ff}from"../chunks/DgJN7ZGk.js";import{h as No}from"../chunks/DPaJEl9x.js";import{h as Pf,t as js}from"../chunks/CyzubGmB.js";import{V as Af}from"../chunks/B4JyWbwP.js";import{P as Nf}from"../chunks/CC0srtFs.js";var If=X('<i class="icon-ok"></i>'),Bf=X('<div class="flex items-center"><button><!></button> <label> </label></div>'),Hf=X("<div></div>");function zf(t,e){It(e,!0);const r=Ce(e,"saveOn",15);let n=Q(qe([]));const a=s=>{const l=s[e.keyId];e.type=="multiple"?m(n).includes(l)?F(n,m(n).filter(u=>u!==l),!0):m(n).push(l):m(n).includes(l)?F(n,[],!0):F(n,[l],!0),r()&&e.save&&(e.type==="multiple"?r(r()[e.save]=m(n),!0):r(r()[e.save]=m(n)[0]||void 0,!0))};let i;nt(()=>{!r()||!e.save||i!==r()&&(i=r(),Yn(()=>{e.type==="multiple"?F(n,r()[e.save]||[],!0):F(n,[r()[e.save]||[]],!0)}))});var o=Hf();vt(o,21,()=>e.options,ct,(s,l)=>{const u=ye(()=>m(n).includes(m(l)[e.keyId]));var d=Bf(),f=z(d);let h;f.__click=b=>{b.stopPropagation(),a(m(l))};var v=z(f);{var c=b=>{var y=If();j(b,y)};le(v,b=>{m(u)&&b(c)})}I(f);var p=D(f,2),g=z(p,!0);I(p),I(d),ne(()=>{h=Z(f,1,"flex mr-4 pt-1 items-center p-0 lh-10 justify-center rounded-[4px] shrink-0 w-28 h-26 _1 svelte-vp2fnd",null,h,{_2:m(u)}),wr(f,"aria-label",m(l)[e.keyName]),Le(g,m(l)[e.keyName])}),j(s,d)}),I(o),ne(()=>Z(o,1,`flex ${e.css??""}`,"svelte-vp2fnd")),j(t,o),Bt()}Ht(["click"]);var vi=function(t,e){return vi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},vi(t,e)};function Li(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");vi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var C=function(){return C=Object.assign||function(e){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},C.apply(this,arguments)};function xf(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(r=0)),r;)try{if(n=1,a&&(i=u[0]&2?a.return:u[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,u[1])).done)return i;switch(a=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function At(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function M(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(s){o={error:s}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function P(t,e,r){if(r||arguments.length===2)for(var n=0,a=e.length,i;n<a;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}function Fr(t){var e={blockGroupType:"Document",blocks:[]};return t&&(e.format=t),e}function Zr(t){switch(t.blockType){case"Paragraph":return t.segments.length==0;case"Table":return t.rows.every(function(e){return e.cells.length==0});case"BlockGroup":return Ri(t);case"Entity":return!1;default:return!1}}function Ri(t){switch(t.blockGroupType){case"FormatContainer":return t.tagName=="div"?!1:t.blocks.every(Zr);case"ListItem":return t.blocks.every(Zr);case"Document":case"General":case"TableCell":return!1;default:return!0}}function qs(t,e){var r;switch(t.segmentType){case"Text":return!t.text&&(!e||!(!((r=t.link)===null||r===void 0)&&r.format.name));default:return!1}}function Uf(t){return Wf(t)?Ri(t):Kf(t)?Zr(t):Gf(t)?qs(t):!1}function Gf(t){return typeof t.segmentType=="string"}function Kf(t){return typeof t.blockType=="string"}function Wf(t){return typeof t.blockGroupType=="string"}var Xs=["marginRight","marginLeft","paddingRight","paddingLeft"],Ys=["direction","textAlign","htmlAlign"],Fi=Xs.concat(Ys),Vf=["backgroundColor","direction","textAlign","htmlAlign","lineHeight","textIndent","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft"];function Sr(t,e,r,n){var a,i,o;try{for(var s=At(r),l=s.next();!l.done;l=s.next()){var u=l.value;e[u]!==void 0&&(Object.assign(t,(o={},o[u]=e[u],o)),n&&delete e[u])}}catch(d){a={error:d}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(a)throw a.error}}}function w(t){t.cachedElement&&delete t.cachedElement,jf(t)?t.rows.forEach(function(r){delete r.cachedElement}):qf(t)&&t.levels.forEach(function(r){return delete r.cachedElement});var e=t;return e}function Pi(t,e){var r=w(t),n=[r,[],[]];return e&&e.forEach(function(a){var i=t.segments.indexOf(a);i>=0&&(n[1].push(r.segments[i]),n[2].push(i))}),n}function at(t,e,r){var n,a=M(Pi(t,[e]),3),i=a[0],o=a[1],s=a[2],l=o[0]==e?o[0]:null;return r&&l&&r(o[0],i,s[0]),[i,l,(n=s[0])!==null&&n!==void 0?n:-1]}function jf(t){return t.blockType=="Table"}function qf(t){return t.blockGroupType=="ListItem"}function ie(t){return Object.keys(t)}function ar(t,e){if(t==e)return!0;var r=ie(t),n=ie(e);return r.length==n.length&&r.every(function(a){return t[a]==e[a]})}function zt(t){return{segmentType:"Br",format:C({},t)}}var Xf=["pre","pre-wrap","break-spaces"];function an(t){return!!t&&Xf.indexOf(t)>=0}var Yf=/^[\r\n\t ]*$/;function Zs(t){return Yf.test(t)}var rr=" ",ci=" ",Zf=/^\u0020+/,Js=/\u0020+$/;function Jf(t){var e=Ai();t.segments.forEach(function(r){Qs(t,r,e)}),$s(t,e.textSegments,e.lastInlineSegment),eu(t,e.lastTextSegment,e.lastInlineSegment)}function Qf(t,e,r){r===void 0&&(r=!1);var n=Ai();n.ignoreTrailingSpaces=r,Qs(t,e,n)}function Ai(t){return Object.assign(t??{},{textSegments:[],ignoreLeadingSpaces:!0,ignoreTrailingSpaces:!0,lastInlineSegment:void 0,lastTextSegment:void 0})}function Qs(t,e,r){switch(e.segmentType){case"Br":$s(t,r.textSegments,r.lastInlineSegment),eu(t,r.lastTextSegment,r.lastInlineSegment),Ai(r);break;case"Entity":case"General":case"Image":r.lastInlineSegment=e,r.ignoreLeadingSpaces=!1;break;case"Text":r.textSegments.push(e),r.lastInlineSegment=e,r.lastTextSegment=e;var n=e.text.substring(0,1),a=e.text.substr(-1);Zs(e.text)||(n==rr&&at(t,e,function(i){i.text=i.text.replace(Zf,r.ignoreLeadingSpaces?"":ci)}),a==rr&&at(t,e,function(i){i.text=i.text.replace(Js,r.ignoreTrailingSpaces?rr:ci)})),r.ignoreLeadingSpaces=a==rr;break}}function $s(t,e,r){e.forEach(function(n){if(n!=r){var a=n.text;a.substr(-1)==ci&&a.length>1&&a.substr(-2,1)!=rr&&at(t,n,function(i){i.text=a.substring(0,a.length-1)+rr})}})}function eu(t,e,r){e&&e==r&&e?.text.substr(-1)==rr&&at(t,e,function(n){n.text=n.text.replace(Js,"")})}function tu(t){var e=t.segments;if(!t.isImplicit&&e.length>0){var r=e[e.length-1],n=e[e.length-2];if(r.segmentType=="SelectionMarker"&&(!n||n.segmentType=="Br"))w(t).segments.push(zt(r.format));else if(e.length>1&&e[e.length-1].segmentType=="Br"){var a=e.filter(function(i){return i.segmentType!="SelectionMarker"});a.length>1&&a[a.length-2].segmentType!="Br"&&w(t).segments.pop()}$f(t)}an(t.format.whiteSpace)||Jf(t),tv(t),ev(t),nv(t)}function $f(t){t.format.whiteSpace&&t.segments.every(function(e){return e.segmentType=="Br"||e.segmentType=="SelectionMarker"})&&delete w(t).format.whiteSpace}function ev(t){for(var e=t.segments.length-1;e>=0;e--)qs(t.segments[e],!0)&&w(t).segments.splice(e,1)}function tv(t){var e=t.segments.find(function(i){return i.segmentType=="SelectionMarker"});if(e){var r=t.segments.indexOf(e),n=t.segments[r-1],a=t.segments[r+1];(n&&!n.link&&ar(n.format,e.format)&&(!a||!a.link&&ar(a.format,e.format))&&e.link||!n&&e.link&&a&&!a.link&&ar(a.format,e.format))&&at(t,e,function(i){delete i.link})}}var rv=["fontFamily","fontSize","textColor"];function nv(t){if(!t.decorator){var e=t.segments.filter(function(a){return a.segmentType!="SelectionMarker"}),r=t.segmentFormat||{},n=!1;rv.forEach(function(a){n=av(e,r,a)||n}),n&&(w(t).segmentFormat=r)}}function av(t,e,r){var n,a=(n=t[0])===null||n===void 0?void 0:n.format;return a?.[r]&&t.every(function(i){return i.format[r]==a[r]})&&e[r]!=a[r]?(e[r]=a[r],!0):!1}function Xe(t){t.blockType=="Paragraph"&&t.isImplicit&&(w(t).isImplicit=!1)}function Ni(t,e,r){var n,a,i,o=(a=t?.blocks.indexOf(e))!==null&&a!==void 0?a:-1;o>=0&&(e.blocks.forEach(Xe),t&&((i=w(t))===null||i===void 0||(n=i.blocks).splice.apply(n,P([o,1],M(e.blocks.map(function(s){var l=w(s);return r&&Sr(l.format,e.format,r),l})),!1))))}function ht(t){for(var e=t.blocks.length-1;e>=0;e--){var r=t.blocks[e];switch(r.blockType){case"BlockGroup":r.blockGroupType=="ListItem"&&r.levels.length==0?(e+=r.blocks.length,Ni(t,r,Fi)):ht(r);break;case"Paragraph":tu(r);break;case"Table":for(var n=0;n<r.rows.length;n++)for(var a=0;a<r.rows[n].cells.length;a++)r.rows[n].cells[a]&&ht(r.rows[n].cells[a]);break}Zr(r)&&w(t).blocks.splice(e,1)}}function on(t,e){var r,n=Fr(e.defaultFormat);return((r=e.selection)===null||r===void 0?void 0:r.type)=="range"&&e.selection.isReverted&&(n.hasRevertedRangeSelection=!0),e.domIndexer&&e.allowCacheElement&&(n.persistCache=!0),e.elementProcessors.child(n,t,e),ht(n),n}function L(t,e){return!!t&&t.nodeType==Node[e]}function Ze(t){return[].slice.call(t)}function Ii(t,e,r,n){n.modelHandlers.blockGroupChildren(t,e,r,n);var a=iv(t,n);return r.hasRevertedRangeSelection&&a?.type=="range"&&(a.isReverted=!0),n.domIndexer&&n.allowCacheElement&&(r.persistCache=!0),e.normalize(),a}function iv(t,e){var r=e.regularSelection,n=r.start,a=r.end,i=e.tableSelection,o=e.imageSelection,s,l;if(o)return o;if((s=n&&Io(n))&&(l=a&&Io(a))){var u=t.createRange();return u.setStart(s.container,s.offset),u.setEnd(l.container,l.offset),{type:"range",range:u,isReverted:!1}}else return i||null}function Io(t){var e,r,n,a,i,o;if(t.block&&(t.segment?L(t.segment,"TEXT_NODE")?o={container:t.segment,offset:(n=(e=t.offset)!==null&&e!==void 0?e:(r=t.segment.nodeValue)===null||r===void 0?void 0:r.length)!==null&&n!==void 0?n:0}:t.segment.parentNode&&(o={container:t.segment.parentNode,offset:Ze(t.segment.parentNode.childNodes).indexOf(t.segment)+1}):o={container:t.block,offset:0}),o&&L(o.container,"DOCUMENT_FRAGMENT_NODE")){var s=o.container.childNodes;if(s.length>o.offset)o={container:s[o.offset],offset:0};else if(o.container.lastChild){var l=o.container.lastChild;o={container:l,offset:L(l,"TEXT_NODE")?(i=(a=l.nodeValue)===null||a===void 0?void 0:a.length)!==null&&i!==void 0?i:0:l.childNodes.length}}else o=void 0}return o}var ov="________________________________________",lv={onDivider:function(t){return t.tagName=="hr"?ov:""},onEntityBlock:function(){return""},onEntitySegment:function(t){var e;return(e=t.wrapper.textContent)!==null&&e!==void 0?e:""},onGeneralSegment:function(t){var e;return(e=t.element.textContent)!==null&&e!==void 0?e:""},onImage:function(){return" "},onText:function(t){return t.text},onParagraph:function(){return!0},onTable:function(){return!0},onBlockGroup:function(){return!0}};function sv(t,e,r){e===void 0&&(e=`\r
`);var n=[],a=Object.assign({},lv,r);return hi(t,n,a),n.join(e)}function hi(t,e,r){r.onBlockGroup(t)&&t.blocks.forEach(function(n){switch(n.blockType){case"Paragraph":if(r.onParagraph(n)){var a="";n.segments.forEach(function(i){switch(i.segmentType){case"Br":e.push(a),a="";break;case"Entity":a+=r.onEntitySegment(i);break;case"General":a+=r.onGeneralSegment(i);break;case"Text":a+=r.onText(i);break;case"Image":a+=r.onImage(i);break}}),a&&e.push(a)}break;case"Divider":e.push(r.onDivider(n));break;case"Entity":e.push(r.onEntityBlock(n));break;case"Table":r.onTable(n)&&n.rows.forEach(function(i){return i.cells.forEach(function(o){hi(o,e,r)})});break;case"BlockGroup":hi(n,e,r);break}})}function ze(t,e){t.blocks.push(e)}function Ge(t,e,r,n){var a={blockType:"Paragraph",segments:[],format:C({},e)};return r&&Object.keys(r).length>0&&(a.segmentFormat=C({},r)),t&&(a.isImplicit=!0),n&&(a.decorator={tagName:n.tagName,format:C({},n.format)}),a}function ha(t,e,r){var n=t.blocks[t.blocks.length-1];if(n?.blockType=="Paragraph")return w(n);var a=Ge(!0,e,r);return ze(t,a),a}function it(t,e,r,n){var a=ha(t,r,n),i=a.segments[a.segments.length-1];return r?.textIndent&&(r.isTextIndentApplied&&a.segments.length==0?delete a.format.textIndent:r.isTextIndentApplied=!0,delete a.format.isTextIndentApplied),e.segmentType=="SelectionMarker"?(!i||!i.isSelected||!e.isSelected)&&a.segments.push(e):(e.isSelected&&i?.segmentType=="SelectionMarker"&&i.isSelected&&a.segments.pop(),a.segments.push(e)),a}function Bi(t,e){(e.format.href||e.format.name)&&(t.link={format:C({},e.format),dataset:C({},e.dataset)})}function Hi(t,e){e.format.fontFamily&&(t.code={format:C({},e.format)})}function pa(t,e){Bi(t,e.link),Hi(t,e.code)}function He(t){return{segmentType:"SelectionMarker",isSelected:!0,format:C({},t)}}function ru(t,e,r,n){var a=t.blocks[t.blocks.length-1],i=!a||a.blockType!="Paragraph"?{}:a.decorator?{fontFamily:a.decorator.format.fontFamily,fontSize:a.decorator.format.fontSize}:a.segmentFormat?{fontFamily:a.segmentFormat.fontFamily,fontSize:a.segmentFormat.fontSize}:{},o=e.pendingFormat&&e.pendingFormat.insertPoint.node===r&&e.pendingFormat.insertPoint.offset===n?e.pendingFormat.format:void 0,s=Object.assign({},e.defaultFormat,i,e.segmentFormat,o),l=He(s);return pa(l,e),l}function kr(t,e,r,n){var a=ru(t,e,r,n);it(t,a,e.blockFormat,a.format)}function ln(t,e){var r,n=((r=t.selection)===null||r===void 0?void 0:r.type)=="range"?t.selection.range:null,a=n?.startContainer==e?n.startOffset:-1,i=n?.endContainer==e?n.endOffset:-1;return[a,i]}var uv=function(t,e,r){for(var n=M(ln(r,e),2),a=n[0],i=n[1],o=0,s=e.firstChild;s;s=s.nextSibling)Jn(o,r,t,a,i,e),zi(t,s,r),o++;Jn(o,r,t,a,i,e)};function zi(t,e,r){L(e,"ELEMENT_NODE")&&(e.style.display!="none"||r.processNonVisibleElements)?r.elementProcessors.element(t,e,r):L(e,"TEXT_NODE")&&r.elementProcessors["#text"](t,e,r)}function Jn(t,e,r,n,a,i){var o;t==n&&(e.isInSelection=!0,kr(r,e,i,t)),t==a&&((o=e.selection)===null||o===void 0?void 0:o.type)=="range"&&(e.selection.range.collapsed||kr(r,e,i,t),e.isInSelection=!1)}function nu(t,e,r,n,a){return e===void 0&&(e=!0),{segmentType:"Entity",blockType:"Entity",format:C({},r),entityFormat:{id:a,entityType:n,isReadonly:e},wrapper:t}}var Oe={display:"block"},dv={address:Oe,article:Oe,aside:Oe,b:{fontWeight:"bold"},blockquote:{display:"block",marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},br:Oe,center:{display:"block",textAlign:"center"},dd:{display:"block",marginInlineStart:"40px"},div:Oe,dl:{display:"block",marginTop:"1em",marginBottom:"1em"},dt:Oe,em:{fontStyle:"italic"},fieldset:Oe,figcaption:Oe,figure:Oe,footer:Oe,form:Oe,h1:{display:"block",fontWeight:"bold",fontSize:"2em"},h2:{display:"block",fontWeight:"bold",fontSize:"1.5em"},h3:{display:"block",fontWeight:"bold",fontSize:"1.17em"},h4:{display:"block",fontWeight:"bold"},h5:{display:"block",fontWeight:"bold",fontSize:"0.83em"},h6:{display:"block",fontWeight:"bold",fontSize:"0.67em"},header:Oe,hr:Oe,i:{fontStyle:"italic"},li:{display:"list-item"},main:Oe,nav:Oe,ol:C(C({},Oe),{paddingInlineStart:"40px"}),p:{display:"block",marginTop:"1em",marginBottom:"1em"},pre:{display:"block",fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"},s:{textDecoration:"line-through"},section:Oe,strike:{textDecoration:"line-through"},strong:{fontWeight:"bold"},sub:{verticalAlign:"sub",fontSize:"smaller"},sup:{verticalAlign:"super",fontSize:"smaller"},table:{display:"table",boxSizing:"border-box"},td:{display:"table-cell"},th:{display:"table-cell",fontWeight:"bold"},u:{textDecoration:"underline"},ul:C(C({},Oe),{paddingInlineStart:"40px"})};function ga(t){var e=t.tagName.toLowerCase();return dv[e]||{}}var fv=["block","list-item","table","table-cell","flex"];function xt(t){var e=t.style.display=="none"?null:t.style.display,r=e||ga(t).display||"";return fv.indexOf(r)>=0}function K(t,e,r,n){var a=ga(t);e.forEach(function(i){i?.(r,t,n,a)})}var vv=["backgroundColor"],cv=["marginLeft","marginRight","paddingLeft","paddingRight"];function Se(t,e,r){var n=t.segmentFormat,a=t.blockFormat,i=t.link,o=t.code,s=t.blockDecorator,l=e.segment,u=e.paragraph,d=e.link,f=e.code,h=e.blockDecorator;try{t.segmentFormat=Bo(n,l),t.blockFormat=Bo(a,u),t.link=hv(i,d),t.code=pv(o,f),t.blockDecorator=gv(s,h),r()}finally{t.segmentFormat=n,t.blockFormat=a,t.link=i,t.code=o,t.blockDecorator=s}}function hv(t,e){switch(e){case"linkDefault":return{format:{underline:!0},dataset:{}};case"empty":return{format:{},dataset:{}};case"cloneFormat":default:return{dataset:t.dataset,format:C({},t.format)}}}function pv(t,e){switch(e){case"codeDefault":return{format:{fontFamily:"monospace"}};case"empty":return{format:{}};default:return t}}function gv(t,e){switch(e){case"empty":return{format:{},tagName:""};default:return t}}function Bo(t,e){switch(e){case"empty":return{};case void 0:return t;default:var r=C({},t);if(ie(t).forEach(function(a){(e=="shallowCloneForBlock"&&vv.indexOf(a)>=0||e=="shallowCloneForGroup"&&cv.indexOf(a)>=0)&&delete r[a]}),e=="shallowClone"||e=="shallowCloneForGroup"){var n=t;n.textIndent&&(delete r.isTextIndentApplied,n.isTextIndentApplied=!0)}return r}}var mv=function(t,e,r){var n=xt(e)||e.style.display=="inline-block"&&e.style.width=="100%";Se(r,{segment:n?"empty":void 0,paragraph:"empty"},function(){var a,i=nu(e,!0,r.segmentFormat);if(K(e,r.formatParsers.entity,i.entityFormat,r),r.isInSelection&&(i.isSelected=!0),n)ze(t,i);else{var o=it(t,i);(a=r.domIndexer)===null||a===void 0||a.onSegment(e,o,[i])}})};function bv(t,e){return e===void 0&&(e=0),{height:e,format:C({},t),cells:[]}}function au(t,e){for(var r=[],n=0;n<t;n++)r.push(bv());return{blockType:"Table",rows:r,format:C({},e),widths:[],dataset:{}}}function Nt(t,e,r,n,a){var i=typeof t=="number"?t>1:!!t,o=typeof e=="number"?e>1:!!e;return{blockGroupType:"TableCell",blocks:[],format:C({},n),spanLeft:i,spanAbove:o,isHeader:!!r,dataset:C({},a)}}function yv(t){return t.getBoundingClientRect()}function xi(t){return t?t.type=="range"?t.range.commonAncestorContainer:t.type=="table"?t.table:t.type=="image"?t.image:void 0:void 0}function ae(t,e){var r;return((r=t?.tagName)===null||r===void 0?void 0:r.toLocaleLowerCase())==e}var Ev=/(-?\d+(\.\d+)?)([a-z]+|%)/,Cv=96,Sv=16;function Ke(t,e,r){t===void 0&&(t=""),r===void 0&&(r="px");var n=Ev.exec(t),a=0;if(n){var i=M(n,4);i[0];var o=i[1];i[2];var s=i[3],l=parseFloat(o);switch(s){case"px":a=l;break;case"pt":a=iu(l);break;case"em":a=Mn(e)*l;break;case"ex":a=Mn(e)*l/2;break;case"%":a=Mn(e)*l/100;break;case"in":a=l*Cv;break;case"rem":a=(Mn(e)||Sv)*l;break}}return a>0&&r=="pt"&&(a=Tv(a)),a}function Mn(t){var e,r;if(typeof t>"u")return 0;if(typeof t=="number")return t;var n=(r=(e=t.ownerDocument.defaultView)===null||e===void 0?void 0:e.getComputedStyle(t).fontSize)!==null&&r!==void 0?r:"",a=parseFloat(n),i=iu(a);return i}function iu(t){return Math.round(t*4e3/3)/1e3}function Tv(t){return Math.round(t*3e3/4)/1e3}var wv=function(t,e,r){Se(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},function(){var n,a;K(e,r.formatParsers.block,r.blockFormat,r);var i=au(e.rows.length,r.blockFormat),o=((n=r.selection)===null||n===void 0?void 0:n.type)=="table"?r.selection:null,s=o?.table,l=s==e,u=Mv(e,r);r.allowCacheElement&&(i.cachedElement=e),(a=r.domIndexer)===null||a===void 0||a.onTable(e,i),K(e,r.formatParsers.table,i.format,r),K(e,r.formatParsers.tableBorder,i.format,r),K(e,r.formatParsers.segmentOnBlock,r.segmentFormat,r),K(e,r.formatParsers.dataset,i.dataset,r),ze(t,i);for(var d=[0],f=_v(e,r,d),h=[0],v=r.zoomScale||1,c=function(b){var y=e.rows[b],E=i.rows[b],S=y.parentNode;L(S,"ELEMENT_NODE")&&(ae(S,"tbody")||ae(S,"thead")||ae(S,"tfoot"))?K(S,r.formatParsers.tableRow,E.format,r):r.allowCacheElement&&(E.cachedElement=y),K(y,r.formatParsers.tableRow,E.format,r),Se(r,{paragraph:"shallowClone",segment:"shallowClone"},function(){var k=y.parentElement,R=k&&Dv(k);R&&(K(k,r.formatParsers.block,r.blockFormat,r),K(k,r.formatParsers.segmentOnBlock,r.segmentFormat,r)),K(y,r.formatParsers.block,r.blockFormat,r),K(y,r.formatParsers.segmentOnBlock,r.segmentFormat,r),E.height=parseInt(y.style.height)||0;for(var H=function(J,x){for(;E.cells[x];x++);var G=y.cells[J],pe=r.isInSelection;if(u){var $=x+G.colSpan,re=b+G.rowSpan,we=d[$]===void 0,$e=h[re]===void 0;if(we||$e){var se=yv(G);if(se.width>0||se.height>0){if(we){var ot=d[x];d[$]=(typeof ot=="number"?ot:0)+se.width/v}$e&&(h[re]=h[b]+se.height/v)}}}Se(r,{paragraph:"shallowClone",segment:"shallowClone"},function(){K(G,r.formatParsers.block,r.blockFormat,r),K(G,r.formatParsers.segmentOnTableCell,r.segmentFormat,r);var bt=C({},r.blockFormat),ke={};K(G,r.formatParsers.tableCell,bt,r),K(G,r.formatParsers.tableBorder,bt,r),K(G,r.formatParsers.dataset,ke,r);for(var fe=1;fe<=(G.colSpan==0?1:G.colSpan);fe++,x++)for(var Re=1;Re<=(G.rowSpan==0?R?kv(k,G):1:G.rowSpan);Re++){var lt=fe==1&&Re==1,ge=Nt(fe>1,Re>1,G.tagName=="TH",bt);ge.dataset=C({},ke);var Ne=i.rows[b+Re-1];if(Ne&&(Ne.cells[x]=ge),lt){r.allowCacheElement&&!f&&(ge.cachedElement=G);var et=r.listFormat,Gt=et.listParent,st=et.levels;r.listFormat.listParent=void 0,r.listFormat.levels=[];try{r.elementProcessors.child(ge,G,r)}finally{r.listFormat.listParent=Gt,r.listFormat.levels=st}}var Tt=r.isInSelection;(pe&&Tt||l&&o&&b>=o.firstRow&&b<=o.lastRow&&x>=o.firstColumn&&x<=o.lastColumn)&&(ge.isSelected=!0)}}),U=x},U,q=0,W=0;q<y.cells.length;q++)H(q,W),W=U});for(var T=0;T<E.cells.length;T++)E.cells[T]||(E.cells[T]=Nt(!1,!1,!1,r.blockFormat))},p=0;p<e.rows.length;p++)c(p);i.widths=Ho(d);var g=Ho(h);i.rows.forEach(function(b,y){g[y]>0&&(b.height=g[y])})})};function kv(t,e){for(var r=t.rows.length,n=-1,a=0;a<t.rows.length;a++){for(var i=t.rows[a],o=0;o<i.cells.length;o++)if(i.cells[o]===e){n=a;break}if(n!==-1)break}return r-n}function Ho(t){for(var e=[],r=0,n=t.length-1;n>=0;n--){var a=t[n];if(typeof a=="number"){r=a;break}}for(var n=t.length-2;n>=0;n--){var a=t[n];a===void 0?e[n]=0:(e[n]=r-a,r=a)}return e}function _v(t,e,r){for(var n,a,i=0,o=!1,s=t.firstChild;s;s=s.nextSibling)if(L(s,"ELEMENT_NODE")&&s.tagName=="COLGROUP"){o=!0;for(var l=s.firstChild;l;l=l.nextSibling)if(L(l,"ELEMENT_NODE")&&l.tagName=="COL"){var u={};K(l,e.formatParsers.tableColumn,u,e);for(var d=0;d<parseInt((n=l.getAttribute("span"))!==null&&n!==void 0?n:"1");d++)if(u.width===void 0)r.push(void 0);else{var f=Ke((a=u.width)!==null&&a!==void 0?a:"",void 0,"px");r.push(f+i),i+=f}}}return o}function Mv(t,e){switch(e.recalculateTableSize){case!0:case"all":return!0;case"selected":var r=xi(e.selection);return!!r&&(r==t||t.contains(r)||r.contains(t));default:return!1}}function Dv(t){return ae(t,"tbody")||ae(t,"thead")||ae(t,"tfoot")}function Qn(t,e){var r=!1;if(e.isOptional&&typeof t>"u"||e.allowNull&&t===null)r=!0;else{if(!e.isOptional&&typeof t>"u"||!e.allowNull&&t===null)return!1;switch(e.type){case"string":r=typeof t=="string"&&(typeof e.value>"u"||t===e.value);break;case"number":r=typeof t=="number"&&(typeof e.value>"u"||Ov(e.value,t))&&(typeof e.minValue>"u"||t>=e.minValue)&&(typeof e.maxValue>"u"||t<=e.maxValue);break;case"boolean":r=typeof t=="boolean"&&(typeof e.value>"u"||t===e.value);break;case"array":r=Array.isArray(t)&&(typeof e.minLength>"u"||t.length>=e.minLength)&&(typeof e.maxLength>"u"||t.length<=e.maxLength)&&t.every(function(n){return Qn(n,e.itemDef)});break;case"object":r=typeof t=="object"&&ie(e.propertyDef).every(function(n){return Qn(t[n],e.propertyDef[n])});break}}return r}function Ov(t,e){return Math.abs(t-e)<.001}var $n="editingInfo";function ma(t,e){var r=t.dataset[$n],n=null;try{n=JSON.parse(r)}catch{}return!e||Qn(n,e)?n:null}function ba(t,e,r){var n=ma(t,r);return e&&(n=e(n),n?(!r||Qn(n,r))&&(t.dataset[$n]=JSON.stringify(n)):delete t.dataset[$n]),n}function ou(t){return!!t.dataset[$n]}var Lv=/^[.|\-|_|\d]/;function _r(t){return t&&(t.match(Lv)?'[id="'+t+'"]':"#"+t)}function St(t,e,r){if(t){for(;!r&&t.firstChild;)t.removeChild(t.firstChild);for(;e?.firstChild;)t.appendChild(e.firstChild)}}function ir(t,e){var r=t.ownerDocument.createElement(e);return St(r,t),t.appendChild(r),r}function sn(t,e,r){var n,a=t.createElement(r);return(n=e.parentNode)===null||n===void 0||n.insertBefore(a,e),a.appendChild(e),a}function lu(t){var e=t?t.parentNode:null;if(!e)return null;for(;t.firstChild;)e.insertBefore(t.firstChild,t);return e.removeChild(t),e}function ee(t,e,r,n){e.forEach(function(a){a?.(r,t,n)})}var un="_Entity",Rv="."+un,pi="_EType_",gi="_EId_",mi="_EReadonly_",Ui="​",Gi="entityDelimiterBefore",Ki="entityDelimiterAfter",su="_E_EBlockEntityContainer",Fv="."+su;function pt(t){return L(t,"ELEMENT_NODE")&&t.classList.contains(un)}function Wi(t,e){return e.findClosestElementAncestor(t,Rv)}function uu(t,e){return e.findClosestElementAncestor(t,Fv)}function du(t){return Ze(t.querySelectorAll("."+un))}function or(t){var e=!1,r={};return t.classList.forEach(function(n){e=Pv(n,r)||e}),e||(r.isFakeEntity=!0,r.isReadonly=!t.isContentEditable),r}function Pv(t,e){if(t==un)return!0;t.indexOf(pi)==0?e.entityType=t.substring(pi.length):t.indexOf(gi)==0?e.id=t.substring(gi.length):t.indexOf(mi)==0&&(e.isReadonly=t.substring(mi.length)=="1")}function fu(t){var e;return t.isFakeEntity?"":un+" "+pi+((e=t.entityType)!==null&&e!==void 0?e:"")+" "+(t.id?""+gi+t.id+" ":"")+mi+(t.isReadonly?"1":"0")}function Rt(t,e){var r=e===void 0||e,n=e===void 0||!e;return ae(t,"span")&&(n&&t.classList.contains(Ki)||r&&t.classList.contains(Gi))&&t.textContent===Ui}function dn(t){return ae(t,"div")&&t.classList.contains(su)}function Vi(t,e,r,n){var a=M(Av(e),2),i=a[0],o=a[1];return i||(i=xo(t,e,!0),n&&r&&ee(i,n.formatAppliers.segment,r,n)),o||(o=xo(t,e,!1),n&&r&&ee(o,n.formatAppliers.segment,r,n)),[i,o]}function Av(t){var e=[],r=t.nextElementSibling,n=t.previousElementSibling;return e.push(zo(r,Ki),zo(n,Gi)),e}function zo(t,e){return t?.classList.contains(e)&&t.textContent==Ui?t:void 0}function xo(t,e,r){var n,a=t.createElement("span");return a.className=r?Ki:Gi,a.appendChild(t.createTextNode(Ui)),(n=e.parentNode)===null||n===void 0||n.insertBefore(a,r?e.nextSibling:e),a}function lr(t,e,r,n){var a;if(e.parentNode==t){for(var i=pt(e);r&&r!=e&&(i||!pt(r));){var o=r.nextSibling;(a=r.parentNode)===null||a===void 0||a.removeChild(r),L(r,"ELEMENT_NODE")&&n?.removedBlockElements.push(r),r=o}r&&r==e?r=r.nextSibling:t.insertBefore(e,r)}else t.insertBefore(e,r);return r}function Te(t){var e=t||{left:0,right:0,top:0,bottom:0},r=e.left,n=e.right,a=e.top,i=e.bottom;return r===0&&n===0&&a===0&&i===0?null:{left:Math.round(r),right:Math.round(n),top:Math.round(a),bottom:Math.round(i)}}function Nv(t,e,r,n,a,i){a===void 0&&(a=0),i===void 0&&(i=!1);var o,s=0;a!=0&&(o=Ua(r,o),s=Math.max(0,Math.min(a*o,(e.bottom-e.top-n.bottom+n.top)/2)));var l=n.top-s,u=n.bottom+s,d=u-l,f=function(){o=Ua(r,o),t.scrollTop-=(e.top-l)/o},h=function(){o=Ua(r,o),t.scrollTop+=(u-e.bottom)/o},v=l<e.top,c=u>e.bottom;d>e.bottom-e.top?i?f():h():i?v?f():c&&h():c?h():v&&f()}function Ua(t,e){return e===void 0?t.calculateZoomScale():e}function ji(t,e){var r=t,n=r.__roosterjsHiddenProperty;return n?n[e]:void 0}function qi(t,e,r){var n=t,a=n.__roosterjsHiddenProperty||{};a[e]=r,n.__roosterjsHiddenProperty=a}var vu="undeletable";function Iv(t,e){qi(t,vu,e)}function cu(t){return!!ji(t,vu)}function sr(t,e,r){return{listType:t,format:C({},e),dataset:C({},r)}}function fn(t,e){var r=He(e);return r.isSelected=!1,{blockType:"BlockGroup",blockGroupType:"ListItem",blocks:[],levels:t?t.map(function(n){return sr(n.listType,n.format,n.dataset)}):[],formatHolder:r,format:{}}}function Xi(t,e){return{blockType:"BlockGroup",blockGroupType:"FormatContainer",tagName:t,blocks:[],format:C({},e)}}function xe(t,e,r,n){var a={segmentType:"Text",text:t,format:C({},e)};return r&&Bi(a,r),n&&Hi(a,n),a}function Bv(t,e){return{segmentType:"Image",src:t,format:C({},e),dataset:{}}}function hu(t,e){return{tagName:t.toLocaleLowerCase(),format:C({},e)}}function Hv(t,e){return{blockType:"BlockGroup",blockGroupType:"General",segmentType:"General",format:C({},e),blocks:[],element:t}}function zv(t){return{blockType:"BlockGroup",blockGroupType:"General",element:t,blocks:[],format:{}}}function xv(t,e){return{blockType:"Divider",tagName:t,format:C({},e)}}function Uv(t){var e=Fr(t),r=Ge(!1,void 0,t);return r.segments.push(He(t),zt(t)),e.blocks.push(r),e}function Xr(t,e,r){var n,a;if(e){var i=ha(t,r.blockFormat);(!Zs(e)||((n=i?.segments.length)!==null&&n!==void 0?n:0)>0||an(i?.format.whiteSpace))&&(a=xe(e,r.segmentFormat),r.isInSelection&&(a.isSelected=!0),pa(a,r),it(t,a,r.blockFormat))}return a}function pu(t){return t.blockGroupType=="General"&&t.segmentType=="General"}function Gv(t){for(var e=null,r=0;r<t.segments.length;r++){var n=t.segments[r];n.segmentType!="Text"?e=null:!e||!Kv(e,n)?e=n:(e.text+=n.text,t.segments.splice(r,1),r--)}}function Kv(t,e){return!!t.isSelected==!!e.isSelected&&ar(t.format,e.format)&&Wv(t.link,e.link)&&Vv(t.code,e.code)}function Wv(t,e){return!t&&!e||t&&e&&ar(t.format,e.format)&&ar(t.dataset,e.dataset)}function Vv(t,e){return!t&&!e||t&&e&&ar(t.format,e.format)}var jv={a:{underline:!0,textColor:void 0},blockquote:{marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},code:{fontFamily:"monospace"},dd:{marginLeft:"40px"},dl:{marginTop:"1em",marginBottom:"1em"},h1:{fontWeight:"bold",fontSize:"2em"},h2:{fontWeight:"bold",fontSize:"1.5em"},h3:{fontWeight:"bold",fontSize:"1.17em"},h4:{fontWeight:"bold",fontSize:"1em"},h5:{fontWeight:"bold",fontSize:"0.83em"},h6:{fontWeight:"bold",fontSize:"0.67em"},p:{marginTop:"1em",marginBottom:"1em"},pre:{fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"},th:{fontWeight:"bold"}},qv=function(t,e,r,n,a){var i=n.modelHandlers;switch(r.blockType){case"Table":a=i.table(t,e,r,n,a);break;case"Paragraph":a=i.paragraph(t,e,r,n,a);break;case"Entity":a=i.entityBlock(t,e,r,n,a);break;case"Divider":a=i.divider(t,e,r,n,a);break;case"BlockGroup":switch(r.blockGroupType){case"General":a=i.generalBlock(t,e,r,n,a);break;case"FormatContainer":a=i.formatContainer(t,e,r,n,a);break;case"ListItem":a=i.listItem(t,e,r,n,a);break}break}return a},Xv=function(t,e,r,n){var a,i=n.listFormat,o=i.nodeStack,s=e.firstChild;try{for(r.blocks.forEach(function(u,d){var f;(d==0||u.blockType!="BlockGroup"||u.blockGroupType!="ListItem")&&(i.nodeStack=[]),s=n.modelHandlers.block(t,e,u,n,s),u.blockType=="Entity"&&((f=n.domIndexer)===null||f===void 0||f.onBlockEntity(u,r))});s;){var l=s.nextSibling;L(s,"ELEMENT_NODE")&&n.rewriteFromModel.removedBlockElements.push(s),(a=s.parentNode)===null||a===void 0||a.removeChild(s),s=l}}finally{i.nodeStack=o}};function ya(t,e,r,n,a,i){var o;e.firstChild||(a.regularSelection.current.segment=e),ee(r,a.formatAppliers.styleBasedSegment,n.format,a),i?.push(e),a.modelHandlers.segmentDecorator(t,r,n,a,i),ee(r,a.formatAppliers.elementBasedSegment,n.format,a),(o=a.onNodeCreated)===null||o===void 0||o.call(a,n,e)}var Yv=function(t,e,r,n,a){var i=t.createElement("br"),o=t.createElement("span");o.appendChild(i),e.appendChild(o),ya(t,i,o,r,n,a)},Zv=function(t,e,r,n,a){var i,o=n.allowCacheElement?r.cachedElement:void 0;return o&&!r.isSelected?a=lr(e,o,a,n.rewriteFromModel):(o=t.createElement(r.tagName),n.allowCacheElement&&(r.cachedElement=o),e.insertBefore(o,a),n.rewriteFromModel.addedBlockElements.push(o),ee(o,n.formatAppliers.divider,r.format,n),r.size&&o.setAttribute("size",r.size)),(i=n.onNodeCreated)===null||i===void 0||i.call(n,r,o),a},Uo="_E_EBlockEntityContainer",Jv=function(t,e,r,n,a){var i,o,s=r.entityFormat,l=r.wrapper;ee(l,n.formatAppliers.entity,s,n);var u=n.addDelimiterForEntity&&l.style.display=="inline-block"&&l.style.width=="100%",d=(i=l.parentElement)===null||i===void 0?void 0:i.classList.contains(Uo),f=d&&u?l.parentElement:l;if(a=lr(e,f,a,n.rewriteFromModel),u){if(!d){var h=sn(t,l,"div");h.classList.add(Uo)}Vi(t,l,gu(n),n)}return(o=n.onNodeCreated)===null||o===void 0||o.call(n,r,l),a},Qv=function(t,e,r,n,a){var i,o=r.entityFormat,s=r.wrapper,l=r.format;if(e.appendChild(s),a?.push(s),ie(l).length>0){var u=sn(t,s,"span");ee(u,n.formatAppliers.segment,l,n)}if(ee(s,n.formatAppliers.entity,o,n),n.addDelimiterForEntity&&o.isReadonly){var d=M(Vi(t,s,gu(n),n),2),f=d[0],h=d[1];a&&(a.push(f,h),f.firstChild&&a.push(f.firstChild),h.firstChild&&a.push(h.firstChild)),n.regularSelection.current.segment=f}else n.regularSelection.current.segment=s;(i=n.onNodeCreated)===null||i===void 0||i.call(n,r,s)};function gu(t){var e;return C(C({},(e=t.pendingFormat)===null||e===void 0?void 0:e.format),t.defaultFormat)}function qt(t,e,r){var n=typeof e=="string"?t.defaultContentModelFormatMap[e]:e;if(n){var a=t.implicitFormat;try{t.implicitFormat=C(C({},a),n),r()}finally{t.implicitFormat=a}}else r()}var $v={fontFamily:"monospace",whiteSpace:"pre"},ec=function(t,e,r,n,a){var i,o=n.allowCacheElement?r.cachedElement:void 0;if(o)a=lr(e,o,a,n.rewriteFromModel),n.modelHandlers.blockGroupChildren(t,o,r,n);else if(!Ri(r)){var s=t.createElement(r.tagName);n.allowCacheElement&&(r.cachedElement=s),e.insertBefore(s,a),n.rewriteFromModel.addedBlockElements.push(s),qt(n,r.tagName,function(){ee(s,n.formatAppliers.container,r.format,n),ee(s,n.formatAppliers.segmentOnBlock,r.format,n),ee(s,n.formatAppliers.container,r.format,n)}),r.tagName=="pre"?qt(n,$v,function(){n.modelHandlers.blockGroupChildren(t,s,r,n)}):n.modelHandlers.blockGroupChildren(t,s,r,n),o=s}return o&&((i=n.onNodeCreated)===null||i===void 0||i.call(n,r,o)),a},tc=function(t,e,r,n,a){var i,o=r.element;return a&&o.parentNode==e?a=lr(e,o,a,n.rewriteFromModel):(o=o.cloneNode(),r.element=o,ee(o,n.formatAppliers.general,r.format,n),e.insertBefore(o,a),n.rewriteFromModel.addedBlockElements.push(o)),(i=n.onNodeCreated)===null||i===void 0||i.call(n,r,o),n.modelHandlers.blockGroupChildren(t,o,r,n),a},rc=function(t,e,r,n,a){var i,o=r.element.cloneNode();if(r.element=o,e.appendChild(o),L(o,"ELEMENT_NODE")){var s=sn(t,o,"span");ya(t,o,s,r,n,a),ee(o,n.formatAppliers.general,r.format,n),(i=n.onNodeCreated)===null||i===void 0||i.call(n,r,o)}n.modelHandlers.blockGroupChildren(t,o,r,n)},nc=function(t,e,r,n,a){var i=t.createElement("img"),o=document.createElement("span");e.appendChild(o),o.appendChild(i),i.src=r.src,r.alt&&(i.alt=r.alt),r.title&&(i.title=r.title),ee(i,n.formatAppliers.image,r.format,n),ee(i,n.formatAppliers.dataset,r.dataset,n);var s=r.format,l=s.width,u=s.height,d=l?Ke(l):0,f=u?Ke(u):0;d>0&&(i.width=d),f>0&&(i.height=f),r.isSelectedAsImageSelection&&(n.imageSelection={type:"image",image:i}),ya(t,i,o,r,n,a)};function mu(t,e,r,n){e&&ba(t,function(a){return e.applierFunction(a,r,n),a},e.metadataDefinition)}var ac=function(t,e,r,n,a){var i,o,s,l=0,u=n.listFormat.nodeStack;for(u.length==0&&u.push({node:e});l<r.levels.length&&l+1<u.length;l++){var d=u[l+1],f=r.levels[l];if(d.listType!=f.listType||((i=d.dataset)===null||i===void 0?void 0:i.editingInfo)!=f.dataset.editingInfo||f.listType=="OL"&&typeof f.format.startNumberOverride=="number"||f.listType=="UL"&&f.format.listStyleType!=((o=d.format)===null||o===void 0?void 0:o.listStyleType))break}for(u.splice(l+1);l<r.levels.length;l++){var h=r.levels[l],v=t.createElement(h.listType||"UL"),c=u[u.length-1].node;c.insertBefore(v,l==0?a:null),u.push(C({node:v},h)),ee(v,n.formatAppliers.listLevelThread,h.format,n),mu(h,n.metadataAppliers.listLevel,h.format,n),ee(v,n.formatAppliers.listLevel,h.format,n),ee(v,n.formatAppliers.dataset,h.dataset,n),(s=n.onNodeCreated)===null||s===void 0||s.call(n,h,v)}return a},ic=new Set(["div","span","p","section","article","aside","header","footer","main","nav","address","blockquote","pre","figure","figcaption","hgroup"]);function oc(t){if(!t)return!1;var e=t.tagName.toLowerCase();return ic.has(e)}var lc="role",sc="presentation",uc=function(t,e,r,n,a){var i,o;a=n.modelHandlers.list(t,e,r,n,a);var s=n.listFormat.nodeStack,l=((i=s?.[s?.length-1])===null||i===void 0?void 0:i.node)||e,u=t.createElement("li"),d=r.levels[r.levels.length-1];l.insertBefore(u,a?.parentNode==l?a:null),n.rewriteFromModel.addedBlockElements.push(u),d?(ee(u,n.formatAppliers.segment,r.formatHolder.format,n),ee(u,n.formatAppliers.listItemThread,d.format,n),mu(d,n.metadataAppliers.listItem,r.format,n),ee(u,n.formatAppliers.listItemElement,r.format,n),qt(n,r.formatHolder.format,function(){n.modelHandlers.blockGroupChildren(t,u,r,n)})):(r.blocks.forEach(Xe),n.modelHandlers.blockGroupChildren(t,u,r,n),lu(u));for(var f=0;f<u.children.length;f++){var h=u.children.item(f);oc(h)&&h.setAttribute(lc,sc)}return(o=n.onNodeCreated)===null||o===void 0||o.call(n,r,u),a},dc=["SPAN","B","EM","I","U","SUB","SUP","STRIKE","S","A","CODE"];function fc(t){for(var e=t.firstChild;e;){var r=e.nextSibling;if(r&&L(e,"ELEMENT_NODE")&&L(r,"ELEMENT_NODE")&&e.tagName==r.tagName&&dc.indexOf(e.tagName)>=0&&vc(e,r)){for(;r.firstChild;)e.appendChild(r.firstChild);r.parentNode.removeChild(r)}else e=r}}function vc(t,e){var r=t.attributes,n=e.attributes;if(r.length!=n.length)return!1;for(var a=0;a<r.length;a++)if(r[a].name!=n[a].name||r[a].value!=n[a].value)return!1;return!0}function cc(t){for(var e=t.firstChild;e;)if(L(e,"ELEMENT_NODE")&&e.tagName=="SPAN"&&e.attributes.length==0){var r=e,n=e.nextSibling;for(e=e.nextSibling;r.lastChild;){var a=r.lastChild;t.insertBefore(a,n),n=a}t.removeChild(r)}else e=e.nextSibling}function bu(t,e){if(!pt(t)){cc(t),fc(t);for(var r=t.firstChild;r;r=r.nextSibling)bu(r,e);hc(t,e)}}function hc(t,e){var r,n,a,i,o=null,s,l,u=e.regularSelection;for(s=t.firstChild,l=s?s.nextSibling:null;s;s=l,l=s?s.nextSibling:null)if(!L(s,"TEXT_NODE"))o=null;else if(!o)o=s;else{var d=(n=(r=o.nodeValue)===null||r===void 0?void 0:r.length)!==null&&n!==void 0?n:0;(a=e.domIndexer)===null||a===void 0||a.onMergeText(o,s),o.nodeValue+=(i=s.nodeValue)!==null&&i!==void 0?i:"",u&&(Go(u.start,o,s,d),Go(u.end,o,s,d)),t.removeChild(s)}}function Go(t,e,r,n){t&&t.offset==null&&(t.segment==e?t.offset=n:t.segment==r&&(t.segment=e))}var pc="div",gc=function(t,e,r,n,a){var i,o=n.allowCacheElement?r.cachedElement:void 0;return o&&r.segments.every(function(s){return s.segmentType!="General"&&!s.isSelected})?a=lr(e,o,a,n.rewriteFromModel):qt(n,((i=r.decorator)===null||i===void 0?void 0:i.tagName)||null,function(){var s,l,u,d,f,h=!r.isImplicit||!!r.decorator||ie(r.format).length>0&&r.segments.some(function(p){return p.segmentType!="SelectionMarker"}),v=h?C(C({},((s=r.decorator)===null||s===void 0?void 0:s.format)||{}),r.segmentFormat):{};o=t.createElement(((l=r.decorator)===null||l===void 0?void 0:l.tagName)||pc),e.insertBefore(o,a),n.regularSelection.current={block:h?o:o.parentNode,segment:null};var c=function(){var p=o;if(p){var g=r.segments[0];g?.segmentType=="SelectionMarker"&&n.modelHandlers.text(t,p,C(C({},g),{segmentType:"Text",text:""}),n,[]),r.segments.forEach(function(b){var y=[];n.modelHandlers.segment(t,p,b,n,y),y.forEach(function(E){var S;(S=n.domIndexer)===null||S===void 0||S.onSegment(E,r,[b])})})}};h?(qt(n,v,c),ee(o,n.formatAppliers.block,r.format,n),ee(o,n.formatAppliers.container,r.format,n),ee(o,n.formatAppliers.segmentOnBlock,v,n),(u=n.paragraphMap)===null||u===void 0||u.applyMarkerToDom(o,r)):c(),bu(o,n),a=o.nextSibling,o&&((d=n.onNodeCreated)===null||d===void 0||d.call(n,r,o),(f=n.domIndexer)===null||f===void 0||f.onParagraph(o)),h?(n.allowCacheElement&&(r.cachedElement=o),n.rewriteFromModel.addedBlockElements.push(o)):(lu(o),o=void 0)}),a},mc=function(t,e,r,n,a){var i=n.regularSelection;switch(r.isSelected&&!i.start&&(i.start=C({},i.current)),r.segmentType){case"Text":n.modelHandlers.text(t,e,r,n,a);break;case"Br":n.modelHandlers.br(t,e,r,n,a);break;case"Image":n.modelHandlers.image(t,e,r,n,a);break;case"General":n.modelHandlers.generalSegment(t,e,r,n,a);break;case"Entity":n.modelHandlers.entitySegment(t,e,r,n,a);break}r.isSelected&&i.start&&(i.end=C({},i.current))},bc=function(t,e,r,n){var a=r.code,i=r.link;L(e,"ELEMENT_NODE")&&(i&&qt(n,"a",function(){var o,s=ir(e,"a");ee(s,n.formatAppliers.link,i.format,n),ee(s,n.formatAppliers.dataset,i.dataset,n),(o=n.onNodeCreated)===null||o===void 0||o.call(n,i,s)}),a&&qt(n,"code",function(){var o,s=ir(e,"code");ee(s,n.formatAppliers.code,a.format,n),(o=n.onNodeCreated)===null||o===void 0||o.call(n,a,s)}))},yc=function(t,e,r,n,a){var i,o,s,l,u,d,f;if(Zr(r))return a;var h=n.allowCacheElement?r.cachedElement:void 0;h?(a=lr(e,h,a,n.rewriteFromModel),St(h)):(h=t.createElement("table"),n.allowCacheElement&&(r.cachedElement=h),e.insertBefore(h,a),n.rewriteFromModel.addedBlockElements.push(h),ee(h,n.formatAppliers.block,r.format,n),ee(h,n.formatAppliers.table,r.format,n),ee(h,n.formatAppliers.tableBorder,r.format,n),ee(h,n.formatAppliers.dataset,r.dataset,n)),(i=n.onNodeCreated)===null||i===void 0||i.call(n,r,h);var v=t.createElement("tbody");h.appendChild(v);for(var c=0;c<r.rows.length;c++){var p=r.rows[c];if(p.cells.length!=0){var g=n.allowCacheElement&&p.cachedElement||t.createElement("tr");v.appendChild(g),St(g),p.cachedElement||(n.allowCacheElement&&(p.cachedElement=g),ee(g,n.formatAppliers.tableRow,p.format,n)),(o=n.onNodeCreated)===null||o===void 0||o.call(n,p,g);for(var b=function(E){var S=p.cells[E];if(S.isSelected){var T=n.tableSelection||{type:"table",table:h,firstColumn:E,lastColumn:E,firstRow:c,lastRow:c};T.table==h&&(T.lastColumn=Math.max(T.lastColumn,E),T.lastRow=Math.max(T.lastRow,c)),n.tableSelection=T}if(!S.spanAbove&&!S.spanLeft){var k=S.isHeader?"th":"td",R=n.allowCacheElement&&S.cachedElement||t.createElement(k);g.appendChild(R);for(var H=1,U=1,q=r.widths[E],W=p.height;!((l=(s=r.rows[c+H])===null||s===void 0?void 0:s.cells[E])===null||l===void 0)&&l.spanAbove;H++)W+=r.rows[c+H].height;for(;!((u=p.cells[E+U])===null||u===void 0)&&u.spanLeft;U++)q+=r.widths[E+U];H>1&&(R.rowSpan=H),U>1&&(R.colSpan=U),(!S.cachedElement||S.format.useBorderBox&&ou(r))&&(q>0&&!R.style.width&&(R.style.width=q+"px"),W>0&&!R.style.height&&(R.style.height=W+"px")),qt(n,k,function(){S.cachedElement||(n.allowCacheElement&&(S.cachedElement=R),ee(R,n.formatAppliers.block,S.format,n),ee(R,n.formatAppliers.tableCell,S.format,n),ee(R,n.formatAppliers.tableCellBorder,S.format,n),ee(R,n.formatAppliers.dataset,S.dataset,n)),n.modelHandlers.blockGroupChildren(t,R,S,n)}),(d=n.onNodeCreated)===null||d===void 0||d.call(n,S,R)}},y=0;y<p.cells.length;y++)b(y)}}return(f=n.domIndexer)===null||f===void 0||f.onTable(h,r),a},Ec=function(t,e,r,n,a){var i=t.createTextNode(r.text),o=t.createElement("span");e.appendChild(o),o.appendChild(i),n.formatAppliers.text.forEach(function(s){return s(r.format,i,n)}),ya(t,i,o,r,n,a)},Ko={block:qv,blockGroupChildren:Xv,br:Yv,entityBlock:Jv,entitySegment:Qv,generalBlock:tc,generalSegment:rc,divider:Zv,image:nc,list:ac,listItem:uc,paragraph:gc,formatContainer:ec,segment:mc,segmentDecorator:bc,table:yc,text:Ec},Cc={parse:function(t,e){var r=e.getAttribute("aria-describedby"),n=e.getAttribute("title");r&&(t.ariaDescribedBy=r),n&&(t.title=n)},apply:function(t,e){t.ariaDescribedBy&&e.setAttribute("aria-describedby",t.ariaDescribedBy),t.title&&e.setAttribute("title",t.title)}},yu=["inactiveborder","activeborder","inactivecaptiontext","inactivecaption","activecaption","appworkspace","infobackground","background","buttonhighlight","buttonshadow","captiontext","infotext","menutext","menu","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedfhadow","windowtext","windowframe","window"],Sc="rgb(0, 0, 0)",Tc=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,wc=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,kc=/^rgb\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,_c=/^rgba\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,Eu=/^\s*var\(\s*(\-\-[a-zA-Z0-9\-_]+)\s*(?:,\s*(.*))?\)\s*$/,bi="var(",Mc=")",Dc="--darkColor";function Mr(t,e,r,n,a){var i=(e?t.style.backgroundColor:t.style.color)||t.getAttribute(e?"bgcolor":"color")||a;if(i&&yu.indexOf(i)>-1)i=e?void 0:Sc;else if(n&&i){var o=i.startsWith(bi)?Eu.exec(i):null;o?i=o[2]||"":r&&(i=Lc(i,n.knownColors)||"")}return i}function Dr(t,e,r,n,a){var i,o,s=e&&e.startsWith(bi)?Eu.exec(e):null,l=M(s??[],3);l[0];var u=l[1],d=l[2];if(e=d??e,a&&e){var f=r?"background":"text",h=u||a.generateColorKey(e,void 0,f,t),v=((o=(i=a.knownColors)===null||i===void 0?void 0:i[h])===null||o===void 0?void 0:o.darkModeColor)||a.getDarkColor(e,void 0,f,t);a.updateKnownColor(n,h,{lightModeColor:e,darkModeColor:v}),e=n?""+bi+h+", "+e+Mc:e}t.removeAttribute(r?"bgcolor":"color"),t.style.setProperty(r?"background-color":"color",e||null)}var Oc=function(t){return Dc+"_"+t.replace(/[^\d\w]/g,"_")};function yi(t){t=(t||"").trim();var e;return(e=t.match(Tc))?[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]:(e=t.match(wc))?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:(e=t.match(kc)||t.match(_c))?[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]:null}function Lc(t,e){var r=yi(t);if(r&&e){var n=ie(e).find(function(a){var i=yi(e[a].darkModeColor);return i&&i[0]==r[0]&&i[1]==r[1]&&i[2]==r[2]});if(n)return e[n].lightModeColor}return null}function Ea(t,e,r,n){return!!t&&t!="inherit"&&!!(t!=e||r||n&&t!=n)}var Rc={parse:function(t,e,r,n){var a=Mr(e,!0,!!r.isDarkMode,r.darkColorHandler)||n.backgroundColor;Ea(a,"transparent",void 0,n.backgroundColor)&&(t.backgroundColor=a)},apply:function(t,e,r){t.backgroundColor&&Dr(e,t.backgroundColor,!0,!!r.isDarkMode,r.darkColorHandler)}},Fc={parse:function(t,e,r,n){var a=e.style.fontWeight||n.fontWeight;Ea(a,"400",t.fontWeight,n.fontWeight)&&(t.fontWeight=a)},apply:function(t,e,r){if(!(typeof t.fontWeight>"u")){var n=r.implicitFormat.fontWeight;(n&&n!=t.fontWeight||!n&&t.fontWeight&&t.fontWeight!="normal")&&(t.fontWeight=="bold"?ir(e,"b"):e.style.fontWeight=t.fontWeight||"normal")}}},Pc={parse:function(t,e){var r;((r=e.style)===null||r===void 0?void 0:r.boxSizing)=="border-box"&&(t.useBorderBox=!0)},apply:function(t,e){t.useBorderBox&&(e.style.boxSizing="border-box")}},vn=["borderTop","borderRight","borderBottom","borderLeft"],Wo=["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"],Cu=["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"],Ac=vn.concat(Cu),Nc={parse:function(t,e,r,n){vn.forEach(function(i,o){var s,l=e.style[i],u=(s=n[Wo[o]])!==null&&s!==void 0?s:"0px",d=e.style[Wo[o]];d=="0"&&(d="0px"),l&&d!=u&&(t[i]=l=="none"?"":l)});var a=e.style.borderRadius;a?t.borderRadius=a:Cu.forEach(function(i){var o=e.style[i];o&&(t[i]=o)})},apply:function(t,e){Ac.forEach(function(r){var n=t[r];n&&(e.style[r]=n)}),t.borderRadius&&(e.style.borderRadius=t.borderRadius)}},Ic={parse:function(t,e){var r;!((r=e.style)===null||r===void 0)&&r.boxShadow&&(t.boxShadow=e.style.boxShadow)},apply:function(t,e){t.boxShadow&&(e.style.boxShadow=t.boxShadow)}},Bc={parse:function(t,e){var r=e.dataset;ie(r).forEach(function(n){t[n]=r[n]||""})},apply:function(t,e){ie(t).forEach(function(r){e.dataset[r]=t[r]})}},Ca={parse:function(t,e,r,n){var a=e.style.direction||e.dir||n.direction;a&&(t.direction=a=="rtl"?"rtl":"ltr")},apply:function(t,e){t.direction&&(e.style.direction=t.direction),t.direction=="rtl"&&ae(e,"table")&&(e.style.justifySelf="flex-end")}},Hc={parse:function(t,e){var r=e.style.display;r&&(t.display=r)},apply:function(t,e){t.display&&(e.style.display=t.display)}},zc={parse:function(t,e){Object.assign(t,or(e))},apply:function(t,e){t.isFakeEntity||(e.className=fu(t)),t.isReadonly?e.contentEditable="false":e.removeAttribute("contenteditable")}},xc={parse:function(t,e){var r=e.style.float||e.getAttribute("align");r&&(t.float=r)},apply:function(t,e){t.float&&(e.style.float=t.float)}},Uc={parse:function(t,e,r,n){var a=e.style.fontFamily||n.fontFamily;a&&a!="inherit"&&(t.fontFamily=a)},apply:function(t,e,r){t.fontFamily&&t.fontFamily!=r.implicitFormat.fontFamily&&(e.style.fontFamily=t.fontFamily)}},Gc={parse:function(t,e,r,n){var a=e.style.verticalAlign||n.verticalAlign,i=e.style.fontSize||n.fontSize;Su(i,a)&&(t.superOrSubScriptSequence=(t.superOrSubScriptSequence||"").split(" ").concat(a).join(" ").trim())},apply:function(t,e){t.superOrSubScriptSequence&&t.superOrSubScriptSequence.split(" ").reverse().forEach(function(r){var n=r=="super"?"sup":r=="sub"?"sub":null;n&&ir(e,n)})}};function Su(t,e){return t=="smaller"&&(e=="sub"||e=="super")}var Kc={parse:function(t,e,r,n){var a=e.style.fontSize||n.fontSize,i=e.style.verticalAlign||n.verticalAlign;a&&!Su(a,i)&&a!="inherit"&&(e.style.fontSize?t.fontSize=Vc(a,r.segmentFormat.fontSize,r):n.fontSize&&(t.fontSize=a))},apply:function(t,e,r){t.fontSize&&t.fontSize!=r.implicitFormat.fontSize&&(e.style.fontSize=t.fontSize)}},Wc={"xx-small":"6.75pt","x-small":"7.5pt",small:"9.75pt",medium:"12pt",large:"13.5pt","x-large":"18pt","xx-large":"24pt","xxx-large":"36pt"};function Vc(t,e,r){var n=Wc[t],a=t.endsWith("rem");if(n)return n;if(t=="smaller"||t=="larger"||t.endsWith("em")||t.endsWith("%")||a){if(!e&&!a)return;var i=a?r.rootFontSize:Ke(e);if(i)switch(t){case"smaller":return Math.round(i*500/6)/100+"px";case"larger":return Math.round(i*600/5)/100+"px";default:return Ke(t,i,"px")+"px"}}else return t=="inherit"||t=="revert"||t=="unset"?void 0:t}var Tu={start:{ltr:"left",rtl:"right"},center:{ltr:"center",rtl:"center"},end:{ltr:"right",rtl:"left"},initial:{ltr:"initial",rtl:"initial"},justify:{ltr:"justify",rtl:"justify"}};function wu(t,e){switch(t){case"center":return"center";case"left":return e=="rtl"?"end":"start";case"right":return e=="rtl"?"start":"end";case"start":case"end":return t;case"justify":case"initial":return t;default:return}}var jc={parse:function(t,e,r,n){if(!e.style.textAlign){Ca.parse(t,e,r,n);var a=e.getAttribute("align");a&&(t.htmlAlign=wu(a,t.direction),delete t.textAlign,delete r.blockFormat.textAlign)}},apply:function(t,e){var r=t.direction=="rtl"?"rtl":"ltr";t.htmlAlign&&e.setAttribute("align",Tu[t.htmlAlign][r])}},qc={parse:function(t,e){e.id&&(t.id=e.id)},apply:function(t,e){t.id&&(e.id=t.id)}};function Xc(t){return ji(t,"imageState")}function Yc(t,e){qi(t,"imageState",e)}var Zc={parse:function(t,e){var r=Xc(e);r&&(t.imageState=r)},apply:function(t,e){t.imageState&&Yc(e,t.imageState)}},Jc={parse:function(t,e,r,n){var a=e.style.fontStyle||n.fontStyle;a=="italic"||a=="oblique"?t.italic=!0:(a=="initial"||a=="normal")&&(t.italic=!1)},apply:function(t,e,r){if(!(typeof t.italic>"u")){var n=r.implicitFormat.italic;!!n!=!!t.italic&&(t.italic?ir(e,"i"):e.style.fontStyle="normal")}}},Qc={parse:function(t,e,r,n){var a=e.style.letterSpacing||n.letterSpacing;Ea(a,"normal",t.letterSpacing,n.letterSpacing)&&(t.letterSpacing=a)},apply:function(t,e){t.letterSpacing&&(e.style.letterSpacing=t.letterSpacing)}},$c={parse:function(t,e,r,n){var a=e.style.lineHeight||n.lineHeight;a&&a!="inherit"&&(t.lineHeight=a)},apply:function(t,e){t.lineHeight&&(e.style.lineHeight=t.lineHeight)}},eh={parse:function(t,e){if(ae(e,"a")){var r=e.name,n=e.getAttribute("href"),a=e.target,i=e.rel,o=e.id,s=e.className,l=e.title;r&&(t.name=r),n&&(t.href=n),a&&(t.target=a),o&&(t.anchorId=o),i&&(t.relationship=i),l&&(t.anchorTitle=l),s&&(t.anchorClass=s)}},apply:function(t,e){ae(e,"a")&&(t.href||t.name)&&(t.href&&(e.href=t.href),t.name&&(e.name=t.name),t.target&&(e.target=t.target),t.anchorId&&(e.id=t.anchorId),t.anchorClass&&(e.className=t.anchorClass),t.anchorTitle&&(e.title=t.anchorTitle),t.relationship&&(e.rel=t.relationship))}},th={parse:function(t,e,r,n){var a=r.listFormat,i=a.levels.length,o=e.style.display||n.display;o&&o!="list-item"?t.displayForDummyItem=o:Vo(e)&&i>0&&(a.threadItemCounts[i-1]++,a.threadItemCounts.splice(i),a.levels.forEach(function(s){delete s.format.startNumberOverride}))},apply:function(t,e,r){var n;if(t.displayForDummyItem)e.style.display=t.displayForDummyItem;else if(Vo(e)){var a=r.listFormat,i=a.threadItemCounts,o=a.nodeStack.length-2;o>=0&&(i.splice(o+1),i[o]=((n=i[o])!==null&&n!==void 0?n:0)+1)}}};function Vo(t){return ae(t,"li")&&L(t.parentNode,"ELEMENT_NODE")&&ae(t.parentNode,"ol")}var rh={parse:function(t,e,r){if(ae(e,"ol")){var n=r.listFormat,a=n.threadItemCounts,i=n.levels,o=i.length;(e.start==1||typeof a[o]=="number"&&e.start!=a[o]+1)&&(t.startNumberOverride=e.start),a[o]=e.start-1}},apply:function(t,e,r){var n=r.listFormat,a=n.threadItemCounts,i=n.nodeStack,o=i.length-2;if(o>=0&&ae(e,"ol")){var s=t.startNumberOverride;typeof s=="number"?a[o]=s-1:typeof a[o]!="number"&&(a[o]=0),a.splice(o+1),e.start=a[o]+1}}},nh={parse:function(t,e){var r=e.style.listStylePosition,n=e.style.listStyleType;r&&(t.listStylePosition=r),n&&(t.listStyleType=n)},apply:function(t,e){t.listStylePosition&&(e.style.listStylePosition=t.listStylePosition),t.listStyleType&&(e.style.listStyleType=t.listStyleType)}},jo=["marginTop","marginRight","marginBottom","marginLeft"],ah={ltr:{marginRight:"marginInlineEnd",marginLeft:"marginInlineStart"},rtl:{marginRight:"marginInlineStart",marginLeft:"marginInlineEnd"}},ih={marginLeft:"marginRight",marginRight:"marginLeft",marginTop:"marginTop",marginBottom:"marginBottom"},oh={parse:function(t,e,r,n){jo.forEach(function(a){var i,o,s=ah[(i=t.direction)!==null&&i!==void 0?i:"ltr"][a],l=e.style[a]||n[a]||(s?(o=n[s])===null||o===void 0?void 0:o.toString():"");if(l)switch(a){case"marginTop":case"marginBottom":t[a]=l;break;case"marginLeft":case"marginRight":t[a]=t[a]?Ke(t[a]||"",e)+Ke(l,e)+"px":l;break}})},apply:function(t,e,r){jo.forEach(function(n){var a=t[n],i=t.direction=="rtl"?ih[n]:n;a!=r.implicitFormat[i]&&(e.style[n]=a||"0")})}},qo=["paddingTop","paddingRight","paddingBottom","paddingLeft"],lh={paddingLeft:"paddingInlineStart"},sh={paddingRight:"paddingInlineStart"},uh={parse:function(t,e,r,n){Ca.parse(t,e,r,n),qo.forEach(function(a){var i,o,s=e.style[a],l=(t.direction=="rtl"?sh:lh)[a],u=((o=(i=n[a])!==null&&i!==void 0?i:l?n[l]:void 0)!==null&&o!==void 0?o:"0px")+"";s||(s=u),(!s||s=="0")&&(s="0px"),s&&s!=u&&(t[a]=s)})},apply:function(t,e,r){qo.forEach(function(n){var a=t[n],i=void 0;(e.tagName=="OL"||e.tagName=="UL")&&(t.direction=="rtl"&&n=="paddingRight"||t.direction!="rtl"&&n=="paddingLeft")&&(i="40px"),a&&a!=i&&(e.style[n]=a)})}},dh={parse:function(t,e){var r=e.getAttribute("role");r&&(t.role=r)},apply:function(t,e){t.role&&e.setAttribute("role",t.role)}},fh=/[\d\.]+%/,vh={parse:function(t,e,r){var n=e.style.width||Xo(e,"width"),a=e.style.height||Xo(e,"height"),i=e.style.maxWidth,o=e.style.maxHeight,s=e.style.minWidth,l=e.style.minHeight;n&&(t.width=n),a&&(t.height=a),i&&(t.maxWidth=i),o&&(t.maxHeight=o),s&&(t.minWidth=s),l&&(t.minHeight=l)},apply:function(t,e){t.width&&(e.style.width=t.width),t.height&&(e.style.height=t.height),t.maxWidth&&(e.style.maxWidth=t.maxWidth),t.maxHeight&&(e.style.maxHeight=t.maxHeight),t.minWidth&&(e.style.minWidth=t.minWidth),t.minHeight&&(e.style.minHeight=t.minHeight)}};function Xo(t,e){var r=t.getAttribute(e),n=parseInt(r||"");return r&&fh.test(r)?r:Number.isNaN(n)||n==0?void 0:n+"px"}var ch={parse:function(t,e,r,n){var a=e.style.textDecoration||n.textDecoration;a?.indexOf("line-through")>=0&&(t.strikethrough=!0)},apply:function(t,e){t.strikethrough&&ir(e,"s")}},hh={parse:function(t,e){var r=e.style.tableLayout;r&&r!="inherit"&&(t.tableLayout=r)},apply:function(t,e){t.tableLayout&&(e.style.tableLayout=t.tableLayout)}},Yo="collapse",Zo="separate",ph="cellPadding",gh={parse:function(t,e){if(e.style.borderCollapse==Yo)t.borderCollapse=!0;else{var r=e.getAttribute(ph);r&&(t.borderCollapse=!0)}e.style.borderCollapse==Zo&&(t.borderSeparate=!0)},apply:function(t,e){t.borderCollapse?(e.style.borderCollapse=Yo,e.style.borderSpacing="0",e.style.boxSizing="border-box"):t.borderSeparate&&(e.style.borderCollapse=Zo,e.style.borderSpacing="0",e.style.boxSizing="border-box")}},mh={parse:function(t,e,r,n){var a;Ca.parse(t,e,r,n);var i=e.style.textAlign||n.textAlign;e.tagName=="LI"&&((a=e.parentElement)===null||a===void 0?void 0:a.style.display)==="flex"&&e.parentElement.style.flexDirection==="column"&&e.style.alignSelf&&(i=e.style.alignSelf),i&&(t.textAlign=wu(i,t.direction))},apply:function(t,e){var r=t.direction=="rtl"?"rtl":"ltr";if(t.textAlign){var n=e.parentElement,a=n?.tagName;e.tagName=="LI"&&n&&(a=="OL"||a=="UL")?(e.style.alignSelf=t.textAlign,e.parentElement.style.flexDirection="column",e.parentElement.style.display="flex"):e.style.textAlign=Tu[t.textAlign][r]}}},bh={parse:function(t,e,r,n){var a=Mr(e,!1,!!r.isDarkMode,r.darkColorHandler)||n.color;a&&a!="inherit"&&(t.textColor=a)},apply:function(t,e,r){var n=r.implicitFormat.textColor;t.textColor&&t.textColor!=n&&Dr(e,t.textColor,!1,!!r.isDarkMode,r.darkColorHandler)}},yh={parse:function(t,e){e.style.color&&delete t.textColor},apply:function(){}},Eh={parse:function(t,e){var r=e.style.textIndent;r&&(t.textIndent=r)},apply:function(t,e){t.textIndent&&(e.style.textIndent=t.textIndent)}},Ch={parse:function(t,e){ae(e,"a")&&cu(e)&&(t.undeletable=!0)},apply:function(t,e){t.undeletable&&ae(e,"a")&&Iv(e,!0)}},Sh={parse:function(t,e,r,n){var a=e.style.textDecoration||n.textDecoration;a?.indexOf("underline")>=0?t.underline=!0:e.tagName=="A"&&a=="none"&&(t.underline=!1)},apply:function(t,e,r){if(!(typeof t.underline>"u")){var n=r.implicitFormat.underline;!!n!=!!t.underline&&(t.underline?ir(e,"u"):e.style.textDecoration="none")}}},Th={parse:function(t,e){var r=e.style.verticalAlign||e.getAttribute("valign");switch(r){case"baseline":case"initial":case"super":case"sub":case"text-top":case"text-bottom":case"top":t.verticalAlign="top";break;case"bottom":t.verticalAlign="bottom";break;case"middle":t.verticalAlign="middle";break}},apply:function(t,e){t.verticalAlign&&(e.style.verticalAlign=t.verticalAlign)}},wh={parse:function(t,e,r,n){var a=e.style.whiteSpace||n.whiteSpace;Ea(a,"normal",t.whiteSpace,n.whiteSpace)&&(t.whiteSpace=a)},apply:function(t,e,r){var n=r.implicitFormat.whiteSpace;t.whiteSpace!=n&&(e.style.whiteSpace=t.whiteSpace||"normal")}},kh={parse:function(t,e,r,n){var a=e.style.wordBreak||n.wordBreak;a&&(t.wordBreak=a)},apply:function(t,e){t.wordBreak&&(e.style.wordBreak=t.wordBreak)}},ea={aria:Cc,backgroundColor:Rc,bold:Fc,border:Nc,borderBox:Pc,boxShadow:Ic,dataset:Bc,direction:Ca,display:Hc,float:xc,fontFamily:Uc,fontSize:Kc,entity:zc,htmlAlign:jc,id:qc,imageState:Zc,italic:Jc,letterSpacing:Qc,lineHeight:$c,link:eh,listItemThread:th,listLevelThread:rh,listStyle:nh,margin:oh,padding:uh,role:dh,size:vh,strike:ch,superOrSubScript:Gc,tableLayout:hh,tableSpacing:gh,textAlign:mh,textColor:bh,textColorOnTableCell:yh,textIndent:Eh,undeletableLink:Ch,underline:Sh,verticalAlign:Th,whiteSpace:wh,wordBreak:kh},Dn=["letterSpacing","fontFamily","fontSize"],On=["strike","underline","superOrSubScript","italic","bold"],Ga=["direction","textAlign","textIndent","lineHeight","whiteSpace"],Jo=["backgroundColor","margin","padding","border"],ta={block:Ga,listItemThread:["listItemThread"],listLevelThread:["listLevelThread"],listItemElement:P(P([],M(Ga),!1),["direction","textAlign","lineHeight","margin","listStyle"],!1),listLevel:["direction","textAlign","margin","padding","listStyle","backgroundColor"],styleBasedSegment:P(P([],M(Dn),!1),["textColor","backgroundColor","lineHeight"],!1),elementBasedSegment:On,segment:P(P(P([],M(Dn),!1),M(On),!1),["textColor","backgroundColor","lineHeight"],!1),segmentOnBlock:P(P(P([],M(Dn),!1),M(On),!1),["textColor"],!1),segmentOnTableCell:P(P(P([],M(Dn),!1),M(On),!1),["textColorOnTableCell"],!1),tableCell:["border","backgroundColor","padding","verticalAlign","wordBreak","textColor","htmlAlign","size"],tableRow:["backgroundColor"],tableColumn:["size"],table:["aria","id","border","backgroundColor","display","htmlAlign","margin","size","tableLayout","textColor","direction","role"],tableBorder:["borderBox","tableSpacing"],tableCellBorder:["borderBox"],image:["id","size","margin","padding","borderBox","border","boxShadow","display","float","verticalAlign","imageState"],link:["link","textColor","underline","display","margin","padding","backgroundColor","border","size","textAlign","undeletableLink"],segmentUnderLink:["textColor"],code:["fontFamily","display"],dataset:["dataset"],divider:P(P(P([],M(Ga),!1),M(Jo),!1),["display","size","htmlAlign"],!1),container:P(P([],M(Jo),!1),["htmlAlign","size","display","id"],!1),entity:["entity"],general:["textColor","backgroundColor"]},ku=ie(ea).reduce(function(t,e){return t[e]=ea[e].parse,t},{}),_u=ie(ea).reduce(function(t,e){return t[e]=ea[e].apply,t},{});function Sa(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return Yi(Mu(e),t)}function Yi(t,e){return Object.assign({},e,_h(),Mh(),Dh(),t)}function _h(){return{regularSelection:{current:{block:null,segment:null}}}}function Mh(){return{listFormat:{threadItemCounts:[],nodeStack:[]},implicitFormat:{}}}function Dh(){return{rewriteFromModel:{addedBlockElements:[],removedBlockElements:[]}}}function Mu(t){return{modelHandlers:Object.assign.apply(Object,P([{},Ko],M(t.map(function(e){return e?.modelHandlerOverride})),!1)),formatAppliers:Oh(t.map(function(e){return e?.formatApplierOverride}),t.map(function(e){return e?.additionalFormatAppliers})),defaultModelHandlers:Ko,defaultFormatAppliers:_u,metadataAppliers:Object.assign.apply(Object,P([{}],M(t.map(function(e){return e?.metadataAppliers})),!1)),defaultContentModelFormatMap:Object.assign.apply(Object,P([{},jv],M(t.map(function(e){return e?.defaultContentModelFormatOverride})),!1))}}function Oh(t,e){t===void 0&&(t=[]),e===void 0&&(e=[]);var r=Object.assign.apply(Object,P([{}],M(t),!1)),n=ie(ta).reduce(function(a,i){var o,s=(o=ta[i].map(function(l){return r[l]===void 0?_u[l]:r[l]})).concat.apply(o,P([],M(e.map(function(l){var u;return(u=l?.[i])!==null&&u!==void 0?u:[]})),!1));return a[i]=s,a},{text:[]});return e.forEach(function(a){a?.text&&(n.text=n.text.concat(a.text))}),n}var Lh=function(t,e,r){var n,a=zt(r.segmentFormat),i=M(ln(r,e),2),o=i[0],s=i[1];o>=0&&(r.isInSelection=!0),r.isInSelection&&(a.isSelected=!0);var l=it(t,a,r.blockFormat);s>=0&&(r.isInSelection=!1),(n=r.domIndexer)===null||n===void 0||n.onSegment(e,l,[a])},Du=["marginLeft","marginRight","paddingLeft","paddingRight"],Kr=function(t,e,r){Se(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},function(){K(e,r.formatParsers.block,r.blockFormat,r),K(e,r.formatParsers.segmentOnBlock,r.segmentFormat,r);var n=C({},r.blockFormat);K(e,r.formatParsers.container,n,r);var a=ga(e).display=="block"?e.tagName.toLowerCase():"div",i=Xi(a,n);if(Du.forEach(function(s){delete r.blockFormat[s]}),r.elementProcessors.child(i,e,r),e.style.fontSize&&parseInt(e.style.fontSize)==0&&(i.zeroFontSize=!0),Rh(i)){var o=i.blocks[0];i.zeroFontSize&&(o.segmentFormat=Object.assign({},o.segmentFormat,{fontSize:"0"})),Object.assign(o.format,i.format),Xe(o),ze(t,o)}else ze(t,i)}),ze(t,Ge(!0,r.blockFormat))};function Rh(t){var e=t.blocks[0];return t.tagName=="div"&&t.blocks.length==1&&e.blockType=="Paragraph"&&e.isImplicit}var Fh=["A","CODE"];function Zi(t,e,r,n){var a,i=r.blockDecorator.tagName?r.blockDecorator:void 0,o=Fh.indexOf(e.tagName)>=0;K(e,r.formatParsers.block,r.blockFormat,r);var s=C({},r.blockFormat);if(K(e,r.formatParsers.container,s,r),Du.forEach(function(u){s[u]&&(r.blockFormat[u]=s[u])}),!o){var l=Ge(!1,s,n,i);(a=r.paragraphMap)===null||a===void 0||a.assignMarkerToModel(e,l),ze(t,l)}r.elementProcessors.child(t,e,r)}var Ph=["marginBottom","marginTop","paddingBottom","paddingTop","paddingLeft","paddingRight","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth","width","height","maxWidth","maxHeight","minWidth","minHeight"],Ah=["id"],Nh=["H1","H2","H3","H4","H5","H6","P","A"],Ih=["A","CODE"],Pe=function(t,e,r){var n=xt(e);if((n||e.style.display=="inline-block")&&Bh(e))Kr(t,e,r);else if(dn(e))r.elementProcessors.child(t,e,r);else if(n){var a=r.blockDecorator.tagName?r.blockDecorator:void 0,i=Ih.indexOf(e.tagName)>=0;Se(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},function(){var o={};K(e,r.formatParsers.segmentOnBlock,o,r),Object.assign(r.segmentFormat,o),Zi(t,e,r,o)}),n&&!i&&ze(t,Ge(!0,r.blockFormat,void 0,a))}else Se(r,{segment:"shallowClone",paragraph:"shallowClone",link:"cloneFormat"},function(){K(e,r.formatParsers.segment,r.segmentFormat,r),r.link.format.href&&e.tagName!="A"&&K(e,r.formatParsers.segmentUnderLink,r.link.format,r),r.elementProcessors.child(t,e,r)})};function Bh(t,e){if(Nh.indexOf(t.tagName)>=0)return!1;var r=t.style,n=ga(t),a=r.getPropertyValue("background-color");return!!(a&&a!="transparent"||Ph.some(function(i){return parseInt(r[i]||n[i]||"")>0})||Ah.some(function(i){return t.hasAttribute(i)})||r.marginLeft=="auto"||r.marginRight=="auto"||t.getAttribute("align"))}var Hh=function(t,e,r){Se(r,{code:"codeDefault"},function(){K(e,r.formatParsers.code,r.code.format,r),Pe(t,e,r)})},zh=function(t,e,r){var n,a,i=((n=r.selection)===null||n===void 0?void 0:n.type)=="range"?r.selection.range:null;i&&(e.contains(i.startContainer)&&(r.isInSelection=!0,kr(t,r)),((a=r.selection)===null||a===void 0?void 0:a.type)=="range"&&e.contains(i.endContainer)&&(r.selection.range.collapsed||kr(t,r),r.isInSelection=!1))},xh=function(t,e,r){var n=e.tagName.toLowerCase(),a=Uh(e,r)||Gh(e,r)||r.elementProcessors[n]||n.indexOf(":")>=0&&r.elementProcessors.child||r.elementProcessors["*"];a(t,e,r)};function Uh(t,e){return pt(t)||t.contentEditable=="false"?e.elementProcessors.entity:null}function Gh(t,e){return Rt(t)?e.elementProcessors.delimiter:null}var Hr=["10px","13px","16px","18px","24px","32px","48px"];function Kh(t){var e=parseInt(t||"");if(!Number.isNaN(e))return e<1?Hr[0]:e>Hr.length?Hr[Hr.length-1]:Hr[e-1]}var Wh=function(t,e,r){Se(r,{segment:xt(e)?"shallowCloneForBlock":"shallowClone"},function(){var n=e.getAttribute("face"),a=Kh(e.getAttribute("size")),i=e.getAttribute("color"),o=r.segmentFormat;n&&(o.fontFamily=n),a&&(o.fontSize=a),i&&(o.textColor=i),K(e,r.formatParsers.segment,r.segmentFormat,r),r.elementProcessors.child(t,e,r)})},Vh=function(t,e,r){var n=zv(e),a=r.isInSelection;Se(r,{segment:"empty",paragraph:"empty",link:"empty"},function(){ze(t,n),K(e,r.formatParsers.general,n.format,r),r.elementProcessors.child(n,e,r)}),a&&r.isInSelection&&(n.isSelected=!0)},jh=function(t,e,r){var n,a=Hv(e,r.segmentFormat),i=r.isInSelection;pa(a,r);var o=it(t,a);(n=r.domIndexer)===null||n===void 0||n.onSegment(e,o,[a]),Se(r,{segment:"empty"},function(){K(e,r.formatParsers.general,a.format,r),r.elementProcessors.child(a,e,r)}),i&&r.isInSelection&&(a.isSelected=!0)},qh=function(t,e,r){var n=xt(e)?Vh:jh;n(t,e,r)},fr=function(t,e,r){Se(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone",blockDecorator:"empty"},function(){var n={};K(e,r.formatParsers.segmentOnBlock,n,r),ie(n).forEach(function(a){delete r.segmentFormat[a]}),r.blockDecorator=hu(e.tagName,n),Zi(t,e,r)}),ze(t,Ge(!0,r.blockFormat))},Xh=function(t,e,r){Se(r,{paragraph:"shallowClone"},function(){K(e,r.formatParsers.divider,r.blockFormat,r);var n=xv("hr",r.blockFormat);e.size&&(n.size=e.size),r.isInSelection&&(n.isSelected=!0),ze(t,n)})},Yh=function(t,e,r){Se(r,{segment:"shallowClone"},function(){var n,a,i,o=r.segmentFormat,s=(n=e.getAttribute("src"))!==null&&n!==void 0?n:"";K(e,r.formatParsers.segment,o,r),K(e,r.formatParsers.image,o,r),K(e,r.formatParsers.block,r.blockFormat,r);var l=Bv(s,o),u=e.alt,d=e.title;K(e,r.formatParsers.dataset,l.dataset,r),pa(l,r),u&&(l.alt=u),d&&(l.title=d),r.isInSelection&&(l.isSelected=!0),((a=r.selection)===null||a===void 0?void 0:a.type)=="image"&&r.selection.image==e&&(l.isSelectedAsImageSelection=!0,l.isSelected=!0);var f=it(t,l);(i=r.domIndexer)===null||i===void 0||i.onSegment(e,f,[l])})},Zh=function(t,e,r){var n=e.getAttribute("name"),a=e.getAttribute("href");if(n||a){var i=!!n&&!a,o={link:i?"empty":"linkDefault"};Se(r,o,function(){if(K(e,r.formatParsers.link,r.link.format,r),K(e,r.formatParsers.dataset,r.link.dataset,r),i&&!e.firstChild){var s=xe("",r.segmentFormat,{dataset:r.link.dataset,format:r.link.format});r.isInSelection&&(s.isSelected=!0),it(t,s)}else Pe(t,e,r)})}else Pe(t,e,r)},Jh=function(t,e,r){var n,a=r.listFormat;if(a.listParent&&a.levels.length>0)Se(r,{segment:"shallowCloneForBlock"},function(){K(e,r.formatParsers.segmentOnBlock,r.segmentFormat,r);var s=fn(a.levels,r.segmentFormat);K(e,r.formatParsers.listItemElement,s.format,r),a.listParent.blocks.push(s),K(e,r.formatParsers.listItemThread,s.levels[s.levels.length-1].format,r),r.elementProcessors.child(s,e,r);var l=s.blocks[0];s.blocks.length==1&&l.blockType=="Paragraph"&&l.isImplicit&&(Object.assign(s.format,l.format),l.format={})});else{var i=(n=a.listParent)===null||n===void 0?void 0:n.blocks,o=i?.[i?.length-1];r.elementProcessors["*"](o?.blockType=="BlockGroup"?o:t,e,r)}},Qo=function(t,e,r){Se(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},function(){var n=sr(e.tagName,r.blockFormat),a=r.listFormat;K(e,r.formatParsers.dataset,n.dataset,r),K(e,r.formatParsers.listLevelThread,n.format,r),K(e,r.formatParsers.listLevel,n.format,r),K(e,r.formatParsers.segment,r.segmentFormat,r);var i=a.listParent;a.listParent=a.listParent||t,a.levels.push(n);try{r.elementProcessors.child(t,e,r)}finally{a.levels.pop(),a.listParent=i}})},Qh=function(t,e,r){Se(r,{blockDecorator:"empty",segment:"shallowCloneForBlock",paragraph:"shallowClone"},function(){r.blockDecorator=hu(e.tagName);var n={};K(e,r.formatParsers.segmentOnBlock,n,r),Object.assign(r.segmentFormat,n),Zi(t,e,r,n)}),ze(t,Ge(!0,r.blockFormat))},$h=function(t,e,r){r.formatParsers.text.length>0?Se(r,{segment:"shallowClone"},function(){r.formatParsers.text.forEach(function(n){n(r.segmentFormat,e,r),$o(t,e,r)})}):$o(t,e,r)};function $o(t,e,r){var n,a=ha(t,r.blockFormat),i=a.segments.length;r.elementProcessors.textWithSelection(t,e,r);var o=a.segments.slice(i);(n=r.domIndexer)===null||n===void 0||n.onSegment(e,a,o.filter(function(s){return s?.segmentType=="Text"}))}var ep=function(t,e,r){var n=e.nodeValue||"",a=ln(r,e),i=a[0],o=a[1];if(i>=0){var s=n.substring(0,i);Xr(t,s,r),r.isInSelection=!0,kr(t,r,e,i),n=n.substring(i),o-=i}if(o>=0){var s=n.substring(0,o);Xr(t,s,r),r.selection&&(r.selection.type!="range"||!r.selection.range.collapsed)&&kr(t,r,e,a[1]),r.isInSelection=!1,n=n.substring(o)}Xr(t,n,r)},el={a:Zh,b:Pe,blockquote:Pe,br:Lh,code:Hh,dd:Kr,del:Pe,div:Pe,dl:Kr,dt:Kr,em:Pe,font:Wh,i:Pe,img:Yh,h1:fr,h2:fr,h3:fr,h4:fr,h5:fr,h6:fr,hr:Xh,li:Jh,ol:Qo,p:Qh,pre:Kr,s:Pe,section:Pe,span:Pe,strike:Pe,strong:Pe,sub:Pe,sup:Pe,table:wv,u:Pe,ul:Qo,"*":qh,"#text":$h,textWithSelection:ep,element:xh,entity:mv,child:uv,delimiter:zh};function cn(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return hn(Ou(e),t)}function hn(t,e){return Object.assign({},e,tp(),rp(e?.isRootRtl),np(),t)}function tp(){return{isInSelection:!1}}function rp(t){var e=t?{direction:"rtl"}:{};return{blockFormat:e,segmentFormat:{},listFormat:{levels:[],threadItemCounts:[]}}}function np(){return{link:{format:{},dataset:{}},code:{format:{}},blockDecorator:{format:{},tagName:""}}}function Ou(t){return{elementProcessors:Object.assign.apply(Object,P([{},el],M(t.map(function(e){return e?.processorOverride})),!1)),formatParsers:ap(t.map(function(e){return e?.formatParserOverride}),t.map(function(e){return e?.additionalFormatParsers})),defaultElementProcessors:el,defaultFormatParsers:ku,processNonVisibleElements:t.some(function(e){return!!e?.processNonVisibleElements})}}function ap(t,e){t===void 0&&(t=[]),e===void 0&&(e=[]);var r=Object.assign.apply(Object,P([{}],M(t),!1)),n=ie(ta).reduce(function(a,i){var o,s=(o=ta[i].map(function(l){return r[l]===void 0?ku[l]:r[l]})).concat.apply(o,P([],M(e.map(function(l){var u;return(u=l?.[i])!==null&&u!==void 0?u:[]})),!1));return a[i]=s,a},{text:[]});return e.forEach(function(a){a?.text&&(n.text=n.text.concat(a.text))}),n}function ip(t,e){var r,n,a=document.createElement("span"),i=xe("text",t),o=hn(e.domToModelSettings.calculated),s=Yi(e.modelToDomSettings.calculated),l=Fr();s.modelHandlers.segment(a.ownerDocument,a,i,s,[]),o.elementProcessors.element(l,a,o);var u=ha(l);return(n=(r=u.segments[0])===null||r===void 0?void 0:r.format)!==null&&n!==void 0?n:t}var B={Min:1,Decimal:1,DecimalDash:2,DecimalParenthesis:3,DecimalDoubleParenthesis:4,LowerAlpha:5,LowerAlphaParenthesis:6,LowerAlphaDoubleParenthesis:7,LowerAlphaDash:8,UpperAlpha:9,UpperAlphaParenthesis:10,UpperAlphaDoubleParenthesis:11,UpperAlphaDash:12,LowerRoman:13,LowerRomanParenthesis:14,LowerRomanDoubleParenthesis:15,LowerRomanDash:16,UpperRoman:17,UpperRomanParenthesis:18,UpperRomanDoubleParenthesis:19,UpperRomanDash:20,Max:20},op=65,Ka={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};function Ji(t,e){switch(t){case B.LowerAlpha:case B.LowerAlphaDash:case B.LowerAlphaDoubleParenthesis:case B.LowerAlphaParenthesis:return tl(e,!0);case B.UpperAlpha:case B.UpperAlphaDash:case B.UpperAlphaDoubleParenthesis:case B.UpperAlphaParenthesis:return tl(e,!1);case B.LowerRoman:case B.LowerRomanDash:case B.LowerRomanDoubleParenthesis:case B.LowerRomanParenthesis:return rl(e,!0);case B.UpperRoman:case B.UpperRomanDash:case B.UpperRomanDoubleParenthesis:case B.UpperRomanParenthesis:return rl(e,!1);default:return e+""}}function tl(t,e){var r="";for(t--;t>=0;)r=String.fromCharCode(t%26+op)+r,t=Math.floor(t/26)-1;return e?r.toLowerCase():r}function rl(t,e){var r,n,a="";try{for(var i=At(ie(Ka)),o=i.next();!o.done;o=i.next()){var s=o.value,l=Math.floor(t/Ka[s]);t=t-l*Ka[s],a=a+s.repeat(l)}}catch(u){r={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return e?a.toLocaleLowerCase():a}var me={Min:1,Disc:1,Dash:2,Square:3,ShortArrow:4,LongArrow:5,UnfilledArrow:6,Hyphen:7,DoubleLongArrow:8,Circle:9,BoxShadow:10,Xrhombus:11,CheckMark:12,Max:12},nl=[B.Decimal,B.LowerAlpha,B.LowerRoman],al=[me.Disc,me.Circle,me.Square],lp={"lower-alpha":B.LowerAlpha,"lower-latin":B.LowerAlpha,"upper-alpha":B.UpperAlpha,"upper-latin":B.UpperAlpha,"lower-roman":B.LowerRoman,"upper-roman":B.UpperRoman},sp={disc:me.Disc,circle:me.Circle,square:me.Square};function Qi(t,e,r,n){var a=e.orderedStyleType,i=e.unorderedStyleType,o=e.applyListStyleFromLevel;return t=="OL"?typeof a=="number"?a:o?nl[r%nl.length]:n?lp[n]:void 0:typeof i=="number"?i:o?al[r%al.length]:n?sp[n]:void 0}function Lu(t){return!!t&&(t=="bold"||t=="bolder"||parseInt(t)>=600)}function up(t,e){var r,n,a=t.createRange();return(n=(r=il(e,a))!==null&&r!==void 0?r:il(e=dp(e),a))!==null&&n!==void 0?n:fp(e.node)}function dp(t){for(var e=t.node,r=t.offset;e.lastChild;)r==e.childNodes.length?(e=e.lastChild,r=e.childNodes.length):(e=e.childNodes[r],r=0);return{node:e,offset:r}}function il(t,e){var r=t.node,n=t.offset;e.setStart(r,n),e.setEnd(r,n);var a=Te(e.getBoundingClientRect());if(a)return a;var i=e.getClientRects&&e.getClientRects();return i&&i.length==1?Te(i[0]):null}function fp(t){return L(t,"ELEMENT_NODE")&&t.getBoundingClientRect?Te(t.getBoundingClientRect()):null}var vp="Control",cp="Alt",hp="Meta",pp=new Set(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"]);function Or(t){var e=t.ctrlKey||t.key===vp,r=t.altKey||t.key===cp,n=t.metaKey||t.key===hp;return e||r||n}function Ta(t){return!Or(t)&&!!t.key&&t.key.length==1}function $i(t){return pp.has(t.key)}var gp=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"],mp=/^(thin|medium|thick|[\d\.]+\w*)$/;function Ru(t){var e={},r=(t||"").replace(/, /g,",").split(" ");return r.forEach(function(n){gp.indexOf(n)>=0&&!e.style?e.style=n:mp.test(n)&&!e.width?e.width=n:n&&!e.color&&(e.color=n)}),e}function Fu(t){return[t.width||"",t.style||"",t.color||""].join(" ").trim()||"none"}var bp=/[\u2000\u2009\u200a​\u200b​\u202f\u205f​\u3000\s\t\r\n]/gm,yp='.,?!:"()[]\\/';function ra(t){return yp.indexOf(t)>=0}function na(t){var e,r=(e=t?.charCodeAt(0))!==null&&e!==void 0?e:0;return r==160||r==32||bp.test(t)}function Pu(t,e){return t.replace(e?/^\u0020+/:/\u0020+$/," ")}function Jr(t){var e=Ze(t.rows),r=e.map(function(n){return[]});return e.forEach(function(n,a){for(var i=0,o=0;i<n.cells.length;i++){for(;r[a][o]!==void 0;o++);for(var s=n.cells[i],l=0;l<s.colSpan;l++,o++)for(var u=0;u<s.rowSpan;u++)r[a+u]&&(r[a+u][o]=l==0?u==0?s:"spanTop":u==0?"spanLeft":"spanBoth")}for(var d=0;d<r[a].length;d++)r[a][d]=r[a][d]||null}),r}function Ep(t,e){try{if(t){var r=new FileReader;r.onload=function(){e(r.result)},r.onerror=function(){e(null)},r.readAsDataURL(t)}}catch{e(null)}}function aa(t,e,r,n){var a=r=="lightToDark",i=function(o){var s=Mr(o,!1,!a,n),l=Mr(o,!0,!a,n);Dr(o,s,!1,a,n),Dr(o,l,!0,a,n)};Au(t,i,e)}function Au(t,e,r){r&&ol(t)&&e(t);for(var n=t.firstChild;n;n=n.nextSibling)ol(n)&&e(n),Au(n,e)}function ol(t){var e=t;return t.nodeType==Node.ELEMENT_NODE&&!!e.style}function Cp(t){for(var e=/(".*?")|('.*?')/g,r=e.exec(t),n=0,a=[];r;)ll(t,a,n,r.index),n=r.index+r[0].length,a.push(r[0]),r=e.exec(t);return ll(t,a,n,t.length),a.join(", ")}function ll(t,e,r,n){var a=t.substring(r,n).split(",");a.forEach(function(i){i=i.trim(),i&&(/[^a-zA-Z0-9\-]/.test(i)?e.push('"'+i+'"'):e.push(i))})}var Jt,sl=(Jt={},Jt["text/html"]=function(t,e){return t.rawHtml=e},Jt["text/plain"]=function(t,e){return t.text=e},Jt["text/*"]=function(t,e,r){return!!r&&(t.customValues[r]=e)},Jt["text/link-preview"]=Tp,Jt["text/uri-list"]=function(t,e){return t.text=e},Jt);function Sp(t,e){var r={types:[],text:"",image:null,files:[],rawHtml:null,customValues:{},pasteNativeEvent:!0};return Promise.all((t||[]).map(function(n){var a=n.type;if(a.indexOf("image/")==0&&!r.image&&n.kind=="file")return r.types.push(a),r.image=n.getAsFile(),new Promise(function(s){r.image?Ep(r.image,function(l){r.imageDataUri=l,s()}):s()});if(n.kind=="file")return new Promise(function(s){var l=n.getAsFile();l&&(r.types.push(a),r.files.push(l)),s()});var i=wp(a,e),o=sl[a]||(i?sl["text/*"]:null);return new Promise(function(s){return o?n.getAsString(function(l){r.types.push(a),o(r,l,i),s()}):s()})})).then(function(){return r})}function Tp(t,e){try{t.customValues["link-preview"]=e,t.linkPreview=JSON.parse(e)}catch{}}function wp(t,e){var r=t.indexOf("text/")==0?t.substring(5):null,n=e&&r?e.indexOf(r):-1;return r&&n>=0?r:void 0}function kp(t,e,r){var n=t.eventDataCache&&t.eventDataCache.hasOwnProperty(e)?t.eventDataCache[e]:r(t);return t.eventDataCache=t.eventDataCache||{},t.eventDataCache[e]=n,n}function _p(t){return ji(t,"paragraphMarker")}function Mp(t,e){qi(t,"paragraphMarker",e)}var Dp=["BR","HR","IMG"];function Op(t,e,r,n,a){var i={text:r?e:e.toLowerCase(),matchCase:r,wholeWord:n,result:[],paragraphText:"",indexes:[],editableOnly:!0};return i.text&&Nu(t,i),i.result}function ul(t){return xt(t)||Dp.indexOf(t.tagName)>=0}function Nu(t,e){for(var r=!e.editableOnly||t.isContentEditable,n=t.firstChild;n;n=n.nextSibling)if(L(n,"TEXT_NODE")&&r){var a=e.matchCase?n.nodeValue||"":(n.nodeValue||"").toLowerCase();a&&(e.paragraphText+=a,e.indexes.push({node:n,length:a.length}))}else L(n,"ELEMENT_NODE")&&(e.paragraphText&&ul(n)&&dl(t.ownerDocument,e),Nu(n,e));e.paragraphText&&ul(t)&&dl(t.ownerDocument,e)}function dl(t,e){for(var r,n=0;(r=e.paragraphText.indexOf(e.text,n))>-1;){if(!e.wholeWord||(r==0||fl(e.paragraphText[r-1]))&&(r+e.text.length==e.paragraphText.length||fl(e.paragraphText[r+e.text.length]))){var a=vl(e.indexes,r,!1),i=vl(e.indexes,r+e.text.length,!0);if(a&&i){var o=t.createRange();o.setStart(a.node,a.offset),o.setEnd(i.node,i.offset),e.result.push(o)}}n=r+e.text.length}e.paragraphText="",e.indexes=[]}function fl(t){return na(t)||ra(t)}function vl(t,e,r){for(var n=0,a=0;a<t.length;a++){var i=t[a].length;if(r?n+i>=e:n+i>e)return{node:t[a].node,offset:e-n};n+=i}return null}function gt(t,e){var r=t;return r?.blockGroupType==e}function Qe(t,e,r){var n=t.blockGroupType=="Document"?t.persistCache:!1,a=n?e:function(i,o,s,l){var u;return!((u=s)===null||u===void 0)&&u.cachedElement&&delete s.cachedElement,e(i,o,s,l)};Wr([t],a,r)}function Wr(t,e,r,n,a){for(var i=t[0],o=r?.includeListFormatHolder||"allSegments",s=r?.contentUnderSelectedTableCell||"include",l=r?.contentUnderSelectedGeneralElement||"contentOnly",u=!1,d=!1,f=0;f<i.blocks.length;f++){var h=i.blocks[f];switch(h.blockType){case"BlockGroup":var v=P([h],M(t),!1);if(h.blockGroupType=="General"){var c=a||h.isSelected,p=!c||l=="both"||l=="contentOnly",g=c&&(l=="both"||l=="generalElementOnly"||h.blocks.length==0);if(p&&Wr(v,e,r,n,c)||g&&e(t,n,h))return!0}else if(Wr(v,e,r,n,a))return!0;break;case"Table":var b=h.rows,y=b.every(function(J){return J.cells.every(function(x){return x.isSelected})});if(s!="include"&&y){if(e(t,n,h))return!0}else for(var E=0;E<b.length;E++)for(var S=b[E],T=0;T<S.cells.length;T++){var k=S.cells[T];if(k){var R={table:h,rowIndex:E,colIndex:T,isWholeTableSelected:y};if(k.isSelected&&e(t,R))return!0;if(!k.isSelected||s!="ignoreForTableOrCell"){var H=P([k],M(t),!1),c=a||k.isSelected;if(Wr(H,e,r,R,c))return!0}}}break;case"Paragraph":for(var U=[],q=0;q<h.segments.length;q++){var W=h.segments[q],c=a||W.isSelected;if(W.segmentType=="General"){var p=!c||l=="both"||l=="contentOnly",g=c&&(l=="both"||l=="generalElementOnly"||W.blocks.length==0);if(p&&Wr(P([W],M(t),!1),e,r,n,c))return!0;g&&U.push(W)}else c&&U.push(W);c?u=!0:d=!0}if(U.length>0&&e(t,n,h,U))return!0;break;case"Divider":case"Entity":if((a||h.isSelected)&&e(t,n,h))return!0;break}}return!!(o!="never"&&i.blockGroupType=="ListItem"&&u&&(!d||o=="anySegment")&&e(t,n,void 0,[i.formatHolder]))}function Je(t,e,r,n){r===void 0&&(r=[]);for(var a=0;a<t.length;a++){var i=t[a];if(e.indexOf(i.blockGroupType)>=0)return a;if(r.indexOf(i.blockGroupType)>=0)return-1}return-1}function pn(t,e,r,n){var a=eo(t,{includeListFormatHolder:e?"allSegments":"never"}),i=[];return a.forEach(function(o){var s=o.segments,l=o.block,u=o.path;if(s)if(e&&!l&&s.length==1&&u[0].blockGroupType=="ListItem"&&s[0]==u[0].formatHolder){var d=u[0];n&&w(d),i.push([d.formatHolder,null,u])}else l?.blockType=="Paragraph"&&(n&&w(l),s.forEach(function(f){(r||f.segmentType!="Entity"||!f.entityFormat.isReadonly)&&i.push([f,l,u])}));else l?.blockType=="Entity"&&r&&i.push([l,null,u])}),i}function Lp(t,e,r){var n=pn(t,e);return n.map(function(a){return a[0]})}function gn(t,e,r,n,a){var i=[],o=[e],s=eo(t,{includeListFormatHolder:"never",contentUnderSelectedTableCell:"ignoreForTable"});return Iu(s),s.forEach(function(l){for(var u=l.path,d=l.block,f=function(c){var p=Je(u,o[c],r);if(p>=0)return i.filter(function(g){return g.block==u[p]}).length<=0&&i.push({parent:u[p+1],block:u[p],path:u.slice(p+1)}),"break";if(c==o.length-1&&d)return i.push({parent:u[0],block:d,path:u}),"break"},h=0;h<o.length;h++){var v=f(h);if(v==="break")break}}),i}function Qr(t){var e=eo(t,{includeListFormatHolder:"never"}),r,n=[];return Iu(e),e.forEach(function(a){var i=a.block,o=a.tableContext,s=a.path;if(!r){if(i?.blockType=="Table")r=i,n=P([],M(s),!1);else if(o?.table){r=o.table;var l=s.filter(function(d){return d.blocks.indexOf(o.table)>=0})[0],u=s.indexOf(l);n=u>=0?s.slice(u):[]}}}),[r,n]}function Rp(t){var e;return gn(t,["ListItem"],["TableCell"]).forEach(function(r){!e&&gt(r.block,"ListItem")&&(e=r.block)}),e}function eo(t,e){var r=[];return Qe(t,function(n,a,i,o){r.push({path:n,tableContext:a,block:i,segments:o})},e),r}function Iu(t){t.length>1&&cl(t,!1)&&t.pop(),t.length>1&&cl(t,!0)&&t.shift()}function cl(t,e){var r,n=t[e?0:t.length-1];if(((r=n.block)===null||r===void 0?void 0:r.blockType)=="Paragraph"&&n.segments&&n.segments.length>0){var a=n.block.segments,i=n.segments[0];return n.segments.length==1&&i.segmentType=="SelectionMarker"&&i==a[e?a.length-1:0]}else return!1}function Fp(t){return t.isSelected||t.segmentType=="General"&&t.blocks.some(wa)}function wa(t){switch(t.blockType){case"Paragraph":return t.segments.some(Fp);case"Table":return t.rows.some(function(e){return e.cells.some(ia)});case"BlockGroup":return ia(t);case"Divider":case"Entity":return!!t.isSelected;default:return!1}}function ia(t){return!!(t.blockGroupType=="TableCell"&&t.isSelected||t.blocks.some(wa))}function mt(t){var e=-1,r=-1,n=-1,a=-1,i=!1;return t.rows.forEach(function(o,s){return o.cells.forEach(function(l,u){ia(l)&&(i=!0,e<0&&(e=s),r<0&&(r=u),n=Math.max(n,s),a=Math.max(a,u))})}),i?{firstRow:e,firstColumn:r,lastRow:n,lastColumn:a}:null}function Et(t,e,r){$r(t,!1,e||null,r||null)}function $r(t,e,r,n){return Ei(e,t,r,n,function(a){pu(t)&&ka(t,a)&&to(w(t),a);var i=[];t.blocks.forEach(function(l,u){a=Pp(l,a,r,n),l.blockType=="Paragraph"&&l.segments.length==0&&l.isImplicit&&i.push(u)});var o;if(i.length>0)for(var s=w(t);(o=i.pop())!==void 0;)o>=0&&s.blocks.splice(o,1);return a})}function Pp(t,e,r,n){switch(t.blockType){case"BlockGroup":return $r(t,e,r,n);case"Table":return Ap(t,e,r,n);case"Divider":case"Entity":return Ei(e,t,r,n,function(s){if(ka(t,s)){var l=w(t);s?l.isSelected=!0:delete l.isSelected}return s});case"Paragraph":var a=[];if(t.segments.forEach(function(s,l){e=Ei(e,s,r,n,function(u){return Np(t,s,u,a,r,n,l)})}),a.length>0)for(var i=w(t),o=void 0;(o=a.pop())!==void 0;)o>=0&&i.segments.splice(o,1);return e;default:return e}}function Ap(t,e,r,n){var a=hl(t,r),i=n?hl(t,n):a;if(e)t.rows.forEach(function(f){return f.cells.forEach(function(h){var v=e;e=$r(h,e,r,n),v&&e&&(w(h).isSelected=!0)})});else for(var o=0;o<t.rows.length;o++)for(var s=t.rows[o],l=0;l<s.cells.length;l++){var u=t.rows[o].cells[l],d=o>=a.row&&o<=i.row&&l>=a.col&&l<=i.col;ka(u,d)&&to(w(u),d),d||$r(u,!1,r,n)}return e}function hl(t,e){var r=-1,n=e?t.rows.findIndex(function(a){return(r=a.cells.indexOf(e))>=0}):-1;return{row:n,col:r}}function Np(t,e,r,n,a,i,o){switch(e.segmentType){case"SelectionMarker":return(!r||e!=a&&e!=i)&&n.push(o),r;case"General":return Wa(t,e,r),e!=a&&e!=i?$r(e,r,a,i):r;case"Image":var s=a==e&&(!i||i==e);return Wa(t,e,r,!e.isSelectedAsImageSelection!=!s?function(l){return l.isSelectedAsImageSelection=s}:void 0),r;default:return Wa(t,e,r),r}}function Wa(t,e,r,n){(n||ka(e,r))&&at(t,e,function(a){to(a,r),n?.(a)})}function ka(t,e){return!t.isSelected!=!e}function to(t,e){return e?t.isSelected=!0:delete t.isSelected,e}function Ei(t,e,r,n,a){return t=t||e==r,t=a(t),t&&!!n&&e!=n}function en(t,e){var r=bn(t,e||{});return t.format&&(r.format=Object.assign({},t.format)),r}function Ip(t,e){switch(t.blockType){case"BlockGroup":switch(t.blockGroupType){case"FormatContainer":return Gp(t,e);case"General":return Hu(t,e);case"ListItem":return Kp(t,e)}break;case"Divider":return Vp(t,e);case"Entity":return Bu(t,e);case"Paragraph":return Hp(t,e);case"Table":return zp(t,e)}}function Bp(t,e){switch(t.segmentType){case"Br":return Pr(t);case"Entity":return Bu(t,e);case"General":return qp(t,e);case"Image":return jp(t);case"SelectionMarker":return zu(t);case"Text":return Xp(t)}}function Ft(t){return{format:Object.assign({},t.format)}}function mn(t){return{dataset:Object.assign({},t.dataset)}}function ur(t){var e=t.blockType;return Object.assign({blockType:e},Ft(t))}function bn(t,e){var r=t.blockGroupType,n=t.blocks;return{blockGroupType:r,blocks:n.map(function(a){return Ip(a,e)})}}function Pr(t){var e=t.segmentType,r=t.isSelected,n=t.code,a=t.link,i=Object.assign({segmentType:e,isSelected:r},Ft(t));return n&&(i.code=Ft(n)),a&&(i.link=Object.assign(Ft(a),mn(a))),i}function Bu(t,e){var r=t.wrapper,n=t.entityFormat;return Object.assign({wrapper:Ut(r,"entity",e),entityFormat:C({},n)},ur(t),Pr(t))}function Hp(t,e){var r=t.cachedElement,n=t.segments,a=t.isImplicit,i=t.decorator,o=t.segmentFormat,s=Object.assign({cachedElement:Ut(r,"cache",e),isImplicit:a,segments:n.map(function(l){return Bp(l,e)}),segmentFormat:o?C({},o):void 0},ur(t),Ft(t));return i&&(s.decorator=Object.assign({tagName:i.tagName},Ft(i))),s}function zp(t,e){var r=t.cachedElement,n=t.widths,a=t.rows;return Object.assign({cachedElement:Ut(r,"cache",e),widths:Array.from(n),rows:a.map(function(i){return xp(i,e)})},ur(t),mn(t))}function xp(t,e){var r=t.height,n=t.cells,a=t.cachedElement;return Object.assign({height:r,cachedElement:Ut(a,"cache",e),cells:n.map(function(i){return Up(i,e)})},Ft(t))}function Up(t,e){var r=t.cachedElement,n=t.isSelected,a=t.spanAbove,i=t.spanLeft,o=t.isHeader;return Object.assign({cachedElement:Ut(r,"cache",e),isSelected:n,spanAbove:a,spanLeft:i,isHeader:o},bn(t,e),Ft(t),mn(t))}function Gp(t,e){var r=t.tagName,n=t.cachedElement,a=Object.assign({tagName:r,cachedElement:Ut(n,"cache",e)},ur(t),bn(t,e));return t.zeroFontSize&&(a.zeroFontSize=!0),a}function Kp(t,e){var r=t.formatHolder,n=t.levels,a=t.cachedElement;return Object.assign({formatHolder:zu(r),levels:n.map(Wp),cachedElement:Ut(a,"cache",e)},ur(t),bn(t,e))}function Wp(t){var e=t.listType;return Object.assign({listType:e},Ft(t),mn(t))}function Vp(t,e){var r=t.tagName,n=t.isSelected,a=t.cachedElement;return Object.assign({isSelected:n,tagName:r,cachedElement:Ut(a,"cache",e)},ur(t))}function Hu(t,e){var r=t.element;return Object.assign({element:Ut(r,"general",e)},ur(t),bn(t,e))}function zu(t){return Object.assign({isSelected:t.isSelected},Pr(t))}function jp(t){var e=t.src,r=t.alt,n=t.title,a=t.isSelectedAsImageSelection;return Object.assign({src:e,alt:r,title:n,isSelectedAsImageSelection:a},Pr(t),mn(t))}function qp(t,e){return Object.assign(Hu(t,e),Pr(t))}function Xp(t){var e=t.text;return Object.assign({text:e},Pr(t))}function Ut(t,e,r){var n=r.includeCachedElement;if(t)if(n){if(n===!0)return t;var a=n(t,e);if((e=="general"||e=="entity")&&!a)throw new Error("Entity and General Model must has wrapper element");return a}else return e=="cache"?void 0:t.cloneNode(!0);else return}function oa(t,e,r,n,a){return{type:"number",isOptional:t,value:e,maxValue:n,minValue:r,allowNull:a}}function Tr(t,e,r){return{type:"boolean",isOptional:t,value:e,allowNull:r}}function xu(t,e,r){return{type:"string",isOptional:t,value:e,allowNull:r}}function _a(t,e,r){return{type:"object",isOptional:e,propertyDef:t,allowNull:r}}var Yp=_a({bgColorOverride:Tr(!0),vAlignOverride:Tr(!0),borderOverride:Tr(!0)},!1,!0);function ro(t,e){return ba(t,e,Yp)}var Uu=20,Gu=80,Ku="#ffffff",Wu="#000000";function Vu(t,e,r,n){if(e){t.format.backgroundColor=e;var a=ju(e);a<Uu?t.format.textColor=Ku:a>Gu?t.format.textColor=Wu:delete t.format.textColor,Jp(t)}else delete t.format.backgroundColor,delete t.format.textColor,Zp(t)}function Zp(t){t.blocks.forEach(function(e){var r,n;if(e.blockType=="Paragraph"){var a=w(e);!((r=a.segmentFormat)===null||r===void 0)&&r.textColor&&pl((n=a.segmentFormat)===null||n===void 0?void 0:n.textColor,t.format.backgroundColor||"")&&delete a.segmentFormat.textColor,a.segments.forEach(function(i){i.format.textColor&&pl(i.format.textColor,t.format.backgroundColor||"")&&delete i.format.textColor})}})}function Jp(t){t.format.textColor&&t.blocks.forEach(function(e){var r;if(e.blockType=="Paragraph"){var n=w(e);!((r=n.segmentFormat)===null||r===void 0)&&r.textColor||(n.segmentFormat=C(C({},n.segmentFormat),{textColor:t.format.textColor})),n.segments.forEach(function(a){var i;!((i=a.format)===null||i===void 0)&&i.textColor||(a.format=C(C({},a.format),{textColor:t.format.textColor}))})}})}function pl(t,e){var r=ju(e);return[Ku,"rgb(255,255,255)"].indexOf(t)>-1&&(r>Gu||e=="")||[Wu,"rgb(0,0,0)"].indexOf(t)>-1&&(r<Uu||e=="")}function ju(t){var e=yi(t);if(e){var r=e[0]/255,n=e[1]/255,a=e[2]/255;return(Math.max(r,n,a)+Math.min(r,n,a))*50}else return 255}var rt={Min:0,Default:0,ListWithSideBorders:1,NoHeaderBorders:2,NoSideBorders:3,FirstColumnHeaderExternal:4,EspecialType1:5,EspecialType2:6,EspecialType3:7,Clear:8,Max:8},Qt=xu(!1,void 0,!0),Ln=Tr(!1),qu=_a({topBorderColor:Qt,bottomBorderColor:Qt,verticalBorderColor:Qt,hasHeaderRow:Ln,headerRowColor:Qt,hasFirstColumn:Ln,hasBandedColumns:Ln,hasBandedRows:Ln,bgColorEven:Qt,bgColorOdd:Qt,tableBorderFormat:oa(!1,void 0,rt.Min,rt.Max),verticalAlign:Qt},!1,!0);function Qp(t){return ma(t,qu)}function Xu(t,e){return ba(t,e,qu)}var ft,$p={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:rt.Default,verticalAlign:null};function Ma(t,e,r){var n=w(t),a=n.rows;Xu(n,function(i){var o=C(C(C({},$p),i),e),s=eg(a,!r);return tg(a,o,s),rg(a,o),ng(a,o,s),o})}function eg(t,e){var r={bgColorOverrides:[],vAlignOverrides:[],borderOverrides:[]};return t.forEach(function(n){var a=[],i=[],o=[];r.bgColorOverrides.push(a),r.vAlignOverrides.push(i),r.borderOverrides.push(o),n.cells.forEach(function(s){ro(w(s),function(l){return l&&e?(a.push(!1),delete l.bgColorOverride):a.push(!!l?.bgColorOverride),i.push(!!l?.vAlignOverride),o.push(!!l?.borderOverride),l})})}),r}var gl=(ft={},ft[rt.Default]=function(t){return[!1,!1,!1,!1]},ft[rt.ListWithSideBorders]=function(t){var e=t.lastColumn,r=t.firstColumn;return[!1,!e,!1,!r]},ft[rt.FirstColumnHeaderExternal]=function(t){var e=t.firstColumn,r=t.firstRow,n=t.lastColumn,a=t.lastRow;return[!r,!n&&!e||e&&r,!a&&!r,!e]},ft[rt.NoHeaderBorders]=function(t){var e=t.firstRow,r=t.firstColumn,n=t.lastColumn;return[e,e||n,!1,e||r]},ft[rt.NoSideBorders]=function(t){var e=t.firstColumn,r=t.lastColumn;return[!1,r,!1,e]},ft[rt.EspecialType1]=function(t){var e=t.firstRow,r=t.firstColumn;return[r&&!e,e,r&&!e,e&&!r]},ft[rt.EspecialType2]=function(t){var e=t.firstRow,r=t.firstColumn;return[!e,e||!r,!e,!r]},ft[rt.EspecialType3]=function(t){var e=t.firstColumn,r=t.firstRow;return[!0,r||!e,!r,!0]},ft[rt.Clear]=function(){return[!0,!0,!0,!0]},ft);function tg(t,e,r){var n=e.hasBandedRows,a=e.hasBandedColumns,i=e.bgColorOdd,o=e.bgColorEven,s=e.hasFirstColumn;t.forEach(function(l,u){l.cells.forEach(function(d,f){var h,v=w(d);if(!r.borderOverrides[u][f]&&typeof e.tableBorderFormat=="number"){var c=(h=gl[e.tableBorderFormat])===null||h===void 0?void 0:h.call(gl,{firstRow:u===0,lastRow:u===t.length-1,firstColumn:f===0,lastColumn:f===l.cells.length-1}),p=[e.topBorderColor,e.verticalBorderColor,e.bottomBorderColor,e.verticalBorderColor];c?.forEach(function(b,y){var E=!b&&p[y]||"";v.format[vn[y]]=Fu({style:Yu(E),width:"1px",color:E})})}if(!r.bgColorOverrides[u][f]){var g=void 0;s&&f==0&&u>0?g=null:g=(n||a)&&(a&&f%2!=0||n&&u%2!=0)?i:o,Vu(v,g)}e.verticalAlign&&!r.vAlignOverrides[u][f]&&(v.format.verticalAlign=e.verticalAlign),v.isHeader=!1})})}function rg(t,e){e.hasFirstColumn&&t.forEach(function(r,n){r.cells.forEach(function(a,i){var o=w(a);if(i===0)switch(o.isHeader=!0,n){case 0:o.isHeader=!!e.hasHeaderRow,o.isHeader&&(o.format.fontWeight="bold");break;case t.length-1:nr(o.format,"borderTop");break;case 1:nr(o.format,"borderBottom");break;default:nr(o.format,"borderTop"),nr(o.format,"borderBottom");break}})})}function ng(t,e,r){var n;if(e.hasHeaderRow){var a=0;(n=t[a])===null||n===void 0||n.cells.forEach(function(i,o){var s=w(i);s.isHeader=!0,s.format.fontWeight="bold",e.headerRowColor&&(r.bgColorOverrides[a][o]||Vu(s,e.headerRowColor),nr(s.format,"borderTop",e.headerRowColor),nr(s.format,"borderRight",e.headerRowColor),nr(s.format,"borderLeft",e.headerRowColor))})}}function nr(t,e,r){var n=Ru(t[e]);n.color=r||"",n.style=Yu(n.color),t[e]=Fu(n)}function Yu(t){return!t||t=="transparent"?"none":"solid"}function Zu(t,e,r,n,a){var i=t.indexOf(e);switch(e.blockType){case"Table":case"Divider":return r?t.splice(i,1,r):t.splice(i,1),!0;case"Entity":var o=e.isSelected?"overwrite":a=="forward"?"removeFromStart":a=="backward"?"removeFromEnd":void 0;return o!==void 0&&(r?t.splice(i,1,r):t.splice(i,1),n?.deletedEntities.push({entity:e,operation:o})),!0;case"BlockGroup":switch(e.blockGroupType){case"General":return r?(t.splice(i,1,r),!0):!1;case"ListItem":case"FormatContainer":return t.splice(i,1),!0}}return!1}function ag(t,e){for(var r=P([],M(t),!1),n=0,a=e?0:r.length-1,i="notDeleted";a>=0&&a<r.length&&i!="done";a+=e?1:-1)switch(r[a]){case"‍":case"⃣":case"︎":case"️":i="notDeleted",n++;break;default:i=="notDeleted"?(i="waiting",n++):i=="waiting"&&(i="done");break}return r.splice(e?0:r.length-n,n),r.join("")}function la(t,e,r,n,a){var i=M(at(t,e),3),o=i[0],s=i[1],l=i[2],u=o.segments,d=an(o.format.whiteSpace),f=n=="forward",h=n=="backward";switch(d||ig(o,u,l),s?.segmentType){case"Br":case"Image":case"SelectionMarker":return zr(u,l,n,a),!0;case"Entity":var v=s.isSelected?"overwrite":f?"removeFromStart":h?"removeFromEnd":void 0;return v!==void 0&&(zr(u,l,n,a),r?.deletedEntities.push({entity:s,operation:v})),!0;case"Text":if(s.text.length==0||s.isSelected)s.text="",zr(u,l,n,a);else if(n){var c=s.text;c=ag(c,f),d||(c=Pu(c,f)),s.text=c,c==""&&zr(u,l,n,a)}return!0;case"General":return s.isSelected?(zr(u,l,n,a),!0):!1;default:return!1}}function zr(t,e,r,n){var a,i=t.splice(e,1)[0];if(!((a=i.link)===null||a===void 0)&&a.format.undeletable)if(delete i.isSelected,n)n.push(i);else{var o=void 0;switch(r){case"forward":o=e>0&&t[e-1].segmentType=="SelectionMarker"?e-1:e;break;case"backward":o=e<t.length&&t[e].segmentType=="SelectionMarker"?e+1:e;break;default:o=e}t.splice(o,0,i)}}function ig(t,e,r){for(var n,a=r-1;((n=e[a])===null||n===void 0?void 0:n.segmentType)=="SelectionMarker";)a--;var i=e[a];i&&Qf(t,i)}function Ju(t,e){var r,n=(r=t.format)!==null&&r!==void 0?r:{},a={fontFamily:n.fontFamily,fontSize:n.fontSize,textColor:n.textColor,backgroundColor:n.backgroundColor,letterSpacing:n.letterSpacing,lineHeight:n.lineHeight,fontWeight:e?n.fontWeight:void 0,italic:e?n.italic:void 0,underline:e?n.underline:void 0};return og(a)}var og=function(t){var e={};return Object.keys(t).filter(function(r){var n=t[r];n!==void 0&&(e[r]=n)}),e},lg={contentUnderSelectedTableCell:"ignoreForTableOrCell",contentUnderSelectedGeneralElement:"generalElementOnly",includeListFormatHolder:"never"};function sg(t,e){var r={deleteResult:"notDeleted",insertPoint:null,formatContext:e,undeletableSegments:[]};return Qe(t,function(n,a,i,o){var s=Ge(!0,void 0,t.format),l=t.format,u=0;if(o&&i?.blockType=="Paragraph"){var d=M(Pi(i,o),3),f=d[0],h=d[1],v=d[2];if(h[0]){s=f,u=v[0],l=Ju(h[0],!0);var c=!r.lastParagraph;r.lastParagraph=s,r.lastTableContext=a,h.forEach(function(R,H){H==0&&!r.insertPoint&&R.segmentType=="SelectionMarker"?r.insertPoint=ml(R,f,n,a):la(f,R,r.formatContext,void 0,c?void 0:r.undeletableSegments)&&(r.deleteResult="range")}),r.deleteResult=="range"&&Xe(f)}}else if(i){var p=w(n[0]).blocks;Zu(p,i,s,r.formatContext)&&(r.deleteResult="range")}else if(a){var g=a.table,b=a.colIndex,y=a.rowIndex,E=w(g),S=E.rows[y],T=w(S.cells[b]);n=P([T],M(n),!1),s.segments.push(zt(t.format)),T.blocks=[s],r.deleteResult="range"}if(!r.insertPoint){var k=He(l);Xe(s),s.segments.splice(u,0,k),r.insertPoint=ml(k,s,n,a)}},lg),r}function ml(t,e,r,n){return{marker:t,paragraph:e,path:r,tableContext:n}}function Qu(t,e){t.forEach(function(r){r&&ug(e)&&r(e)})}function ug(t){return!!t.insertPoint}function Ar(t,e,r){e===void 0&&(e=[]);var n=sg(t,r),a=e.filter(function(i){return!!i});return Qu(a,n),dg(n),n}function dg(t){var e,r,n=t.insertPoint,a=t.deleteResult,i=t.lastParagraph,o=t.lastTableContext,s=t.undeletableSegments;if(n&&a!="notDeleted"&&a!="nothingToDelete"&&i&&i!=n.paragraph&&o==n.tableContext){var l=w(i),u=w(n.paragraph);s&&(e=l.segments).unshift.apply(e,P([],M(s),!1)),(r=u.segments).push.apply(r,P([],M(l.segments),!1)),l.segments=[]}}var no={backgroundColor:"",fontFamily:"",fontSize:"",fontWeight:"",italic:!1,letterSpacing:"",lineHeight:"",strikethrough:!1,superOrSubScriptSequence:"",textColor:"",underline:!1},Yr=30,tn=22;function Da(t,e){var r,n=w(t),a=n.format;(!a.borderCollapse||!a.useBorderBox)&&(a.borderCollapse=!0,a.useBorderBox=!0),n.rows.forEach(function(h,v){h.cells.forEach(function(c,p){var g=w(c);if(g.blocks.length==0){var b=g.format.textColor?C(C({},e),{textColor:g.format.textColor}):e;ze(g,Ge(void 0,void 0,b)),it(g,zt(b))}v==0?g.spanAbove=!1:v>0&&p>0&&g.isHeader&&(g.isHeader=!1),p==0&&(g.spanLeft=!1),g.format.useBorderBox=!0}),h.height<tn&&(h.height=tn)});for(var i=Math.max.apply(Math,P([],M(n.rows.map(function(h){return h.cells.length})),!1)),o=0;o<i;o++)n.widths[o]===void 0?n.widths[o]=fg(i):n.widths[o]<Yr&&(n.widths[o]=Yr);for(var s=((r=n.rows[0])===null||r===void 0?void 0:r.cells.length)||0,l=function(h){n.rows.forEach(function(v){var c=v.cells[h],p=v.cells[h-1];c&&p&&c.spanLeft&&bl(p,c)}),n.rows.every(function(v){var c;return(c=v.cells[h])===null||c===void 0?void 0:c.spanLeft})&&(n.rows.forEach(function(v){return v.cells.splice(h,1)}),n.widths.splice(h-1,2,n.widths[h-1]+n.widths[h]))},u=s-1;u>0;u--)l(u);for(var d=function(h){var v=n.rows[h];v.cells.forEach(function(c,p){var g,b=(g=n.rows[h-1])===null||g===void 0?void 0:g.cells[p];b&&c.spanAbove&&bl(b,c)}),v.cells.every(function(c){return c.spanAbove})&&(n.rows[h-1].height+=v.height,n.rows.splice(h,1))},f=n.rows.length-1;f>0;f--)d(f)}function fg(t){return t<=4?120:t<=6?100:70}function bl(t,e){var r,n=e.blocks.every(function(a){return a.blockType=="Paragraph"&&vg(a.segments)});n||((r=w(t).blocks).push.apply(r,P([],M(e.blocks),!1)),w(e).blocks=[])}function vg(t){return t=t.filter(function(e){return e.segmentType!="SelectionMarker"}),t.length==0||t.length==1&&t[0].segmentType=="Br"}var cg=["h1","h2","h3","h4","h5","h6"],hg=ie(no);function ao(t,e,r,n){var a,i=(a=n?.insertPosition)!==null&&a!==void 0?a:Ar(t,[],r).insertPoint,o=n||{},s=o.addParagraphAfterMergedContent,l=o.mergeFormat,u=o.mergeTable;if(s&&!u){var d=i||{},f=d.paragraph,h=d.marker,v=Ge(!1,f?.format,h?.format);ze(e,v)}if(i){if(l&&l!="none"){var c=C(C({},t.format||{}),i.marker.format);Gn(e,c,l)}for(var p=0;p<e.blocks.length;p++){var g=e.blocks[p];switch(g.blockType){case"Paragraph":pg(i,g,p==0,r,n);break;case"Divider":Vr(i,g);break;case"Entity":Vr(i,g),r?.newEntities.push(g);break;case"Table":e.blocks.length==1&&u?gg(i,g,e):Vr(i,g);break;case"BlockGroup":switch(g.blockGroupType){case"General":case"FormatContainer":Vr(i,g);break;case"ListItem":mg(i,g);break}break}}}return ht(t),i}function pg(t,e,r,n,a){var i=t.paragraph,o=t.marker,s=r?i:io(t,e.format),l=s.segments.indexOf(o);if(a?.mergeFormat=="none"&&r&&(s.segments.forEach(function(v){v.format=C(C({},s.segmentFormat||{}),v.format)}),delete s.segmentFormat),l>=0)for(var u=0;u<e.segments.length;u++){var d=e.segments[u];s.segments.splice(l+u,0,d),n&&(d.segmentType=="Entity"&&n.newEntities.push(d),d.segmentType=="Image"&&n.newImages.push(d))}if(e.decorator&&(s.decorator=C({},e.decorator),cg.indexOf(s.decorator.tagName)>-1)){var f=ie(s.decorator.format),h=ie(s.segmentFormat||{});f.forEach(function(v){var c;h.indexOf(v)>-1&&((c=s.segmentFormat)===null||c===void 0||delete c[v])})}r?s.format=C(C({},s.format),e.format):s.format=e.format}function gg(t,e,r){var n,a,i=t.tableContext,o=t.marker;if(i&&r.blocks.length==1&&r.blocks[0]==e){for(var s=i.table,l=i.colIndex,u=i.rowIndex,d=w(s),f=0;f<e.rows.length;f++)for(var h=0;h<e.rows[f].cells.length;h++){var v=e.rows[f].cells[h];if(f==0&&l+h>=d.rows[0].cells.length)for(var c=0;c<d.rows.length;c++){var p=(n=d.rows[c])===null||n===void 0?void 0:n.cells[l+h-1];d.rows[c].cells[l+h]=Nt(!1,!1,p?.isHeader,p?.format)}if(h==0&&u+f>=d.rows.length){d.rows[u+f]||(d.rows[u+f]={cells:[],format:{},height:0});for(var c=0;c<d.rows[u].cells.length;c++){var g=(a=d.rows[u+f-1])===null||a===void 0?void 0:a.cells[c];d.rows[u+f].cells[c]=Nt(!1,!1,!1,g?.format)}}var b=d.rows[u+f].cells[l+h];if(d.rows[u+f].cells[l+h]=v,f==0&&h==0){var y=He(o.format),E=it(v,y);t.path[0]==b&&(t.path[0]=v,t.marker=y,t.paragraph=E)}}Da(d,t.marker.format),Ma(d,void 0,!0)}else Vr(t,e)}function mg(t,e){io(t,e.format);var r=t.path,n=t.paragraph,a=Je(r,["ListItem"],["TableCell"]),i=r[a],o=r[a+1],s=o.blocks.indexOf(i||n);s>=0&&w(o).blocks.splice(s,0,e),i&&i?.levels.forEach(function(l,u){e.levels[u]=C({},l)})}function io(t,e){var r=t.paragraph,n=t.marker,a=t.path,i=r.segments.indexOf(n),o=a[0].blocks.indexOf(r),s=Ge(!1,C(C({},r.format),e),r.segmentFormat);i>=0&&(s.segments=r.segments.splice(i)),o>=0&&w(a[0]).blocks.splice(o+1,0,s);var l=Je(a,["ListItem"],["FormatContainer","TableCell"]),u=a[l];if(u){var d=l>=0?a[l+1]:null,f=d?d.blocks.indexOf(u):-1;if(f>=0&&d){var h=fn(u.levels,u.formatHolder.format);o>=0&&(h.blocks=u.blocks.splice(o+1)),f>=0&&w(d).blocks.splice(f+1,0,h),a[l]=h}}return t.paragraph=s,s}function Vr(t,e){var r=t.path,n=e.blockType!=="Paragraph"?{}:e.format,a=io(t,n),i=r[0].blocks.indexOf(a);i>=0&&w(r[0]).blocks.splice(i,0,e)}function Gn(t,e,r){t.blocks.forEach(function(n){var a;switch(bg(r,n),n.blockType){case"BlockGroup":n.blockGroupType=="ListItem"&&(w(n).formatHolder.format=yl(r,e,n.formatHolder.format)),Gn(n,e,r);break;case"Table":n.rows.forEach(function(s){return s.cells.forEach(function(l){Gn(l,e,r)})});break;case"Paragraph":var i=((a=n.decorator)===null||a===void 0?void 0:a.format)||{},o=w(n);o.segments.forEach(function(s){s.segmentType=="General"&&Gn(s,e,r),s.format=yl(r,e,C(C({},i),s.format)),s.link&&(s.link.format=yg(r,e,s.link.format))}),r==="keepSourceEmphasisFormat"&&delete o.decorator;break}})}function bg(t,e){t=="keepSourceEmphasisFormat"&&e.format.backgroundColor&&delete w(e).format.backgroundColor}function Va(t){var e={};return t.backgroundColor&&(e.backgroundColor=t.backgroundColor),t.underline&&(e.underline=t.underline),e}function yg(t,e,r){switch(t){case"mergeAll":case"preferSource":return C(C({},Va(e)),r);case"keepSourceEmphasisFormat":return C(C(C(C({},ed(r)),Va(e)),$u(r)),Eg(r));case"preferTarget":return C(C({},r),Va(e))}}function yl(t,e,r){switch(t){case"mergeAll":case"preferSource":return C(C({},e),r);case"preferTarget":return C(C({},r),e);case"keepSourceEmphasisFormat":return C(C(C({},ed(r)),e),$u(r))}}function $u(t){var e={},r=t.fontWeight,n=t.italic,a=t.underline;return r&&r!="normal"&&(e.fontWeight=r),n&&(e.italic=n),a&&(e.underline=a),e}function ed(t){var e=C({},t);return hg.forEach(function(r){return delete e[r]}),e}function Eg(t){var e={};return t.textColor&&(e.textColor=t.textColor),e}var Dt=oa(!0),El=Tr(!0),Cg=_a({widthPx:Dt,heightPx:Dt,leftPercent:Dt,rightPercent:Dt,topPercent:Dt,bottomPercent:Dt,angleRad:Dt,src:xu(),naturalHeight:Dt,naturalWidth:Dt,flippedHorizontal:El,flippedVertical:El});function Sg(t){return ma(t,Cg)}function Tg(t,e,r,n,a,i,o){n===void 0&&(n="remove");var s,l,u=!0,d=!0,f=!0,h=void 0,v=C({},t.format);delete v.italic,delete v.underline,delete v.fontWeight,Qe(t,function(c,p,g,b){if(_g(r,c,u,n),g&&(l?r.isMultilineSelection=!0:l=g),g?.blockType=="Paragraph"&&(kg(r,g,u,n),b?.forEach(function(T){var k,R,H,U;if(f||T.segmentType!="SelectionMarker"){var q=Object.assign({},g.format,(k=g.decorator)===null||k===void 0?void 0:k.format,T.format,(R=T.code)===null||R===void 0?void 0:R.format,(H=T.link)===null||H===void 0?void 0:H.format,e);Lg(q)||(h||(h=(U=a?.getContainerFormat(i,o))!==null&&U!==void 0?U:v),q=Object.assign({},h,q)),wg(r,u,q,n),he(r,"isCodeInline",!!T?.code,u,n)}f=!1,r.canUnlink=r.canUnlink||!!T.link,r.canAddImageAltText=r.canAddImageAltText||b.some(function(W){return W.segmentType=="Image"}),u=!1,T.segmentType==="Image"&&(d?(Dg(T,r),d=!1):(r.imageFormat=void 0,r.imageEditingMetadata=void 0))}),u=!1),p)if(s){var y=s.table,E=s.colIndex,S=s.rowIndex;p.table==y&&(p.colIndex!=E||p.rowIndex!=S)&&(r.canMergeTableCell=!0,r.isMultilineSelection=!0)}else Mg(p,r),s=p},{includeListFormatHolder:"never"}),r.fontSize&&(r.fontSize=Og(r.fontSize))}function wg(t,e,r,n){var a,i;n===void 0&&(n="remove");var o=(i=(a=r.superOrSubScriptSequence)===null||a===void 0?void 0:a.split(" "))===null||i===void 0?void 0:i.pop();he(t,"isBold",Lu(r.fontWeight),e,n),he(t,"isItalic",r.italic,e,n),he(t,"isUnderline",r.underline,e,n),he(t,"isStrikeThrough",r.strikethrough,e,n),he(t,"isSuperscript",o=="super",e,n),he(t,"isSubscript",o=="sub",e,n),he(t,"letterSpacing",r.letterSpacing,e,n),he(t,"fontName",r.fontFamily,e,n),he(t,"fontSize",r.fontSize,e,n,function(s){return Ke(s,void 0,"pt")+"pt"}),he(t,"backgroundColor",r.backgroundColor,e,n),he(t,"textColor",r.textColor,e,n),he(t,"fontWeight",r.fontWeight,e,n),he(t,"lineHeight",r.lineHeight,e,n)}function kg(t,e,r,n){var a;n===void 0&&(n="remove");var i=parseInt((((a=e.decorator)===null||a===void 0?void 0:a.tagName)||"").substring(1)),o=i>=1&&i<=6?i:void 0;he(t,"marginBottom",e.format.marginBottom,r,n),he(t,"marginTop",e.format.marginTop,r,n),he(t,"headingLevel",o,r,n),he(t,"textAlign",e.format.textAlign,r,n),he(t,"direction",e.format.direction,r,n)}function _g(t,e,r,n){var a,i;n===void 0&&(n="remove");var o=Je(e,["ListItem"],[]),s=Je(e,["FormatContainer"],[]);if(o>=0){var l=e[o],u=(a=l?.levels[l.levels.length-1])===null||a===void 0?void 0:a.listType;he(t,"isBullet",u=="UL",r,n),he(t,"isNumbering",u=="OL",r,n)}he(t,"isBlockQuote",s>=0&&((i=e[s])===null||i===void 0?void 0:i.tagName)=="blockquote",r,n)}function Mg(t,e){var r=Qp(t.table);e.isInTable=!0,e.tableHasHeader=t.table.rows.some(function(n){return n.cells.some(function(a){return a.isHeader})}),r&&(e.tableFormat=r)}function Dg(t,e){var r=t.format,n="borderTop",a=Ru(r[n]),i=a.color,o=a.width,s=a.style;e.imageFormat={borderColor:i,borderWidth:o,borderStyle:s,boxShadow:r.boxShadow,borderRadius:r.borderRadius},e.imageEditingMetadata=Sg(t)}function he(t,e,r,n,a,i){if(a===void 0&&(a="remove"),i===void 0&&(i=function(o){return o}),n)r!==void 0&&(t[e]=r);else if(i(r)!==i(t[e]))switch(a){case"remove":delete t[e];break;case"keepFirst":break;case"returnMultiple":typeof t[e]=="string"?t[e]="Multiple":delete t[e];break}}function Og(t){if(t){var e=t.indexOf("px");if(e!==-1&&e===t.length-2)return Math.round(parseFloat(t)*75+.05)/100+"pt"}return t}function Lg(t){return!!t.fontFamily&&!!t.fontSize&&!!t.textColor}var ce,oo=(ce={},ce[B.Decimal]="decimal",ce[B.DecimalDash]='"${Number}- "',ce[B.DecimalParenthesis]='"${Number}) "',ce[B.DecimalDoubleParenthesis]='"(${Number}) "',ce[B.LowerAlpha]="lower-alpha",ce[B.LowerAlphaDash]='"${LowerAlpha}- "',ce[B.LowerAlphaParenthesis]='"${LowerAlpha}) "',ce[B.LowerAlphaDoubleParenthesis]='"(${LowerAlpha}) "',ce[B.UpperAlpha]="upper-alpha",ce[B.UpperAlphaDash]='"${UpperAlpha}- "',ce[B.UpperAlphaParenthesis]='"${UpperAlpha}) "',ce[B.UpperAlphaDoubleParenthesis]='"(${UpperAlpha}) "',ce[B.LowerRoman]="lower-roman",ce[B.LowerRomanDash]='"${LowerRoman}- "',ce[B.LowerRomanParenthesis]='"${LowerRoman}) "',ce[B.LowerRomanDoubleParenthesis]='"(${LowerRoman}) "',ce[B.UpperRoman]="upper-roman",ce[B.UpperRomanDash]='"${UpperRoman}- "',ce[B.UpperRomanParenthesis]='"${UpperRoman}) "',ce[B.UpperRomanDoubleParenthesis]='"(${UpperRoman}) "',ce),Ve,lo=(Ve={},Ve[me.Disc]="disc",Ve[me.Square]="square",Ve[me.Circle]="circle",Ve[me.Dash]='"- "',Ve[me.LongArrow]='"➔ "',Ve[me.DoubleLongArrow]='"➔ "',Ve[me.ShortArrow]='"➢ "',Ve[me.UnfilledArrow]='"➪ "',Ve[me.Hyphen]='"— "',Ve[me.CheckMark]='"✔ "',Ve[me.Xrhombus]='"❖ "',Ve[me.BoxShadow]='"❑ "',Ve);function Rg(t,e){var r=t=="OL"?oo:lo,n=ie(r),a=n.find(function(i){return r[i]==e});return a&&(typeof a=="string"?parseInt(a):a)}var Oa=_a({orderedStyleType:oa(!0,void 0,B.Min,B.Max),unorderedStyleType:oa(!0,void 0,me.Min,me.Max),applyListStyleFromLevel:Tr(!0)},!0,!0);function Fg(t){return ma(t,Oa)}function sa(t,e){return ba(t,e,Oa)}var Ue={AutoLink:"AutoLink",CreateLink:"CreateLink",Format:"Format",ImageResize:"ImageResize",Paste:"Paste",SetContent:"SetContent",Cut:"Cut",Drop:"Drop",InsertEntity:"InsertEntity",SwitchToDarkMode:"SwitchToDarkMode",SwitchToLightMode:"SwitchToLightMode",ListChain:"ListChain",Keyboard:"Keyboard",AutoFormat:"AutoFormat",Replace:"Replace"};function Ci(t,e,r){var n,a,i=[],o;if(!t||!r.contains(t))return i;if(L(t,"TEXT_NODE")){for(o=t.parentNode;t.previousSibling&&L(t.previousSibling,"TEXT_NODE");)e+=((n=t.previousSibling.nodeValue)===null||n===void 0?void 0:n.length)||0,t=t.previousSibling;i.unshift(e)}else o=t,t=t.childNodes[e];do{e=0;for(var s=!1,l=o?.firstChild||null;l&&l!=t;l=l.nextSibling){if(L(l,"TEXT_NODE")){if(((a=l.nodeValue)===null||a===void 0?void 0:a.length)===0||s)continue;s=!0}else s=!1;e++}i.unshift(e),t=o,o=o?.parentNode||null}while(t&&t!=r);return i}function Pg(t){var e=t.physicalRoot,r=t.api,n=r.getDOMSelection(t);if(n?.type=="range"){var a=n.range,i=a.startContainer,o=a.startOffset,s=a.endContainer,l=a.endOffset,u=Cl(i,e);if(s!=i&&(u=Cl(s,e)||u),u){var d=e.ownerDocument.createRange();d.setStart(i,o),d.setEnd(s,l),r.setDOMSelection(t,{type:"range",range:d,isReverted:!!n.isReverted},!0)}}switch(n?.type){case"image":return{type:"image",imageId:n.image.id};case"table":return{type:"table",tableId:n.table.id,firstColumn:n.firstColumn,lastColumn:n.lastColumn,firstRow:n.firstRow,lastRow:n.lastRow};case"range":var f=n.range;return{type:"range",start:Ci(f.startContainer,f.startOffset,e),end:Ci(f.endContainer,f.endOffset,e),isReverted:!!n.isReverted};default:return{type:"range",start:[],end:[],isReverted:!1}}}function Cl(t,e){for(var r=t,n=!1;r&&e.contains(r);)L(r,"ELEMENT_NODE")&&ae(r,"table")&&(n=Ag(r)||n),r=r.parentNode;return n}function Ag(t){for(var e,r=!1,n=null,a=t.firstChild;a;a=a.nextSibling){var i=L(a,"ELEMENT_NODE")?a.tagName:null;switch(i){case"TR":n||(n=t.ownerDocument.createElement("tbody"),t.insertBefore(n,a)),n.appendChild(a),a=n,r=!0;break;case"TBODY":n?(St(n,a,!0),(e=a.parentNode)===null||e===void 0||e.removeChild(a),a=n,r=!0):n=a;break;default:n=null;break}}var o=t.querySelectorAll("colgroup"),s=t.querySelector("thead");return s&&o.forEach(function(l){s.contains(l)||s.appendChild(l)}),r}var Ng=function(t,e,r){var n=t.lifecycle,a=t.physicalRoot,i=t.logicalRoot,o=t.undo,s=null;if(!n.shadowEditFragment){var l={eventType:"beforeAddUndoSnapshot",additionalState:{}};t.api.triggerEvent(t,l,!1);var u=Pg(t),d=a.innerHTML;if(i!==a){var f=Wi(i,t.domHelper);if(!r&&f){var h=or(f);if(h.entityType&&h.id){var v={eventType:"entityOperation",operation:"snapshotEntityState",entity:{type:h.entityType,id:h.id,wrapper:f,isReadonly:h.isReadonly},state:void 0};t.api.triggerEvent(t,v,!1),v.state&&(r=[{type:h.entityType,id:h.id,state:v.state}])}}}s={html:d,additionalState:l.additionalState,entityStates:r,isDarkMode:!!n.isDarkMode,selection:u},i!==a&&(s.logicalRootPath=Ci(i,0,a)),o.snapshotsManager.addSnapshot(s,!!e),o.snapshotsManager.hasNewContent=!1}return s};function td(t){var e=t.createElement("div");return e.style.clip="rect(0px, 0px, 0px, 0px)",e.style.clipPath="inset(100%)",e.style.height="1px",e.style.overflow="hidden",e.style.position="absolute",e.style.whiteSpace="nowrap",e.style.width="1px",e.ariaLive="assertive",t.body.appendChild(e),e}var Ig=".",Bg=function(t,e){var r=e.text,n=e.defaultStrings,a=e.formatStrings,i=a===void 0?[]:a,o=e.ariaLiveMode,s=o===void 0?"assertive":o,l=t.lifecycle.announcerStringGetter,u=n&&l?.(n),d=Hg(u||r,i);if(t.lifecycle.announceContainer||(t.lifecycle.announceContainer=td(t.physicalRoot.ownerDocument)),d&&t.lifecycle.announceContainer){var f=t.lifecycle.announceContainer;f.ariaLive!=s&&(f.ariaLive=s),d==f.textContent&&(d+=Ig),f&&(f.textContent=d)}};function Hg(t,e){return t==null||(t=t.replace(/\{(\d+)\}/g,function(r,n){var a=parseInt(n),i=e[a];return i??""})),t}var zg=function(t,e){var r=ie(e||{}).map(function(n){var a=e[n],i=a.pluginEventType,o=a.beforeDispatch,s=a.capture,l=n,u=function(d){o&&o(d),i!=null&&t.api.triggerEvent(t,{eventType:i,rawEvent:d},!1)};return t.logicalRoot.addEventListener(l,u,{capture:s}),function(){t.logicalRoot.removeEventListener(l,u,{capture:s})}});return function(){return r.forEach(function(n){return n()})}};function ua(t,e,r){if(t.cachedModel=e,r?.type=="range"){var n=r.range,a=n.startContainer,i=n.startOffset,o=n.endContainer,s=n.endOffset,l=r.isReverted;t.cachedSelection={type:"range",isReverted:l,start:{node:a,offset:i},end:{node:o,offset:s}}}else t.cachedSelection=r??void 0}var xg=function(t,e,r){var n;(n=t.cache.textMutationObserver)===null||n===void 0||n.flushMutations();var a=!e||e.tryGetFromCache&&typeof e.recalculateTableSize>"u";if(!r&&a){var i=t.cache.cachedModel;if(i)return t.lifecycle.shadowEditFragment?en(i,{includeCachedElement:!0}):i}var o=r=="none"?void 0:r||t.api.getDOMSelection(t)||void 0,s=!e&&!r,l=t.api.createEditorContext(t,s);l.recalculateTableSize=e?.recalculateTableSize;var u=t.environment.domToModelSettings,d=e?cn(l,u.builtIn,u.customized,e):hn(u.calculated,l);o&&(d.selection=o);var f=on(t.logicalRoot,d);return s&&ua(t.cache,f,o),f},Ug=16;function rd(t){var e,r=(e=t.defaultView)===null||e===void 0?void 0:e.getComputedStyle(t.documentElement);return{rootFontSize:Ke(r?.fontSize)||Ug}}var Gg=function(t,e){var r,n,a=t.lifecycle,i=t.format,o=t.darkColorHandler,s=t.logicalRoot,l=t.cache,u=t.domHelper;e=e&&!t.lifecycle.shadowEditFragment;var d=C({isDarkMode:a.isDarkMode,defaultFormat:i.defaultFormat,pendingFormat:(r=i.pendingFormat)!==null&&r!==void 0?r:void 0,darkColorHandler:o,addDelimiterForEntity:!0,allowCacheElement:!0,domIndexer:e?l.domIndexer:void 0,zoomScale:u.calculateZoomScale(),experimentalFeatures:(n=t.experimentalFeatures)!==null&&n!==void 0?n:[],paragraphMap:t.cache.paragraphMap},rd(s.ownerDocument));return t.domHelper.isRightToLeft()&&(d.isRootRtl=!0),d},Kg=function(t){var e;if(!t.lifecycle.shadowEditFragment){var r=t.api,n=t.domHelper,a=t.selection;!n.hasFocus()&&((e=a.selection)===null||e===void 0?void 0:e.type)=="range"&&r.setDOMSelection(t,a.selection,!0),n.hasFocus()||t.logicalRoot.focus()}};function Wg(t,e){var r=up(t.physicalRoot.ownerDocument,e.type=="image"?{node:e.image,offset:0}:e.isReverted?{node:e.range.startContainer,offset:e.range.startOffset}:{node:e.range.endContainer,offset:e.range.endOffset}),n=t.api.getVisibleViewport(t),a=t.domEvent.scrollContainer;r&&n&&Nv(a,n,t.domHelper,r)}var Vg=function(t,e,r,n){var a,i,o=r||{},s=o.onNodeCreated,l=o.rawEvent,u=o.selectionOverride,d=o.scrollCaretIntoView,f=t.api.createContentModel(t,n,u),h={newEntities:[],deletedEntities:[],rawEvent:l,newImages:[],paragraphIndexer:t.cache.paragraphMap},v=t.domHelper.hasFocus(),c=e(f,h),p=h.skipUndoSnapshot,g=h.clearModelCache,b=h.entityStates,y=h.canUndoByBackspace;if(c){var E=t.undo.isNested,S=(!p||p=="DoNotSkip")&&!E,T=(p===!0||p=="MarkNewContent")&&!E,k=void 0;S&&(t.undo.isNested=!0,t.api.addUndoSnapshot(t,!!y,b));try{jg(t,h),k=(a=t.api.setContentModel(t,f,v?void 0:{ignoreSelection:!0},s))!==null&&a!==void 0?a:void 0,Sl(t,h,k),d&&(k?.type=="range"||k?.type=="image")&&Wg(t,k);var R={eventType:"contentChanged",contentModel:g?void 0:f,selection:g?void 0:k,source:r?.changeSource||Ue.Format,data:(i=r?.getChangeData)===null||i===void 0?void 0:i.call(r),formatApiName:r?.apiName,changedEntities:qg(h,l),skipUndo:!(T||S)||r?.changeSource==Ue.Keyboard};t.api.triggerEvent(t,R,!0),y&&k?.type=="range"&&(t.undo.autoCompleteInsertPoint={node:k.range.startContainer,offset:k.range.startOffset}),S&&t.api.addUndoSnapshot(t,!1,b),T&&(t.undo.snapshotsManager.hasNewContent=!0)}finally{E||(t.undo.isNested=!1)}}else g&&(t.cache.cachedModel=void 0,t.cache.cachedSelection=void 0),Sl(t,h,t.api.getDOMSelection(t));h.announceData&&t.api.announce(t,h.announceData)};function jg(t,e){if(e.newImages.length>0){var r=t.domHelper.getClientWidth(),n=10,a=Math.max(r,n);e.newImages.forEach(function(i){i.format.maxWidth=a+"px"})}}function Sl(t,e,r){var n,a,i=e.newPendingFormat=="preserve"?(n=t.format.pendingFormat)===null||n===void 0?void 0:n.format:e.newPendingFormat,o=e.newPendingParagraphFormat=="preserve"?(a=t.format.pendingFormat)===null||a===void 0?void 0:a.paragraphFormat:e.newPendingParagraphFormat;(i||o)&&r?.type=="range"&&r.range.collapsed&&(t.format.pendingFormat={format:i?C({},i):void 0,paragraphFormat:o?C({},o):void 0,insertPoint:{node:r.range.startContainer,offset:r.range.startOffset}})}function qg(t,e){return t.autoDetectChangedEntities?void 0:t.newEntities.map(function(r){return{entity:r,operation:"newEntity",rawEvent:e}}).concat(t.deletedEntities.map(function(r){return{entity:r.entity,operation:r.operation,rawEvent:e}}))}var Xg=function(t){if(t.lifecycle.shadowEditFragment)return null;var e=t.selection.selection;return e&&(e.type!="range"||!t.domHelper.hasFocus())?e:Yg(t)};function Yg(t){var e,r=(e=t.logicalRoot.ownerDocument.defaultView)===null||e===void 0?void 0:e.getSelection(),n=r&&r.rangeCount>0?r.getRangeAt(0):null;return r&&n&&t.logicalRoot.contains(n.commonAncestorContainer)?{type:"range",range:n,isReverted:r.focusNode!=n.endContainer||r.focusOffset!=n.endOffset}:null}var Zg=function(t){var e=t.domEvent.scrollContainer;return Jg(e==t.physicalRoot?[e]:[e,t.physicalRoot])};function Jg(t,e){e===void 0&&(e=[]);var r=t.map(function(a){return Te(a.getBoundingClientRect())}).concat(e).filter(function(a){return!!a}),n={top:Math.max.apply(Math,P([],M(r.map(function(a){return a.top})),!1)),bottom:Math.min.apply(Math,P([],M(r.map(function(a){return a.bottom})),!1)),left:Math.max.apply(Math,P([],M(r.map(function(a){return a.left})),!1)),right:Math.min.apply(Math,P([],M(r.map(function(a){return a.right})),!1))};return n.top<n.bottom&&n.left<n.right?n:null}function Qg(t,e){var r=t.lifecycle.isDarkMode;t.darkColorHandler.updateKnownColor(r),!!e.isDarkMode!=!!r&&aa(t.physicalRoot,!1,r?"lightToDark":"darkToLight",t.darkColorHandler)}function $g(t,e){for(var r,n,a=t.physicalRoot,i=t.entity.entityMap,o=a.firstChild,s=t.domCreator.htmlToDOM(e.html).body,l=s.firstChild;l;){var u=l.nextSibling,d=Tl(i,l);if(d){if(dn(d))for(var f=d.firstChild;f;f=f.nextSibling)L(f,"ELEMENT_NODE")&&Rt(f)&&((r=t.cache.domIndexer)===null||r===void 0||r.clearIndex(f));o=lr(a,d,o)}else if(a.insertBefore(l,o),L(l,"ELEMENT_NODE")){var h=du(l);h.forEach(function(v){var c,p=Tl(i,v);if(p){if(p==o){var g=p.cloneNode();a.insertBefore(g,o),o=g}(c=v.parentNode)===null||c===void 0||c.replaceChild(p,v)}})}l=u}for(;o;){var u=o.nextSibling;(n=o.parentNode)===null||n===void 0||n.removeChild(o),o=u}}function Tl(t,e){var r=null;if(L(e,"ELEMENT_NODE"))if(pt(e)){var n=or(e);r=nd(t,n.id)}else dn(e)&&(r=em(e,t));return r}function em(t,e){for(var r,n=t.firstChild;n;n=n.nextSibling)if(pt(n)&&L(n,"ELEMENT_NODE")){var a=or(n),i=(r=nd(e,a.id))===null||r===void 0?void 0:r.parentElement;return L(i,"ELEMENT_NODE")&&dn(i)?i:null}return null}function nd(t,e){var r=e?t[e]:void 0;return r?.canPersist?r.element:null}function Si(t,e){for(var r=0,n=0;n<e.length&&(r=e[n],n<e.length-1&&t&&L(t,"ELEMENT_NODE")&&t.childNodes.length>r);n++)t=t.childNodes[r];return{node:t,offset:r}}function tm(t,e){if(e.logicalRootPath&&e.logicalRootPath.length>0){var r=Si(t.physicalRoot,e.logicalRootPath).node;r!==t.logicalRoot&&t.api.setLogicalRoot(t,r)}}function rm(t,e){var r=e.selection,n=t.physicalRoot,a=null;try{if(r)switch(r.type){case"range":var i=Si(n,r.start),o=Si(n,r.end),s=n.ownerDocument.createRange();s.setStart(i.node,i.offset),s.setEnd(o.node,o.offset),a={type:"range",range:s,isReverted:r.isReverted};break;case"table":var l=n.querySelector(_r(r.tableId));l&&(a={type:"table",table:l,firstColumn:r.firstColumn,firstRow:r.firstRow,lastColumn:r.lastColumn,lastRow:r.lastRow});break;case"image":var u=n.querySelector(_r(r.imageId));u&&(a={type:"image",image:u});break}a&&t.api.setDOMSelection(t,a)}catch{}}var nm=function(t,e){t.api.triggerEvent(t,{eventType:"beforeSetContent",newContent:e.html},!0);try{t.undo.isRestoring=!0,t.api.setLogicalRoot(t,null),$g(t,e),tm(t,e),rm(t,e),Qg(t,e);var r={eventType:"contentChanged",additionalState:e.additionalState,entityStates:e.entityStates,source:Ue.SetContent};t.api.triggerEvent(t,r,!1)}finally{t.undo.isRestoring=!1}},am=function(t,e,r,n,a){var i,o,s=t.api.createEditorContext(t,!0),l=r?Sa(s,t.environment.modelToDomSettings.builtIn,t.environment.modelToDomSettings.customized,r):Yi(t.environment.modelToDomSettings.calculated,s);l.onNodeCreated=n,(i=t.onFixUpModel)===null||i===void 0||i.call(t,e);var u=Ii(t.logicalRoot.ownerDocument,t.logicalRoot,e,l);return t.lifecycle.shadowEditFragment||((o=t.cache.textMutationObserver)===null||o===void 0||o.flushMutations(!0),ua(t.cache,e,u),!r?.ignoreSelection&&u?t.api.setDOMSelection(t,u):t.selection.selection=u),a?t.lifecycle.rewriteFromModel=l.rewriteFromModel:t.api.triggerEvent(t,C({eventType:"rewriteFromModel"},l.rewriteFromModel),!0),u};function ad(t,e){if(t==e)return!0;switch(t.type){case"image":return e.type=="image"&&e.image==t.image;case"table":return e.type=="table"&&lm(t,e);case"range":default:if(e.type=="range"){var r=t.range;if(sm(e)){var n=e.start,a=e.end;return r.startContainer==n.node&&r.endContainer==a.node&&r.startOffset==n.offset&&r.endOffset==a.offset}else return od(r,e.range)}else return!1}}function id(t,e,r){return r.every(function(n){return t[n]==e[n]})}var im=["table","firstColumn","lastColumn","firstRow","lastRow"],om=["startContainer","endContainer","startOffset","endOffset"];function lm(t,e){return id(t,e,im)}function od(t,e){return id(t,e,om)}function sm(t){return!!t.start}function ld(t,e,r){var n;r===void 0&&(r=!1);var a=(n=t.defaultView)===null||n===void 0?void 0:n.getSelection();if(a){var i=a.rangeCount>0&&a.getRangeAt(0);if(i&&od(i,e))return;a.removeAllRanges(),r?a.setBaseAndExtent(e.endContainer,e.endOffset,e.startContainer,e.startOffset):a.addRange(e)}}function Ti(t,e){e=t.id||e;for(var r=t.ownerDocument,n=0;!t.id||r.querySelectorAll(_r(t.id)).length>1;)t.id=e+"_"+n++;return t.id}function um(t,e){for(var r,n,a,i,o=e.row,s=e.col;o>=0&&s>=0&&o<t.length&&s<((n=(r=t[o])===null||r===void 0?void 0:r.length)!==null&&n!==void 0?n:0);){var l=(a=t[o])===null||a===void 0?void 0:a[s+1],u=(i=t[o+1])===null||i===void 0?void 0:i[s];if(l=="spanLeft"||l=="spanBoth")s++;else if(u=="spanTop"||u=="spanBoth")o++;else return{row:o,col:s}}return null}function Kn(t,e){for(var r,n,a,i=e.row,o=e.col;i>=0&&o>=0&&i<t.length&&o<((n=(r=t[i])===null||r===void 0?void 0:r.length)!==null&&n!==void 0?n:0);){var s=(a=t[i])===null||a===void 0?void 0:a[o];if(s){if(typeof s=="object")return{cell:s,row:i,col:o};s=="spanLeft"||s=="spanBoth"?o--:i--}else break}return null}var dm="caret-color: transparent",fm="_DOMSelectionHideCursor";function da(t,e){t.api.setEditorStyle(t,fm,e?dm:null)}var ja="_DOMSelection",qa="_DOMSelectionHideSelection",vm="image",cm="table",wl="background-color: transparent !important;",kl="*::selection",hm="#DB626C",pm=function(t,e,r){var n,a,i,o=t.api.getDOMSelection(t);if(!(o&&e&&ad(o,e))){var s=t.selection.skipReselectOnFocus,l=t.physicalRoot.ownerDocument,u=t.lifecycle.isDarkMode;t.selection.skipReselectOnFocus=!0,t.api.setEditorStyle(t,ja,null),t.api.setEditorStyle(t,qa,null),da(t,!1);try{switch(e?.type){case"image":var d=e.image;t.selection.selection=e;var f=u?t.selection.imageSelectionBorderColorDark:t.selection.imageSelectionBorderColor;t.api.setEditorStyle(t,ja,"outline-style:solid!important; outline-color:"+(f||hm)+"!important;",[_r(Ti(d,vm))]),t.api.setEditorStyle(t,qa,wl,[kl]),_l(l,d,!1);break;case"table":var h=e.table,v=e.firstColumn,c=e.firstRow,p=e.lastColumn,g=e.lastRow,b=Jr(e.table),y={row:Math.min(c,g),col:Math.min(v,p),cell:null},E={row:Math.max(c,g),col:Math.max(v,p)};if(y=Kn(b,y)||y,E=um(b,E)||E,isNaN(y.row)||isNaN(y.col)||isNaN(E.row)||isNaN(E.col))return;e={type:"table",table:h,firstRow:y.row,firstColumn:y.col,lastRow:E.row,lastColumn:E.col,tableSelectionInfo:e.tableSelectionInfo};var S=Ti(h,cm),T=_r(S),k=y.row==0&&y.col==0&&E.row==b.length-1&&E.col==((a=(n=b[E.row])===null||n===void 0?void 0:n.length)!==null&&a!==void 0?a:0)-1?[T,T+" *"]:gm(b,T,h,y,E);t.selection.selection=e;var R=u?t.selection.tableCellSelectionBackgroundColorDark:t.selection.tableCellSelectionBackgroundColor;t.api.setEditorStyle(t,ja,"background-color:"+R+"!important;",k),t.api.setEditorStyle(t,qa,wl,[kl]),da(t,!0);var H=((i=y.cell)===null||i===void 0?void 0:i.firstElementChild)||y.cell;H&&_l(l,H||void 0,!0);break;case"range":ld(l,e.range,e.isReverted),t.selection.selection=t.domHelper.hasFocus()?null:e;break;default:t.selection.selection=null;break}}finally{t.selection.skipReselectOnFocus=s}if(!r){var U={eventType:"selectionChanged",newSelection:e};t.api.triggerEvent(t,U,!0)}}};function gm(t,e,r,n,a){var i=[],o=0,s=Ze(r.childNodes).filter(function(l){return["THEAD","TBODY","TFOOT"].indexOf(L(l,"ELEMENT_NODE")?l.tagName:"")>-1}).map(function(l){var u={el:l.tagName,start:o,end:l.childNodes.length+o};return o=u.end,u});return t.forEach(function(l,u){for(var d=0,f=s.filter(function(b){return b.start<=u&&b.end>u})[0],h=f?">"+f.el+">":">",v=f&&u+1>=f.start?u+1-f.start:u+1,c=0;c<l.length;c++){var p=l[c];if(typeof p=="object"&&(d++,u>=n.row&&u<=a.row&&c>=n.col&&c<=a.col)){var g=""+e+h+" tr:nth-child("+v+")>"+p.tagName+":nth-child("+d+")";i.push(g,g+" *")}}}),i}function _l(t,e,r){var n;if(e&&t.contains(e)){var a=t.createRange(),i=void 0;if(a.selectNode(e),r)a.collapse();else{var o=(n=t.defaultView)===null||n===void 0?void 0:n.getSelection(),s=o&&o.rangeCount>0&&o.getRangeAt(0);o&&s&&(i=o.focusNode!=s.endContainer||o.focusOffset!=s.endOffset)}ld(t,a,i)}}var mm=9e3,bm="contentDiv",ym=function(t,e,r,n,a){a===void 0&&(a=mm);var i=t.lifecycle.styleElements[e];if(!i&&r){var o=t.physicalRoot.ownerDocument;i=o.createElement("style"),o.head.appendChild(i),i.dataset.roosterjsStyleKey=e,t.lifecycle.styleElements[e]=i}var s=i?.sheet;if(s){for(var l=s.cssRules.length-1;l>=0;l--)s.deleteRule(l);if(r){var u=_r(Ti(t.physicalRoot,bm)),d=n?typeof n=="string"?[u+"::"+n]:Em(u,n,a-r.length-3):[u];d.forEach(function(f){s.insertRule(f+" {"+r+"}")})}}};function Em(t,e,r){var n=[],a=[],i=0;return e.forEach(function(o){i>=r&&(n.push(a.join(",")),a=[],i=0);var s=t+" "+o;i+=s.length+1,a.push(s)}),n.push(a.join(",")),n}var Cm=function(t,e){if(!e||t.physicalRoot.contains(e)){if(e||(e=t.physicalRoot),e!==t.logicalRoot){var r={eventType:"beforeLogicalRootChange",logicalRoot:t.logicalRoot};t.api.triggerEvent(t,r,!1),t.logicalRoot.contentEditable="false",e.contentEditable="true",t.logicalRoot=e,t.selection.selection=null,t.cache.cachedModel=void 0,t.cache.cachedSelection=void 0;var n={eventType:"logicalRootChanged",logicalRoot:e};t.api.triggerEvent(t,n,!1)}}else return null},Sm=function(t,e){var r=t;if(e!=!!r.lifecycle.shadowEditFragment)if(e){var n=r.cache.cachedModel?null:r.api.createContentModel(r),a=r.logicalRoot.ownerDocument.createDocumentFragment(),i=r.logicalRoot.cloneNode(!0);St(a,i),r.api.triggerEvent(r,{eventType:"enteredShadowEdit"},!1),!r.cache.cachedModel&&n&&(r.cache.cachedModel=n),da(r,!0),r.lifecycle.shadowEditFragment=a}else r.lifecycle.shadowEditFragment=null,da(r,!1),r.api.triggerEvent(r,{eventType:"leavingShadowEdit"},!1),r.cache.cachedModel&&(Qe(r.cache.cachedModel,function(){}),r.api.setContentModel(r,r.cache.cachedModel,{ignoreSelection:!0}))},Tm=["editorReady","beforeDispose","extractContentWithDom","zoomChanged"],wm=function(t,e,r){(!t.lifecycle.shadowEditFragment||Tm.indexOf(e.eventType)>=0)&&(r||!t.plugins.some(function(n){return km(e,n)}))&&t.plugins.forEach(function(n){n.onPluginEvent&&n.onPluginEvent(e)})};function km(t,e){var r;return e.onPluginEvent&&(!((r=e.willHandleEventExclusively)===null||r===void 0)&&r.call(e,t))?(e.onPluginEvent(t),!0):!1}var Ml={createContentModel:xg,createEditorContext:Gg,formatContentModel:Vg,setContentModel:am,setLogicalRoot:Cm,getDOMSelection:Xg,setDOMSelection:pm,focus:Kg,addUndoSnapshot:Ng,restoreUndoSnapshot:nm,attachDomEvent:zg,triggerEvent:wm,switchShadowEdit:Sm,getVisibleViewport:Zg,setEditorStyle:ym,announce:Bg},_m=(function(){function t(e,r,n,a){this.root=e,this.getDarkColor=r,this.knownColors=n,this.generateColorKey=a}return t.prototype.updateKnownColor=function(e,r,n){var a=this;r&&n?(this.knownColors[r]||(this.knownColors[r]=n),e&&this.root.style.setProperty(r,n.darkModeColor)):e&&Object.keys(this.knownColors).forEach(function(i){a.root.style.setProperty(i,a.knownColors[i].darkModeColor)})},t.prototype.reset=function(){var e=this;Object.keys(this.knownColors).forEach(function(r){e.root.style.removeProperty(r)})},t})();function Mm(t,e,r,n){return r===void 0&&(r={}),n===void 0&&(n=Oc),new _m(t,e,r,n)}var Dm=function(t){return function(e){return t.htmlToDOM(e).body.innerHTML}};function Om(t){return t&&sd(t)?t:Rm(t)}function sd(t){return typeof t.htmlToDOM=="function"}var Lm=function(t){return t};function Rm(t){var e=t||Lm;return{htmlToDOM:function(r){return new DOMParser().parseFromString(e(r),"text/html")},isBypassed:!t}}var Fm=(function(){function t(e,r){this.contentDiv=e,this.options=r}return t.prototype.queryElements=function(e){return Ze(this.contentDiv.querySelectorAll(e))},t.prototype.getTextContent=function(){return this.contentDiv.textContent||""},t.prototype.isNodeInEditor=function(e,r){return r&&e==this.contentDiv?!1:this.contentDiv.contains(e)},t.prototype.calculateZoomScale=function(){var e,r=((e=this.contentDiv.getBoundingClientRect())===null||e===void 0?void 0:e.width)||0,n=this.contentDiv.offsetWidth;return n>0&&r>0?Math.round(r/n*100)/100:1},t.prototype.setDomAttribute=function(e,r){r===null?this.contentDiv.removeAttribute(e):this.contentDiv.setAttribute(e,r)},t.prototype.getDomAttribute=function(e){return this.contentDiv.getAttribute(e)},t.prototype.getDomStyle=function(e){return this.contentDiv.style[e]},t.prototype.findClosestElementAncestor=function(e,r){var n=L(e,"ELEMENT_NODE")?e:e.parentElement,a=r?n?.closest(r):n;return a&&this.isNodeInEditor(a)&&a!=this.contentDiv?a:null},t.prototype.findClosestBlockElement=function(e){for(var r=e;r&&this.isNodeInEditor(r);){if(L(r,"ELEMENT_NODE")&&xt(r))return r;r=r.parentElement}return this.contentDiv},t.prototype.hasFocus=function(){var e=this.contentDiv.ownerDocument.activeElement;return!!(e&&this.contentDiv.contains(e))},t.prototype.isRightToLeft=function(){var e,r=this.contentDiv,n=(e=r.ownerDocument.defaultView)===null||e===void 0?void 0:e.getComputedStyle(r);return n?.direction=="rtl"},t.prototype.getClientWidth=function(){var e,r=this.contentDiv,n=(e=r.ownerDocument.defaultView)===null||e===void 0?void 0:e.getComputedStyle(r),a=Ke(n?.paddingLeft),i=Ke(n?.paddingRight);return this.contentDiv.clientWidth-(a+i)},t.prototype.getClonedRoot=function(){if(this.options.cloneIndependentRoot){var e=this.contentDiv.ownerDocument.implementation.createHTMLDocument(),r=e.importNode(this.contentDiv,!0);return r}else return this.contentDiv.cloneNode(!0)},t.prototype.getContainerFormat=function(e,r){var n,a,i=this.contentDiv.ownerDocument.defaultView,o=i?.getComputedStyle(this.contentDiv);return o?{fontSize:o.fontSize,fontFamily:o.fontFamily,fontWeight:o.fontWeight,textColor:Mr(this.contentDiv,!1,!!e,r,o.color),backgroundColor:Mr(this.contentDiv,!0,!!e,r,o.backgroundColor),italic:o.fontStyle=="italic",letterSpacing:o.letterSpacing,lineHeight:o.lineHeight,strikethrough:(n=o.textDecoration)===null||n===void 0?void 0:n.includes("line-through"),superOrSubScriptSequence:o.verticalAlign,underline:(a=o.textDecoration)===null||a===void 0?void 0:a.includes("underline")}:{}},t.prototype.getRangesByText=function(e,r,n){return Op(this.contentDiv,e,r,n)},t})();function ud(t,e){return e===void 0&&(e={}),new Fm(t,e)}var Pm=/\$\{(\w+)\}/;function dd(t,e,r){if(t=="OL"){var n=Ji(e,r??1),a=oo[e];return a?a.replace(Pm,n):void 0}else return lo[e]}function fd(t,e){var r=e=="OL"?oo[t]:lo[t];return r?.indexOf('"')>=0}var Am={metadataDefinition:Oa,applierFunction:function(t,e,r){var n,a=r.listFormat.nodeStack.length-2;if(a>=0){var i=(n=r.listFormat.nodeStack[a+1].listType)!==null&&n!==void 0?n:"OL",o=Qi(i,t??{},a);o!==void 0&&(fd(o,i)?e.listStyleType=dd(i,o,r.listFormat.threadItemCounts[a]):delete e.listStyleType)}}},Nm={metadataDefinition:Oa,applierFunction:function(t,e,r){var n,a=r.listFormat.nodeStack.length-2;if(a>=0){var i=(n=r.listFormat.nodeStack[a+1].listType)!==null&&n!==void 0?n:"OL",o=Qi(i,t??{},a);if(o!==void 0)if(fd(o,i))delete e.listStyleType;else{var s=r.listFormat.threadItemCounts[a]>0?r.listFormat.threadItemCounts[a]:1,l=dd(i,o,s);l&&(e.listStyleType=l)}}}};function Im(t){var e,r={},n=(e=t.defaultDomToModelOptions)!==null&&e!==void 0?e:{};return{builtIn:r,customized:n,calculated:Ou([r,n])}}function Bm(t){var e,r={metadataAppliers:{listItem:Am,listLevel:Nm}},n=(e=t.defaultModelToDomOptions)!==null&&e!==void 0?e:{};return{builtIn:r,customized:n,calculated:Mu([r,n])}}var Hm="paragraph",zm=(function(){function t(){this.nextId=0,this.paragraphMap={},t.prefixNum++}return t.prototype.assignMarkerToModel=function(e,r){var n=_p(e),a=r;n?(a._marker=n,this.paragraphMap[n]=r):(a._marker=this.generateId(),this.applyMarkerToDom(e,r))},t.prototype.applyMarkerToDom=function(e,r){var n=r;n._marker||(n._marker=this.generateId());var a=n._marker;a&&(Mp(e,a),this.paragraphMap[a]=r)},t.prototype.getParagraphFromMarker=function(e){var r=e._marker;return r&&this.paragraphMap[r]||null},t.prototype.clear=function(){this.paragraphMap={}},t.prototype._reset=function(){t.prefixNum=0,this.nextId=0},t.prototype._getMap=function(){return this.paragraphMap},t.prototype.generateId=function(){return Hm+"_"+t.prefixNum+"_"+this.nextId++},t.prefixNum=0,t})();function xm(){return new zm}var Um=(function(){function t(e,r){var n=this;this.contentDiv=e,this.onMutation=r,this.onMutationInternal=function(a){for(var i=!0,o=null,s=null,l=[],u=[],d=!1,f=new Set,h=new Set,v=0;v<a.length&&i;v++){var c=a[v],p=c.target;if(!f.has(p)){if(!h.has(p))if(Wi(p,n.domHelper)||uu(p,n.domHelper)){f.add(p);continue}else h.add(p);switch(c.type){case"attributes":n.domHelper.isNodeInEditor(p,!0)&&(c.attributeName=="id"&&L(p,"ELEMENT_NODE")?n.onMutation({type:"elementId",element:p}):i=!1);break;case"characterData":s&&s!=c.target?i=!1:(s=c.target,d=!0);break;case"childList":o?o!=c.target&&(i=!1):o=c.target,i&&(l=l.concat(Array.from(c.addedNodes)),u=u.concat(Array.from(c.removedNodes)));break}}}i?((l.length>0||u.length>0)&&n.onMutation({type:"childList",addedNodes:l,removedNodes:u}),d&&n.onMutation({type:"text"})):n.onMutation({type:"unknown"})},this.observer=new MutationObserver(this.onMutationInternal),this.domHelper=ud(e)}return t.prototype.startObserving=function(){this.observer.observe(this.contentDiv,{subtree:!0,childList:!0,attributes:!0,characterData:!0})},t.prototype.stopObserving=function(){this.observer.disconnect()},t.prototype.flushMutations=function(e){var r=this.observer.takeRecords();e||this.onMutationInternal(r)},t})();function Dl(t,e){return new Um(t,e)}function Wt(t){var e,r=(e=t.__roosterjsContentModel)!==null&&e!==void 0?e:{},n=r.paragraph,a=r.segments;return n&&n.blockType=="Paragraph"&&Array.isArray(n.segments)&&Array.isArray(a)&&a.every(function(i){return n.segments.includes(i)})}function Gm(t){var e,r=(e=t.__roosterjsContentModel)!==null&&e!==void 0?e:{},n=r.entity,a=r.parent;return n?.blockType=="Entity"&&n.wrapper&&a?.blockGroupType&&Array.isArray(a.blocks)}function $t(t){return t&&Wt(t)?t.__roosterjsContentModel:null}function Ol(t){var e=t.__roosterjsContentModel,r=e?.table;return r?.blockType=="Table"&&Array.isArray(r.rows)&&r.rows.every(function(n){return Array.isArray(n?.cells)&&n.cells.every(function(a){return a?.blockGroupType=="TableCell"})})?e:null}function Wn(t){delete t.__roosterjsContentModel}var Km=(function(){function t(e){this.keepSelectionMarkerWhenEnteringTextNode=e}return t.prototype.onSegment=function(e,r,n){var a=e;a.__roosterjsContentModel={paragraph:r,segments:n}},t.prototype.onParagraph=function(e){for(var r=null,n=e.firstChild;n;n=n.nextSibling)if(L(n,"TEXT_NODE"))if(!r)r=n;else{var a=$t(r);a&&Wt(n)&&(a.segments=a.segments.concat(n.__roosterjsContentModel.segments),n.__roosterjsContentModel.segments=[])}else L(n,"ELEMENT_NODE")?(r=null,this.onParagraph(n)):r=null},t.prototype.onTable=function(e,r){var n=e;n.__roosterjsContentModel={table:r}},t.prototype.onBlockEntity=function(e,r){this.onBlockEntityDelimiter(e.wrapper.previousSibling,e,r),this.onBlockEntityDelimiter(e.wrapper.nextSibling,e,r)},t.prototype.onMergeText=function(e,r){var n;Wt(e)&&Wt(r)?e.nextSibling==r&&((n=e.__roosterjsContentModel.segments).push.apply(n,P([],M(r.__roosterjsContentModel.segments),!1)),Wn(r)):(Wn(r),Wn(e))},t.prototype.clearIndex=function(e){vd(e)},t.prototype.reconcileSelection=function(e,r,n){var a,i,o;if(n){var s=void 0;n.type=="range"&&this.isCollapsed(n)&&(s=n.start.node)&&L(s,"TEXT_NODE")&&Wt(s)&&s.__roosterjsContentModel.segments.length>0?this.reconcileTextSelection(s):(o=this.selectionMarkerToKeepWhenEnteringTextNode(n,r),Et(e))}switch(r.type){case"image":var l=$t(r.image),u=l?.segments[0];return u?(u.isSelected=!0,Et(e,u),!0):!1;case"table":var d=Ol(r.table);if(d){var f=(a=d.table.rows[r.firstRow])===null||a===void 0?void 0:a.cells[r.firstColumn],h=(i=d.table.rows[r.lastRow])===null||i===void 0?void 0:i.cells[r.lastColumn];if(f&&h)return Et(e,f,h),!0}return!1;case"range":var v=r.range;if(v){var c=v.startContainer,p=v.startOffset,g=v.endContainer,b=v.endOffset,y=v.collapsed;if(delete e.hasRevertedRangeSelection,y)return!!this.reconcileNodeSelection(c,p,e.format);if(c==g&&L(c,"TEXT_NODE"))return r.isReverted&&(e.hasRevertedRangeSelection=!0),Wt(c)&&!!this.reconcileTextSelection(c,p,b,o);var E=this.reconcileNodeSelection(c,p),S=this.reconcileNodeSelection(g,b);return E&&S?(r.isReverted&&(e.hasRevertedRangeSelection=!0),Et(e,E,S),!0):!1}break}return!1},t.prototype.reconcileChildList=function(e,r){var n=!0,a={segIndex:-1},i=e[0];e.length==1&&L(i,"TEXT_NODE")?n=this.reconcileAddedNode(i,a):e.length>0&&(n=!1);var o=r[0];return n&&r.length==1?n=this.reconcileRemovedNode(o,a):r.length>0&&(n=!1),n&&!a.pendingTextNode},t.prototype.reconcileElementId=function(e){var r;if(ae(e,"img")){var n=$t(e);return((r=n?.segments[0])===null||r===void 0?void 0:r.segmentType)=="Image"?(n.segments[0].format.id=e.id,!0):!1}else if(ae(e,"table")){var a=Ol(e);return a?(a.table.format.id=e.id,!0):!1}else return!1},t.prototype.onBlockEntityDelimiter=function(e,r,n){if(L(e,"ELEMENT_NODE")&&Rt(e)&&e.firstChild){var a=e.firstChild;a.__roosterjsContentModel={entity:r,parent:n}}},t.prototype.isCollapsed=function(e){var r=e.start,n=e.end;return r.node==n.node&&r.offset==n.offset},t.prototype.reconcileNodeSelection=function(e,r,n){return L(e,"TEXT_NODE")?Wt(e)?this.reconcileTextSelection(e,r):Gm(e)?this.reconcileDelimiterSelection(e,n):void 0:r>=e.childNodes.length?this.insertMarker(e.lastChild,!0):this.insertMarker(e.childNodes[r],!1)},t.prototype.insertMarker=function(e,r){var n,a=e&&$t(e);if(a){var i=a.paragraph,o=a.segments,s=i.segments.indexOf(o[0]);if(s>=0){var l=!r&&i.segments[s-1]||i.segments[s];n=He(l.format),i.segments.splice(r?s+1:s,0,n)}}return n},t.prototype.reconcileTextSelection=function(e,r,n,a){var i,o,s,l,u,d,f,h=e.__roosterjsContentModel,v=h.paragraph,c=h.segments,p=c[0],g=c[c.length-1],b;if(p?.segmentType=="Text"&&g?.segmentType=="Text"){var y=[],E=e.nodeValue||"",S=[];if(r===void 0)p.text=E,y.push(p),S.push(p);else{if(r>0&&(p.text=E.substring(0,r),y.push(p),S.push(p)),n===void 0){var T=He((o=a?.format)!==null&&o!==void 0?o:p.format);y.push(T),r<((s=e.nodeValue)!==null&&s!==void 0?s:"").length&&(p.link&&Bi(T,p.link),p.code&&Hi(T,p.code)),b=T,n=r}else if(n>r){var k=xe(E.substring(r,n),(l=a?.format)!==null&&l!==void 0?l:p.format,p.link,p.code);k.isSelected=!0,y.push(k),S.push(k),b=k}if(n<E.length){var R=xe(E.substring(n),(u=a?.format)!==null&&u!==void 0?u:p.format,p.link,p.code);y.push(R),S.push(R)}}var H=v.segments.indexOf(p),U=v.segments.indexOf(g);if(H>=0&&U>=0){for(;H>0&&v.segments[H-1].segmentType=="SelectionMarker";)H--;for(;U<v.segments.length-1&&v.segments[U+1].segmentType=="SelectionMarker";)U++;(i=v.segments).splice.apply(i,P([H,U-H+1],M(y),!1))}this.onSegment(e,v,S)}else if(p?.segmentType=="Entity"&&p==g){var q=p.wrapper,W=v.segments.indexOf(p),J=e.parentElement,x=q.previousSibling==J,G=q.nextSibling==J;if(W>=0&&J&&Rt(J)&&(x||G)){var T=He((d=a?.format)!==null&&d!==void 0?d:((f=v.segments[G?W+1:W-1])!==null&&f!==void 0?f:p).format);v.segments.splice(G?W+1:W,0,T),b=T}}return b},t.prototype.reconcileDelimiterSelection=function(e,r){var n,a=e.__roosterjsContentModel,i=a.entity,o=a.parent,s=o.blocks.indexOf(i),l=e.parentElement,u=i.wrapper,d=u.previousSibling==l,f=u.nextSibling==l;if(s>=0&&l&&Rt(l)&&(d||f)){n=He(r);var h=Ge(!0,void 0,r);h.segments.push(n),o.blocks.splice(d?s:s+1,0,h)}return n},t.prototype.reconcileAddedNode=function(e,r){var n=null,a=-1,i,o=e.previousSibling,s=e.nextSibling;if((n=$t(Wm(o)))&&(i=n.segments[n.segments.length-1])&&(a=n.paragraph.segments.indexOf(i))>=0)this.indexNode(n.paragraph,a+1,e,i.format);else if((n=$t(Vm(s)))&&(i=n.segments[0])&&(a=n.paragraph.segments.indexOf(i))>=0)this.indexNode(n.paragraph,a,e,i.format);else if(r.paragraph&&r.segIndex>=0)this.indexNode(r.paragraph,r.segIndex,e,r.format);else if(r.pendingTextNode===void 0)r.pendingTextNode=e;else return!1;return!0},t.prototype.reconcileRemovedNode=function(e,r){var n=null,a;if(r.segIndex<0&&!r.paragraph&&(n=$t(e))&&(a=n.segments[0])){if(r.format=a.format,r.paragraph=n.paragraph,r.segIndex=n.paragraph.segments.indexOf(n.segments[0]),r.segIndex<0)return!1;for(var i=0;i<n.segments.length;i++){var o=n.paragraph.segments.indexOf(n.segments[i]);o>=0&&n.paragraph.segments.splice(o,1)}return r.pendingTextNode&&(this.indexNode(r.paragraph,r.segIndex,r.pendingTextNode,n.segments[0].format),r.pendingTextNode=null),!0}else return!1},t.prototype.indexNode=function(e,r,n,a){var i,o=a?C({},a):void 0;o&&ie(o).forEach(function(l){no[l]===void 0&&delete o[l]});var s=xe((i=n.textContent)!==null&&i!==void 0?i:"",o);e.segments.splice(r,0,s),this.onSegment(n,e,[s])},t.prototype.selectionMarkerToKeepWhenEnteringTextNode=function(e,r){if(this.keepSelectionMarkerWhenEnteringTextNode&&e.type=="range"&&this.isCollapsed(e)&&r.type=="range"&&L(r.range.commonAncestorContainer,"TEXT_NODE")&&r.range.commonAncestorContainer.parentElement==e.start.node&&Wt(r.range.commonAncestorContainer)&&r.range.commonAncestorContainer.__roosterjsContentModel.paragraph.segments[0].segmentType=="SelectionMarker")return r.range.commonAncestorContainer.__roosterjsContentModel.paragraph.segments[0]},t})();function Wm(t){for(;t?.lastChild;)t=t.lastChild;return t}function Vm(t){for(;t?.firstChild;)t=t.firstChild;return t}function vd(t){Wn(t);for(var e=t.firstChild;e;e=e.nextSibling)vd(e)}var jm=(function(){function t(e,r){var n=this;this.editor=null,this.onMutation=function(a){if(n.editor)switch(a.type){case"childList":n.state.domIndexer.reconcileChildList(a.addedNodes,a.removedNodes)||n.invalidateCache();break;case"text":n.updateCachedModel(n.editor,!0);break;case"elementId":var i=a.element;n.state.domIndexer.reconcileElementId(i)||n.invalidateCache();break;case"unknown":n.invalidateCache();break}},this.onNativeSelectionChange=function(){var a;!((a=n.editor)===null||a===void 0)&&a.hasFocus()&&n.updateCachedModel(n.editor)},this.state={domIndexer:new Km(e.experimentalFeatures&&e.experimentalFeatures.indexOf("KeepSelectionMarkerWhenEnteringTextNode")>=0),textMutationObserver:Dl(r,this.onMutation)},e.enableParagraphMap&&(this.state.paragraphMap=xm())}return t.prototype.getName=function(){return"Cache"},t.prototype.initialize=function(e){this.editor=e,this.editor.getDocument().addEventListener("selectionchange",this.onNativeSelectionChange),this.state.textMutationObserver.startObserving()},t.prototype.dispose=function(){this.state.textMutationObserver.stopObserving(),this.editor&&(this.editor.getDocument().removeEventListener("selectionchange",this.onNativeSelectionChange),this.editor=null)},t.prototype.getState=function(){return this.state},t.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"logicalRootChanged":this.invalidateCache(),this.state.textMutationObserver.stopObserving(),this.state.textMutationObserver=Dl(e.logicalRoot,this.onMutation),this.state.textMutationObserver.startObserving();break;case"selectionChanged":this.updateCachedModel(this.editor);break;case"contentChanged":var r=e.contentModel,n=e.selection;r?ua(this.state,r,n):this.invalidateCache();break}},t.prototype.invalidateCache=function(){var e,r;!((e=this.editor)===null||e===void 0)&&e.isInShadowEdit()||(this.state.cachedModel=void 0,this.state.cachedSelection=void 0,(r=this.state.paragraphMap)===null||r===void 0||r.clear())},t.prototype.updateCachedModel=function(e,r){if(!e.isInShadowEdit()){var n=this.state.cachedSelection;this.state.cachedSelection=void 0;var a=e.getDOMSelection()||void 0,i=this.state.cachedModel,o=r||!n||!a||!ad(a,n);o?!i||!a||!this.state.domIndexer.reconcileSelection(i,a,n)?this.invalidateCache():ua(this.state,i,a):this.state.cachedSelection=n}},t})();function qm(t,e){return new jm(t,e)}var Xm=2,Ym=(function(){function t(e){var r=this,n;this.editor=null,this.disposer=null,this.onContextMenuEvent=function(a){var i;if(r.editor){var o=[],s=a,l=a,u=s.button==Xm?s.target:l?.pointerType==="touch"||l?.pointerType==="pen"?l.target:r.getFocusedNode(r.editor);u&&r.state.contextMenuProviders.forEach(function(d){var f,h=(f=d.getContextMenuItems(u,s))!==null&&f!==void 0?f:[];h?.length>0&&(o.length>0&&o.push(null),o.push.apply(o,P([],M(h),!1)))}),(i=r.editor)===null||i===void 0||i.triggerEvent("contextMenu",{rawEvent:s,items:o})}},this.state={contextMenuProviders:((n=e.plugins)===null||n===void 0?void 0:n.filter(Zm))||[]}}return t.prototype.getName=function(){return"ContextMenu"},t.prototype.initialize=function(e){var r=this;this.editor=e;var n={contextmenu:{beforeDispatch:function(a){return r.onContextMenuEvent(a)}}};this.disposer=this.editor.attachDomEvent(n)},t.prototype.dispose=function(){var e;(e=this.disposer)===null||e===void 0||e.call(this),this.disposer=null,this.editor=null},t.prototype.getState=function(){return this.state},t.prototype.getFocusedNode=function(e){var r=e.getDOMSelection();return r?(r.type=="range"&&r.range.collapse(!0),xi(r)||null):null},t})();function Zm(t){var e;return!!(!((e=t)===null||e===void 0)&&e.getContextMenuItems)}function Jm(t){return new Ym(t)}function cd(t){return t&&t.blockType=="Paragraph"?t.segments.every(function(e){return e.segmentType!=="SelectionMarker"&&e.segmentType=="Br"}):t&&t.blockType=="BlockGroup"?t.blocks.every(cd):!!t}var Qm=function(t){var e=t.insertPoint,r=t.deleteResult;if(r=="range"&&e?.path){var n=Je(e.path,["ListItem"],["TableCell"]),a=e.path[n];if(n>=0&&a&&a.blockGroupType=="ListItem"){var i=e.path[n+1].blocks.indexOf(a),o=i>-1?e.path[n+1].blocks[i-1]:void 0,s=i>-1?e.path[n+1].blocks[i+1]:void 0;ia(a)&&(!o||wa(o))&&s&&cd(s)&&(w(a).levels=[])}}};function $m(t,e){if(t.getEnvironment().isSafari&&e?.type=="image"){var r=new Range;r.setStartBefore(e.image),r.setEndAfter(e.image),t.setDOMSelection({range:r,type:"range",isReverted:!1})}}function e0(t){var e,r,n;Qe(t,function(a,i,o,s){if(e)return i!=n&&r?.segments.includes(e)&&r.segments.splice(r.segments.indexOf(e),1),!0;var l=s?.find(function(u){return u.segmentType=="SelectionMarker"});return!e&&l&&(n=i,r=o?.blockType=="Paragraph"?o:void 0,e=l),!1})}var wi="_EBlock",hd="100%",pd="inline-block",t0=function(t,e){var r=t;r&&r.wrapper&&r.blockType=="Entity"&&L(e,"ELEMENT_NODE")&&ae(e,"div")&&!xt(r.wrapper)&&r.wrapper.style.display==pd&&r.wrapper.style.width==hd&&(e.classList.add(wi),e.style.display="block",e.style.width="")},r0=function(t,e){e.classList.contains(wi)&&(e.classList.remove(wi),e.style.display=pd,e.style.width=hd)};function n0(t){var e=mt(t);t.rows=t.rows.map(function(r){return C(C({},r),{cells:r.cells.filter(function(n){return n.isSelected})})}).filter(function(r){return r.cells.length>0}),delete t.format.width,t.widths=e?t.widths.filter(function(r,n){return n>=e?.firstColumn&&n<=e?.lastColumn}):[]}function gd(t){ki(t,!1),a0(t)}function ki(t,e){for(var r,n,a,i=t.blocks.length-1;i>=0;i--){var o=t.blocks[i];switch(o.blockType){case"BlockGroup":ki(o,e),(o.blockGroupType=="General"?o.blocks.length==0&&!o.isSelected:o.blocks.length==0)&&t.blocks.splice(i,1);break;case"Divider":case"Entity":o.isSelected?e=!0:t.blocks.splice(i,1);break;case"Paragraph":var s=[];try{for(var l=(r=void 0,At(o.segments)),u=l.next();!u.done;u=l.next()){var d=u.value;d.segmentType=="General"?(gd(d),(d.blocks.length>0||d.isSelected)&&s.push(d)):d.isSelected&&d.segmentType!="SelectionMarker"&&s.push(d)}}catch(y){r={error:y}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}o.segments=s,o.segments.length==0?t.blocks.splice(i,1):e=!0;break;case"Table":for(var f=[],h=0;h<o.rows.length;h++){for(var v=o.rows[h],c=0;c<v.cells.length;c++){var p=v.cells[c];p.isSelected?e=!0:ki(p,e)}for(var g=[],b=0;b<v.cells.length;b++){var p=v.cells[b];(p.isSelected||p.blocks.length>0)&&g.push(p)}v.cells=g,v.cells.length>0&&f.push(v)}if(!e&&f.length==1&&f[0].cells.length==1&&!f[0].cells[0].isSelected){var p=f[0].cells[0];(a=t.blocks).splice.apply(a,P([i,1],M(p.blocks),!1))}else f.length==0?t.blocks.splice(i,1):o.rows=f;break}}return e}function a0(t){var e=t.blocks[0];if(t.blocks.length==1){for(;e.blockType=="BlockGroup";)if(t.blocks=e.blocks,e=t.blocks[0],t.blocks.length>1)return;e.blockType=="Paragraph"&&(e.isImplicit=!0,e.format={},i0(e))}}function i0(t){var e=t.segmentFormat;if(e!==void 0)for(var r=0;r<t.segments.length;r++){var n=t.segments[r];n.format=C(C({},t.segmentFormat),n.format)}}var o0=function(t,e){L(e,"ELEMENT_NODE")&&ae(e,"table")&&sn(e.ownerDocument,e,"div"),L(e,"ELEMENT_NODE")&&!e.isContentEditable&&e.removeAttribute("contenteditable"),t0(t,e)};function l0(t,e,r){var n=t.getDOMSelection();if($m(t,n),n&&(n.type!="range"||!n.range.collapsed)){var a=t.getContentModelCopy("disconnected");gd(a),n.type==="table"?Qe(a,function(f,h){return h?.table?(n0(h.table),!0):!1}):n.type==="range"&&e0(a);var i=Sa();i.onNodeCreated=o0;var o=t.getDocument(),s=o.createElement("div"),l=Ii(o,s,a,i),u=l?s0(o,l):null;if(u){var d=t.triggerEvent("beforeCutCopy",{clonedRoot:s,range:u,rawEvent:r,isCut:e}).clonedRoot;return{htmlContent:d,textContent:sv(a)}}}return null}function s0(t,e){var r,n=null;if(e.type==="table"){var a=e.table,i=((r=a.parentElement)===null||r===void 0?void 0:r.childElementCount)==1?a.parentElement:a;n=t.createRange(),n.selectNode(i)}else e.type==="image"?(n=t.createRange(),n.selectNode(e.image)):n=e.range;return n}var u0="<!--",d0="<!--",f0="-->",Rn="<style",v0="</style>",c0=/\W/;function h0(t){for(var e,r=Ll(t),n=r.styleIndex,a=r.styleEndIndex;n>-1;)t=Xa(t,u0,a,n),t=Xa(t,d0,a,n),t=Xa(t,f0,a,n),e=Ll(t,a+1),n=e.styleIndex,a=e.styleEndIndex;return t}function Ll(t,e){e===void 0&&(e=0);for(var r=t.toLowerCase(),n=r.indexOf(Rn,e),a=n+Rn.length,i=t.substring(a,a+1);!c0.test(i)&&n>-1;)n=r.indexOf(Rn,n+1),a=n+Rn.length,i=t.substring(a,a+1);var o=r.indexOf(v0,e);return{styleIndex:n,styleEndIndex:o}}function Xa(t,e,r,n){for(var a=t.indexOf(e,n);a>-1&&a<r;)t=t.substring(0,a)+t.substring(a+e.length),a=t.indexOf(e,a+1);return t}var p0=function(t,e){(e.tagName=="DIV"||e.tagName=="P")&&(delete t.width,delete t.height)},md=["a","abbr","address","area","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","fieldset","figcaption","figure","font","footer","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","menu","menuitem","meter","nav","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","small","span","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","tt","u","ul","var","wbr","xmp"],bd=["applet","audio","base","basefont","embed","frame","frameset","iframe","link","meta","noscript","object","param","script","slot","source","style","template","title","track","video"],g0=/^\s*var\(\s*[a-zA-Z0-9-_]+\s*(,\s*(.*))?\)\s*$/,m0="var(",b0=["accept","align","alt","checked","cite","class","color","cols","colspan","contextmenu","coords","datetime","default","dir","dirname","disabled","download","face","headers","height","hidden","high","href","hreflang","ismap","kind","label","lang","list","low","max","maxlength","media","min","multiple","open","optimum","pattern","placeholder","readonly","rel","required","reversed","rows","rowspan","scope","selected","shape","size","sizes","span","spellcheck","src","srclang","srcset","start","step","style","tabindex","target","title","translate","type","usemap","valign","value","width","wrap","bgColor"],y0={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none","font-style":"normal","font-variant-ligatures":"normal","font-variant-caps":"normal","font-weight":"400","letter-spacing":"normal",orphans:"2","text-align":"start","text-indent":"0px","text-transform":"none",widows:"2","word-spacing":"0px","white-space":"normal"};function yd(t,e,r,n,a){var i=t.tagName.toLowerCase(),o=r.indexOf(i)>=0?null:Ed(t.ownerDocument,e.indexOf(i)>=0?i:"span",t.attributes,n,a);if(o)for(var s=t.firstChild;s;s=s.nextSibling){var l=L(s,"ELEMENT_NODE")?yd(s,e,r,n,a):L(s,"TEXT_NODE")?s.cloneNode():null;l&&o?.appendChild(l)}return o}function Ed(t,e,r,n,a){for(var i=t.createElement(e),o=0;o<r.length;o++){var s=r[o],l=s.name.toLowerCase().trim(),u=s.value,d=a?.[l],f=l=="style"?E0(e,u,n):typeof d=="function"?d(u,e):typeof d=="boolean"?d?u:null:b0.indexOf(l)>=0||l.indexOf("data-")==0?u:null;f!=null&&!f.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)&&i.setAttribute(l,f)}return i}function E0(t,e,r){var n=e.split(";"),a=[];return n.forEach(function(i){var o=i.indexOf(":"),s=i.slice(0,o).trim(),l=i.slice(o+1).trim();if(s&&l){S0(l)&&(l=C0(l));var u=r?.[s],d=typeof u=="function"?u(l,t):u===!1?null:l;d&&d!="inherit"&&d!="initial"&&d.indexOf("expression")<0&&!s.startsWith("-")&&y0[s]!=d&&a.push(s+":"+d)}}),a.join(";")}function C0(t){var e=g0.exec(t);return e?.[2]||""}function S0(t){return t.indexOf(m0)==0}var T0={position:!1};function w0(t){var e=md.concat(t.additionalAllowedTags),r=bd.concat(t.additionalDisallowedTags),n=Object.assign({},T0,t.styleSanitizers),a=t.attributeSanitizers;return function(i,o,s){var l=yd(o,e,r,n,a);l&&s.defaultElementProcessors.entity(i,l,s)}}var k0=function(t){return t=="flex"?null:t},_0={position:!1,display:k0};function M0(t){var e=md.concat(t.additionalAllowedTags),r=bd.concat(t.additionalDisallowedTags),n=Object.assign({},_0,t.styleSanitizers),a=t.attributeSanitizers;return function(i,o,s){var l=o.tagName.toLowerCase(),u=e.indexOf(l)>=0?function(d,f,h){var v,c,p=Ed(f.ownerDocument,f.tagName,f.attributes,n,a);St(p,f),(c=(v=h.defaultElementProcessors)["*"])===null||c===void 0||c.call(v,d,p,h)}:r.indexOf(l)>=0?void 0:s.defaultElementProcessors.span;u?.(i,o,s)}}var D0=function(t,e){var r=e.style.display;r&&r!="flex"&&(t.display=r)},O0=function(t,e,r){var n,a,i=r.blockFormat.whiteSpace;an(i)&&(e.nodeValue=(a=(n=e.nodeValue)===null||n===void 0?void 0:n.replace(/\u0020\u0020/g,"  "))!==null&&a!==void 0?a:""),r.defaultElementProcessors["#text"](t,e,r)},L0="pre",R0=function(t,e,r,n){var a,i;e.style.whiteSpace!=L0&&((i=(a=r.defaultFormatParsers).whiteSpace)===null||i===void 0||i.call(a,t,e,r,n))},F0={processorOverride:{},formatParserOverride:{},additionalFormatParsers:{},additionalAllowedTags:[],additionalDisallowedTags:[],styleSanitizers:{},attributeSanitizers:{},processNonVisibleElements:!1};function P0(t,e,r,n){var a=C(C({},F0),n);return cn(C(C({defaultFormat:e},rd(t)),{experimentalFeatures:[]}),r,{processorOverride:{"#text":O0,entity:w0(a),"*":M0(a)},formatParserOverride:{display:D0,whiteSpace:R0},additionalFormatParsers:{container:[p0],entity:[r0]}},a)}var A0="rgb(0,0,0)",N0={includeCachedElement:function(t,e){return e=="cache"?void 0:t}};function Cd(t){return en(t,N0)}function I0(t,e,r){var n=e.fragment,a=e.domToModelOption,i=e.customizedMerge,o=e.pasteType,s=e.clipboardData,l=e.containsBlockElements;t.formatContentModel(function(u,d){if(!r&&s.modelBeforePaste){var f=Cd(s.modelBeforePaste);u.blocks=f.blocks}var h=P0(t.getDocument(),void 0,t.getEnvironment().domToModelSettings.customized,a);h.segmentFormat=B0(u,o);var v=on(n,h),c={mergeFormat:o=="mergeFormat"?"keepSourceEmphasisFormat":"none",mergeTable:H0(v),addParagraphAfterMergedContent:l},p=i?i(u,v):ao(u,v,d,c);return p&&(d.newPendingFormat=C(C(C({},no),u.format),o=="normal"&&!l?z0(v):p.marker.format)),!0},{changeSource:Ue.Paste,getChangeData:function(){return s},scrollCaretIntoView:!0,apiName:"paste"})}function B0(t,e){var r=Lp(t,!0)[0];if(r){var n=Ju(r);return e=="normal"&&(n.textColor=A0),n}return{}}function H0(t){return t.blocks.length==2&&t.blocks[0].blockType==="Table"&&t.blocks[1].blockType==="Paragraph"&&t.blocks[1].segments.length===1&&t.blocks[1].segments[0].segmentType==="Br"&&t.blocks.splice(1),t.blocks.length===1&&t.blocks[0].blockType==="Table"}function z0(t){if(t.blocks.length==1){var e=M(t.blocks,1),r=e[0];if(r.blockType=="Paragraph"){var n=r.segments[r.segments.length-1];return C({},n.format)}}return{}}function x0(t){var e=/(?![^(]*\)),/;return t.split(e).map(function(r){return r.trim()})}function U0(t){var e=Ze(t.querySelectorAll("style")),r=[];return e.forEach(function(n){var a,i=n.sheet;if(i)for(var o=0;o<i.cssRules.length;o++){var s=i.cssRules[o];s.type==CSSRule.STYLE_RULE&&s.selectorText&&r.push({selectors:x0(s.selectorText),text:s.style.cssText})}(a=n.parentNode)===null||a===void 0||a.removeChild(n)}),r}function G0(t,e){for(var r=function(a){var i,o,s=e[a],l=s.selectors,u=s.text;try{for(var d=(i=void 0,At(l)),f=d.next();!f.done;f=d.next()){var h=f.value;if(!(!h||!h.trim())){var v=Ze(t.querySelectorAll(h));v.forEach(function(c){return c.setAttribute("style",u+(c.getAttribute("style")||""))})}}}catch(c){i={error:c}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}},n=e.length-1;n>=0;n--)r(n)}var Ya=" ",K0=" ",Rl=6;function W0(t,e,r,n){!e.text&&r==="asPlainText"&&n&&(e.text=n.textContent||e.text);var a=e.imageDataUri,i=e.text,o=t.createDocumentFragment();if(r=="asImage"&&a||r!="asPlainText"&&!i&&a){var s=t.createElement("img");s.style.maxWidth="100%",s.src=a,o.appendChild(s)}else r!="asPlainText"&&n?St(o,n):i&&i.split(`
`).forEach(function(l,u,d){l=l.replace(/^ /g,Ya).replace(/ $/g,Ya).replace(/\r/g,"").replace(/ {2}/g," "+Ya),l.includes("	")&&(l=V0(l));var f=t.createTextNode(l);d.length==2&&u==0?(o.appendChild(f),o.appendChild(t.createElement("br"))):u>0&&u<d.length-1?o.appendChild(sn(t,l==""?t.createElement("br"):f,"div")):o.appendChild(f)});return o}function V0(t,e){e===void 0&&(e=0);for(var r=t,n;(n=r.indexOf("	"))!=-1;){var a=r.slice(0,n),i=r.slice(n+1),o=Rl-(a.length+e)%Rl,s=Array(o).fill(K0).join("");r=a+s+i}return r}function j0(t,e,r,n,a){var i,o,s={additionalAllowedTags:[],additionalDisallowedTags:[],additionalFormatParsers:{},formatParserOverride:{},processorOverride:{},styleSanitizers:{},attributeSanitizers:{},processNonVisibleElements:!!t.getEnvironment().domToModelSettings.customized.processNonVisibleElements},l={eventType:"beforePaste",clipboardData:e,fragment:r,htmlBefore:(i=n.htmlBefore)!==null&&i!==void 0?i:"",htmlAfter:(o=n.htmlAfter)!==null&&o!==void 0?o:"",htmlAttributes:n.metadata,pasteType:a,domToModelOption:s,containsBlockElements:!!n.containsBlockElements};return t.triggerEvent("beforePaste",l,!0)}var Za="<!--StartFragment-->",Fl="<!--EndFragment-->";function q0(t,e){var r={metadata:{},globalCssRules:[]};return t&&(r=C(C({},Z0(e)),{globalCssRules:U0(t),metadata:Y0(t),containsBlockElements:J0(t)}),e.htmlFirstLevelChildTags=X0(t)),r}function X0(t){for(var e,r=[],n=t.body.firstChild;n;n=n.nextSibling)if(L(n,"TEXT_NODE")){var a=(e=n.nodeValue)===null||e===void 0?void 0:e.replace(/(\r\n|\r|\n)/gm,"").trim();a&&r.push("")}else L(n,"ELEMENT_NODE")&&r.push(n.tagName);return r}function Y0(t){var e,r={},n=(e=t.querySelector("html"))===null||e===void 0?void 0:e.attributes;return(n?Ze(n):[]).forEach(function(a){r[a.name]=a.value}),Ze(t.querySelectorAll("meta")).forEach(function(a){r[a.name]=a.content}),r}function Z0(t){var e,r=(e=t.rawHtml)!==null&&e!==void 0?e:"",n=r.indexOf(Za),a=r.lastIndexOf(Fl),i="",o="";return n>=0&&a>=n+Za.length?(i=r.substring(0,n),o=r.substring(a+Fl.length),t.html=r.substring(n+Za.length,a)):t.html=r,{htmlBefore:i,htmlAfter:o}}function J0(t){var e=Ze(t.body.querySelectorAll("*"));return e.some(function(r){return L(r,"ELEMENT_NODE")&&xt(r)})}function Q0(t,e,r){var n;r===void 0&&(r="normal"),t.focus();var a=!1;e.modelBeforePaste||(a=!0,t.formatContentModel(function(f){return e.modelBeforePaste=Cd(f),!1}));var i=t.getDOMCreator();!i.isBypassed&&e.rawHtml&&(e.rawHtml=h0(e.rawHtml));var o=Pl(e.rawHtml,i),s=typeof r=="function"?r(o,e):r,l=q0(o,e),u=W0(t.getDocument(),e,s,(n=e.rawHtml==e.html?o:Pl(e.html,i))===null||n===void 0?void 0:n.body),d=j0(t,e,u,l,s);G0(d.fragment,l.globalCssRules),I0(t,d,a)}function Pl(t,e){return t?e.htmlToDOM(t):null}var $0=(function(){function t(e){var r=this;this.editor=null,this.disposer=null,this.onPaste=function(n){if(r.editor&&Al(n)){var a=r.editor,i=n.clipboardData;eb(i,a)&&(n.preventDefault(),Sp(Ze(i.items),r.state.allowedCustomPasteType).then(function(o){a.isDisposed()||Q0(a,o,r.state.defaultPasteType)}))}},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[],tempDiv:null,defaultPasteType:e.defaultPasteType}}return t.prototype.getName=function(){return"CopyPaste"},t.prototype.initialize=function(e){var r=this;this.editor=e,this.disposer=this.editor.attachDomEvent({paste:{beforeDispatch:function(n){return r.onPaste(n)}},copy:{beforeDispatch:function(n){return r.onCutCopy(n,!1)}},cut:{beforeDispatch:function(n){return r.onCutCopy(n,!0)}}})},t.prototype.dispose=function(){var e;this.state.tempDiv&&((e=this.state.tempDiv.parentNode)===null||e===void 0||e.removeChild(this.state.tempDiv),this.state.tempDiv=null),this.disposer&&this.disposer(),this.disposer=null,this.editor=null},t.prototype.getState=function(){return this.state},t.prototype.onCutCopy=function(e,r){var n,a;if(!(!this.editor||!Al(e))){var i=l0(this.editor,r,e);if(i){var o=i.htmlContent,s=i.textContent;e.preventDefault(),(n=e.clipboardData)===null||n===void 0||n.setData("text/html",o.innerHTML),(a=e.clipboardData)===null||a===void 0||a.setData("text/plain",s),r&&this.editor.formatContentModel(function(l,u){return Ar(l,[Qm],u).deleteResult=="range"&&ht(l),!0},{apiName:"cut",changeSource:Ue.Cut})}}},t})();function Al(t){return!!t.clipboardData}function eb(t,e){return t?.items?e.getEnvironment().isAndroid?Ze(t.items).some(function(r){var n=r.type,a=r.kind==="file"&&n!=="",i=n.indexOf("text/")===0;return a||i}):!0:!1}function tb(t){return new $0(t)}var rb={keydown:"keyDown",keyup:"keyUp",keypress:"keyPress"},nb=(function(){function t(e,r){var n=this;this.editor=null,this.disposer=null,this.pointerEvent=null,this.timer=0,this.onDragStart=function(a){var i=a,o=i.target,s=L(o,"ELEMENT_NODE")?o:o.parentElement;s&&!s.isContentEditable&&i.preventDefault()},this.onDrop=function(){var a,i,o=(a=n.editor)===null||a===void 0?void 0:a.getDocument();(i=o?.defaultView)===null||i===void 0||i.requestAnimationFrame(function(){n.editor&&(n.editor.takeSnapshot(),n.editor.triggerEvent("contentChanged",{source:Ue.Drop}))})},this.onScroll=function(a){var i;(i=n.editor)===null||i===void 0||i.triggerEvent("scroll",{rawEvent:a,scrollContainer:n.state.scrollContainer})},this.keyboardEventHandler={beforeDispatch:function(a){var i,o,s,l=rb[a.type];(Ta(a)||$i(a))&&a.stopPropagation();var u=(s=(o=(i=n.editor)===null||i===void 0?void 0:i.getEnvironment())===null||o===void 0?void 0:o.isAndroid)!==null&&s!==void 0?s:!1,d=!u&&(a.isComposing||n.state.isInIME);n.editor&&l&&!d&&n.editor.triggerEvent(l,{rawEvent:a})}},this.inputEventHandler={beforeDispatch:function(a){var i,o,s;a.stopPropagation();var l=(s=(o=(i=n.editor)===null||i===void 0?void 0:i.getEnvironment())===null||o===void 0?void 0:o.isAndroid)!==null&&s!==void 0?s:!1,u=!l&&(a.isComposing||n.state.isInIME);n.editor&&!u&&n.editor.triggerEvent("input",{rawEvent:a})}},this.onMouseDown=function(a){n.editor&&(n.state.mouseUpEventListerAdded||(n.editor.getDocument().addEventListener("mouseup",n.onMouseUp,!0),n.state.mouseUpEventListerAdded=!0,n.state.mouseDownX=a.pageX,n.state.mouseDownY=a.pageY),n.editor.triggerEvent("mouseDown",{rawEvent:a}),a.defaultPrevented&&(n.pointerEvent=null),n.pointerEvent&&n.editor.triggerEvent("pointerDown",{rawEvent:n.pointerEvent,originalEvent:a}))},this.onMouseUp=function(a){n.editor&&(n.removeMouseUpEventListener(),n.editor.triggerEvent("mouseUp",{rawEvent:a,isClicking:n.state.mouseDownX==a.pageX&&n.state.mouseDownY==a.pageY})),n.pointerEvent&&(n.pointerEvent=null)},this.onDoubleClick=function(a){n.editor&&n.editor.triggerEvent("doubleClick",{rawEvent:a})},this.onCompositionStart=function(){n.state.isInIME=!0},this.onCompositionEnd=function(a){var i;n.state.isInIME=!1,(i=n.editor)===null||i===void 0||i.triggerEvent("compositionEnd",{rawEvent:a})},this.onPointerDown=function(a){(a.pointerType==="touch"||a.pointerType==="pen")&&(n.pointerEvent=a)},this.state={isInIME:!1,scrollContainer:e.scrollContainer||r,mouseDownX:null,mouseDownY:null,mouseUpEventListerAdded:!1}}return t.prototype.getName=function(){return"DOMEvent"},t.prototype.initialize=function(e){var r=this,n,a;this.editor=e;var i=this.editor.getDocument(),o={keypress:this.keyboardEventHandler,keydown:this.keyboardEventHandler,keyup:this.keyboardEventHandler,input:this.inputEventHandler,mousedown:{beforeDispatch:this.onMouseDown},dblclick:{beforeDispatch:function(s){return r.onDoubleClick(s)}},compositionstart:{beforeDispatch:this.onCompositionStart},compositionend:{beforeDispatch:this.onCompositionEnd},dragstart:{beforeDispatch:this.onDragStart},drop:{beforeDispatch:this.onDrop},pointerdown:{beforeDispatch:function(s){return r.onPointerDown(s)}}};this.disposer=this.editor.attachDomEvent(o),this.state.scrollContainer.addEventListener("scroll",this.onScroll),(n=i.defaultView)===null||n===void 0||n.addEventListener("scroll",this.onScroll),(a=i.defaultView)===null||a===void 0||a.addEventListener("resize",this.onScroll)},t.prototype.dispose=function(){var e,r,n,a,i;this.removeMouseUpEventListener();var o=(e=this.editor)===null||e===void 0?void 0:e.getDocument();(r=o?.defaultView)===null||r===void 0||r.removeEventListener("resize",this.onScroll),(n=o?.defaultView)===null||n===void 0||n.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),(a=this.disposer)===null||a===void 0||a.call(this),this.disposer=null,this.editor=null,this.pointerEvent=null,this.timer&&((i=o?.defaultView)===null||i===void 0||i.clearTimeout(this.timer),this.timer=0)},t.prototype.getState=function(){return this.state},t.prototype.removeMouseUpEventListener=function(){this.editor&&this.state.mouseUpEventListerAdded&&(this.state.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},t})();function ab(t,e){return new nb(t,e)}function Vn(t,e){t.blocks.forEach(function(r){switch(r.blockType){case"BlockGroup":Vn(r,e);break;case"Entity":e.push({entity:r,operation:"newEntity"});break;case"Paragraph":r.segments.forEach(function(n){switch(n.segmentType){case"Entity":e.push({entity:n,operation:"newEntity"});break;case"General":Vn(n,e);break}});break;case"Table":r.rows.forEach(function(n){return n.cells.forEach(function(a){return Vn(a,e)})});break}})}function ib(t,e,r){var n,a=t.isDisposed()?null:t.getDOMSelection();if(!(!a||a.type!="range")){var i=a.range,o=a.isReverted,s=o?i.startContainer:i.endContainer,l=o?i.startOffset:i.endOffset,u=L(s,"ELEMENT_NODE")?s:s.parentElement,d=u&&((n=t.getDocument().defaultView)===null||n===void 0?void 0:n.getComputedStyle(u).direction)=="rtl",f=e=="ArrowLeft"!=!!d;u&&(Rt(u,!f)&&(f&&l==0||!f&&l==1)||dn(u))&&t.formatContentModel(function(h){var v,c,p=pn(h,!1,!0),g=p[o?0:p.length-1],b=(c=(v=g?.[1])===null||v===void 0?void 0:v.segments.indexOf(g[0]))!==null&&c!==void 0?c:-1;if(g&&g[1]&&b>=0){var y=M(g,3),E=y[0],S=y[1],T=y[2],k=r&&!i.collapsed&&f!=!!o,R=k?E:S.segments[f?b-1:b+1],H=lb(R,T,S,f);if(H){var U=ob(i,k,f,H,r);t.setDOMSelection({type:"range",range:U,isReverted:U.collapsed?!1:o})}}return!1})}}function ob(t,e,r,n,a){var i=t.cloneRange();return e?r?i.setEndBefore(n):i.setStartAfter(n):(r?i.setStartBefore(n):i.setEndAfter(n),a||(r?i.setEndBefore(n):i.setStartAfter(n))),i}function lb(t,e,r,n){var a=null;if(t?.segmentType=="Entity")a=t;else{var i=e[0].blocks,o=i.indexOf(r),s=o>=0?i[n?o-1:o+1]:null;s?.blockType=="Entity"&&(a=s)}var l=a?n?a.wrapper.previousElementSibling:a.wrapper.nextElementSibling:null;return L(l,"ELEMENT_NODE")&&Rt(l,n)?l:null}var sb=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function jn(t,e){var r,n,a,i,o=L(t,"TEXT_NODE")?(n=(r=t.nodeValue)===null||r===void 0?void 0:r.length)!==null&&n!==void 0?n:0:t.childNodes.length;for(e=Math.max(Math.min(e,o),0);t?.lastChild;)if(e>=t.childNodes.length)t=t.lastChild,e=L(t,"TEXT_NODE")?(i=(a=t.nodeValue)===null||a===void 0?void 0:a.length)!==null&&i!==void 0?i:0:t.childNodes.length;else{var s=t.childNodes[e];if(L(s,"ELEMENT_NODE")&&sb.indexOf(s.tagName)>=0)break;t=t.childNodes[e],e=0}return{node:t,offset:e}}var so="entityDelimiterBefore",rn="entityDelimiterAfter",fa="."+rn+",."+so,Lr="​",ub="_Entity",db="span."+ub;function Sd(t,e){var r=t.classList.contains(rn),n=r?t.previousElementSibling:t.nextElementSibling;n&&pt(n)&&(Td([n.previousElementSibling,n.nextElementSibling].filter(function(a){return!!a})),e.formatContentModel(function(a,i){return Qe(a,function(o,s,l,u){l?.blockType=="Paragraph"&&l.segments.forEach(function(d){d.segmentType=="Text"&&d.text.indexOf(Lr)>=0&&at(l,d,function(f){f.text=f.text.replace(Lr,"")})})}),i.skipUndoSnapshot=!0,!0}))}function fb(t,e){if(t.length>0){var r=Sa();t.forEach(function(n){L(n,"ELEMENT_NODE")&&pt(n)&&!n.isContentEditable&&Vi(n.ownerDocument,n,e,r)})}}function vb(t){var e;(e=t?.parentElement)===null||e===void 0||e.removeChild(t)}function Td(t){t.forEach(function(e){if(L(e,"ELEMENT_NODE"))if(Rt(e)){var r=e.classList.contains(so)?e.nextElementSibling:e.previousElementSibling;L(r,"ELEMENT_NODE")&&pt(r)||vb(e)}else cb(e)})}function cb(t,e){if(e===void 0&&(e=!0),!!t){var r=t.classList.contains(rn),n=r?t.previousElementSibling:t.nextElementSibling;e&&n&&pt(n)||(t.classList.remove(rn,so),t.normalize(),t.childNodes.forEach(function(a){var i,o,s=(o=(i=a.textContent)===null||i===void 0?void 0:i.indexOf(Lr))!==null&&o!==void 0?o:-1;if(s>=0){var l=new Range;l.setStart(a,s),l.setEnd(a,s+1),l.deleteContents()}}))}}function wd(t,e){var r,n,a,i,o,s=t.range,l=t.isReverted,u=l?s.startContainer:s.endContainer,d=l?s.startOffset:s.endOffset;if(u){var f=jn(u,d);u=f.node,d=f.offset}if(L(u,"ELEMENT_NODE"))u=u.childNodes.length==d?u:u.childNodes.item(d);else{var h=e?Lr+e:Lr;u.textContent!=h&&(u.textContent||"").length==d?u=(a=(r=u.nextSibling)!==null&&r!==void 0?r:(n=u.parentElement)===null||n===void 0?void 0:n.closest(fa))!==null&&a!==void 0?a:null:u=(o=(i=u?.parentElement)===null||i===void 0?void 0:i.closest(fa))!==null&&o!==void 0?o:null}return u&&!u.hasChildNodes()&&(u=u.nextSibling),L(u,"ELEMENT_NODE")?u:null}function hb(t){var e=t.getDOMHelper();Td(e.queryElements(fa)),fb(e.queryElements(db),t.getPendingFormat())}function pb(t,e){var r=t.getDOMSelection();if(r?.type=="range"&&r.range.collapsed){var n=wd(r,e.rawEvent.data);n?.firstChild&&L(n.firstChild,"TEXT_NODE")&&n.matches(fa)&&n.textContent==Lr+e.rawEvent.data&&Sd(n,t)}}function gb(t,e){var r,n=t.getDOMSelection();if(!(!n||n.type!="range")){var a=e.rawEvent,i=n.range,o=a.key;switch(o){case"Enter":var s=t.getDOMHelper(),l=Wi(i.startContainer,s);l&&L(l,"ELEMENT_NODE")&&s.isNodeInEditor(l)&&Eb(t,l,a);break;case"ArrowLeft":case"ArrowRight":!a.altKey&&!a.ctrlKey&&!a.metaKey&&((r=t.getDocument().defaultView)===null||r===void 0||r.requestAnimationFrame(function(){ib(t,o,a.shiftKey)}));break;default:Ta(a)&&i.collapsed&&mb(t,i,wd(n),a);break}}}function mb(t,e,r,n){var a,i=t.getDOMHelper();if(r&&Rt(r)&&i.isNodeInEditor(r)){var o=uu(r,i),s=n.key==="Enter";if(o&&i.isNodeInEditor(o)){var l=r.classList.contains(rn);l?e.setStartAfter(o):e.setStartBefore(o),e.collapse(!0),s&&n.preventDefault(),t.formatContentModel(bb,{selectionOverride:{type:"range",isReverted:!1,range:e}})}else s?t.formatContentModel(function(u,d){var f=yb(u);return f&&n.preventDefault(),f}):(t.takeSnapshot(),(a=t.getDocument().defaultView)===null||a===void 0||a.requestAnimationFrame(function(){return Sd(r,t)}))}}var bb=function(t,e){return Qe(t,function(r,n,a){if(a?.blockType=="Paragraph"){var i=w(a);delete i.isImplicit;var o=i.segments.find(function(s){return s.segmentType=="SelectionMarker"});o?.segmentType=="SelectionMarker"&&(i.segmentFormat=C({},o.format),e.newPendingFormat=C({},o.format)),i.segments.unshift(zt())}}),!0},yb=function(t){var e,r,n;if(Qe(t,function(u,d,f){f?.blockType=="Paragraph"&&(r=f,n=u[0])}),n?.blockGroupType=="ListItem")return!1;if(r&&n){var a=r.segments.findIndex(function(u){return u.segmentType=="SelectionMarker"});if(a>=0){var i=w(r),o=i.segments.splice(a),s=Ge(!1,i.format,i.segmentFormat,i.decorator);(i.segments.every(function(u){return u.segmentType=="SelectionMarker"||u.segmentType=="Br"})||o.every(function(u){return u.segmentType=="SelectionMarker"}))&&s.segments.push(zt(i.format)),(e=s.segments).push.apply(e,P([],M(o),!1));var l=n.blocks.indexOf(i);l>=0&&w(n).blocks.splice(l+1,0,s)}}return!0},Eb=function(t,e,r){var n=or(e);n.id&&n.entityType&&!n.isFakeEntity&&t.triggerEvent("entityOperation",{operation:"click",entity:{id:n.id,type:n.entityType,isReadonly:!!n.isReadonly,wrapper:e},rawEvent:r})},Cb=/_(\d{1,8})$/,Sb=(function(){function t(){this.editor=null,this.state={entityMap:{}}}return t.prototype.getName=function(){return"Entity"},t.prototype.initialize=function(e){this.editor=e},t.prototype.dispose=function(){this.editor=null,this.state.entityMap={}},t.prototype.getState=function(){return this.state},t.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"mouseUp":this.handleMouseUpEvent(this.editor,e);break;case"contentChanged":this.handleContentChangedEvent(this.editor,e);break;case"keyDown":gb(this.editor,e);break;case"compositionEnd":pb(this.editor,e);break;case"editorReady":this.handleContentChangedEvent(this.editor);break;case"extractContentWithDom":this.handleExtractContentWithDomEvent(this.editor,e.clonedRoot);break}},t.prototype.handleMouseUpEvent=function(e,r){var n=r.rawEvent,a=r.isClicking,i=n.target;if(a&&this.editor)for(;i&&this.editor.getDOMHelper().isNodeInEditor(i);)if(pt(i)){this.triggerEvent(e,i,"click",n);break}else i=i.parentNode},t.prototype.handleContentChangedEvent=function(e,r){var n=this,a,i=(a=r?.changedEntities)!==null&&a!==void 0?a:this.getChangedEntities(e),o=r?.entityStates;i.forEach(function(s){var l=s.entity,u=s.operation,d=s.rawEvent,f=l.entityFormat,h=f.id,v=f.entityType,c=f.isFakeEntity,p=l.wrapper;if(v&&!c){if(u=="newEntity"){l.entityFormat.id=n.ensureUniqueId(v,h??"",p),p.className=fu(l.entityFormat),l.entityFormat.isReadonly&&(p.contentEditable="false");var g=n.triggerEvent(e,p,u,d);n.state.entityMap[l.entityFormat.id]={element:p,canPersist:g?.shouldPersist},e.isDarkMode()&&aa(p,!0,"lightToDark",e.getColorManager())}else if(h){var b=n.state.entityMap[h];b&&(b.isDeleted=!0),n.triggerEvent(e,p,u,d)}}}),o?.forEach(function(s){var l,u=s.id,d=s.state,f=(l=n.state.entityMap[u])===null||l===void 0?void 0:l.element;f&&n.triggerEvent(e,f,"updateEntityState",void 0,d)}),hb(e)},t.prototype.getChangedEntities=function(e){var r=this,n=[];return e.formatContentModel(function(a){return Vn(a,n),!1}),ie(this.state.entityMap).forEach(function(a){var i=r.state.entityMap[a];if(!i.isDeleted){var o=n.findIndex(function(u){return u.operation=="newEntity"&&u.entity.entityFormat.id==a&&u.entity.wrapper==i.element});if(o>=0)n.splice(o,1);else{var s=or(i.element);if(!s.isFakeEntity){var l=nu(i.element,s.isReadonly,{},s.entityType,s.id);n.push({entity:l,operation:"overwrite"})}}}}),n},t.prototype.handleExtractContentWithDomEvent=function(e,r){var n=this;du(r).forEach(function(a){a.removeAttribute("contentEditable"),n.triggerEvent(e,a,"replaceTemporaryContent")})},t.prototype.triggerEvent=function(e,r,n,a,i){var o=or(r);return o.id&&o.entityType&&!o.isFakeEntity?e.triggerEvent("entityOperation",{operation:n,rawEvent:a,entity:{id:o.id,type:o.entityType,isReadonly:!!o.isReadonly,wrapper:r},state:n=="updateEntityState"?i:void 0,shouldPersist:n=="newEntity"?!0:void 0}):null},t.prototype.ensureUniqueId=function(e,r,n){for(var a=Cb.exec(r),i=(a?r.substr(0,r.length-a[0].length):r)||e,o="",s=a&&parseInt(a[1])||0;;s++){o=s>0?i+"_"+s:i;var l=this.state.entityMap[o];if(!l||l.element==n)break}return o},t})();function Tb(){return new Sb}function wb(t,e){var r=t.getDOMSelection();r?.type=="range"&&r.range.collapsed&&t.formatContentModel(function(n,a){return Qe(n,function(i,o,s,l){var u=l?.[0];if(s?.blockType=="Paragraph"&&u?.segmentType=="SelectionMarker"){var d=i[0].blocks,f=d.length,h=d.indexOf(s);if(s.isImplicit&&s.segments.length==1&&s.segments[0]==u&&f>0&&h==f-1){var v=d[h-1];v?.blockType!="Paragraph"&&(a.newPendingFormat=Nl(t,e,u.format))}else s.segments.every(function(c){return c.segmentType!="Text"})&&(a.newPendingFormat=Nl(t,e,u.format))}return!0}),!1})}function Nl(t,e,r){return C(C(C({},e),t.getPendingFormat()),r)}var Il=" ",Bl=" ";function kb(t,e,r,n){var a=!1;t.formatContentModel(function(i,o){return Qe(i,function(s,l,u,d){if(u?.blockType=="Paragraph"&&d?.length==1&&d[0].segmentType=="SelectionMarker"){var f=d[0],h=u.segments.indexOf(f),v=u.segments[h-1];if(v?.segmentType=="Text"){var c=v.text,p=c.substr(-e.length,e.length);if((p==e||e==Il&&p==Bl)&&(r&&!Hl(v.format,r)&&(at(u,v,function(b){b.text=c.substring(0,c.length-e.length)}),at(u,f,function(b,y){b.format=C({},r);var E=xe(e==Il?Bl:e,C(C({},v.format),r));y.segments.splice(h,0,E),Xe(y)}),a=!0),n&&!Hl(u.format,n))){var g=w(u);Object.assign(g.format,n),a=!0}}}return!0}),a&&(ht(i),o.skipUndoSnapshot=!0),a},{apiName:"applyPendingFormat"})}function Hl(t,e){var r=ie(e),n=!0;return r.forEach(function(a){t[a]!==e[a]&&(n=!1)}),n}var _b="Process",Mb="Unidentified",zl={backgroundColor:"backgroundColor",textColor:"color",fontFamily:"fontFamily",fontSize:"fontSize"},Db=(function(){function t(e){var r=this;this.editor=null,this.lastCheckedNode=null,this.state={defaultFormat:C({},e.defaultSegmentFormat),pendingFormat:null};var n=this.state.defaultFormat;n.fontFamily&&(n.fontFamily=Cp(n.fontFamily)),this.defaultFormatKeys=new Set,ie(zl).forEach(function(a){r.state.defaultFormat[a]&&r.defaultFormatKeys.add(zl[a])})}return t.prototype.getName=function(){return"Format"},t.prototype.initialize=function(e){this.editor=e,this.state.defaultFormat=ip(this.state.defaultFormat,e.getEnvironment())},t.prototype.dispose=function(){this.editor=null},t.prototype.getState=function(){return this.state},t.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"input":this.checkAndApplyPendingFormat(e.rawEvent.data);break;case"compositionEnd":this.checkAndApplyPendingFormat(e.rawEvent.data);break;case"keyDown":var r=this.editor.getEnvironment().isAndroid&&e.rawEvent.key==Mb;$i(e.rawEvent)?(this.clearPendingFormat(),this.lastCheckedNode=null):this.defaultFormatKeys.size>0&&(r||Ta(e.rawEvent)||e.rawEvent.key==_b)&&this.shouldApplyDefaultFormat(this.editor)&&wb(this.editor,this.state.defaultFormat);break;case"mouseUp":case"contentChanged":this.lastCheckedNode=null,this.canApplyPendingFormat()||this.clearPendingFormat();break}},t.prototype.checkAndApplyPendingFormat=function(e){this.editor&&e&&this.state.pendingFormat&&(kb(this.editor,e,this.state.pendingFormat.format,this.state.pendingFormat.paragraphFormat),this.clearPendingFormat())},t.prototype.clearPendingFormat=function(){this.state.pendingFormat=null},t.prototype.canApplyPendingFormat=function(){var e=!1;if(this.state.pendingFormat&&this.editor){var r=this.editor.getDOMSelection(),n=r?.type=="range"&&r.range.collapsed?r.range:null,a=this.state.pendingFormat.insertPoint,i=a.node,o=a.offset;n&&n.startContainer==i&&n.startOffset==o&&(e=!0)}return e},t.prototype.shouldApplyDefaultFormat=function(e){var r,n,a=e.getDOMSelection(),i=a?.type=="range"?a.range:null,o=(r=i?.startContainer)!==null&&r!==void 0?r:null;if(o&&o!=this.lastCheckedNode){this.lastCheckedNode=o;for(var s=e.getDOMHelper(),l=L(o,"ELEMENT_NODE")?o:o.parentElement,u=new Set,d=function(){if(!((n=l.getAttribute)===null||n===void 0)&&n.call(l,"style")){var v=l.style;if(f.defaultFormatKeys.forEach(function(c){v[c]&&u.add(c)}),u.size==f.defaultFormatKeys.size)return{value:!1}}if(xt(l))return"break";l=l.parentElement},f=this;l?.parentElement&&s.isNodeInEditor(l.parentElement);){var h=d();if(typeof h=="object")return h.value;if(h==="break")break}return!0}else return!1},t})();function Ob(t){return new Db(t)}var xl="contenteditable",Lb="#000000",Rb="#ffffff",Fb=(function(){function t(e,r){var n=this;this.editor=null,this.initializer=null,this.disposer=null,r.getAttribute(xl)===null&&(this.initializer=function(){r.contentEditable="true",r.style.userSelect="text"},this.disposer=function(){r.style.userSelect="",r.removeAttribute(xl)}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){n.adjustContainerColor(r)},this.state={isDarkMode:!!e.inDarkMode,shadowEditFragment:null,styleElements:{},announcerStringGetter:e.announcerStringGetter}}return t.prototype.getName=function(){return"Lifecycle"},t.prototype.initialize=function(e){var r,n;this.editor=e,(r=this.initializer)===null||r===void 0||r.call(this),this.adjustColor();var a=(n=this.state.rewriteFromModel)!==null&&n!==void 0?n:{addedBlockElements:[],removedBlockElements:[]};this.editor.triggerEvent("editorReady",a,!0),delete this.state.rewriteFromModel,this.state.announceContainer=td(e.getDocument())},t.prototype.dispose=function(){var e=this,r,n;(r=this.editor)===null||r===void 0||r.triggerEvent("beforeDispose",{},!0),ie(this.state.styleElements).forEach(function(i){var o,s=e.state.styleElements[i];(o=s.parentElement)===null||o===void 0||o.removeChild(s),delete e.state.styleElements[i]});var a=this.state.announceContainer;a&&((n=a.parentElement)===null||n===void 0||n.removeChild(a),delete this.state.announceContainer),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},t.prototype.getState=function(){return this.state},t.prototype.onPluginEvent=function(e){e.eventType=="contentChanged"&&(e.source==Ue.SwitchToDarkMode||e.source==Ue.SwitchToLightMode)&&this.adjustColor()},t.prototype.adjustContainerColor=function(e){if(this.editor){var r=this.state.isDarkMode,n=this.editor.getColorManager();Dr(e,Lb,!1,r,n),Dr(e,Rb,!0,r,n)}},t})();function Pb(t,e){return new Fb(t,e)}var Ab="TH,TD";function Fn(t,e,r){var n=r.findClosestElementAncestor(e,Ab),a=null;return n&&t.some(function(i,o){var s=n?i.indexOf(n):-1;return a=s>=0?{row:o,col:s}:null}),a||t.some(function(i,o){var s=i.findIndex(function(l){return typeof l=="object"&&l.contains(e)});return a=s>=0?{row:o,col:s}:null}),a}function Nb(t){var e=Ib(t),r=e.startNode,n=e.endNode,a=e.startOffset,i=e.endOffset,o=Math.max(a,i),s=Math.min(a,i);if(r&&n&&r==n&&o-s==1){var l=r?.childNodes.item(s);if(L(l,"ELEMENT_NODE")&&ae(l,"img"))return l}return null}function Ib(t){return Bb(t)?{startNode:t.anchorNode,endNode:t.focusNode,startOffset:t.anchorOffset,endOffset:t.focusOffset}:{startNode:t.startContainer,endNode:t.endContainer,startOffset:t.startOffset,endOffset:t.endOffset}}function Bb(t){return!!t.getRangeAt}var Ja=0,Hb=2,er="ArrowUp",Pn="ArrowDown",An="ArrowLeft",Qa="ArrowRight",Ul="Tab",Gl="#DB626C",Kl="#C6C6C6",zb=(function(){function t(e){var r=this,n,a;this.editor=null,this.disposer=null,this.logicalRootDisposer=null,this.isSafari=!1,this.isMac=!1,this.scrollTopCache=0,this.onMouseMove=function(i){var o,s,l;if(r.editor&&r.state.tableSelection){var u=!!r.state.tableSelection.lastCo,d=i.target,f=r.editor.getDOMHelper(),h=r.editor.getDocument().createRange(),v=r.state.tableSelection.startNode,c=d.compareDocumentPosition(v)==Node.DOCUMENT_POSITION_FOLLOWING;c?(h.setStart(d,0),h.setEnd(v,L(v,"TEXT_NODE")?(s=(o=v.nodeValue)===null||o===void 0?void 0:o.length)!==null&&s!==void 0?s:0:v.childNodes.length)):(h.setStart(v,0),h.setEnd(d,0));var p=h.commonAncestorContainer,g=r.parseTableSelection(p,v,f);if(g){var b=Fn(g.parsedTable,d,f);g.table!=r.state.tableSelection.table&&(r.state.tableSelection=g,r.state.tableSelection.lastCo=b??void 0);var y=b&&r.updateTableSelection(b);(u||y)&&i.preventDefault()}else((l=r.editor.getDOMSelection())===null||l===void 0?void 0:l.type)=="table"&&r.setDOMSelection({type:"range",range:h,isReverted:c},r.state.tableSelection)}},this.onDrop=function(){r.detachMouseEvent()},this.getContainedTargetImage=function(i,o){if(!r.isMac||!o||o.type!=="image")return null;var s=i.target;return L(s,"ELEMENT_NODE")&&ae(s,"span")&&s.firstChild===o.image?o.image:null},this.onFocus=function(){var i;if(!r.state.skipReselectOnFocus&&r.state.selection&&r.setDOMSelection(r.state.selection,r.state.tableSelection),((i=r.state.selection)===null||i===void 0?void 0:i.type)=="range"&&!r.isSafari&&(r.state.selection=null),r.scrollTopCache&&r.editor){var o=r.editor.getScrollContainer();o.scrollTop=r.scrollTopCache,r.scrollTopCache=0}},this.onBlur=function(){if(r.editor){r.state.selection||(r.state.selection=r.editor.getDOMSelection());var i=r.editor.getScrollContainer();r.scrollTopCache=i.scrollTop}},this.onSelectionChange=function(){var i;if(!((i=r.editor)===null||i===void 0)&&i.hasFocus()&&!r.editor.isInShadowEdit()){var o=r.editor.getDOMSelection(),s=r.editor.getDocument().getSelection();if(s&&s.focusNode){var l=Nb(s);if(o?.type=="image"&&!l){var u=s.getRangeAt(0);r.editor.setDOMSelection({type:"range",range:u,isReverted:s.focusNode!=u.endContainer||s.focusOffset!=u.endOffset})}else o?.type!=="image"&&l&&r.editor.setDOMSelection({type:"image",image:l})}o?.type=="range"&&r.isSafari&&(r.state.selection=o)}},this.state={selection:null,tableSelection:null,imageSelectionBorderColor:(n=e.imageSelectionBorderColor)!==null&&n!==void 0?n:Gl,imageSelectionBorderColorDark:e.imageSelectionBorderColor?void 0:Gl,tableCellSelectionBackgroundColor:(a=e.tableCellSelectionBackgroundColor)!==null&&a!==void 0?a:Kl,tableCellSelectionBackgroundColorDark:e.tableCellSelectionBackgroundColor?void 0:Kl}}return t.prototype.getName=function(){return"Selection"},t.prototype.initialize=function(e){this.editor=e,!this.state.imageSelectionBorderColorDark&&this.state.imageSelectionBorderColor&&(this.state.imageSelectionBorderColorDark=e.getColorManager().getDarkColor(this.state.imageSelectionBorderColor,void 0,"border")),!this.state.tableCellSelectionBackgroundColorDark&&this.state.tableCellSelectionBackgroundColor&&(this.state.tableCellSelectionBackgroundColorDark=e.getColorManager().getDarkColor(this.state.tableCellSelectionBackgroundColor,void 0,"background"));var r=this.editor.getEnvironment(),n=this.editor.getDocument();this.isSafari=!!r.isSafari,this.isMac=!!r.isMac,n.addEventListener("selectionchange",this.onSelectionChange),this.isSafari?this.disposer=this.editor.attachDomEvent({focus:{beforeDispatch:this.onFocus},drop:{beforeDispatch:this.onDrop}}):this.disposer=this.editor.attachDomEvent({focus:{beforeDispatch:this.onFocus},blur:{beforeDispatch:this.onBlur},drop:{beforeDispatch:this.onDrop}})},t.prototype.dispose=function(){var e,r;(e=this.editor)===null||e===void 0||e.getDocument().removeEventListener("selectionchange",this.onSelectionChange),this.disposer&&(this.disposer(),this.disposer=null),(r=this.logicalRootDisposer)===null||r===void 0||r.call(this),this.logicalRootDisposer=null,this.detachMouseEvent(),this.editor=null},t.prototype.getState=function(){return this.state},t.prototype.onPluginEvent=function(e){var r;if(this.editor)switch(e.eventType){case"mouseDown":this.onMouseDown(this.editor,e.rawEvent);break;case"mouseUp":this.onMouseUp();break;case"keyDown":this.onKeyDown(this.editor,e.rawEvent);break;case"contentChanged":this.state.tableSelection=null;break;case"scroll":this.editor.hasFocus()||(this.scrollTopCache=e.scrollContainer.scrollTop);break;case"logicalRootChanged":(r=this.logicalRootDisposer)===null||r===void 0||r.call(this),this.isSafari?this.logicalRootDisposer=this.editor.attachDomEvent({focus:{beforeDispatch:this.onFocus},drop:{beforeDispatch:this.onDrop}}):this.logicalRootDisposer=this.editor.attachDomEvent({focus:{beforeDispatch:this.onFocus},blur:{beforeDispatch:this.onBlur},drop:{beforeDispatch:this.onDrop}});break}},t.prototype.onMouseDown=function(e,r){var n,a,i,o=e.getDOMSelection(),s;if(o?.type=="image"&&(r.button==Ja||r.button==Hb&&!this.getClickingImage(r)&&!this.getContainedTargetImage(r,o))&&this.setDOMSelection(null,null),(s=(n=this.getClickingImage(r))!==null&&n!==void 0?n:this.getContainedTargetImage(r,o))&&s.isContentEditable){this.setDOMSelection({type:"image",image:s},null);return}o?.type=="table"&&r.button==Ja&&this.setDOMSelection(null,null);var l,u=r.target;if(u&&r.button==Ja&&(l=this.parseTableSelection(u,u,e.getDOMHelper()))){if(this.state.tableSelection=l,r.detail>=3){var d=Fn(l.parsedTable,r.target,e.getDOMHelper());d&&(l.lastCo=d,this.updateTableSelection(d),r.preventDefault())}(i=(a=this.state).mouseDisposer)===null||i===void 0||i.call(a),this.state.mouseDisposer=e.attachDomEvent({mousemove:{beforeDispatch:this.onMouseMove}})}},t.prototype.onMouseUp=function(){this.detachMouseEvent()},t.prototype.onKeyDown=function(e,r){var n=this,a,i,o=r.key,s=e.getDOMSelection(),l=e.getDocument().defaultView;switch(s?.type){case"image":if(!Or(r)&&!r.shiftKey&&s.image.parentNode&&(o==="Escape"?(this.selectBeforeOrAfterElement(e,s.image),r.stopPropagation()):o!=="Delete"&&o!=="Backspace"&&this.selectBeforeOrAfterElement(e,s.image)),(Or(r)||r.shiftKey)&&s.image&&!this.isSafari){var u=s.image.ownerDocument.createRange();u.selectNode(s.image),this.setDOMSelection({type:"range",range:u,isReverted:!1},null)}break;case"range":if(o==er||o==Pn||o==An||o==Qa||o==Ul){var d=s.range.startContainer;this.state.tableSelection=this.parseTableSelection(d,d,e.getDOMHelper()),this.state.tableSelection&&!r.defaultPrevented&&(o==Ul?(this.handleSelectionInTable(this.getTabKey(r)),r.preventDefault()):l?.requestAnimationFrame(function(){return n.handleSelectionInTable(o)}))}break;case"table":if(this.state.tableSelection==null){var f=s.table,h=s.firstRow,v=s.firstColumn,c=s.lastRow,p=s.lastColumn,g=Jr(f);if(g){var b={row:h,col:v},y={row:c,col:p};this.state.tableSelection={table:f,parsedTable:g,firstCo:b,lastCo:y,startNode:((a=Kn(g,b))===null||a===void 0?void 0:a.cell)||f}}}if(!((i=this.state.tableSelection)===null||i===void 0)&&i.lastCo){var E=r.shiftKey,S=r.key;if(E&&(S==An||S==Qa)){var T=l?.getComputedStyle(this.state.tableSelection.table).direction=="rtl";this.updateTableSelectionFromKeyboard(0,(S==An?-1:1)*(T?-1:1)),r.preventDefault()}else E&&(S==er||S==Pn)?(this.updateTableSelectionFromKeyboard(S==er?-1:1,0),r.preventDefault()):S!="Shift"&&!Ta(r)&&(S==er||S==Pn||S==An||S==Qa)&&(this.setDOMSelection(null,this.state.tableSelection),l?.requestAnimationFrame(function(){return n.handleSelectionInTable(S)}))}break}},t.prototype.getTabKey=function(e){return e.shiftKey?"TabLeft":"TabRight"},t.prototype.handleSelectionInTable=function(e){var r,n,a,i,o,s;if(!(!this.editor||!this.state.tableSelection)){var l=this.editor.getDOMSelection(),u=this.editor.getDOMHelper();if(l?.type=="range"){var d=l.range,f=d.collapsed,h=d.startContainer,v=d.endContainer,c=d.commonAncestorContainer,p=l.isReverted,g=p?v:h,b=p?h:v,y=this.parseTableSelection(c,g,u);if(!y)return;var E=Fn(y?.parsedTable,b,u),S=!1,T=this.state.tableSelection,k=T.parsedTable,R=T.firstCo,H=T.table;if(E&&y.table==H){if(E.col!=R.col&&(e==er||e==Pn)){var U=e==er?-1:1,q=(r=Kn(k,R))===null||r===void 0?void 0:r.cell,W=null;for(E={row:R.row+U,col:R.col};E.row>=0&&E.row<k.length&&(W=((n=Kn(k,E))===null||n===void 0?void 0:n.cell)||null,W==q);)E.row+=U;f&&W?this.setRangeSelectionInTable(W,e==er?W.childNodes.length:0,this.editor):!W&&(E.row==-1||E.row<=k.length)&&this.selectBeforeOrAfterElement(this.editor,H,U==1,U!=1)}else if(e=="TabLeft"||e=="TabRight")for(var J=e=="TabLeft",x=J?-1:1,G=(a=E.row)!==null&&a!==void 0?a:0,pe=((i=E.col)!==null&&i!==void 0?i:0)+x;;pe+=x){if(pe<0||pe>=k[G].length){if(G+=x,G<0){this.selectBeforeOrAfterElement(this.editor,y.table);break}else if(G>=k.length){this.selectBeforeOrAfterElement(this.editor,y.table,!0);break}pe=J?k[G].length-1:0}var $=k[G][pe];if(typeof $!="string"){S=!0,this.setRangeSelectionInTable($,0,this.editor,!0),E.row=G,E.col=pe;break}}else this.state.tableSelection=null;f&&(E.col!=R.col||E.row!=R.row)&&E.row>=0&&E.row==k.length-1&&E.col==((o=k[E.row])===null||o===void 0?void 0:o.length)-1&&((s=this.editor)===null||s===void 0||s.announce({defaultStrings:"announceOnFocusLastCell"}))}!f&&E&&!S&&(this.state.tableSelection=y,this.updateTableSelection(E))}}},t.prototype.setRangeSelectionInTable=function(e,r,n,a){var i=n.getDocument().createRange();if(a&&e.firstChild&&e.lastChild){var o=e.firstChild,s=e.lastChild,l=jn(o,0),u=jn(s,s.childNodes.length);i.setStart(l.node,l.offset),i.setEnd(u.node,u.offset),i.toString()===""&&i.collapse(!0)}else{var d=jn(e,r),f=d.node,h=d.offset;i.setStart(f,h),i.collapse(!0)}this.setDOMSelection({type:"range",range:i,isReverted:!1},null)},t.prototype.updateTableSelectionFromKeyboard=function(e,r){var n;if(!((n=this.state.tableSelection)===null||n===void 0)&&n.lastCo&&this.editor){var a=this.state.tableSelection,i=a.lastCo,o=a.parsedTable,s=i.row+e,l=i.col+r;s>=0&&s<o.length&&l>=0&&l<o[s].length&&this.updateTableSelection({row:s,col:l})}},t.prototype.selectBeforeOrAfterElement=function(e,r,n,a){var i=e.getDocument(),o=r.parentNode,s=o&&Ze(o.childNodes).indexOf(r),l;if(o&&s!==null&&s>=0){var u=i.createRange();a&&(l=n?r.nextElementSibling:r.previousElementSibling)&&L(l,"ELEMENT_NODE")?(u.selectNodeContents(l),u.collapse(!1)):(u.setStart(o,s+(n?1:0)),u.collapse()),this.setDOMSelection({type:"range",range:u,isReverted:!1},null)}},t.prototype.getClickingImage=function(e){var r=e.target;return L(r,"ELEMENT_NODE")&&ae(r,"img")?r:null},t.prototype.parseTableSelection=function(e,r,n){var a,i,o;return(a=n.findClosestElementAncestor(e,"table"))&&a.isContentEditable&&(i=Jr(a))&&(o=Fn(i,r,n))?{table:a,parsedTable:i,firstCo:o,startNode:r}:null},t.prototype.updateTableSelection=function(e){if(this.state.tableSelection&&this.editor){var r=this.state.tableSelection,n=r.table,a=r.firstCo,i=r.parsedTable,o=r.startNode,s=r.lastCo;if(s||a.row!=e.row||a.col!=e.col)return this.state.tableSelection.lastCo=e,this.setDOMSelection({type:"table",table:n,firstRow:a.row,firstColumn:a.col,lastRow:e.row,lastColumn:e.col,tableSelectionInfo:this.state.tableSelection},{table:n,firstCo:a,lastCo:e,parsedTable:i,startNode:o}),!0}return!1},t.prototype.setDOMSelection=function(e,r){var n;(n=this.editor)===null||n===void 0||n.setDOMSelection(e),this.state.tableSelection=r},t.prototype.detachMouseEvent=function(){this.state.mouseDisposer&&(this.state.mouseDisposer(),this.state.mouseDisposer=void 0)},t})();function xb(t){return new zb(t)}var Ub=1e7,Gb=(function(){function t(e){this.hasNewContentValue=!1,this.snapshots=e??{snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:Ub}}return Object.defineProperty(t.prototype,"hasNewContent",{get:function(){return this.hasNewContentValue},set:function(e){this.hasNewContentValue=e},enumerable:!1,configurable:!0}),t.prototype.canMove=function(e){var r=this.snapshots.currentIndex+e;return r>=0&&r<this.snapshots.snapshots.length},t.prototype.move=function(e){var r,n,a=null;return this.canMove(e)&&(this.snapshots.currentIndex+=e,this.snapshots.autoCompleteIndex=-1,a=this.snapshots.snapshots[this.snapshots.currentIndex]),(n=(r=this.snapshots).onChanged)===null||n===void 0||n.call(r,"move"),a},t.prototype.addSnapshot=function(e,r){var n,a,i=this.snapshots.snapshots[this.snapshots.currentIndex],o=i&&i.html==e.html&&!i.additionalState&&!e.additionalState&&!i.entityStates&&!e.entityStates,s=!i||Wb(i,e);if(this.snapshots.currentIndex<0||s){this.clearRedo(),this.snapshots.snapshots.push(e),this.snapshots.currentIndex++,this.snapshots.totalSize+=this.getSnapshotLength(e);for(var l=0;l<this.snapshots.snapshots.length&&this.snapshots.totalSize>this.snapshots.maxSize;)this.snapshots.totalSize-=this.getSnapshotLength(this.snapshots.snapshots[l]),l++;l>0&&(this.snapshots.snapshots.splice(0,l),this.snapshots.currentIndex-=l,this.snapshots.autoCompleteIndex>=0&&(this.snapshots.autoCompleteIndex-=l)),r&&(this.snapshots.autoCompleteIndex=this.snapshots.currentIndex)}else o&&this.snapshots.snapshots.splice(this.snapshots.currentIndex,1,e);(a=(n=this.snapshots).onChanged)===null||a===void 0||a.call(n,"add")},t.prototype.clearRedo=function(){var e,r;if(this.canMove(1)){for(var n=0,a=this.snapshots.currentIndex+1;a<this.snapshots.snapshots.length;a++)n+=this.getSnapshotLength(this.snapshots.snapshots[a]);this.snapshots.snapshots.splice(this.snapshots.currentIndex+1),this.snapshots.totalSize-=n,this.snapshots.autoCompleteIndex=-1,(r=(e=this.snapshots).onChanged)===null||r===void 0||r.call(e,"clear")}},t.prototype.canUndoAutoComplete=function(){return this.snapshots.autoCompleteIndex>=0&&this.snapshots.currentIndex-this.snapshots.autoCompleteIndex==1},t.prototype.getSnapshotLength=function(e){var r,n;return(n=(r=e.html)===null||r===void 0?void 0:r.length)!==null&&n!==void 0?n:0},t})();function Kb(t){return new Gb(t)}function Wb(t,e){return t.html!==e.html||t.additionalState&&e.additionalState&&JSON.stringify(t.additionalState)!==JSON.stringify(e.additionalState)||!t.additionalState&&e.additionalState||t.entityStates&&e.entityStates&&t.entityStates!==e.entityStates||!t.entityStates&&e.entityStates}function uo(t){t.focus();var e=t.getSnapshotsManager();e.hasNewContent&&t.takeSnapshot();var r=e.move(-1);r&&t.restoreSnapshot(r)}var Nn="Backspace",Wl="Delete",Vl="Enter",Vb=(function(){function t(e){this.editor=null,this.state={snapshotsManager:Kb(e.snapshots),isRestoring:!1,isNested:!1,autoCompleteInsertPoint:null,lastKeyPress:null}}return t.prototype.getName=function(){return"Undo"},t.prototype.initialize=function(e){this.editor=e},t.prototype.dispose=function(){this.editor=null},t.prototype.getState=function(){return this.state},t.prototype.willHandleEventExclusively=function(e){return!!this.editor&&e.eventType=="keyDown"&&e.rawEvent.key==Nn&&!e.rawEvent.ctrlKey&&this.canUndoAutoComplete(this.editor)},t.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"editorReady":var r=this.state.snapshotsManager,n=r.hasNewContent||r.canMove(-1),a=r.canMove(1);!n&&!a&&this.addUndoSnapshot();break;case"keyDown":this.onKeyDown(this.editor,e.rawEvent);break;case"keyPress":this.onKeyPress(this.editor,e.rawEvent);break;case"compositionEnd":this.clearRedoForInput(),this.addUndoSnapshot();break;case"contentChanged":this.onContentChanged(e);break;case"beforeKeyboardEditing":this.onBeforeKeyboardEditing(e.rawEvent);break;case"mouseDown":this.state.snapshotsManager.hasNewContent&&this.addUndoSnapshot();break}},t.prototype.onKeyDown=function(e,r){var n=this.state.snapshotsManager;if(r.key==Nn&&!r.altKey||r.key==Wl){if(r.key==Nn&&!r.ctrlKey&&this.canUndoAutoComplete(e))r.preventDefault(),uo(e),this.state.autoCompleteInsertPoint=null,this.state.lastKeyPress=r.key;else if(!r.defaultPrevented){var a=e.getDOMSelection();a&&(a.type!="range"||!a.range.collapsed||this.state.lastKeyPress!=r.key||this.isCtrlOrMetaPressed(e,r))&&this.addUndoSnapshot(),n.hasNewContent=!0,this.state.lastKeyPress=r.key}}else $i(r)?(n.hasNewContent&&this.addUndoSnapshot(),this.state.lastKeyPress=null):(this.state.lastKeyPress==Nn||this.state.lastKeyPress==Wl)&&n.hasNewContent&&this.addUndoSnapshot()},t.prototype.onKeyPress=function(e,r){if(!r.metaKey){var n=e.getDOMSelection();n&&(n.type!="range"||!n.range.collapsed)||r.key==" "&&this.state.lastKeyPress!=" "||r.key==Vl?(this.addUndoSnapshot(),r.key==Vl&&(this.state.snapshotsManager.hasNewContent=!0)):this.clearRedoForInput(),this.state.lastKeyPress=r.key}},t.prototype.onBeforeKeyboardEditing=function(e){e.key!=this.state.lastKeyPress&&this.addUndoSnapshot(),this.state.lastKeyPress=e.key,this.state.snapshotsManager.hasNewContent=!0},t.prototype.onContentChanged=function(e){!this.state.isRestoring&&!e.skipUndo&&this.clearRedoForInput()},t.prototype.clearRedoForInput=function(){this.state.snapshotsManager.clearRedo(),this.state.lastKeyPress=null,this.state.snapshotsManager.hasNewContent=!0},t.prototype.canUndoAutoComplete=function(e){var r,n=e.getDOMSelection();return this.state.snapshotsManager.canUndoAutoComplete()&&n?.type=="range"&&n.range.collapsed&&n.range.startContainer==((r=this.state.autoCompleteInsertPoint)===null||r===void 0?void 0:r.node)&&n.range.startOffset==this.state.autoCompleteInsertPoint.offset},t.prototype.addUndoSnapshot=function(){var e;(e=this.editor)===null||e===void 0||e.takeSnapshot(),this.state.autoCompleteInsertPoint=null},t.prototype.isCtrlOrMetaPressed=function(e,r){var n=e.getEnvironment();return n.isMac?r.metaKey:r.ctrlKey},t})();function jb(t){return new Vb(t)}function qb(t,e){return{cache:qm(t,e),format:Ob(t),copyPaste:tb(t),domEvent:ab(t,e),lifecycle:Pb(t,e),entity:Tb(),selection:xb(t),contextMenu:Jm(t),undo:jb(t)}}function Xb(t,e){var r,n,a,i=qb(e,t),o=Om(e.trustedHTMLHandler);return C(C({physicalRoot:t,logicalRoot:t,api:C(C({},Ml),e.coreApiOverride),originalApi:C({},Ml),plugins:P(P([i.cache,i.format,i.copyPaste,i.domEvent,i.selection,i.entity],M(((r=e.plugins)!==null&&r!==void 0?r:[]).filter(function(s){return!!s})),!1),[i.undo,i.contextMenu,i.lifecycle],!1),environment:Yb(t,e),darkColorHandler:Mm(t,(n=e.getDarkColor)!==null&&n!==void 0?n:Qb,e.knownColors,e.generateColorKey),trustedHTMLHandler:e.trustedHTMLHandler&&!sd(e.trustedHTMLHandler)?e.trustedHTMLHandler:Dm(o),domCreator:o,domHelper:ud(t,{cloneIndependentRoot:(a=e.experimentalFeatures)===null||a===void 0?void 0:a.includes("CloneIndependentRoot")})},Jb(i)),{disposeErrorHandler:e.disposeErrorHandler,onFixUpModel:e.onFixUpModel,experimentalFeatures:e.experimentalFeatures?P([],M(e.experimentalFeatures),!1):[]})}function Yb(t,e){var r,n,a,i=(r=t.ownerDocument.defaultView)===null||r===void 0?void 0:r.navigator,o=(n=i?.userAgent)!==null&&n!==void 0?n:"",s=(a=i?.appVersion)!==null&&a!==void 0?a:"";return{domToModelSettings:Im(e),modelToDomSettings:Bm(e),isMac:s.indexOf("Mac")!=-1,isAndroid:/android/i.test(o),isIOS:/iPad|iPhone/.test(o),isSafari:o.indexOf("Safari")>=0&&o.indexOf("Chrome")<0&&o.indexOf("Android")<0,isMobileOrTablet:Zb(o)}}function Zb(t){return!!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substring(0,4)))}function Jb(t){return{domEvent:t.domEvent.getState(),copyPaste:t.copyPaste.getState(),cache:t.cache.getState(),format:t.format.getState(),lifecycle:t.lifecycle.getState(),entity:t.entity.getState(),selection:t.selection.getState(),contextMenu:t.contextMenu.getState(),undo:t.undo.getState()}}function Qb(t){return t}var $b=(function(){function t(e,r){var n=this;r===void 0&&(r={});var a;this.core=null,this.cloneOptionCallback=function(o,s){if(s!="cache"){var l=o.cloneNode(!0);if(n.isDarkMode()){var u=n.getColorManager();aa(l,!0,"darkToLight",u),l.style.color=l.style.color||"inherit",l.style.backgroundColor=l.style.backgroundColor||"inherit"}return l}},this.core=Xb(e,r);var i=(a=r.initialModel)!==null&&a!==void 0?a:Uv(this.core.format.defaultFormat);this.core.api.setContentModel(this.core,i,{ignoreSelection:!0},void 0,!0),this.core.plugins.forEach(function(o){return o.initialize(n)})}return t.prototype.dispose=function(){for(var e,r=this.getCore(),n=r.plugins.length-1;n>=0;n--){var a=r.plugins[n];try{a.dispose()}catch(i){(e=r.disposeErrorHandler)===null||e===void 0||e.call(r,a,i)}}r.darkColorHandler.reset(),this.core=null},t.prototype.isDisposed=function(){return!this.core},t.prototype.getContentModelCopy=function(e){var r=this.getCore();switch(e){case"connected":case"disconnected":return en(r.api.createContentModel(r,{tryGetFromCache:!1}),{includeCachedElement:this.cloneOptionCallback});case"clean":var n=hn(r.environment.domToModelSettings.calculated,r.api.createEditorContext(r,!1));return en(on(r.physicalRoot,n),{includeCachedElement:this.cloneOptionCallback})}},t.prototype.getEnvironment=function(){return this.getCore().environment},t.prototype.getDOMSelection=function(){var e=this.getCore();return e.api.getDOMSelection(e)},t.prototype.setDOMSelection=function(e){var r=this.getCore();r.api.setDOMSelection(r,e)},t.prototype.setLogicalRoot=function(e){var r=this.getCore();r.api.setLogicalRoot(r,e)},t.prototype.formatContentModel=function(e,r,n){var a=this.getCore();a.api.formatContentModel(a,e,r,n)},t.prototype.getPendingFormat=function(){var e,r;return(r=(e=this.getCore().format.pendingFormat)===null||e===void 0?void 0:e.format)!==null&&r!==void 0?r:null},t.prototype.getDOMHelper=function(){return this.getCore().domHelper},t.prototype.takeSnapshot=function(e){var r=this.getCore();return r.api.addUndoSnapshot(r,!1,e?[e]:void 0)},t.prototype.restoreSnapshot=function(e){var r=this.getCore();r.api.restoreUndoSnapshot(r,e)},t.prototype.getDocument=function(){return this.getCore().physicalRoot.ownerDocument},t.prototype.focus=function(){var e=this.getCore();e.api.focus(e)},t.prototype.hasFocus=function(){var e=this.getCore();return e.domHelper.hasFocus()},t.prototype.triggerEvent=function(e,r,n){n===void 0&&(n=!1);var a=this.getCore(),i=C({eventType:e},r);return a.api.triggerEvent(a,i,n),i},t.prototype.attachDomEvent=function(e){var r=this.getCore();return r.api.attachDomEvent(r,e)},t.prototype.getSnapshotsManager=function(){var e=this.getCore();return e.undo.snapshotsManager},t.prototype.isDarkMode=function(){return this.getCore().lifecycle.isDarkMode},t.prototype.setDarkModeState=function(e){var r=this.getCore();!!e!=r.lifecycle.isDarkMode&&(aa(r.physicalRoot,!1,e?"lightToDark":"darkToLight",r.darkColorHandler),r.lifecycle.isDarkMode=!!e,r.api.triggerEvent(r,{eventType:"contentChanged",source:e?Ue.SwitchToDarkMode:Ue.SwitchToLightMode,skipUndo:!0},!0))},t.prototype.isInShadowEdit=function(){return!!this.getCore().lifecycle.shadowEditFragment},t.prototype.startShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!0)},t.prototype.stopShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!1)},t.prototype.getColorManager=function(){return this.getCore().darkColorHandler},t.prototype.getTrustedHTMLHandler=function(){return this.getCore().trustedHTMLHandler},t.prototype.getDOMCreator=function(){return this.getCore().domCreator},t.prototype.getScrollContainer=function(){return this.getCore().domEvent.scrollContainer},t.prototype.getVisibleViewport=function(){return this.getCore().api.getVisibleViewport(this.getCore())},t.prototype.setEditorStyle=function(e,r,n){var a=this.getCore();a.api.setEditorStyle(a,e,r,n)},t.prototype.announce=function(e){var r=this.getCore();r.api.announce(r,e)},t.prototype.isExperimentalFeatureEnabled=function(e){return this.getCore().experimentalFeatures.indexOf(e)>=0},t.prototype.getCore=function(){if(!this.core)throw new Error("Editor is already disposed");return this.core},t})();function fo(t){t.focus();var e=t.getSnapshotsManager(),r=e.move(1);r&&t.restoreSnapshot(r)}function Nr(t,e){if(!t||!t.tag)return null;var r=t.tag,n=t.namespace,a=t.className,i=t.style,o=t.dataset,s=t.attributes,l=t.children,u=n?e.createElementNS(n,r):e.createElement(r);return i&&u.setAttribute("style",i),a&&(u.className=a),o&&L(u,"ELEMENT_NODE")&&ie(o).forEach(function(d){u.dataset[d]=o[d]}),s&&ie(s).forEach(function(d){u.setAttribute(d,s[d])}),l&&l.forEach(function(d){if(typeof d=="string")u.appendChild(e.createTextNode(d));else if(d){var f=Nr(d,e);f&&u.appendChild(f)}}),u}var ey=(function(){return{MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEUP:"mouseup",getPageXY:ty}})(),jl=(function(){return{MOUSEDOWN:"touchstart",MOUSEMOVE:"touchmove",MOUSEUP:"touchend",getPageXY:ry}})();function ty(t){return[t.pageX,t.pageY]}function ry(t){var e=0,r=0;if(t.targetTouches&&t.targetTouches.length>0){var n=t.targetTouches[0];e=n.pageX,r=n.pageY}return[e,r]}var vo=(function(){function t(e,r,n,a,i,o){var s=this;this.trigger=e,this.context=r,this.onSubmit=n,this.handler=a,this.zoomScale=i,this.initX=0,this.initY=0,this.initValue=void 0,this.onMouseDown=function(l){var u,d,f;l.preventDefault(),l.stopPropagation(),s.addDocumentEvents(),u=M(s.dndMouse.getPageXY(l),2),s.initX=u[0],s.initY=u[1],s.initValue=(f=(d=s.handler).onDragStart)===null||f===void 0?void 0:f.call(d,s.context,l)},this.onMouseMove=function(l){var u,d,f;l.preventDefault();var h=M(s.dndMouse.getPageXY(l),2),v=h[0],c=h[1],p=(v-s.initX)/s.zoomScale,g=(c-s.initY)/s.zoomScale;s.initValue&&(!((d=(u=s.handler).onDragging)===null||d===void 0)&&d.call(u,s.context,l,s.initValue,p,g))&&((f=s.onSubmit)===null||f===void 0||f.call(s,s.context,s.trigger))},this.onMouseUp=function(l){var u,d,f;l.preventDefault(),s.removeDocumentEvents(),!((d=(u=s.handler).onDragEnd)===null||d===void 0)&&d.call(u,s.context,l,s.initValue)&&((f=s.onSubmit)===null||f===void 0||f.call(s,s.context,s.trigger))},this.dndMouse=o?jl:ey,e.addEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown)}return t.prototype.dispose=function(){this.trigger.removeEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown),this.removeDocumentEvents()},Object.defineProperty(t.prototype,"mouseType",{get:function(){return this.dndMouse==jl?"touch":"mouse"},enumerable:!1,configurable:!0}),t.prototype.addDocumentEvents=function(){var e=this.trigger.ownerDocument;e.addEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.addEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},t.prototype.removeDocumentEvents=function(){var e=this.trigger.ownerDocument;e.removeEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.removeEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},t})();function co(t,e){var r=Fr(),n=cn({zoomScale:t.getDOMHelper().calculateZoomScale(),recalculateTableSize:!0});n.elementProcessors.element(r,e,n);var a=r.blocks[0];return a?.blockType=="Table"?a:void 0}var va=4,ny="horizontalResizer",ay="verticalResizer";function ql(t,e,r,n,a,i,o,s,l){var u=e.ownerDocument,d={tag:"div",style:"position: fixed; cursor: "+(a?"row":"col")+"-resize; user-select: none"},f=t.getDOMHelper().calculateZoomScale(),h=Nr(d,u);(s||u.body).appendChild(h);var v={editor:t,td:e,table:r,isRTL:n,zoomScale:f,onStart:i,originalWidth:Ke(r.style.width)},c=a?uy:dy;c(v,h);var p={onDragStart:oy,onDragging:a?ly:sy,onDragEnd:o},g=new iy(h,v,c,p,f,t.getEnvironment().isMobileOrTablet,l);return{node:e,div:h,featureHandler:g}}var iy=(function(t){Li(e,t);function e(r,n,a,i,o,s,l){var u=t.call(this,r,n,a,i,o,s)||this;return u.disposer=l?.("CellResizer",r),u}return e.prototype.dispose=function(){var r;(r=this.disposer)===null||r===void 0||r.call(this),this.disposer=void 0,t.prototype.dispose.call(this)},e})(vo);function oy(t,e){var r=t.td,n=t.onStart,a=Te(r.getBoundingClientRect()),i=r.cellIndex,o=r.parentElement&&ae(r.parentElement,"tr")?r.parentElement:void 0,s=o?.rowIndex;if(s==null)return{cmTable:void 0,anchorColumn:void 0,anchorRow:void 0,anchorRowHeight:-1,allWidths:[]};var l=t.editor,u=t.table,d=co(l,u);return a&&d?(n(),{cmTable:d,anchorColumn:i,anchorRow:s,anchorRowHeight:d.rows[s].height,allWidths:P([],M(d.widths),!1)}):{cmTable:d,anchorColumn:void 0,anchorRow:void 0,anchorRowHeight:-1,allWidths:[]}}function ly(t,e,r,n,a){var i=t.table,o=r.cmTable,s=r.anchorRow,l=r.anchorRowHeight;if(o&&s!=null&&o.rows[s]!=null){w(o).rows[s].height=(l??0)+a;for(var u=Math.max(o.rows[s].height,tn),d=i.rows[s],f=0;f<d.cells.length;f++){var h=d.cells[f];h.style.height=u+"px",h.style.boxSizing="border-box"}return!0}else return!1}function sy(t,e,r,n){var a=t.table,i=t.isRTL,o=r.cmTable,s=r.anchorColumn,l=r.allWidths;if(o&&s!=null){var u=w(o),d=s==o.widths.length-1,f=n*(i?-1:1);if(d){var h=Math.max(l[s]+f,Yr);u.widths[s]=h}else{var v=l[s]+f,c=l[s+1]-f;if(v<Yr||c<Yr)return!1;u.widths[s]=v,u.widths[s+1]=c}for(var p=0;p<a.rows.length;p++)for(var g=a.rows[p],b=0;b<g.cells.length;b++){var y=g.cells[b];y.style.width=o.widths[b]+"px",y.style.boxSizing="border-box"}if(t.originalWidth>0){var h=t.originalWidth+f+"px";u.format.width=h,a.style.width=h}return!0}else return!1}function uy(t,e){var r=t.td,n=Te(r.getBoundingClientRect());n&&(e.id=ny,e.style.top=n.bottom-va+"px",e.style.left=n.left+"px",e.style.width=n.right-n.left+"px",e.style.height=va+"px")}function dy(t,e){var r=t.td,n=t.isRTL,a=Te(r.getBoundingClientRect());a&&(e.id=ay,e.style.top=a.top+"px",e.style.left=(n?a.left:a.right)-va+1+"px",e.style.width=va+"px",e.style.height=a.bottom-a.top+"px")}function fy(t,e){e===void 0&&(e=[]);var r=t.map(function(a){return Te(a.getBoundingClientRect())}).concat(e).filter(function(a){return!!a}),n={top:Math.max.apply(Math,P([],M(r.map(function(a){return a.top})),!1)),bottom:Math.min.apply(Math,P([],M(r.map(function(a){return a.bottom})),!1)),left:Math.max.apply(Math,P([],M(r.map(function(a){return a.left})),!1)),right:Math.min.apply(Math,P([],M(r.map(function(a){return a.right})),!1))};return n.top<n.bottom&&n.left<n.right?n:null}var vy=" ",cy=" ",hy=" ",nn=40;function kd(t){var e=py(t),r=Math.floor(e/4);return r}function py(t){var e,r,n=0;try{for(var a=At(t),i=a.next();!i.done;i=a.next()){var o=i.value;if(o===vy||o===hy||o==cy)n++;else break}}catch(s){e={error:s}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return n}function gy(t){var e=t.blocks[0];if(e.blockType=="Paragraph"&&e.segments.length>0&&e.segments[0].segmentType=="Text"){var r=kd(e.segments[0].text);r>0&&(at(e,e.segments[0],function(n){n.text=n.text.substring(r*4)}),t.levels[0].format.marginLeft=r*nn+"px")}}function my(t,e){var r=t.paragraph,n=t.marker,a=by(r);a&&(t.paragraph.segments=[n],t.paragraph.format.direction=="rtl"?e.format.marginRight=a*nn+"px":e.format.marginLeft=a*nn+"px")}var by=function(t){var e,r,n=0,a=t.segments,i=t.segments.every(function(d){return d.segmentType=="Text"&&d.text.trim().length==0||d.segmentType=="SelectionMarker"||d.segmentType=="Br"});if(i){var o=0;try{for(var s=At(a),l=s.next();!l.done;l=s.next()){var u=l.value;if(u.segmentType==="Text")n=n+kd(u.text),o++;else break}}catch(d){e={error:d}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}if(a.length-2<=o)return n}};function yy(t,e,r){var n=au(r);return ze(t,n),n.rows.forEach(function(a){for(var i=0;i<e;i++){var o=Nt();a.cells.push(o)}}),n}function Ey(t,e,r,n){t.focus(),t.formatContentModel(function(a,i){var o,s,l,u=Ar(a,[],i).insertPoint;if(u){var d=Fr(),f=yy(d,e,r);Da(f,t.getPendingFormat()||u.marker.format),my(u,f),n=n||{verticalAlign:"top"},Ma(f,n),ao(a,d,i,{insertPosition:u,mergeFormat:"mergeAll"});var h=(s=(o=f.rows[0])===null||o===void 0?void 0:o.cells[0])===null||s===void 0?void 0:s.blocks[0];if(h?.blockType=="Paragraph"){var v=He((l=h.segments[0])===null||l===void 0?void 0:l.format);h.segments.unshift(v),Et(a,v)}return!0}else return!1},{apiName:"insertTable"})}function _d(t,e){t.format.marginLeft=e=="alignLeft"?"":"auto",t.format.marginRight=e=="alignRight"?"":"auto"}function Cy(t){t.rows=[]}function Md(t,e){var r,n=e.firstColumn,a=e.firstRow,i=(r=t[a])===null||r===void 0?void 0:r.cells[n];i&&it(w(i),He())}function Sy(t){var e=mt(t);if(e){for(var r=0;r<t.rows.length;r++){var n=t.rows[r].cells[e.lastColumn+1];n&&(w(n).spanLeft=n.spanLeft&&t.rows[r].cells[e.firstColumn].spanLeft),t.rows[r].cells.splice(e.firstColumn,e.lastColumn-e.firstColumn+1)}t.widths.splice(e.firstColumn,e.lastColumn-e.firstColumn+1),Md(t.rows,e)}}function Ty(t){var e=mt(t);e&&(t.rows[e.firstRow].cells.forEach(function(r,n){var a,i=(a=t.rows[e.lastRow+1])===null||a===void 0?void 0:a.cells[n];i&&(w(i).spanAbove=i.spanAbove&&r.spanAbove)}),t.rows.splice(e.firstRow,e.lastRow-e.firstRow+1),Md(t.rows,e))}function wy(t,e,r){var n,a,i,o=(n=r.rows.filter(function(d){return d.cells.length>0})[0])===null||n===void 0?void 0:n.cells[0];if(o)i=o.blocks.filter(function(d){return d.blockType=="Paragraph"})[0],i||(i=Xl(t),w(o).blocks.push(i));else{var s=r,l;for(i=Xl(t);l=e.shift();){var u=(a=l.blocks.indexOf(s))!==null&&a!==void 0?a:-1;if(l&&u>=0&&w(l).blocks.splice(u,1,i),l.blockGroupType=="FormatContainer"&&l.blocks.length==1&&l.blocks[0]==i)s=l;else break}}return i}function Xl(t){var e=Ge(!1,void 0,t.format),r=zt(t.format);return e.segments.push(r),e}function Dd(t,e,r,n){t.focus(),t.formatContentModel(function(a){var i=M(Qr(a),2),o=i[0],s=i[1];if(o){var l=w(o);if(r(l),!wa(l)){var u=wy(a,s,l);if(u){var d=He(a.format);u.segments.unshift(d),Xe(u),Et(a,d)}}return Da(l,a.format),ou(l)&&Ma(l,void 0,!0),!0}else return!1},{apiName:e,selectionOverride:n},{recalculateTableSize:"selected"})}function ho(t,e){if(e.firstColumn>=0&&e.firstRow>=0&&e.lastRow<t.rows.length&&e.lastColumn<t.rows[e.lastRow].cells.length)for(var r=e.firstRow;r<=e.lastRow;r++)for(var n=t.rows[r],a=e.firstColumn;a<=e.lastColumn;a++){var i=n.cells[a];i&&(i.isSelected&&(w(i).isSelected=!1),Et(i))}}function Od(t,e){var r=mt(t),n=e=="insertLeft";if(r){ho(t,r);for(var a=r?.firstColumn;a<=r.lastColumn;a++)t.rows.forEach(function(i){var o=i.cells[n?r.firstColumn:r.lastColumn],s=Nt(o.spanLeft,o.spanAbove,o.isHeader,o.format,o.dataset);s.isSelected=!0,i.cells.splice(n?r.firstColumn:r.lastColumn+1,0,s)}),t.widths.splice(n?r.firstColumn:r.lastColumn+1,0,t.widths[n?r.firstColumn:r.lastColumn])}}function po(t,e){var r=mt(t),n=e=="insertAbove";if(r){ho(t,r);for(var a=r.firstRow;a<=r.lastRow;a++){var i=t.rows[n?r.firstRow:r.lastRow];t.rows.splice(n?r.firstRow:r.lastRow+1,0,{format:C({},i.format),cells:i.cells.map(function(o){var s=Nt(o.spanLeft,o.spanAbove,o.isHeader,o.format,o.dataset);return s.isSelected=!0,s}),height:i.height})}}}function go(t,e,r,n,a){var i=r==a||t[e].cells.every(function(u,d){return d<r||d>a||!u.spanAbove}),o=e==n||t.every(function(u,d){return d<e||d>n||!u.cells[r].spanLeft}),s=t[n].cells.map(function(u,d){return d>=r&&d<=a?ky(t,n,d):-1}).every(function(u,d,f){return u<0||u==f[r]}),l=t.map(function(u,d){return d>=e&&d<=n?_y(t,d,a):-1}).every(function(u,d,f){return u<0||u==f[e]});return i&&o&&s&&l}function ky(t,e,r){for(var n,a,i=0,o=e+1;o<t.length&&(!((a=(n=t[o])===null||n===void 0?void 0:n.cells[r])===null||a===void 0)&&a.spanAbove);o++)i++;return i}function _y(t,e,r){for(var n,a,i,o=0,s=r+1;s<((n=t[e])===null||n===void 0?void 0:n.cells.length)&&(!((i=(a=t[e])===null||a===void 0?void 0:a.cells[s])===null||i===void 0)&&i.spanLeft);s++)o++;return o}function My(t){var e=mt(t);if(e&&go(t.rows,e.firstRow,e.firstColumn,e.lastRow,e.lastColumn))for(var r=e.firstRow;r<=e.lastRow;r++)for(var n=e.firstColumn;n<=e.lastColumn;n++){var a=t.rows[r].cells[n];if(a){var i=w(a);i.spanLeft=n>e.firstColumn,i.spanAbove=r>e.firstRow}}}function Dy(t,e){var r,n,a,i,o=mt(t),s=e=="mergeLeft";if(o){var l=s?o.firstColumn:o.lastColumn+1;if(l>0&&l<t.rows[0].cells.length)for(var u=o.firstRow;u<=o.lastRow;u++){var d=(r=t.rows[u])===null||r===void 0?void 0:r.cells[l];if(d&&go(t.rows,u,l-1,u,l)){w(d).spanLeft=!0;for(var f=l;!((a=(n=t.rows[u])===null||n===void 0?void 0:n.cells[f])===null||a===void 0)&&a.spanLeft;)w(t.rows[u].cells[f]),f--;var h=(i=t.rows[u])===null||i===void 0?void 0:i.cells[f];h&&(w(h).isSelected=!0)}}}}function Oy(t,e){var r,n,a,i=mt(t),o=e=="mergeAbove";if(i){var s=o?i.firstRow:i.lastRow+1;if(s>0&&s<t.rows.length)for(var l=i.firstColumn;l<=i.lastColumn;l++){var u=t.rows[s].cells[l];if(u&&go(t.rows,s-1,l,s,l)){w(u).spanAbove=!0;for(var d=s;!((n=(r=t.rows[d])===null||r===void 0?void 0:r.cells[l])===null||n===void 0)&&n.spanAbove;)w(t.rows[d].cells[l]),d--;var f=(a=t.rows[d])===null||a===void 0?void 0:a.cells[l];f&&(w(f).isSelected=!0)}}}}var Ly=30;function Ry(t){var e=mt(t);if(e)for(var r=function(a){if(t.rows.every(function(o,s){var l;return s<e.firstRow||s>e.lastRow||((l=o.cells[a+1])===null||l===void 0?void 0:l.spanLeft)}))t.rows.forEach(function(o,s){w(o.cells[a]),s>=e.firstRow&&s<=e.lastRow&&(w(o.cells[a+1]).spanLeft=!1)});else{t.rows.forEach(function(o,s){var l=o.cells[a];if(l){var u=w(l);delete u.format.width;var d=Nt(l.spanLeft,l.spanAbove,l.isHeader,u.format);d.dataset=C({},l.dataset),s<e.firstRow||s>e.lastRow?d.spanLeft=!0:d.isSelected=l.isSelected,o.cells.splice(a+1,0,d),w(o.cells[a])}});var i=Math.max(t.widths[a]/2,Ly);t.widths.splice(a,1,i,i)}},n=e.lastColumn;n>=e.firstColumn;n--)r(n)}var Fy=22;function Py(t){var e=mt(t);if(e)for(var r=e.lastRow;r>=e.firstRow;r--){var n=t.rows[r],a=t.rows[r+1];if(n.cells.forEach(w),a?.cells.every(function(s,l){return l<e.firstColumn||l>e.lastColumn||s.spanAbove}))a.cells.forEach(function(s,l){l>=e.firstColumn&&l<=e.lastColumn&&(w(s).spanAbove=!1)});else{var i=Math.max(n.height/=2,Fy),o={format:C({},n.format),height:i,cells:n.cells.map(function(s,l){var u=w(s);delete u.format.height;var d=Nt(s.spanLeft,s.spanAbove,s.isHeader,u.format);return d.dataset=C({},s.dataset),l<e.firstColumn||l>e.lastColumn?d.spanAbove=!0:d.isSelected=s.isSelected,d})};n.height=i,t.rows.splice(r+1,0,o)}}}var Ay={alignCellLeft:"start",alignCellCenter:"center",alignCellRight:"end"},Ny={alignCellTop:"top",alignCellMiddle:"middle",alignCellBottom:"bottom"};function Iy(t,e){Ld(t,function(r){r.format.textAlign=Ay[e]})}function By(t,e){Ld(t,function(r){r.format.verticalAlign=Ny[e],ro(r,function(n){return n=n||{},n.vAlignOverride=!0,n})})}function Ld(t,e){var r,n=mt(t);if(n)for(var a=n.firstRow;a<=n.lastRow;a++)for(var i=n.firstColumn;i<=n.lastColumn;i++){var o=(r=t.rows[a])===null||r===void 0?void 0:r.cells[i],s=o?.format;s&&(e(w(o)),o.blocks.forEach(function(l){l.blockType==="Paragraph"&&l.format.textAlign&&delete w(l).format.textAlign}))}}function vr(t,e){t.focus(),Hy(t),Dd(t,"editTable",function(r){switch(e){case"alignCellLeft":case"alignCellCenter":case"alignCellRight":Iy(r,e);break;case"alignCellTop":case"alignCellMiddle":case"alignCellBottom":By(r,e);break;case"alignCenter":case"alignLeft":case"alignRight":_d(r,e);break;case"deleteColumn":Sy(r);break;case"deleteRow":Ty(r);break;case"deleteTable":Cy(r);break;case"insertAbove":case"insertBelow":po(r,e);break;case"insertLeft":case"insertRight":Od(r,e);break;case"mergeAbove":case"mergeBelow":Oy(r,e);break;case"mergeCells":My(r);break;case"mergeLeft":case"mergeRight":Dy(r,e);break;case"splitHorizontally":Ry(r);break;case"splitVertically":Py(r);break}})}function Hy(t){if(t.getEnvironment().isSafari){var e=t.getDOMSelection();e?.type=="range"&&!e.range.collapsed&&(e.range.collapse(!0),t.setDOMSelection({type:"range",range:e.range,isReverted:!1}))}}function mo(t){var e,r,n,a,i,o=pn(t,!1,!1);try{for(var s=At(o),l=s.next();!l.done;l=s.next()){var u=M(l.value,3),d=u[0],f=u[1],h=u[2];if(f?.segments.some(function(T){return T.segmentType=="Br"})){var v=Yl(f),c=!1,p=[],g=w(h[0]),b=g.blocks.indexOf(f);if(b>=0){try{for(var y=(n=void 0,At(w(f).segments)),E=y.next();!E.done;E=y.next()){var S=E.value;S.segmentType=="Br"?(c||v.segments.push(S),v.segments.length>0&&p.push(v),v=Yl(f),c=!1):(v.segments.push(S),S.segmentType!="SelectionMarker"&&(c=!0))}}catch(T){n={error:T}}finally{try{E&&!E.done&&(a=y.return)&&a.call(y)}finally{if(n)throw n.error}}v.segments.length>0&&p.push(v),(i=g.blocks).splice.apply(i,P([b,1],M(p),!1))}}}}catch(T){e={error:T}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}}function Yl(t){return Ge(!1,t.format,t.segmentFormat,t.decorator)}function Rd(t,e,r){r===void 0&&(r=!1),mo(t);var n=gn(t,["ListItem"],[]),a=n.every(function(o){var s,l=o.block;return gt(l,"ListItem")?((s=l.levels[l.levels.length-1])===null||s===void 0?void 0:s.listType)==e:Zl(l)}),i=[];return n.forEach(function(o,s){var l,u,d=o.block,f=o.parent;if(gt(d,"ListItem")){var h=d.levels.pop();!a&&h?(h.listType=e,sa(h,function(E){return Object.assign({},E,{applyListStyleFromLevel:!0})}),d.levels.push(h)):d.blocks.length==1&&Xe(d.blocks[0]),a&&d.blocks.forEach(function(E){Sr(E.format,d.format,Fi)})}else{var v=f.blocks.indexOf(d);if(v>=0)if(n.length==1||!Zl(d)){var c=f.blocks[v-1],p=d.blockType=="Paragraph"&&((l=d.segments[0])===null||l===void 0?void 0:l.format)||{},g=fn([sr(e,{startNumberOverride:s>0||c?.blockType=="BlockGroup"&&c.blockGroupType=="ListItem"&&((u=c.levels[0])===null||u===void 0?void 0:u.listType)=="OL"?void 0:1,direction:d.format.direction,textAlign:d.format.textAlign,marginBottom:r?"0px":void 0,marginTop:r?"0px":void 0})],{fontFamily:p.fontFamily,fontSize:p.fontSize,textColor:p.textColor});d.blockType=="Paragraph"&&Xe(d);var b=w(d);g.blocks.push(b),gy(g),Sr(g.format,b.format,Xs,!0),Sr(g.format,b.format,Ys),w(f).blocks.splice(v,1,g),i.push(g);var y=g.levels.length-1,h=w(g).levels[y];h&&sa(h,function(S){return Object.assign({},S,{applyListStyleFromLevel:!0})})}else i.forEach(function(E){return w(E).levels[0].format.marginBottom="0px"}),i=[]}}),ht(t),n.length>0}function Zl(t){switch(t.blockType){case"Table":return!1;case"Paragraph":return t.segments.every(function(e){return e.segmentType=="Br"||e.segmentType=="SelectionMarker"});default:return!0}}function Fd(t,e){e===void 0&&(e=!1),t.focus(),t.formatContentModel(function(r,n){return n.newPendingFormat="preserve",Rd(r,"UL",e)},{apiName:"toggleBullet"})}function Pd(t,e){e===void 0&&(e=!1),t.focus(),t.formatContentModel(function(r,n){return n.newPendingFormat="preserve",Rd(r,"OL",e)},{apiName:"toggleNumbering"})}function Ad(t,e){var r;Qe(t,function(u,d,f,h){return f?.blockType=="Paragraph"&&h?.length==1&&h[0]==e&&(r=w(f)),!0});var n=r?P([],M(r.segments),!1):void 0;if(n&&r){for(var a=[],i=n.indexOf(e),o=i-1;o>=0;o--){var s=n[o];if(s.segmentType=="Text"){var l=Jl(s,!1);if(l>-1){if(l==s.text.length)break;Ql(n,s,o,l),a.push(n[o+1]);break}else a.push(n[o])}else break}if(i=n.indexOf(e),a.push(e),a.length<=1)return a;for(var o=i+1;o<n.length;o++){var s=n[o];if(s.segmentType=="Text"){var l=Jl(s,!0);if(l>-1){if(l==0)break;Ql(n,s,o,l),a.push(n[o]);break}else a.push(n[o])}else break}return a[a.length-1]==e?[e]:(r.segments=n,a)}else return[e]}function Jl(t,e){var r=t.text,n=-1;if(e)for(var a=0;a<r.length;a++){var i=r[a];if(ra(i)||na(i)){n=a;break}}else for(var a=r.length-1;a>=0;a--){var i=r[a];if(ra(i)||na(i)){n=a+1;break}}return n}function Ql(t,e,r,n){var a=e.text,i=xe(a.substring(0,n),e.format,e.link,e.code),o=xe(a.substring(n,a.length),e.format,e.link,e.code);t.splice(r,1,i,o)}function Nd(t,e){var r,n=t.getDOMHelper(),a={isDarkMode:t.isDarkMode(),defaultFormat:C({},e.format),darkColorHandler:t.getColorManager(),addDelimiterForEntity:!1,allowCacheElement:!1,domIndexer:void 0,zoomScale:n.calculateZoomScale(),experimentalFeatures:[]};return((r=t.getDocument().defaultView)===null||r===void 0?void 0:r.getComputedStyle(e.wrapper).direction)=="rtl"&&(a.isRootRtl=!0),a}function Yt(t,e,r,n,a,i){t.formatContentModel(function(o,s){var l=pn(o,!!a,!0,!0),u=l.length>=1&&l.every(function(p){return p[0].segmentType=="SelectionMarker"});if(u){var d=l[0][1],f=l[0][2];l=Ad(o,l[0][0]).map(function(p){return[p,d,f]}),l.length>1&&(u=!1)}var h=[],v=[];l.forEach(function(p){p[0].segmentType=="Entity"?zy(t,p[0],h,v):h.push([p[0].format,p[0],p[1]])});var c=n?h.every(function(p){var g=M(p,3),b=g[0],y=g[1],E=g[2];return n(b,y,E)}):!1;return h.forEach(function(p){var g=M(p,3),b=g[0],y=g[1],E=g[2];r(b,!c,y,E)}),i?.(o,c,s),h.forEach(function(p){var g=M(p,3);g[0],g[1];var b=g[2];b&&Gv(b)}),xy(t,v),u?(s.newPendingFormat=l[0][0].format,t.focus(),!1):h.length>0},{apiName:e})}function zy(t,e,r,n){var a=e.entityFormat,i=a.id,o=a.entityType,s=a.isReadonly;if(i&&o){var l=[],u={entity:{id:i,type:o,isReadonly:!!s,wrapper:e.wrapper},operation:"beforeFormat",formattableRoots:l};t.triggerEvent("entityOperation",u),l.forEach(function(d){if(e.wrapper.contains(d.element)){var f=Nd(t,e),h=cn(f,d.domToModelOptions);h.isInSelection=!0;var v=on(d.element,h),c=pn(v,!1,!1,!0);c.forEach(function(p){r.push([p[0].format,p[0],p[1]])}),n.push([e,d,v])}})}}function xy(t,e){e.forEach(function(r){var n=M(r,3),a=n[0],i=n[1],o=n[2],s=Nd(t,a),l=Sa(s,i.modelToDomOptions);Ii(t.getDocument(),i.element,o,l)})}function Id(t,e){t.focus(),Yt(t,"toggleBold",function(r,n){r.fontWeight=n?"bold":"normal"},function(r,n,a){var i;return Lu(typeof r.fontWeight>"u"?(i=a?.decorator)===null||i===void 0?void 0:i.format.fontWeight:r.fontWeight)},void 0,function(r,n,a){e?.announceFormatChange&&(a.announceData={defaultStrings:n?"announceBoldOff":"announceBoldOn"})})}function Bd(t,e){t.focus(),Yt(t,"toggleItalic",function(r,n){r.italic=!!n},function(r){return!!r.italic},void 0,function(r,n,a){e?.announceFormatChange&&(a.announceData={defaultStrings:n?"announceItalicOff":"announceItalicOn"})})}function Hd(t,e){t.focus(),Yt(t,"toggleUnderline",function(r,n,a){r.underline=!!n,a?.link&&(a.link.format.underline=!!n)},function(r,n){var a,i;return!!r.underline||!!(!((i=(a=n?.link)===null||a===void 0?void 0:a.format)===null||i===void 0)&&i.underline)},!1,function(r,n,a){e?.announceFormatChange&&(a.announceData={defaultStrings:n?"announceUnderlineOff":"announceUnderlineOn"})})}function Uy(t){t.focus(),Yt(t,"toggleStrikethrough",function(e,r){e.strikethrough=!!r},function(e){return!!e.strikethrough})}function Gy(t,e){t.focus();var r=null,n=-1;Yt(t,"setBackgroundColor",function(a,i,o,s){e===null?delete a.backgroundColor:a.backgroundColor=e,o&&s&&o.segmentType!="SelectionMarker"&&(r=s,n=r.segments.indexOf(o))},void 0,void 0,function(a){var i;if(r&&n>=0){var o=He((i=r.segments[n])===null||i===void 0?void 0:i.format);r.segments.splice(n+1,0,o),Et(a,o,o)}})}function Ky(t,e){t.focus(),Yt(t,"setFontSize",function(r,n,a,i){return zd(e,r,i)},void 0,!0)}function zd(t,e,r){var n;if(e.fontSize=t,!((n=r?.segmentFormat)===null||n===void 0)&&n.fontSize){var a=r.segmentFormat.fontSize;r.segments.forEach(function(i){i.format.fontSize||(i.format.fontSize=a)}),delete r.segmentFormat.fontSize}}function Wy(t,e){t.focus(),Yt(t,"setTextColor",e===null?function(r,n,a){delete r.textColor,a?.link&&delete a.link.format.textColor}:function(r,n,a){r.textColor=e,a?.link&&(a.link.format.textColor=e)},void 0,!0)}var Vy=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],jy=1,qy=1e3;function xd(t,e,r){r===void 0&&(r=Vy),t.focus(),Yt(t,"changeFontSize",function(n,a,i,o){return Xy(e,n,o,r)},void 0,!0)}function Xy(t,e,r,n){if(e.fontSize){var a=Ke(e.fontSize,void 0,"pt");if(a>0){var i=Yy(a,t=="increase"?1:-1,n);zd(i+"pt",e,r)}}}function Yy(t,e,r){t=e==1?Math.floor(t):Math.ceil(t);var n=r[r.length-1];if(t<=r[0])t=Math.max(t+e,jy);else if(t>n||t==n&&e==1)t=t/10,t=e==1?Math.floor(t):Math.ceil(t),t=Math.min(Math.max((t+e)*10,n),qy);else if(e==1){for(var a=0;a<r.length;a++)if(t<r[a]){t=r[a];break}}else for(var a=r.length-1;a>=0;a--)if(t>r[a]){t=r[a];break}return t}function Zy(t,e,r,n){var a,i=t.text,o=e.segments.indexOf(t),s=xe(i.substring(r,n),t.format,t.link,t.code),l=[s];return r>0&&l.unshift(xe(i.substring(0,r),t.format,t.link,t.code)),n<i.length&&l.push(xe(i.substring(n),t.format,t.link,t.code)),l.forEach(function(u){return u.isSelected=t.isSelected}),(a=e.segments).splice.apply(a,P([o,1],M(l),!1)),s}function bo(t,e){var r=[];return qn(t,r),Jy(r,e)}function qn(t,e){t.blocks.forEach(function(r){switch(r.blockType){case"BlockGroup":r.blockGroupType=="ListItem"?e.push(r):(cr(e),qn(r,e),cr(e));break;case"Paragraph":cr(e),r.segments.forEach(function(n){n.segmentType=="General"&&qn(n,e)}),cr(e);break;case"Table":cr(e),r.rows.forEach(function(n){return n.cells.forEach(function(a){qn(a,e)})}),cr(e);break}})}function cr(t){var e=t[t.length-1];(!e||e!==null)&&t.push(null)}function Jy(t,e){var r,n=[],a=t.indexOf(e),i=e.levels.length,o=((r=e.levels[i-1])===null||r===void 0?void 0:r.listType)=="OL";if(a>=0){for(var s=a;s>=0;s--){var l=t[s];if(!l){if(o)continue;break}var u=es(l,i);if($l(t,a,s)){if(n.unshift(l),o&&u)break}else if(!o||u||l.levels.length<e.levels.length)break}for(var s=a+1;s<t.length;s++){var l=t[s];if(!l){if(o)continue;break}var u=es(l,i);if($l(t,a,s)&&!u)n.push(l);else if(!o||u||l.levels.length<e.levels.length)break}}return n}function $l(t,e,r){var n=t[e].levels,a=t[r].levels;return n.length<=a.length&&n.every(function(i,o){return i.listType==a[o].listType})}function es(t,e){return t.levels.slice(0,e).some(function(r){return r.format.startNumberOverride!==void 0})}function Ud(t){var e=Je(t,["ListItem"],["TableCell"]);if(e>=0){var r=t[e],n=r.levels[r.levels.length-1];if(!n||n.format.displayForDummyItem)return null;if(n.listType=="OL"){var a=Qy(t,r),i=Fg(n),o=Qi("OL",i??{},r.levels.length-1,n.format.listStyleType);return o===void 0?null:{defaultStrings:"announceListItemNumbering",formatStrings:[Ji(o,a)]}}else return{defaultStrings:"announceListItemBullet"}}else return null}function Qy(t,e){for(var r,n,a=bo(t[t.length-1],e),i=0,o=0;o<a.length;o++){var s=a[o];if(i==0&&s.levels.length==e.levels.length&&(i=(n=(r=s.levels[s.levels.length-1])===null||r===void 0?void 0:r.format.startNumberOverride)!==null&&n!==void 0?n:1),s==e)break;if(s.levels.length<e.levels.length)i=0;else{if(s.levels.length>e.levels.length)continue;s.levels[s.levels.length-1].format.displayForDummyItem||i++}}return i}function Ir(t,e,r,n){r===void 0&&(r=nn),mo(t);var a=gn(t,["ListItem"],["TableCell"]),i=e=="indent",o=[];return a.forEach(function(s){var l=s.block,u=s.parent,d=s.path;if(gt(l,"ListItem")){var f=bo(t,l),h=f[0];if(_i(h)&&h.levels.length==1){var v=l.levels[0],c=v.format,p=c.marginLeft,g=c.marginRight,b=ts(c,i,r),y=c.direction=="rtl",E=Ke(y?g:p);!i&&E==0?l.levels.pop():b!==null&&(y?v.format.marginRight=b+"px":v.format.marginLeft=b+"px")}else if(l.levels.length==1||!$y(t,l,u)){if(i){var S=f.indexOf(l),T=f[S-1],k=f[S+1],R=l.levels.length,H=l.levels[R-1],U=sr(H?.listType||"UL",H?.format,T&&T.levels.length>R?T.levels[R].dataset:k&&k.levels.length>R?k.levels[R].dataset:void 0);sa(U,function(x){return x=x||{},x.applyListStyleFromLevel=!0,x}),delete U.format.startNumberOverride,l.levels.push(U)}else l.levels.pop();l.levels.length>0&&n&&(n.announceData=Ud(P([l],M(d),!1)))}}else if(l)for(var q=l,W=u;W&&o.indexOf(q)<0;){var J=d.indexOf(W),c=w(q).format,b=ts(c,i,r);if(b!==null){var y=c.direction=="rtl";y?c.marginRight=b+"px":c.marginLeft=b+"px",o.push(q);break}else if(W.blockGroupType=="FormatContainer"&&J>=0)w(W),q=W,W=d[J+1];else break}}),a.length>0}function _i(t){return t.blocks.some(function(e){if(e.blockType=="Paragraph")return e.segments.some(function(r){return r.isSelected})})}function $y(t,e,r){for(var n=r.blocks.indexOf(e),a=n-1;a>=0;a--){var i=r.blocks[a];if(gt(i,"ListItem")&&i.levels.length==1&&_i(i)){var o=bo(t,i)[0];return _i(o)}if(!gt(i,"ListItem"))return!1}return!1}function ts(t,e,r){r===void 0&&(r=nn);var n=t.marginLeft,a=t.marginRight,i=t.direction,o=i=="rtl",s=Ke(o?a:n),l=(e?Math.ceil:Math.floor)(s/r)*r;return l==s&&(l=Math.max(l+r*(e?1:-1),0)),l==s?null:l}var e1={left:{ltr:"start",rtl:"end"},center:{ltr:"center",rtl:"center"},right:{ltr:"end",rtl:"start"},justify:{ltr:"justify",rtl:"justify"}},t1={left:{ltr:"alignLeft",rtl:"alignRight"},center:{ltr:"alignCenter",rtl:"alignCenter"},right:{ltr:"alignRight",rtl:"alignLeft"}};function r1(t,e){mo(t);var r=gn(t,["ListItem"],["TableCell"]);return r.forEach(function(n){var a=n.block,i=w(a),o=e1[e][i.format.direction=="rtl"?"rtl":"ltr"];if(i.blockType==="Table"&&e!=="justify")_d(i,t1[e][i.format.direction=="rtl"?"rtl":"ltr"]);else if(i){i.blockType==="BlockGroup"&&i.blockGroupType==="ListItem"&&i.blocks.forEach(function(l){var u=w(l).format;u.textAlign=o});var s=i.format;s.textAlign=o}}),r.length>0}function n1(t,e){t.focus(),t.formatContentModel(function(r){return r1(r,e)},{apiName:"setAlignment"})}function a1(t,e,r){if(!r.nodeStack){var n=xi(r.selection);r.nodeStack=n?i1(e,n):[]}var a=r.nodeStack.pop();if(a){var i=M(ln(r,e),2),o=i[0],s=i[1],l=o>=0||s>=0?o1(e,a):-1;l>=0&&Jn(l,r,t,o,s),zi(t,a,r),l>=0&&Jn(l+1,r,t,o,s)}else r.defaultElementProcessors.child(t,e,r)}function i1(t,e){for(var r=[],n=e;n&&t!=n&&t.contains(n);)L(n,"ELEMENT_NODE")&&n.tagName=="TABLE"?r.splice(0,r.length,n):r.push(n),n=n.parentNode;return r}function o1(t,e){for(var r=0,n=t.firstChild;n&&n!=e;)r++,n=n.nextSibling;return r}function l1(t,e){e===void 0&&(e="remove");var r=t.getPendingFormat(),n=t.getSnapshotsManager(),a={canUndo:n.hasNewContent||n.canMove(-1),canRedo:n.canMove(1),isDarkMode:t.isDarkMode()};return t.formatContentModel(function(i){return Tg(i,r,a,e,t.getDOMHelper(),t.isDarkMode(),t.getColorManager()),!1},void 0,{processorOverride:{child:a1},tryGetFromCache:!0}),a}function s1(t,e,r,n){var a=!1;Qe(t,function(d,f,h,v){if(v)if(h?.blockType=="Paragraph"){var c=M(Pi(h,v),2),p=c[1];r.push.apply(r,P([],M(p),!1))}else d[0].blockGroupType=="ListItem"&&v.length==1&&d[0].formatHolder==v[0]&&r.push(w(d[0]).formatHolder);h?e.push([d,w(h)]):f&&f1(f,n)},{includeListFormatHolder:t.format?"never":"anySegment"});var i=r[0];if(e.length==1&&h1(e[0][1])&&e.length==1)r.splice.apply(r,P([0,r.length],M(Ad(t,i)),!1)),a=rs(e[0][0])||a;else if(e.length>1||e.some(function(d){return p1(d[1])}))for(var o=e.length-1;o>=0;o--){var s=M(e[o],2),l=s[0],u=s[1];c1(l,u),a=rs(l)||a,v1(l,u)}return d1(r,t.format),u1(n),a}function u1(t){t.forEach(function(e){var r=M(e,2),n=r[0],a=r[1];a&&(n.format={useBorderBox:n.format.useBorderBox,borderCollapse:n.format.borderCollapse},Xu(n,function(){return null})),Ma(n,void 0,!0)})}function d1(t,e){t.forEach(function(r){r.format=C({},e||{}),r.link&&delete r.link.format.textColor,delete r.code})}function f1(t,e){if(t){var r=t.table,n=t.colIndex,a=t.rowIndex,i=t.isWholeTableSelected,o=r.rows[a].cells[n];if(o.isSelected){var s=w(o);ro(s,function(){return null}),s.isHeader=!1,s.format={useBorderBox:o.format.useBorderBox}}e.find(function(l){return l[0]==r})||e.push([w(r),i])}}function v1(t,e){var r=Je(t,["FormatContainer"],["TableCell"]);if(r>=0&&r<t.length-1){var n=w(t[r]),a=t[r+1].blocks.indexOf(n),i=n.blocks.indexOf(e);if(i>=0&&a>=0){var o=Xi(n.tagName,n.format);n.blocks.splice(i,1),o.blocks=n.blocks.splice(i),w(t[r+1]).blocks.splice(a+1,0,e,o)}}}function rs(t){var e=t[Je(t,["ListItem"],["TableCell"])];return e?(w(e).levels=[],!0):!1}function c1(t,e){if(e.blockType=="Divider"){var r=t[0].blocks.indexOf(e);r>=0&&w(t[0]).blocks.splice(r,1)}else e.blockType=="Paragraph"&&(e.format={},delete e.decorator)}function h1(t){var e=t.blockType=="Paragraph"?t.segments.filter(function(r){return r.isSelected}):[];return e.length==1&&e[0].segmentType=="SelectionMarker"}function p1(t){return t.isSelected||t.blockType=="Paragraph"&&t.segments.every(function(e){return e.isSelected})}var g1=3;function Gd(t){t.focus(),t.formatContentModel(function(e){for(var r=!1,n=!0,a=0;n&&a++<g1;){var i=[],o=[],s=[];n=s1(e,i,o,s),ht(e),r=r||i.length>0||o.length>0||s.length>0}return r},{apiName:"clearFormat"})}var ns=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,as="[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",m1="(?:"+as+"\\.)*"+as,b1=m1+"(?:\\:[0-9]+)?",Ot=b1+"(?:[\\/\\?]\\S*)?",is={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+Ot+"|www\\."+Ot,"i"),except:ns,normalizeUrl:function(t){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(t)?t:"http://"+t}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+Ot,"i"),except:ns},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+Ot+"|ftp\\."+Ot,"i"),normalizeUrl:function(t){return new RegExp("^ftp:\\/\\/","i").test(t)?t:"ftp://"+t}},news:{match:new RegExp("^news:(\\/\\/)?"+Ot,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+Ot,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+Ot,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+Ot,"i")}};function y1(t){var e,r;if(t)try{for(var n=At(ie(is)),a=n.next();!a.done;a=n.next()){var i=a.value,o=is[i],s=t.match(o.match);if(s&&s[0]==t&&(!o.except||!o.except.test(t)))return{scheme:i,originalUrl:t,normalizedUrl:o.normalizeUrl?o.normalizeUrl(t):t}}}catch(l){e={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return null}function E1(t,e,r,n){var a={input:e};t.formatContentModel(function(i,o){if(r(i,o,a.result),a?.result){var s=a.result,l=s.paragraph,u=s.marker,d=l.segments.indexOf(u);d>=0&&w(l).segments.splice(d,1)}return!0},n,{processorOverride:{child:C1(a),textWithSelection:S1(a)},tryGetFromCache:!1})}function C1(t){return function(e,r,n){var a=n;a.path=a.path||[];var i=!1;a.path[0]!=e&&(a.path.unshift(e),i=!0);for(var o=Kd(n,t,r),s=0,l=r.firstChild;l;l=l.nextSibling)os(t,s,n,e,o,r),zi(e,l,n),s++;os(t,s,n,e,o,r),i&&a.path.shift()}}function os(t,e,r,n,a,i){e==a[2]&&(e<=a[0]||a[0]<0)&&(e<a[1]||a[1]<0)&&(Cr(n,r,i,e,t),a[2]=-1),e==a[0]&&(r.isInSelection=!0,Cr(n,r,i,e)),e==a[2]&&(e<a[1]||a[1]<0)&&(Cr(n,r,i,e,t),a[2]=-1),e==a[1]&&(Cr(n,r,i,e),r.isInSelection=!1),e==a[2]&&Cr(n,r,i,e,t)}var S1=function(t){return function(e,r,n){var a=r.nodeValue||"",i=Kd(n,t,r),o=M(i,3),s=o[0],l=o[1],u=o[2],d=function(f,h,v){Xr(e,a.substring(0,f),n),Cr(e,n,r,h,v),i[0]-=f,i[1]-=f,i[2]=v?-1:i[2]-f,a=a.substring(f)};i[2]>=0&&(i[2]<=i[0]||i[0]<0)&&(i[2]<i[1]||i[1]<0)&&d(i[2],u,t),i[0]>=0&&(d(i[0],s),n.isInSelection=!0),i[2]>=0&&i[2]>i[0]&&(i[2]<i[1]||i[1]<0)&&d(i[2],u,t),i[1]>=0&&(d(i[1],l),n.isInSelection=!1),i[2]>=0&&i[2]>=i[1]&&d(i[2],u,t),Xr(e,a,n)}};function Cr(t,e,r,n,a){var i=ru(t,e,r,n);i.isSelected=!a;var o=it(t,i,e.blockFormat,i.format);a&&e.path&&(a.result={path:P([],M(e.path),!1),paragraph:o,marker:i})}function Kd(t,e,r){var n=M(ln(t,r),2),a=n[0],i=n[1],o=e.input.node==r?e.input.offset:-1;return[a,i,o]}var Wd="[s]*[a-zA-Z0-9+][s]*",T1="(T|t)el:"+Wd,w1="(M|m)ailto:"+Wd;function k1(t,e){var r,n=e??{},a=n.autoLink,i=n.autoMailto,o=n.autoTel,s=a?(r=y1(t))===null||r===void 0?void 0:r.normalizedUrl:void 0,l=o?_1(t):void 0,u=i?M1(t):void 0;return s||l||u}function _1(t){return t.match(T1)?t.toLocaleLowerCase():void 0}function M1(t){return t.match(w1)?t.toLocaleLowerCase():void 0}function D1(t,e,r){if(t.link)return null;var n=t.text.split(" ").pop(),a=n?.trim(),i=void 0;if(a&&n&&(i=k1(a,r))){var o=Zy(t,e,t.text.length-n.trimLeft().length,t.text.trimRight().length);return o.link={format:{href:i,underline:!0},dataset:{}},o}return null}var O1="#4A4A4A",L1="white",ca=12,Mi=1,R1="horizontalInserter",F1="verticalInserter";function P1(t,e,r,n,a,i,o,s,l){var u=Te(e.getBoundingClientRect()),d=t.getVisibleViewport(),f=r&&d?fy([r],[d]):null;if(u&&f){var h=e.ownerDocument,v=N1(a,t.isDarkMode(),n,t.getDOMHelper().getDomStyle("backgroundColor")||"white"),c=Nr(v,h);a?(c.id=R1,c.style.left=(n?f.right:f.left-(ca-1+2*Mi))+"px",c.style.top=u.bottom-8+"px",c.firstChild.style.width=f.right-f.left+"px"):(c.id=F1,c.style.left=(n?u.left-8:u.right-8)+"px",c.style.top=f.top-(ca-1+2*Mi)+"px",c.firstChild.style.height=f.bottom-f.top+"px"),(s||h.body).appendChild(c);var p=new A1(c,e,r,a,t,i,o,l);return{div:c,featureHandler:p,node:e}}return null}var A1=(function(){function t(e,r,n,a,i,o,s,l){var u=this;this.div=e,this.td=r,this.table=n,this.isHorizontal=a,this.editor=i,this.onBeforeInsert=o,this.onAfterInsert=s,this.insertTd=function(){var d=u.td.cellIndex,f=u.td.parentElement&&ae(u.td.parentElement,"tr")?u.td.parentElement:void 0,h=f&&f.rowIndex;f?.cells==null||h==null||(u.onBeforeInsert(),Dd(u.editor,"editTablePlugin",function(v){u.isHorizontal?po(v,"insertBelow"):Od(v,"insertRight")},{type:"table",firstColumn:d,firstRow:h,lastColumn:d,lastRow:h,table:u.table}),u.onAfterInsert())},this.div.addEventListener("click",this.insertTd),this.disposer=l?.(a?"HorizontalTableInserter":"VerticalTableInserter",e)}return t.prototype.dispose=function(){var e;this.div.removeEventListener("click",this.insertTd),(e=this.disposer)===null||e===void 0||e.call(this),this.disposer=void 0},t})();function N1(t,e,r,n){var a=e?L1:O1,i="position: fixed; width: "+ca+"px; height: "+ca+"px; font-size: 16px; color: black; line-height: 8px; vertical-align: middle; text-align: center; cursor: pointer; border: solid "+Mi+"px "+a+"; border-radius: 50%; background-color: "+n,o=r?"right":"left",s="position: absolute; box-sizing: border-box; background-color: "+n+";",l={tag:"div",style:s+(t?o+": 12px; top: 5px; height: 3px; border-top: 1px solid "+a+"; border-bottom: 1px solid "+a+"; border-right: 1px solid "+a+"; border-left: 0px;":"left: 5px; top: 12px; width: 3px; border-left: 1px solid "+a+"; border-right: 1px solid "+a+"; border-bottom: 1px solid "+a+"; border-top: 0px;")};return{tag:"div",style:i,children:[l,"+"]}}function Vd(t,e,r){var n=t.getDocument(),a=t.getDOMHelper();if("caretPositionFromPoint"in n){var i=n.caretPositionFromPoint(e,r);if(i&&a.isNodeInEditor(i.offsetNode))return{node:i.offsetNode,offset:i.offset}}if(n.caretRangeFromPoint){var o=n.caretRangeFromPoint(e,r);if(o&&a.isNodeInEditor(o.startContainer))return{node:o.startContainer,offset:o.startOffset}}if(n.elementFromPoint){var s=n.elementFromPoint(e,r);if(s&&a.isNodeInEditor(s))return{node:s,offset:0}}return null}var Rr=12,I1="_Table_Mover",B1="_TableMoverCursorStyle";function H1(t,e,r,n,a,i,o,s,l,u){var d=Te(t.getBoundingClientRect());if(!U1(e,d,o))return null;var f=e.getDOMHelper().calculateZoomScale(),h=t.ownerDocument,v={tag:"div",style:"position: fixed; cursor: move; user-select: none; border: 1px solid #808080"},c=Nr(v,h);c.id=I1,c.style.width=Rr+"px",c.style.height=Rr+"px",(s||h.body).appendChild(c);var p={table:t,zoomScale:f,rect:d,isRTL:r,editor:e,div:c,onFinishDragging:n,onStart:a,onEnd:i,disableMovement:u};x1(p,c);var g=new z1(c,p,function(){},u?{onDragEnd:ls}:{onDragStart:G1,onDragging:K1,onDragEnd:ls},p.zoomScale,l,e.getEnvironment().isMobileOrTablet);return{node:t,div:c,featureHandler:g}}var z1=(function(t){Li(e,t);function e(r,n,a,i,o,s,l){var u=t.call(this,r,n,a,i,o,l)||this;return u.disposer=s?.("TableMover",r),u}return e.prototype.dispose=function(){var r;(r=this.disposer)===null||r===void 0||r.call(this),this.disposer=void 0,t.prototype.dispose.call(this)},e})(vo);function x1(t,e){var r=t.rect;r&&(e.style.top=r.top-Rr+"px",e.style.left=r.left-Rr-2+"px")}function U1(t,e,r){var n=t.getVisibleViewport();if(L(r,"ELEMENT_NODE")&&n&&e){var a=Te(r.getBoundingClientRect());return!!a&&a.top<=e.top&&n.top<=e.top}return!0}function jd(t,e,r){var n;t?.setEditorStyle(B1,e?(n="cursor: "+r)!==null&&n!==void 0?n:"move":null)}function G1(t){var e;t.onStart();var r=t.editor,n=t.table,a=t.div;jd(r,!0,"move");var i=n.getBoundingClientRect(),o={tag:"div",style:"position: fixed; user-select: none; border: 1px solid #808080"},s=Nr(o,document);s.style.width=i.width+"px",s.style.height=i.height+"px",s.style.top=i.top+"px",s.style.left=i.left+"px",(e=a.parentNode)===null||e===void 0||e.appendChild(s);var l=r.getDOMSelection(),u=co(r,n);return{cmTable:u,initialSelection:l,tableRect:s}}function K1(t,e,r){var n=r.tableRect,a=t.editor;n.style.top=e.clientY+Rr+"px",n.style.left=e.clientX+Rr+"px";var i=Vd(a,e.clientX,e.clientY);if(i){var o=a.getDocument().createRange();return o.setStart(i.node,i.offset),o.collapse(!0),a.setDOMSelection({type:"range",range:o,isReverted:!1}),!0}return!1}function ls(t,e,r){var n,a,i=t.editor,o=t.table,s=t.onFinishDragging,l=t.disableMovement,u=e.target;if(r?.tableRect.remove(),jd(i,!1),u==t.div)return s(o),t.onEnd(!1),!0;if(o.contains(u)||!i.getDOMHelper().isNodeInEditor(u)||l)return i.setDOMSelection((n=r?.initialSelection)!==null&&n!==void 0?n:null),t.onEnd(!0),!1;var d=!1,f=Vd(i,e.clientX,e.clientY);return f?E1(i,f,function(h,v,c){var p,g=M(Qr(h),2),b=g[0],y=g[1];if(b){var E=y[0].blocks.indexOf(b);w(y[0]).blocks.splice(E,1)}if(c&&r?.cmTable){var S=Fr();if(S.blocks.push(b??w(r.cmTable)),d=!!ao(h,en(S),v,{mergeFormat:"none",insertPosition:c}),d){var T=(p=Qr(h)[0])!==null&&p!==void 0?p:r.cmTable;if(T){var k=T.rows[0].cells[0],R=k?.blocks[0];if(R?.blockType=="Paragraph"){var H=He(h.format);w(R).segments.unshift(H),Xe(R),Et(h,H)}}}return d}},{selectionOverride:{type:"table",firstColumn:0,firstRow:0,lastColumn:0,lastRow:0,table:o},apiName:"TableMover"}):i.setDOMSelection((a=r?.initialSelection)!==null&&a!==void 0?a:null),t.onEnd(!0),d}var Di=12,W1="_Table_Resizer";function V1(t,e,r,n,a,i,o,s){var l=Te(t.getBoundingClientRect());if(!Xd(e,l,i))return null;var u=t.ownerDocument,d=e.getDOMHelper().calculateZoomScale(),f={tag:"div",style:"position: fixed; cursor: "+(r?"ne":"nw")+"-resize; user-select: none; border: 1px solid #808080"},h=Nr(f,u);h.id=W1,h.style.width=Di+"px",h.style.height=Di+"px",(o||u.body).appendChild(h);var v={isRTL:r,table:t,zoomScale:d,onStart:n,onEnd:a,div:h,editor:e,contentDiv:i};qd(v,h);var c=new j1(h,v,Z1,{onDragStart:q1,onDragging:X1,onDragEnd:Y1},d,e.getEnvironment().isMobileOrTablet,s);return{node:t,div:h,featureHandler:c}}var j1=(function(t){Li(e,t);function e(r,n,a,i,o,s,l){var u=t.call(this,r,n,a,i,o,s)||this;return u.disposer=l?.("TableResizer",r),u}return e.prototype.dispose=function(){var r;(r=this.disposer)===null||r===void 0||r.call(this),this.disposer=void 0,t.prototype.dispose.call(this)},e})(vo);function q1(t,e){t.onStart();var r=t.editor,n=t.table,a=co(r,n),i=[];a?.rows.forEach(function(s){i.push(s.height)});var o=[];return a?.widths.forEach(function(s){o.push(s)}),{originalRect:n.getBoundingClientRect(),cmTable:a,originalHeights:i??[],originalWidths:o??[]}}function X1(t,e,r,n,a){var i,o,s=t.isRTL,l=t.zoomScale,u=t.table,d=r.originalRect,f=r.originalHeights,h=r.originalWidths,v=r.cmTable,c=1+n/d.width*l*(s?-1:1),p=1+a/d.height*l,g=Math.abs(c-1)>.001,b=Math.abs(p-1)>.001;if(u.style.setProperty("width",null),u.style.setProperty("height",null),v&&v.rows&&(g||b)){for(var y=w(v),E=0;E<v.rows.length;E++)for(var S=0;S<v.rows[E].cells.length;S++){var T=v.rows[E].cells[S];T&&(g&&E==0&&(y.widths[S]=((i=h[S])!==null&&i!==void 0?i:0)*c),b&&S==0&&(y.rows[E].height=((o=f[E])!==null&&o!==void 0?o:0)*p))}for(var k=0;k<u.rows.length;k++){var R=u.rows[k];if(R.cells.length!=0)for(var H=Math.max(v.rows[k].height,tn),U=0;U<R.cells.length;U++){var q=R.cells[U],W=Math.max(v.widths[U],tn);q.style.width=W+"px",q.style.height=H+"px",q.style.boxSizing="border-box"}}return!0}else return!1}function Y1(t,e,r){return t.editor.isDisposed()||(Xd(t.editor,Te(t.table.getBoundingClientRect()),t.contentDiv)&&(t.div.style.visibility="visible",qd(t,t.div)),t.onEnd()),!1}function qd(t,e){var r=t.table,n=t.isRTL,a=Te(r.getBoundingClientRect());a&&(e.style.top=a.bottom+"px",e.style.left=n?a.left-Di-2+"px":a.right+"px")}function Z1(t,e){e.style.visibility="hidden"}function Xd(t,e,r){var n=t.getVisibleViewport();if(L(r,"ELEMENT_NODE")&&n&&e){var a=Te(r.getBoundingClientRect());return!!a&&a.bottom>=e.bottom&&n.bottom>=e.bottom}return!0}function hr(t){var e,r,n;t&&((e=t.featureHandler)===null||e===void 0||e.dispose(),t.featureHandler=null,(n=(r=t.div)===null||r===void 0?void 0:r.parentNode)===null||n===void 0||n.removeChild(t.div),t.div=null)}var xr=6,ss;(function(t){t[t.top=0]="top",t[t.side=1]="side"})(ss||(ss={}));var J1=(function(){function t(e,r,n,a,i,o,s,l){var u=this,d;this.editor=e,this.table=r,this.logicalRoot=n,this.onChanged=a,this.anchorContainer=i,this.contentDiv=o,this.onTableEditorCreated=s,this.disableFeatures=l,this.horizontalInserter=null,this.verticalInserter=null,this.horizontalResizer=null,this.verticalResizer=null,this.tableResizer=null,this.tableMover=null,this.range=null,this.onEditorCreated=function(f,h){var v,c=(v=u.onTableEditorCreated)===null||v===void 0?void 0:v.call(u,f,h),p=h&&u.getOnMouseOut(h);return p&&h.addEventListener("mouseout",p),function(){c?.(),p&&h.removeEventListener("mouseout",p)}},this.onFinishEditing=function(){return u.editor.focus(),u.range&&(u.editor.setDOMSelection({type:"range",range:u.range,isReverted:!1}),u.range=null),u.editor.takeSnapshot(),u.onChanged(),u.isCurrentlyEditing=!1,!1},this.onStartTableResize=function(){u.isCurrentlyEditing=!0,u.onStartResize()},this.onStartCellResize=function(){u.isCurrentlyEditing=!0,u.disposeTableResizer(),u.onStartResize()},this.onStartTableMove=function(){u.onBeforeEditTable(),u.isCurrentlyEditing=!0,u.disposeTableResizer(),u.disposeTableInserter(),u.disposeCellResizers()},this.onEndTableMove=function(f){return f&&u.disposeTableMover(),u.onFinishEditing()},this.onBeforeEditTable=function(){u.editor.setLogicalRoot(u.logicalRoot)},this.onAfterInsert=function(){u.disposeTableResizer(),u.onFinishEditing()},this.onSelect=function(f){var h,v;if(u.editor.focus(),f){var c=Jr(f),p={table:f,firstRow:0,firstColumn:0,lastRow:c.length-1,lastColumn:((v=(h=c[0])===null||h===void 0?void 0:h.length)!==null&&v!==void 0?v:0)-1,type:"table"};u.editor.setDOMSelection(p)}},this.getOnMouseOut=function(f){return function(h){f&&h.relatedTarget!=f&&L(u.contentDiv,"ELEMENT_NODE")&&L(h.relatedTarget,"ELEMENT_NODE")&&u.contentDiv!=h.relatedTarget&&!u.isEditing()&&u.dispose()}},this.isRTL=((d=e.getDocument().defaultView)===null||d===void 0?void 0:d.getComputedStyle(r).direction)=="rtl",this.setEditorFeatures(),this.isCurrentlyEditing=!1}return t.prototype.dispose=function(){this.disposeTableResizer(),this.disposeCellResizers(),this.disposeTableInserter(),this.disposeTableMover()},t.prototype.isEditing=function(){return this.isCurrentlyEditing},t.prototype.isOwnedElement=function(e){return[this.tableResizer,this.tableMover,this.horizontalInserter,this.verticalInserter,this.horizontalResizer,this.verticalResizer].filter(function(r){return!!r?.div}).some(function(r){return r?.div==e})},t.prototype.onMouseMove=function(e,r){var n,a=Te(this.table.getBoundingClientRect());if(a){for(var i=r<=a.top+xr?0:this.isRTL?e>=a.right-xr?1:void 0:e<=a.left+xr?1:void 0,o=i?1:0,s=0;s<this.table.rows.length;s++){for(var l=this.table.rows[s],u=0;u<l.cells.length;u++){var d=l.cells[u],f=Te(d.getBoundingClientRect());if(!(!f||!a)){var h=r<=f.bottom,v=this.isRTL?e<=f.right+xr*o:e<=f.right,c=this.isRTL?e>=f.left:e>=f.left-xr*o;if(h&&v&&c){if(s===0&&i==0){var p=(f.left+f.right)/2,g=this.isRTL?e<p:e>p;!this.isFeatureDisabled("VerticalTableInserter")&&this.setInserterTd(g?d:l.cells[u-1],!1)}else if(u===0&&i==1){var b=(n=this.table.rows[s-1])===null||n===void 0?void 0:n.cells[0],y=b?Te(b.getBoundingClientRect()):null,E=y?this.isRTL?y.right===f.right:y.left===f.left:null;!this.isFeatureDisabled("HorizontalTableInserter")&&this.setInserterTd(r<(f.top+f.bottom)/2&&E?b:d,!0)}else this.setInserterTd(null);!this.isFeatureDisabled("CellResizer")&&this.setResizingTd(d);break}}}if(u<l.cells.length)break}this.setEditorFeatures()}},t.prototype.setEditorFeatures=function(){var e=this.isFeatureDisabled("TableSelector"),r=this.isFeatureDisabled("TableMover");!this.tableMover&&!(e&&r)&&(this.tableMover=H1(this.table,this.editor,this.isRTL,e?function(){}:this.onSelect,this.onStartTableMove,this.onEndTableMove,this.contentDiv,this.anchorContainer,this.onEditorCreated,r)),!this.tableResizer&&!this.isFeatureDisabled("TableResizer")&&(this.tableResizer=V1(this.table,this.editor,this.isRTL,this.onStartTableResize,this.onFinishEditing,this.contentDiv,this.anchorContainer,this.onTableEditorCreated))},t.prototype.setResizingTd=function(e){this.horizontalResizer&&this.horizontalResizer.node!=e&&this.disposeCellResizers(),!this.horizontalResizer&&e&&(this.horizontalResizer=ql(this.editor,e,this.table,this.isRTL,!0,this.onStartCellResize,this.onFinishEditing,this.anchorContainer,this.onTableEditorCreated),this.verticalResizer=ql(this.editor,e,this.table,this.isRTL,!1,this.onStartCellResize,this.onFinishEditing,this.anchorContainer,this.onTableEditorCreated))},t.prototype.setInserterTd=function(e,r){var n=r?this.horizontalInserter:this.verticalInserter;if((e===null||n&&n.node!=e)&&this.disposeTableInserter(),!this.horizontalInserter&&!this.verticalInserter&&e){var a=P1(this.editor,e,this.table,this.isRTL,!!r,this.onBeforeEditTable,this.onAfterInsert,this.anchorContainer,this.onEditorCreated);r?this.horizontalInserter=a:this.verticalInserter=a}},t.prototype.disposeTableResizer=function(){this.tableResizer&&(hr(this.tableResizer),this.tableResizer=null)},t.prototype.disposeTableInserter=function(){this.horizontalInserter&&(hr(this.horizontalInserter),this.horizontalInserter=null),this.verticalInserter&&(hr(this.verticalInserter),this.verticalInserter=null)},t.prototype.disposeCellResizers=function(){this.horizontalResizer&&(hr(this.horizontalResizer),this.horizontalResizer=null),this.verticalResizer&&(hr(this.verticalResizer),this.verticalResizer=null)},t.prototype.disposeTableMover=function(){this.tableMover&&(hr(this.tableMover),this.tableMover=null)},t.prototype.onStartResize=function(){this.onBeforeEditTable(),this.isCurrentlyEditing=!0;var e=this.editor.getDOMSelection();e&&e.type=="range"&&(this.range=e.range),this.editor.takeSnapshot()},t.prototype.isFeatureDisabled=function(e){var r;return(r=this.disableFeatures)===null||r===void 0?void 0:r.includes(e)},t})(),In=12,Q1=(function(){function t(e,r,n,a){var i=this;a===void 0&&(a=$1),this.anchorContainerSelector=e,this.onTableEditorCreated=r,this.disableFeatures=n,this.tableSelector=a,this.editor=null,this.onMouseMoveDisposer=null,this.tableRectMap=null,this.tableEditor=null,this.onMouseOut=function(o){var s=o.relatedTarget,l=o.currentTarget,u=s,d=l;L(u,"ELEMENT_NODE")&&L(d,"ELEMENT_NODE")&&i.tableEditor&&!i.tableEditor.isOwnedElement(u)&&!d.contains(u)&&i.setTableEditor(null)},this.onMouseMove=function(o){var s,l=o;if(!(l.buttons>0||!i.editor)){i.ensureTableRects();var u=i.editor.getDocument().defaultView||window,d=l.pageX-u.scrollX,f=l.pageY-u.scrollY,h=null;if(i.tableRectMap)for(var v=i.tableRectMap.length-1;v>=0;v--){var c=i.tableRectMap[v],p=c.rect;if(d>=p.left-In&&d<=p.right+In&&f>=p.top-In&&f<=p.bottom+In){h=c;break}}i.setTableEditor(h,l),(s=i.tableEditor)===null||s===void 0||s.onMouseMove(d,f)}},this.invalidateTableRects=function(){i.tableRectMap=null}}return t.prototype.getName=function(){return"TableEdit"},t.prototype.initialize=function(e){this.editor=e,this.onMouseMoveDisposer=this.editor.attachDomEvent({mousemove:{beforeDispatch:this.onMouseMove}});var r=this.editor.getScrollContainer();r.addEventListener("mouseout",this.onMouseOut)},t.prototype.dispose=function(){var e,r,n=(e=this.editor)===null||e===void 0?void 0:e.getScrollContainer();n?.removeEventListener("mouseout",this.onMouseOut),(r=this.onMouseMoveDisposer)===null||r===void 0||r.call(this),this.invalidateTableRects(),this.disposeTableEditor(),this.editor=null,this.onMouseMoveDisposer=null,this.onTableEditorCreated=void 0},t.prototype.onPluginEvent=function(e){switch(e.eventType){case"input":case"contentChanged":case"scroll":case"zoomChanged":this.setTableEditor(null),this.invalidateTableRects();break}},t.prototype.setTableEditor=function(e,r){if(this.tableEditor&&!this.tableEditor.isEditing()&&e?.table!=this.tableEditor.table&&this.disposeTableEditor(),!this.tableEditor&&e&&this.editor&&e.table.rows.length>0){var n=this.anchorContainerSelector?this.editor.getDocument().querySelector(this.anchorContainerSelector):void 0;this.tableEditor=new J1(this.editor,e.table,e.logicalRoot,this.invalidateTableRects,L(n,"ELEMENT_NODE")?n:void 0,r?.currentTarget,this.onTableEditorCreated,this.disableFeatures)}},t.prototype.disposeTableEditor=function(){var e;(e=this.tableEditor)===null||e===void 0||e.dispose(),this.tableEditor=null},t.prototype.ensureTableRects=function(){var e=this;if(!this.tableRectMap&&this.editor){this.tableRectMap=[];var r=this.tableSelector(this.editor.getDOMHelper());r.forEach(function(n){var a=Te(n.table.getBoundingClientRect());a&&e.tableRectMap&&e.tableRectMap.push(C(C({},n),{rect:a}))})}},t})();function $1(t){return t.queryElements("table").filter(function(e){return e.isContentEditable}).map(function(e){return{table:e,logicalRoot:null}})}function be(t,e,r){var n;t.additionalFormatParsers||(t.additionalFormatParsers={}),t.additionalFormatParsers[e]||(t.additionalFormatParsers[e]=[]),(n=t.additionalFormatParsers[e])===null||n===void 0||n.push(r)}function us(t,e,r){var n=typeof r=="function"?r:function(i){return r?i:null};if(!t[e])t[e]=n;else{var a=t[e];t[e]=function(i,o){var s=typeof a=="function"?a(i,o):a?i:!1;return s?n(s,o):null}}}var eE={width:Bn,height:Bn,"inline-size":Bn,"block-size":Bn};function Bn(t,e){var r=e.toLowerCase();return r=="div"||r=="p"?null:t}var ds=function(t){vn.forEach(function(e){var r=t[e],n="";if(r&&yu.some(function(i){return r.indexOf(i)>-1&&(n=i)})){var a=r.replace(n,"").trimRight();t[e]=a}})},Yd=["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle"],tE="BulletListStyle",rE="NumberListStyle",nE="WACImageBorder",aE="WACImageContainer",fs="OutlineElement",iE="ListContainerWrapper",Zd="CommentHighlightRest",Jd="CommentHighlightClicked",oE=P(P([],M(Yd),!1),["ListMarkerWrappingSpan"],!1),Qd="span."+aE+",span."+nE+",."+Zd+",."+Jd+","+Yd.map(function(t){return'table div[class^="'+t+'"]'}).join(","),lE='ul[class^="'+tE+'"]>.'+fs+',ol[class^="'+rE+'"]>.'+fs+","+Qd,sE=function(t){var e=t.fragment;return!!e.querySelector(lE)},Xt={GOOGLE_SHEET_NODE_NAME:"google-sheets-html-origin",PROG_ID_NAME:"ProgId",EXCEL_DESKTOP_ATTRIBUTE_NAME:"xmlns:x"},uE="urn:schemas-microsoft-com:office:excel",dE=function(t){var e=t.htmlAttributes;return e[Xt.EXCEL_DESKTOP_ATTRIBUTE_NAME]==uE},fE="web data/shadow-workbook",vE=function(t){var e,r=t.clipboardData;return r.types.includes(fE)&&((e=r.htmlFirstLevelChildTags)===null||e===void 0?void 0:e.length)==1&&r.htmlFirstLevelChildTags[0]=="TABLE"},cE="Excel.Sheet",hE=function(t){var e=t.htmlAttributes;return e[Xt.PROG_ID_NAME]==cE&&e[Xt.EXCEL_DESKTOP_ATTRIBUTE_NAME]==null},pE=function(t){var e=t.fragment;return!!e.querySelector(Xt.GOOGLE_SHEET_NODE_NAME)},gE="OneNote.File",mE=function(t){var e=t.htmlAttributes;return e[Xt.PROG_ID_NAME]==gE},bE="PowerPoint.Slide",yE=function(t){return t.htmlAttributes[Xt.PROG_ID_NAME]==bE},vs="xmlns:w",cs="urn:schemas-microsoft-com:office:word",EE="Word.Document",CE=function(t){var e,r=t.htmlAttributes,n=t.clipboardData,a=t.environment;return r[vs]==cs||r[Xt.PROG_ID_NAME]==EE||!!(a.isSafari&&n.rawHtml&&((e=n.rawHtml)===null||e===void 0?void 0:e.replace(/ /g,"").indexOf(vs+'="'+cs))>-1)},SE=function(t){var e,r=t.shouldConvertSingleImage,n=t.clipboardData;return r&&((e=n.htmlFirstLevelChildTags)===null||e===void 0?void 0:e.length)==1&&n.htmlFirstLevelChildTags[0]=="IMG"},TE=new Map([["wordDesktop",CE],["excelDesktop",dE],["excelOnline",hE],["powerPointDesktop",yE],["wacComponents",sE],["googleSheets",pE],["singleImage",SE],["excelNonNativeEvent",vE],["oneNoteDesktop",mE]]);function wE(t,e,r){var n=t.htmlAttributes,a=t.clipboardData,i=t.fragment,o=null,s={htmlAttributes:n,fragment:i,shouldConvertSingleImage:e,clipboardData:a,environment:r};return TE.forEach(function(l,u){!o&&l(s)&&(o=u)}),o??"default"}var kE=["http:","https:","notes:","mailto:","onenote:"],_E=/^file:\/\/\/[a-zA-Z\/]/i,ME=function(t,e){if(ae(e,"a")){var r;try{r=new URL(e.href)}catch{r=void 0}(r&&kE.indexOf(r.protocol)===-1||_E.test(e.href))&&(e.removeAttribute("href"),t.href="")}},DE=function(t,e,r){var n={};K(e,r.formatParsers.segment,n,r),$d(t,e,r,n)};function $d(t,e,r,n){if(e.nodeType===Node.TEXT_NODE){var a=xe(e.nodeValue||"",n);it(t,a)}else if(L(e,"ELEMENT_NODE")){var i=C({},n);K(e,r.formatParsers.segment,i,r);for(var o=0;o<e.childNodes.length;o++)$d(t,e.childNodes[o],r,i)}}function Pt(t,e,r){t.processorOverride||(t.processorOverride={}),t.processorOverride[e]=r}var OE=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,LE=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,RE=/<tr[^>]*>[^<]*/i,FE=/<table[^>]*>[^<]*/i,hs="table",Hn="solid 1px #d4d4d4";function PE(t,e,r,n){var a=t.fragment,i=t.htmlBefore,o=t.htmlAfter,s=t.clipboardData;n&&AE(a,e,i,s,o);var l=a.firstChild;if(L(l,"ELEMENT_NODE")&&l.tagName=="div"&&l.firstChild){var u=Array.from(l.childNodes).every(function(d){var f=L(d,"ELEMENT_NODE")&&d.tagName;return f=="META"?!0:f=="TABLE"?d==l.lastChild:!1});u&&l.lastChild&&t.fragment.replaceChildren(l.lastChild)}IE(t,r,n)}function AE(t,e,r,n,a){var i=!t.querySelector(hs)&&e.htmlToDOM(r+n.html+a);if(i&&i.querySelector(hs))St(t,i?.body);else{var o=n.html?NE(n.html,r):void 0;if(o&&n.html!=o){var s=e.htmlToDOM(o);St(t,s?.body)}}}function NE(t,e){try{if(t.match(OE)){var r=e.match(RE),n=r?r[0]:"<TR>";t=n+t+"</TR>"}if(t.match(LE)){var a=e.match(FE),i=a?a[0]:"<TABLE>";t=i+t+"</TABLE>"}}finally{return t}}function IE(t,e,r){be(t.domToModelOption,"tableCell",function(n,a){!e&&(a.style.borderStyle==="none"||!r&&a.style.borderStyle=="")&&(n.borderBottom=Hn,n.borderLeft=Hn,n.borderRight=Hn,n.borderTop=Hn)}),Pt(t.domToModelOption,"child",BE)}var BE=function(t,e,r){var n=C({},r.segmentFormat);t.blockGroupType==="TableCell"&&t.format.textColor&&!r.segmentFormat.textColor&&(r.segmentFormat.textColor=t.format.textColor),r.defaultElementProcessors.child(t,e,r),t.blockGroupType==="TableCell"&&t.format.textColor&&(r.segmentFormat=n,delete t.format.textColor)},HE={1:"decimal",a:"lower-alpha",A:"upper-alpha",i:"lower-roman",I:"upper-roman"},zE={disc:"disc",circle:"circle",square:"square"};function xE(t){Pt(t.domToModelOption,"ol",UE),Pt(t.domToModelOption,"ul",GE),Pt(t.domToModelOption,"li",KE)}var UE=function(t,e,r){var n,a,i=yo(r);if(i.oneNoteListContext){var o=e.getAttribute("type");if(o){var s=HE[o],l=parseInt(e.getAttribute("start")||"1")||1;i.oneNoteListContext.listStyleType=s,i.oneNoteListContext.startNumberOverride=l}}(a=(n=i.defaultElementProcessors).ol)===null||a===void 0||a.call(n,t,e,i)},GE=function(t,e,r){var n,a,i=yo(r);if(i.oneNoteListContext){var o=e.getAttribute("type");if(o){var s=zE[o];i.oneNoteListContext.listStyleType=s}}(a=(n=i.defaultElementProcessors).ul)===null||a===void 0||a.call(n,t,e,i)},KE=function(t,e,r){var n,a,i=yo(r),o=!1;if(i.oneNoteListContext){var s=i.oneNoteListContext,l=s.listStyleType,u=s.startNumberOverride;if(l){var d=i.listFormat.levels[i.listFormat.levels.length-1];d.format.listStyleType=l,u&&(o=!0,d.format.startNumberOverride=u,delete i.oneNoteListContext.startNumberOverride),delete i.oneNoteListContext.listStyleType}}(a=(n=i.defaultElementProcessors).li)===null||a===void 0||a.call(n,t,e,i),o&&delete i.listFormat.levels[i.listFormat.levels.length-1].format.startNumberOverride};function yo(t){var e=t;return e.oneNoteListContext||(e.oneNoteListContext={}),e}var Eo=function(t){var e;!((e=t.textIndent)===null||e===void 0)&&e.startsWith("-")&&delete t.textIndent},WE=function(t){delete t.marginLeft};function ef(t,e,r,n,a,i,o){o===void 0&&(o=[]);var s=sr(t);if(K(e,r.formatParsers.listLevel,s.format,r),K(e,o.concat(WE),s.format,r),n>a.levels.length)for(;n!=a.levels.length;)a.levels.push(s);else a.levels.splice(n,a.levels.length-1),a.levels[n-1]=s;a.listParent=i}function tf(t,e,r,n,a,i){var o=t.listFormat,s=o.levels[o.levels.length-1];n&&s&&sa(s,function(d){return Object.assign({},d,n)});var l=fn(o.levels,t.segmentFormat);if(K(e,t.formatParsers.segmentOnBlock,t.segmentFormat,t),K(e,t.formatParsers.listItemElement,l.format,t),K(e,[Eo,VE],l.format,t),a){var u=C({},t.segmentFormat);K(a,t.formatParsers.segmentOnBlock,u,t),l.formatHolder.format=u}i?.(l),t.elementProcessors.child(l,e,t),ze(r,l)}var VE=function(t,e,r,n){ae(e,"li")||Object.keys(n).forEach(function(a){var i=a,o=a;i!="display"&&t[o]!=null&&t[o]==n[i]&&delete t[o]})},jE="* > span > span[style*=mso-special-format]",qE="mso-special-format",rf="style",XE=/mso-special-format:\s*([^;]*)/,$a=function(t){delete t.textAlign,delete t.marginLeft,delete t.paddingLeft};function YE(t,e){var r=t.fragment,n=t.clipboardData,a=t.domToModelOption;if(n.html&&!n.text&&n.image){var i=e.htmlToDOM(n.html);St(r,i?.body)}be(a,"block",Eo),Pt(a,"element",function(o,s,l){var u,d,f=s.getAttribute(rf)||"";if(!(f.includes(qE)&&l.listFormat.levels.length>0)){var h=s.querySelector(jE);if(h){var v=ZE(s,h),c=v.depth,p=v.unorderedBulletType,g=v.orderedBulletType,b=v.startNumberOverrideOrBullet,y=v.isOrderedList,E=v.isNewList;ef(y?"OL":"UL",s,l,c,l.listFormat,o,[$a]);var S={unorderedStyleType:!y&&p?me[p]:void 0,orderedStyleType:y&&g?B[g]:void 0};tf(l,s,o,S,h,function(T){E&&(T.levels[T.levels.length-1].format.startNumberOverride=parseInt(b)),$a(T.levels[T.levels.length-1].format),$a(T.format)})}else(d=(u=l.defaultElementProcessors).element)===null||d===void 0||d.call(u,o,s,l)}})}function ZE(t,e){var r=t.className.substring(1)||"0",n=parseInt(r)+1,a=e.getAttribute(rf)||"",i=a.match(XE),o=M(i?.[1].replace('"',"").split("\\,")||[],2),s=o[0],l=o[1],u=ps.has(s),d=JE.get(e.innerText),f=ps.get(s);return{depth:n,unorderedBulletType:d,orderedBulletType:f,startNumberOverrideOrBullet:l,isOrderedList:u,isNewList:u&&!!f&&e.innerText===QE(f,l)}}var JE=new Map([["•","Disc"],["o","Circle"],["§","Square"],["q","BoxShadow"],["v","Xrhombus"],["Ø","ShortArrow"],["ü","CheckMark"]]),ps=new Map([["numbullet1","UpperAlpha"],["numbullet2","DecimalParenthesis"],["numbullet3","Decimal"],["numbullet7","UpperRoman"],["numbullet9","LowerAlphaParenthesis"],["numbullet0","LowerAlpha"],["numbullet6","LowerRoman"]]);function QE(t,e){var r=Ji(B[t],parseInt(e));switch(t){case"Decimal":case"UpperAlpha":case"LowerAlpha":case"UpperRoman":case"LowerRoman":return r+".";case"DecimalParenthesis":case"LowerAlphaParenthesis":return r+")";default:return}}var ei=/[\n\t'{}"]+/g,jr="<style",$E="</style>",eC=/\W/;function tC(t){for(var e,r=[],n=gs(t),a=n.styleIndex,i=n.styleEndIndex;a>=0&&i>=0;){var o=t.substring(a+jr.length,i).trim();r.push(o),e=gs(t,i+1),a=e.styleIndex,i=e.styleEndIndex}return r}function gs(t,e){e===void 0&&(e=0);for(var r=t.toLowerCase(),n=r.indexOf(jr,e),a=n+jr.length,i=t.substring(a,a+1);!eC.test(i)&&n>-1;)n=r.indexOf(jr,n+1),a=n+jr.length,i=t.substring(a,a+1);var o=r.indexOf($E,e);return{styleIndex:n,styleEndIndex:o}}function rC(t){var e=new Map,r=tC(t.htmlBefore||t.clipboardData.rawHtml||"");return r.forEach(function(n){for(var a=0,i=function(){var o=n.indexOf("@",a+1),s=n.indexOf("}",o),l=n.indexOf("{",o);a=o;var u=n.substring(o+1,l).replace(ei,"").replace("list","").trimRight().trimLeft(),d=n.substring(l,s+1).trimLeft().trimRight(),f={},h=d.split(";");h.forEach(function(c){var p=M(c.split(":"),2),g=p[0],b=p[1];if(g&&b){var y=g.replace(ei,"").trimRight().trimLeft(),E=b.replace(ei,"").trimRight().trimLeft();f[y]=E}});var v={"mso-level-number-format":f["mso-level-number-format"],"mso-level-start-at":f["mso-level-start-at"]||"1","mso-level-text":f["mso-level-text"]};ie(v).some(function(c){return!!v[c]})&&e.set(u,v)};a>=0;)i()}),e}function nf(t){var e={},r=t?.getAttribute("style")||"";return r.split(";").forEach(function(n){var a=n.indexOf(":"),i=n.slice(0,a),o=n.slice(a+1);i&&o&&(e[i.trim()]=o.trim())}),e}var nC=/#_msocom_/,aC="mso-special-character",iC="comment",oC="mso-element",lC="comment-list";function sC(t,e){return t[aC]==iC||ae(e,"a")&&nC.test(e.href)||t[oC]==lC}var af="mso-list",of="ignore",uC="l0",dC=/%[0-9a-zA-Z]+/g,fC="bullet";function vC(t,e,r,n,a){var i,o=n.listFormat;o.wordKnownLevels||(o.wordKnownLevels=new Map);var s=t[af]||"";if(s.toLowerCase()===of)return!0;var l=M(s.split(" "),2),u=l[0],d=l[1];if(o.wordLevel=d&&parseInt(d.substr(5)),o.wordList=u||uC,o.levels.length==0&&(o.levels=o.wordList&&o.wordKnownLevels.get(o.wordList)||[]),s&&e&&typeof o.wordLevel=="number"){var f=o.wordLevel,h=o.wordList,v=a.get(u+":"+d),c=((i=v?.["mso-level-number-format"])===null||i===void 0?void 0:i.toLowerCase())!=fC?"OL":"UL";ef(c,r,n,f,o,e,[gC]),o.levels[o.levels.length-1].format.wordList=h;var p=cC(v,c),g=p?{unorderedStyleType:c=="UL"?p:void 0,orderedStyleType:c=="OL"?p:void 0}:void 0;return tf(n,r,e,g,mC(r),function(b){c=="OL"&&hC(b,n,v,r)}),o.levels.length>0&&o.wordKnownLevels.get(h)!=o.levels&&o.wordKnownLevels.set(h,P([],M(o.levels),!1)),!0}return!1}function cC(t,e){var r=t?.["mso-level-number-format"]||"decimal",n;if(t?.["mso-level-text"]){var a="";switch(r){case"alpha-upper":a="UpperAlpha";break;case"alpha-lower":a="LowerAlpha";break;case"roman-lower":a="LowerRoman";break;case"roman-upper":a="UpperRoman";break;default:a="Number";break}var i=(t["mso-level-text"]||"").replace("\\","").replace('"',"").replace(dC,"${"+a+"}");n='"'+i+' "'}else switch(r){case"alpha-lower":n="lower-alpha";break;case"roman-lower":n="lower-roman";break;case"roman-upper":n="upper-roman";break;default:n="decimal";break}return Rg(e,n)}function hC(t,e,r,n){var a,i,o=e.listFormat,s=o.listParent,l=o.wordList,u=o.wordKnownLevels,d=o.wordLevel,f=o.levels,h=pC(s);if((h?.blockType!="BlockGroup"||h.blockGroupType!="ListItem"||d&&((i=(a=h.levels[d])===null||a===void 0?void 0:a.format)===null||i===void 0?void 0:i.wordList)!=l)&&l){var v=r?.["mso-level-start-at"]?parseInt(r["mso-level-start-at"]):NaN,c=u?.get(l)||[];v!=null&&!isNaN(v)&&c.length!=f.length?t.levels[t.levels.length-1].format.startNumberOverride=v:ae(n,"li")&&L(n.parentElement,"ELEMENT_NODE")&&ae(n.parentElement,"ol")&&n.parentElement.firstElementChild==n&&c.length!=n.parentElement.start&&(t.levels[t.levels.length-1].format.startNumberOverride=n.parentElement.start)}}function pC(t){for(var e=(t?.blocks.length||0)-1;e>0;e--){var r=t?.blocks[e];if(r&&!Uf(r))return r}}function gC(t,e){e.style.marginLeft&&parseInt(e.style.marginLeft)!=0&&(t.paddingLeft="0px"),e.style.marginRight&&parseInt(e.style.marginRight)!=0&&(t.paddingRight="0px")}function mC(t){var e=t.firstElementChild,r=!1;if(e)for(var n=0;n<e.childNodes.length;n++){var a=e.childNodes[n];if(L(a,"ELEMENT_NODE")){var i=nf(a),o=i[af]||"";if(o.toLowerCase()===of){r=!0;break}}}return e&&r?e:void 0}var bC=/%/,yC=1.2;function EC(t){var e=rC(t);Pt(t.domToModelOption,"element",CC(e)),be(t.domToModelOption,"block",SC),be(t.domToModelOption,"block",Eo),be(t.domToModelOption,"listLevel",TC),be(t.domToModelOption,"container",ms),be(t.domToModelOption,"table",ms)}var CC=function(t){return function(e,r,n){var a=nf(r);vC(a,e,r,n,t)||sC(a,r)||n.defaultElementProcessors.element(e,r,n)}};function SC(t,e){var r;bC.test(e.style.lineHeight)&&!isNaN(r=parseInt(e.style.lineHeight))&&(t.lineHeight=(yC*(r/100)).toString())}var TC=function(t,e,r,n){e.style.marginLeft!=""&&(t.marginLeft=n.marginLeft),t.marginBottom=void 0},ms=function(t,e){var r;!((r=t.marginLeft)===null||r===void 0)&&r.startsWith("-")&&delete t.marginLeft,t.htmlAlign&&delete t.htmlAlign},lf=["UL","OL","LI"],wC=lf.join(","),kC=function(t,e){var r=e.style.verticalAlign;r==="super"&&(t.superOrSubScriptSequence="super"),r==="sub"&&(t.superOrSubScriptSequence="sub")},_C=function(t,e,r){var n=e.tagName;if(e.matches(Qd)&&(e.style.removeProperty("display"),e.style.removeProperty("margin")),e.classList.contains(iE)){r.elementProcessors.child(t,e,r);return}if(!oE.some(function(i){return e.classList.contains(i)})){if(OC(n,e,r)){var a=r.listFormat;a.levels=[],a.listParent=void 0}r.defaultElementProcessors.element(t,e,r)}},MC=function(t,e,r){var n,a,i,o,s,l=parseInt((n=e.getAttribute("data-aria-level"))!==null&&n!==void 0?n:""),u=r.listFormat,d=((a=u.levels[r.listFormat.levels.length-1])===null||a===void 0?void 0:a.listType)||((i=e.closest("ol,ul"))===null||i===void 0?void 0:i.tagName.toUpperCase()),f=sr(d,r.blockFormat);if(K(e,r.formatParsers.listLevelThread,f.format,r),K(e,r.formatParsers.listLevel,f.format,r),r.listFormat.levels=u.currentListLevels||r.listFormat.levels,l>0)if(l>r.listFormat.levels.length)for(;l!=r.listFormat.levels.length;)r.listFormat.levels.push(f);else r.listFormat.levels.splice(l,r.listFormat.levels.length-1),r.listFormat.levels[l-1]=f;(s=(o=r.defaultElementProcessors).li)===null||s===void 0||s.call(o,t,e,r);var h=u.listParent;if(h){var v=h.blocks[h.blocks.length-1];if(v.blockType=="BlockGroup"&&v.blockGroupType=="ListItem"){var c=v.levels[v.levels.length-1];FC(c,e,r)}}var p=[];u.levels.forEach(function(g){var b={dataset:C({},g.dataset),format:C({},g.format),listType:g.listType};p.push(b)}),u.currentListLevels=p,u.levels=[]},bs=function(t,e){e.style.display==="block"&&(t.displayForDummyItem=void 0),t.marginLeft=void 0,t.marginRight=void 0},DC=function(t){t.marginLeft=void 0,t.paddingLeft=void 0};function OC(t,e,r){return r.listFormat.levels.length>0&&lf.every(function(n){return n!=t})&&!e.closest(wC)}var LC=function(t,e){(e.className.includes(Zd)||e.className.includes(Jd))&&delete t.backgroundColor};function RC(t){be(t.domToModelOption,"segment",kC),be(t.domToModelOption,"listItemThread",bs),be(t.domToModelOption,"listItemElement",bs),be(t.domToModelOption,"listLevel",DC),be(t.domToModelOption,"container",ys),be(t.domToModelOption,"table",ys),be(t.domToModelOption,"segment",LC),Pt(t.domToModelOption,"element",_C),Pt(t.domToModelOption,"li",MC)}var ys=function(t,e){e.style.marginLeft.startsWith("-")&&delete t.marginLeft};function FC(t,e,r){if(!(!t||t.listType=="UL")){var n=e.closest("ol"),a=r.listFormat,i=M(PC(n,e),2),o=i[0],s=i[1];a.listItemThread||(a.listItemThread=[]);var l=a.listItemThread[s];l&&o-l!=1&&(t.format.startNumberOverride=o),a.listItemThread[s]=o}}function PC(t,e){var r=e&&Array.from(t?.querySelectorAll("li")||[]).indexOf(e),n=parseInt(t?.getAttribute("start")||"1")+(r&&r>0?r:0),a=parseInt(e?.getAttribute("data-aria-level")||"");return[n,a]}var AC=(function(){function t(e,r){r===void 0&&(r={styleSanitizers:eE,additionalAllowedTags:[],additionalDisallowedTags:[],attributeSanitizers:{}}),this.allowExcelNoBorderTable=e,this.domToModelForSanitizing=r,this.editor=null}return t.prototype.getName=function(){return"Paste"},t.prototype.initialize=function(e){this.editor=e},t.prototype.dispose=function(){this.editor=null},t.prototype.onPluginEvent=function(e){if(!(!this.editor||e.eventType!="beforePaste")&&e.domToModelOption){var r=wE(e,!1,this.editor.getEnvironment()),n=e.pasteType;switch(r){case"wordDesktop":EC(e);break;case"wacComponents":RC(e);break;case"excelOnline":case"excelDesktop":case"excelNonNativeEvent":(n==="normal"||n==="mergeFormat")&&PE(e,this.editor.getDOMCreator(),!!this.allowExcelNoBorderTable,r!="excelNonNativeEvent");break;case"googleSheets":e.domToModelOption.additionalAllowedTags.push(Xt.GOOGLE_SHEET_NODE_NAME);break;case"powerPointDesktop":YE(e,this.editor.getDOMCreator());break;case"oneNoteDesktop":xE(e);break}be(e.domToModelOption,"link",ME),be(e.domToModelOption,"tableCell",ds),be(e.domToModelOption,"tableCell",IC),be(e.domToModelOption,"table",ds),Pt(e.domToModelOption,"button",DE),n==="mergeFormat"&&(be(e.domToModelOption,"block",Es),be(e.domToModelOption,"listLevel",Es)),this.setEventSanitizers(e)}},t.prototype.setEventSanitizers=function(e){var r,n;if(this.domToModelForSanitizing){var a=this.domToModelForSanitizing,i=a.styleSanitizers,o=a.attributeSanitizers,s=a.additionalAllowedTags,l=a.additionalDisallowedTags;ie(i).forEach(function(u){return us(e.domToModelOption.styleSanitizers,u,i[u])}),ie(o).forEach(function(u){return us(e.domToModelOption.attributeSanitizers,u,o[u])}),(r=e.domToModelOption.additionalAllowedTags).push.apply(r,P([],M(s),!1)),(n=e.domToModelOption.additionalDisallowedTags).push.apply(n,P([],M(l),!1))}},t})(),Es=function(t,e){e.style.backgroundColor&&delete t.backgroundColor},NC=new Map([["borderTop",{w:"borderTopWidth",s:"borderTopStyle",c:"borderTopColor"}],["borderRight",{w:"borderRightWidth",s:"borderRightStyle",c:"borderRightColor"}],["borderBottom",{w:"borderBottomWidth",s:"borderBottomStyle",c:"borderBottomColor"}],["borderLeft",{w:"borderLeftWidth",s:"borderLeftStyle",c:"borderLeftColor"}]]);function IC(t,e){vn.forEach(function(r){if(!t[r]){var n=NC.get(r);n&&e.style[n.w]&&e.style[n.s]&&!e.style[n.c]&&(t[r]=e.style[n.w]+" "+e.style[n.s])}})}var BC=function(t){if(t.deleteResult=="notDeleted")for(var e=t.insertPoint,r=e.paragraph,n=e.marker,a=r.segments.indexOf(n),i=w(r),o=a-1;o>=0;o--){var s=i.segments[o];s.isSelected=!0,la(r,s,t.formatContext)&&(t.deleteResult="range")}},sf=function(t){var e=t.deleteResult;if(e=="nothingToDelete"||e=="notDeleted"||e=="range"){var r=t.insertPoint,n=t.formatContext,a=r.path,i=r.paragraph,o=n?.rawEvent,s=Je(a,["FormatContainer"],["TableCell","ListItem"]),l=a[s];if(l&&l.blockGroupType==="FormatContainer"&&l.tagName=="blockquote"){var u=a[s+1],d=u.blocks.indexOf(l);HC(l)?(Ni(u,l),o?.preventDefault(),t.deleteResult="range"):o?.key==="Enter"&&l.blocks.indexOf(i)>=0&&uf(i)&&(zC(w(l),u,d,i),o?.preventDefault(),t.deleteResult="range")}}},HC=function(t){return t.blocks.length===1&&t.blocks[0].blockType==="Paragraph"&&uf(t.blocks[0])},uf=function(t){return t.segments.every(function(e){return e.segmentType==="SelectionMarker"||e.segmentType==="Br"})},zC=function(t,e,r,n){var a,i=t.blocks.indexOf(n);if(i>=0){var o=w(e);if(i<t.blocks.length-1){var s=Xi(t.tagName,t.format);(a=s.blocks).push.apply(a,P([],M(t.blocks.splice(i+1,t.blocks.length-i-1)),!1)),o.blocks.splice(r+1,0,s)}o.blocks.splice(r+1,0,n),t.blocks.splice(i,1),t.blocks.length==0&&o.blocks.splice(r,0)}},xC=function(t){if(t.deleteResult=="notDeleted"){var e=t.insertPoint,r=e.paragraph,n=e.marker,a=e.path;if(r.segments[0]==n){var i=Je(a,["ListItem"],["TableCell","FormatContainer"]),o=a[i],s=o?.levels[o.levels.length-1];s&&o?.blocks[0]==r&&(s.format.displayForDummyItem=="block"?o.levels.pop():s.format.displayForDummyItem="block",t.deleteResult="range")}}},UC=function(t){if(t.deleteResult==="nothingToDelete"){var e=t.insertPoint,r=e.paragraph,n=e.path,a=n[0],i=n[1];r.segments.every(function(o){return o.segmentType==="SelectionMarker"||o.segmentType==="Br"})&&r.segments.filter(function(o){return o.segmentType==="Br"}).length<=1&&(Object.keys(r.format).length>0?(r.format={},t.deleteResult="range"):a.blocks.length==1&&a.blocks[0]==r&&i&&(a.blockGroupType=="FormatContainer"||a.blockGroupType=="ListItem"||a.blockGroupType=="General")&&(Ni(i,a),n.shift(),t.deleteResult="range"))}};function GC(t,e,r){for(var n,a=P([],M(t),!1),i=function(){var s=a[0],l=s.blocks.indexOf(e);if(l<0)return"break";var u=s.blocks[l+(r?1:-1)];if(u){for(;u.blockType=="BlockGroup";){var d=u.blocks[r?0:u.blocks.length-1];if(d){if(d.blockType!="BlockGroup")return a.unshift(u),{value:{block:d,path:a}};a.unshift(u),u=d}else return{value:{block:u,path:a}}}return{value:{block:u,path:a}}}else if(pu(s)){a.shift();var f=-1,h=s,v=(n=a[0])===null||n===void 0?void 0:n.blocks.find(function(p){return p.blockType=="Paragraph"&&(f=p.segments.indexOf(h))>=0});if(v){var c=v.segments[f+(r?1:-1)];if(c)return{value:{block:v,path:a,siblingSegment:c}};e=v}else return"break"}else if(s.blockGroupType!="Document"&&s.blockGroupType!="TableCell")a.shift(),e=s;else return"break"};a.length>0;){var o=i();if(typeof o=="object")return o.value;if(o==="break")break}return null}function df(t,e,r){if(t&&t.length){var n=e.format,a=r.format;t.forEach(function(i){var o=n[i];o!==void 0&&(a[i]=o)})}}function KC(t,e){return function(r){var n;if(r.deleteResult=="notDeleted"){var a=t=="forward",i=r.insertPoint,o=i.paragraph,s=i.marker,l=i.path,u=i.tableContext,d=o.segments;jC(o);var f=d.indexOf(s)+(a?1:-1),h=d[f],v,c;if(h)la(o,h,r.formatContext,t)&&(r.deleteResult="singleChar",Xe(o));else if(VC(a,d,o,l)&&(c=WC(l)))Ir(c,"outdent"),r.deleteResult="range";else if(v=GC(l,o,a)){var p=v.block,g=v.path,b=v.siblingSegment;if(p.blockType=="Paragraph"){var y=w(p);b?la(y,b,r.formatContext,t)&&(r.deleteResult="range"):(a?r.lastParagraph=y:(((n=y.segments[y.segments.length-1])===null||n===void 0?void 0:n.segmentType)=="Br"&&w(y).segments.pop(),r.insertPoint={marker:s,paragraph:y,path:g,tableContext:u},r.lastParagraph=o),df(e.formatsToPreserveOnMerge,r.insertPoint.paragraph,r.lastParagraph),r.deleteResult="range"),r.lastTableContext=u}else Zu(w(g[0]).blocks,p,void 0,r.formatContext,t)&&(r.deleteResult="range")}else r.deleteResult="nothingToDelete"}}}function WC(t){var e=t[t.length-1];return e.blockGroupType=="Document"?e:null}function VC(t,e,r,n){return!t&&e.length==1&&e[0].segmentType=="SelectionMarker"&&r.format.marginLeft&&parseInt(r.format.marginLeft)&&Je(n,["Document","TableCell"],["ListItem"])>-1}function jC(t){var e,r,n=t.segments;if(((e=n[n.length-1])===null||e===void 0?void 0:e.segmentType)=="Br"){var a=n.filter(function(i){return i.segmentType!="SelectionMarker"});((r=a[a.length-2])===null||r===void 0?void 0:r.segmentType)!="Br"&&w(t).segments.pop()}}function qC(t,e,r,n,a){switch(a.skipUndoSnapshot=!0,a.clearModelCache=!1,n){case"notDeleted":return a.clearModelCache=!0,!1;case"nothingToDelete":return r.preventDefault(),!1;case"range":case"singleChar":return r.preventDefault(),ht(e),ff(e),n=="range"&&(a.skipUndoSnapshot=!1),t.triggerEvent("beforeKeyboardEditing",{rawEvent:r}),!0}}function XC(t,e){return e&&t.altKey&&!t.metaKey||!e&&t.ctrlKey&&!t.altKey}function YC(t){return t.metaKey&&!t.altKey}function ff(t){for(var e=!1,r=t.blocks.length-1;r>=0;r--){var n=t.blocks[r];n.blockType=="BlockGroup"&&(ff(n),n.blocks.length==0&&(w(t).blocks.splice(r,1),e=!0))}e&&t.blocks.forEach(Xe)}var Cs;(function(t){t[t.Start=0]="Start",t[t.Punctuation=1]="Punctuation",t[t.Text=2]="Text",t[t.NonText=3]="NonText",t[t.Space=4]="Space",t[t.End=5]="End"})(Cs||(Cs={}));function vf(t){return function(e){if(e.deleteResult=="notDeleted")for(var r=e.insertPoint,n=r.marker,a=r.paragraph,i=a.segments.indexOf(n),o=t=="forward",s=ZC(w(a),i,o,e),l=s.next(),u=0;u!=5&&!l.done;){var d=l.value,f=d.punctuation,h=d.space,v=d.text;switch(u){case 0:u=h?4:f?1:2,l=s.next(!0);break;case 1:o&&h?(u=3,l=s.next(!0)):f?l=s.next(!0):u=5;break;case 2:o&&h?(u=3,l=s.next(!0)):v?l=s.next(!0):u=5;break;case 3:f||!h?u=5:l=s.next(!0);break;case 4:h?l=s.next(!0):f?(u=o?3:1,l=s.next(!0)):u=o?5:2;break}}}}function ZC(t,e,r,n){var a,i,o,s,l,u,d,f,h,v,c,p;return xf(this,function(g){switch(g.label){case 0:a=r?1:-1,i=t.segments,o=an(t.format.whiteSpace),s=e+a,g.label=1;case 1:if(!(s>=0&&s<i.length))return[3,12];switch(l=i[s],u=l.segmentType,u){case"Text":return[3,2];case"Image":return[3,7];case"SelectionMarker":return[3,9]}return[3,10];case 2:d=r?0:l.text.length-1,g.label=3;case 3:return d>=0&&d<l.text.length?(f=l.text[d],h=ra(f),v=na(f),c=!h&&!v,[4,{punctuation:h,space:v,text:c}]):[3,6];case 4:if(g.sent())if(p=l.text,p=p.substring(0,d)+p.substring(d+1),o||(p=Pu(p,r)),n.deleteResult="range",p)l.text=p,a>0&&(d-=a);else return i.splice(s,1),a>0&&(s-=a),[3,6];g.label=5;case 5:return d+=a,[3,3];case 6:return[3,11];case 7:return[4,{punctuation:!0,space:!1,text:!1}];case 8:return g.sent()&&(i.splice(s,1),a>0&&(s-=a),n.deleteResult="range"),[3,11];case 9:return[3,11];case 10:return[2,null];case 11:return s+=a,[3,1];case 12:return[2,null]}})}var JC=vf("forward"),QC=vf("backward");function zn(t,e,r){var n=!1,a=t.getDOMSelection(),i=r.handleExpandedSelectionOnDelete;return eS(a,e,!!i)&&t.formatContentModel(function(o,s){var l=Ar(o,$C(e,!!t.getEnvironment().isMac,r),s).deleteResult;return n=qC(t,o,e,l,s),n},{rawEvent:e,changeSource:Ue.Keyboard,getChangeData:function(){return e.which},scrollCaretIntoView:!0,apiName:e.key=="Delete"?"handleDeleteKey":"handleBackspaceKey"}),n}function $C(t,e,r){var n=t.key=="Delete",a=YC(t)&&!n?BC:null,i=XC(t,e)?n?JC:QC:null,o=KC(n?"forward":"backward",r),s=n?null:sf;return[a,i,n?null:xC,o,s,UC]}function eS(t,e,r){var n,a;if(t){if(t.type!="range")return!0;if(t.range.collapsed){var i=t.range,s=i.startContainer,d=i.startOffset;return!(L(s,"TEXT_NODE")&&!Or(e)&&(tS(e,s,d)||rS(e,s,d)))}else{if(r)return!0;var i=t.range,o=t.range,s=o.startContainer,l=o.endContainer,u=s===l&&L(s,"TEXT_NODE");return!(u&&!Or(e)&&i.endOffset-i.startOffset<((a=(n=s.nodeValue)===null||n===void 0?void 0:n.length)!==null&&a!==void 0?a:0))}}else return!1}function tS(t,e,r){var n,a;if(t.key!="Backspace"||r<=1)return!1;var i=(a=(n=e.nodeValue)===null||n===void 0?void 0:n.length)!==null&&a!==void 0?a:0;if(r==i){var o=e.nextSibling,s=L(o,"ELEMENT_NODE")&&ae(o,"a")&&cu(o)&&!o.firstChild;return!s}else return!0}function rS(t,e,r){var n,a;return t.key=="Delete"&&r<((a=(n=e.nodeValue)===null||n===void 0?void 0:n.length)!==null&&a!==void 0?a:0)-1}var nS=function(t){var e=t.deleteResult,r=t.insertPoint;if(e=="notDeleted"||e=="nothingToDelete"){var n=r.marker,a=r.paragraph,i=a.segments.indexOf(n),o=i>0?a.segments[i-1]:null;o?.segmentType=="Text"&&D1(o,a,{autoLink:!0})&&t.formatContext&&(t.formatContext.canUndoByBackspace=!0)}};function cf(t,e,r){var n;e===void 0&&(e=!0),r===void 0&&(r=[]);var a=t.paragraph,i=t.marker,o=Ge(!1,{},a.segmentFormat);Sr(o.format,a.format,Vf),df(r,a,o);var s=a.segments.indexOf(i),l=a.segments.splice(s,a.segments.length-s);(n=o.segments).push.apply(n,P([],M(l),!1));var u=a.segments.length==0,d=!a.isImplicit||!e;return u&&d?a.segments.push(zt(i.format)):u||Xe(a),t.paragraph=o,tu(a),o}var aS=function(t){var e=t.deleteResult,r=t.insertPoint;if(e=="notDeleted"||e=="nothingToDelete"){var n=r.path,a=Je(n,["ListItem"],["TableCell","FormatContainer"]),i=n[a],o=n[a+1];if(i?.blockGroupType==="ListItem"&&o){var s=w(i);iS(s)?s.levels.pop():(s=lS(t,s,o),t.formatContext&&(t.formatContext.announceData=Ud(P([s],M(n.slice(a+1)),!1))));var l=o.blocks.indexOf(s),u=o.blocks[l+1];if(u&&gt(u,"ListItem")&&u.levels[0]&&(u.levels.forEach(function(f){f.format.startNumberOverride!==1&&(f.format.startNumberOverride=void 0)}),s.levels.length==0)){var d=uS(o.blocks,u.levels.length);u.levels[u.levels.length-1].format.startNumberOverride=d}t.deleteResult="range"}}},iS=function(t){return t.blocks.length===1&&oS(t.blocks[0])},oS=function(t){return t.blockType==="Paragraph"&&t.segments.length===2&&t.segments[0].segmentType==="SelectionMarker"&&t.segments[1].segmentType==="Br"},lS=function(t,e,r){var n,a=t.insertPoint,i=r.blocks.indexOf(e),o=a.paragraph,s=e.blocks.indexOf(o),l=cf(a),u=sS(e),d=fn(u,e.formatHolder.format);d.blocks.push(l),Sr(d.format,e.format,Fi);var f=e.blocks.length-s-1;return s>=0&&f>0&&(n=d.blocks).push.apply(n,P([],M(w(e).blocks.splice(s+1,f)),!1)),a.paragraph=l,w(r).blocks.splice(i+1,0,d),t.lastParagraph==o&&(t.lastParagraph=l),d},sS=function(t){return t.levels.map(function(e){return sr(e.listType,C(C({},e.format),{startNumberOverride:void 0,displayForDummyItem:void 0}),e.dataset)})},uS=function(t,e){for(var r=1,n=0;n<t.length;n++){var a=t[n];if(gt(a,"ListItem")&&a.levels.length===e)r++;else if(gt(a,"ListItem")&&a.levels.length==0)return r}return r},dS=function(t){return function(e){var r,n,a=e.insertPoint,i=a.paragraph,o=a.path,s=(n=(r=o[0])===null||r===void 0?void 0:r.blocks.indexOf(i))!==null&&n!==void 0?n:-1;if(e.deleteResult=="notDeleted"&&s>=0){var l=cf(e.insertPoint,!1,t);w(o[0]).blocks.splice(s+1,0,l),e.deleteResult="range",e.lastParagraph=l,e.insertPoint.paragraph=l}}};function fS(t,e,r,n){n===void 0&&(n=[]);var a=t.getDOMSelection();t.formatContentModel(function(i,o){var s,l,u=Ar(i,[],o);if(a&&a.type!="table"){u.deleteResult="notDeleted";var d=e.shiftKey?[]:[nS,aS,sf];(r||vS((s=u.insertPoint)===null||s===void 0?void 0:s.paragraph))&&d.push(dS(n)),Qu(d,u)}return u.deleteResult=="range"?(o.newPendingFormat=(l=u.insertPoint)===null||l===void 0?void 0:l.marker.format,ht(i),e.preventDefault(),!0):!1},{rawEvent:e,scrollCaretIntoView:!0,changeSource:Ue.Keyboard,getChangeData:function(){return e.which},apiName:"handleEnterKey"})}function vS(t){return t&&(t.isImplicit||t.segments.some(function(e){return e.segmentType=="Entity"}))}var cS="​",hS=function(t){if(t.deleteResult=="range"){var e=t.insertPoint,r=e.marker,n=e.paragraph,a=n.segments.indexOf(r);if(a>=0){var i=xe(cS,r.format,r.link,r.code);i.isSelected=!0,n.segments.splice(a,0,i)}}};function pS(t,e){var r=t.getDOMSelection();if(gS(r,e))return t.takeSnapshot(),t.formatContentModel(function(n,a){var i,o=Ar(n,[hS],a);return a.skipUndoSnapshot=!0,o.deleteResult=="range"?(a.newPendingFormat=(i=o.insertPoint)===null||i===void 0?void 0:i.marker.format,ht(n),!0):!1},{scrollCaretIntoView:!0,rawEvent:e,changeSource:Ue.Keyboard,getChangeData:function(){return e.which},apiName:"handleInputKey"}),!0}function gS(t,e){return t&&!Or(e)&&e.key&&(e.key=="Space"||e.key.length==1)?t.type!="range"||!t.range.collapsed:!1}var Ur="    ",mS=" ";function hf(t,e,r,n){var a=e.segments.filter(function(k){return k.isSelected}),i=a.length===1&&a[0].segmentType==="SelectionMarker",o=e.segments.every(function(k){return k.isSelected||k.segmentType=="Text"&&k.text.trim().length==0});if(o){var s=e.format,l=s.marginLeft,u=s.marginRight,d=s.direction,f=d==="rtl";if(r.shiftKey&&(!f&&(!l||l=="0px")||f&&(!u||u=="0px")))return!1;Ir(t,r.shiftKey?"outdent":"indent",void 0,n)}else if(i){var b=e.segments.findIndex(function(k){return k.segmentType==="SelectionMarker"});if(r.shiftKey){if(b<=0)return!1;var E=e.segments[b-1],S=Ur.length;if(E.segmentType=="Text"){var T=E.text.length-S;if(E.text===Ur)w(e).segments.splice(b-1,1);else if(E.text.substring(T)===Ur)at(e,E,function(R){R.text=R.text.substring(0,T)});else return!1}}else{var y=e.segments[b].format,E=xe(Ur,y);w(e).segments.splice(b,0,E)}}else{var h=void 0,v=void 0;if(e.segments.forEach(function(k,R){k.isSelected&&(h||(h=R),v=R)}),h&&v){var c=e.segments[h],p=xe(r.shiftKey?Ur:mS,c.format),g=He(c.format);w(e).segments.splice(h,v-h+1,p,g)}else return!1}return r.preventDefault(),!0}function bS(t,e,r,n){var a=ES(e);return!yS(e)&&a.length==1&&a[0].blockType==="Paragraph"?hf(t,a[0],r,n):(Ir(t,r.shiftKey?"outdent":"indent",void 0,n),r.preventDefault(),!0)}function yS(t){return t.blocks[0].blockType=="Paragraph"&&t.blocks[0].segments[0].segmentType=="SelectionMarker"}function ES(t){return t.blocks.filter(function(e){return e.blockType=="Paragraph"&&e.segments.some(function(r){return r.isSelected})})}function CS(t,e){var r=Qr(t)[0];return r&&SS(r)?(Ir(t,e.shiftKey?"outdent":"indent"),e.preventDefault(),!0):!1}function SS(t){var e,r,n=t.rows[t.rows.length-1],a=n?.cells[n.cells.length-1];return((r=(e=t.rows[0])===null||e===void 0?void 0:e.cells[0])===null||r===void 0?void 0:r.isSelected)&&a?.isSelected}function TS(t,e,r){var n,a,i=Qr(t)[0];if(i){var o=i.rows[i.rows.length-1],s=o?o.cells.length-1:-1,l=o?.cells[s];if(!r.shiftKey&&l&&l===e){var u=w(i);po(u,"insertBelow"),ho(u,{firstRow:u.rows.length-1,firstColumn:0,lastRow:u.rows.length-1,lastColumn:s}),Da(u,t.format);var d=(a=(n=u.rows[u.rows.length-1])===null||n===void 0?void 0:n.cells[0])===null||a===void 0?void 0:a.blocks[0];if(d.blockType=="Paragraph"){var f=He(t.format);w(d).segments.unshift(f),Xe(d),Et(u.rows[u.rows.length-1].cells[0],f)}return r.preventDefault(),!0}}return!1}function wS(t,e){var r=t.getDOMSelection();switch(r?.type){case"range":return t.formatContentModel(function(n,a){return kS(n,e,a)},{apiName:"handleTabKey",rawEvent:e,changeSource:Ue.Keyboard,getChangeData:function(){return e.which}}),!0;case"table":return t.formatContentModel(function(n){return CS(n,e)},{apiName:"handleTabKey",rawEvent:e,changeSource:Ue.Keyboard,getChangeData:function(){return e.which}}),!0}}function kS(t,e,r){var n=gn(t,["ListItem","TableCell"],[]),a=n.length>0?n[0].block:void 0;return n.length>1?(Ir(t,e.shiftKey?"outdent":"indent"),e.preventDefault(),!0):gt(a,"TableCell")?TS(t,a,e):a?.blockType==="Paragraph"?hf(t,a,e,r):gt(a,"ListItem")?bS(t,a,e,r):!1}var Ss=8,Ts=46,_S=229,ws={handleTabKey:!0,handleExpandedSelectionOnDelete:!0},MS=(function(){function t(e){e===void 0&&(e=ws),this.options=e,this.editor=null,this.disposer=null,this.shouldHandleNextInputEvent=!1,this.selectionAfterDelete=null,this.handleNormalEnter=function(){return!1},this.options=C(C({},ws),e)}return t.prototype.createNormalEnterChecker=function(e){return e?function(){return!0}:function(){return!1}},t.prototype.getHandleNormalEnter=function(e){switch(typeof this.options.shouldHandleEnterKey){case"function":return this.options.shouldHandleEnterKey;case"boolean":return this.createNormalEnterChecker(this.options.shouldHandleEnterKey);default:return this.createNormalEnterChecker(e.isExperimentalFeatureEnabled("HandleEnterKey"))}},t.prototype.getName=function(){return"Edit"},t.prototype.initialize=function(e){var r=this;this.editor=e,this.handleNormalEnter=this.getHandleNormalEnter(e),e.getEnvironment().isAndroid&&(this.disposer=this.editor.attachDomEvent({beforeinput:{beforeDispatch:function(n){return r.handleBeforeInputEvent(e,n)}}}))},t.prototype.dispose=function(){var e;this.editor=null,(e=this.disposer)===null||e===void 0||e.call(this),this.disposer=null},t.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"keyDown":this.handleKeyDownEvent(this.editor,e);break;case"keyUp":this.selectionAfterDelete&&(this.editor.setDOMSelection(this.selectionAfterDelete),this.selectionAfterDelete=null);break}},t.prototype.willHandleEventExclusively=function(e){if(this.editor&&this.options.handleTabKey&&e.eventType=="keyDown"&&e.rawEvent.key=="Tab"&&!e.rawEvent.shiftKey){var r=this.editor.getDOMSelection(),n=r?.type=="range"?r.range.startContainer:null,a=n?this.editor.getDOMHelper().findClosestElementAncestor(n,"table"):null,i=a&&Jr(a);if(i){var o=i[i.length-1],s=o&&o[o.length-1];if(typeof s=="object"&&s.contains(n))return!0}}return!1},t.prototype.handleKeyDownEvent=function(e,r){var n=r.rawEvent,a=n.ctrlKey||n.metaKey;if(!n.defaultPrevented&&!r.handledByEditFeature)switch(n.key){case"Backspace":this.shouldBrowserHandleBackspace(e)||zn(e,n,this.options);break;case"Delete":r.rawEvent.shiftKey||zn(e,n,this.options);break;case"Tab":this.options.handleTabKey&&!a&&wS(e,n);break;case"Unidentified":e.getEnvironment().isAndroid&&(this.shouldHandleNextInputEvent=!0);break;case"Enter":!a&&!r.rawEvent.isComposing&&r.rawEvent.keyCode!==_S&&fS(e,n,this.handleNormalEnter(e),this.options.formatsToPreserveOnMerge);break;default:pS(e,n);break}},t.prototype.handleBeforeInputEvent=function(e,r){if(!(!this.shouldHandleNextInputEvent||!(r instanceof InputEvent)||r.defaultPrevented)){this.shouldHandleNextInputEvent=!1;var n=!1;switch(r.inputType){case"deleteContentBackward":this.shouldBrowserHandleBackspace(e)||(n=zn(e,new KeyboardEvent("keydown",{key:"Backspace",keyCode:Ss,which:Ss}),this.options));break;case"deleteContentForward":n=zn(e,new KeyboardEvent("keydown",{key:"Delete",keyCode:Ts,which:Ts}),this.options);break}n&&(r.preventDefault(),this.selectionAfterDelete=e.getDOMSelection())}},t.prototype.shouldBrowserHandleBackspace=function(e){var r=this.options.shouldHandleBackspaceKey;switch(typeof r){case"function":return r(e);case"boolean":return r;default:return!1}},t})(),pr={width:"98%",display:"inline-block"};C({borderTop:"1px none",borderRight:"1px none",borderBottom:"1px solid",borderLeft:"1px none"},pr),C({borderTop:"3pt double",borderRight:"3pt none",borderBottom:"3pt none",borderLeft:"3pt none"},pr),C({borderTop:"1px solid",borderRight:"1px none",borderBottom:"1px solid",borderLeft:"1px none"},pr),C({borderTop:"1px none",borderRight:"1px none",borderBottom:"3px dotted",borderLeft:"1px none"},pr),C({borderTop:"1px none",borderRight:"1px none",borderBottom:"1px solid",borderLeft:"1px none"},pr),C({borderTop:"3pt double",borderRight:"3pt none",borderBottom:"3pt double",borderLeft:"3pt none"},pr);var tr,gr,mr,br,yr,Er,ks;(function(t){t[t.Decimal=1]="Decimal",t[t.LowerAlpha=2]="LowerAlpha",t[t.UpperAlpha=3]="UpperAlpha",t[t.LowerRoman=4]="LowerRoman",t[t.UpperRoman=5]="UpperRoman"})(ks||(ks={}));var _s;(function(t){t[t.Dot=1]="Dot",t[t.Dash=2]="Dash",t[t.Parenthesis=3]="Parenthesis",t[t.DoubleParenthesis=4]="DoubleParenthesis"})(_s||(_s={}));tr={},tr[1]=function(t){return FS[t]||void 0},tr[2]=function(t){return RS[t]||void 0},tr[3]=function(t){return LS[t]||void 0},tr[4]=function(t){return OS[t]||void 0},tr[5]=function(t){return DS[t]||void 0};var DS=(gr={},gr[1]=B.UpperRoman,gr[2]=B.UpperRomanDash,gr[3]=B.UpperRomanParenthesis,gr[4]=B.UpperRomanDoubleParenthesis,gr),OS=(mr={},mr[1]=B.LowerRoman,mr[2]=B.LowerRomanDash,mr[3]=B.LowerRomanParenthesis,mr[4]=B.LowerRomanDoubleParenthesis,mr),LS=(br={},br[1]=B.UpperAlpha,br[2]=B.UpperAlphaDash,br[3]=B.UpperAlphaParenthesis,br[4]=B.UpperAlphaDoubleParenthesis,br),RS=(yr={},yr[1]=B.LowerAlpha,yr[2]=B.LowerAlphaDash,yr[3]=B.LowerAlphaParenthesis,yr[4]=B.LowerAlphaDoubleParenthesis,yr),FS=(Er={},Er[1]=B.Decimal,Er[2]=B.DecimalDash,Er[3]=B.DecimalParenthesis,Er[4]=B.DecimalDoubleParenthesis,Er);function pf(t,e){t.formatContentModel(function(r,n){var a=Rp(r);return a&&a.blocks[0].blockType=="Paragraph"&&a.blocks[0].segments[0].segmentType=="SelectionMarker"?(Ir(r,e,void 0,n),!0):!1})}var Ms;(function(t){t[t.BACKSPACE=8]="BACKSPACE",t[t.SPACE=32]="SPACE",t[t.B=66]="B",t[t.I=73]="I",t[t.U=85]="U",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.COMMA=188]="COMMA",t[t.PERIOD=190]="PERIOD",t[t.FORWARD_SLASH=191]="FORWARD_SLASH",t[t.ArrowRight=39]="ArrowRight",t[t.ArrowLeft=37]="ArrowLeft"})(Ms||(Ms={}));var PS={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:66},onClick:function(t){return Id(t,{announceFormatChange:!0})}},AS={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:73},onClick:function(t){return Bd(t,{announceFormatChange:!0})}},NS={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:85},onClick:function(t){return Hd(t,{announceFormatChange:!0})}},IS={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:32},onClick:function(t){return Gd(t)}},BS={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:90},onClick:function(t){return uo(t)}},HS={shortcutKey:{modifierKey:"alt",shiftKey:!1,which:8},onClick:function(t){return uo(t)},environment:"nonMac"},zS={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:89},onClick:function(t){return fo(t)},environment:"nonMac"},xS={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:90},onClick:function(t){return fo(t)},environment:"mac"},US={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:90},onClick:function(t){return fo(t)}},GS={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:190},onClick:function(t){return Fd(t)}},KS={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:191},onClick:function(t){return Pd(t)}},WS={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:190},onClick:function(t){return xd(t,"increase")}},VS={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:188},onClick:function(t){return xd(t,"decrease")}},jS={shortcutKey:{modifierKey:"alt",shiftKey:!0,which:39},onClick:function(t){pf(t,"indent")},environment:"nonMac"},qS={shortcutKey:{modifierKey:"alt",shiftKey:!0,which:37},onClick:function(t){pf(t,"outdent")},environment:"nonMac"},XS=[PS,AS,NS,IS,BS,HS,zS,US,xS,GS,KS,WS,VS,jS,qS],YS="__ShortcutCommandCache",ZS=(function(){function t(e){e===void 0&&(e=XS),this.shortcuts=e,this.editor=null,this.isMac=!1}return t.prototype.getName=function(){return"Shortcut"},t.prototype.initialize=function(e){this.editor=e,this.isMac=!!this.editor.getEnvironment().isMac},t.prototype.dispose=function(){this.editor=null},t.prototype.willHandleEventExclusively=function(e){return e.eventType=="keyDown"&&(e.rawEvent.ctrlKey||e.rawEvent.altKey||e.rawEvent.metaKey)&&!!this.cacheGetCommand(e)},t.prototype.onPluginEvent=function(e){if(this.editor&&e.eventType=="keyDown"){var r=this.cacheGetCommand(e);r&&(r.onClick(this.editor),e.rawEvent.preventDefault())}},t.prototype.cacheGetCommand=function(e){var r=this;return kp(e,YS,function(n){var a=r.editor,i=n.rawEvent,o=i.ctrlKey,s=i.metaKey;return o&&s?null:a&&r.shortcuts.filter(function(l){return r.matchOS(l.environment)&&r.matchShortcut(l.shortcutKey,n.rawEvent)})[0]})},t.prototype.matchOS=function(e){switch(e){case"mac":return this.isMac;case"nonMac":return!this.isMac;default:return!0}},t.prototype.matchShortcut=function(e,r){var n=r.ctrlKey,a=r.altKey,i=r.shiftKey,o=r.which,s=r.metaKey,l=this.isMac?s:n,u=e.modifierKey=="ctrl"&&l&&!a||e.modifierKey=="alt"&&a&&!l;return u&&i==e.shiftKey&&e.which==o},t})(),JS=["widthPx","heightPx"],QS=["angleRad"],$S=["leftPercent","rightPercent","topPercent","bottomPercent"],eT=P(P([],M(QS),!1),M($S),!1);P(P([],M(eT),!1),M(JS),!1);var Ds;(function(t){t.ResizeHandle="r_resizeH",t.RotateHandle="r_rotateH",t.RotateCenter="r_rotateC",t.CropOverlay="r_cropO",t.CropContainer="r_cropC",t.CropHandle="r_cropH"})(Ds||(Ds={}));function tT(t,e,r){var n=P([new AC,new MS,new ZS],M(e??[]),!1),a={plugins:n,initialModel:r,defaultSegmentFormat:{fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000"}};return new $b(t,a)}var ti={},xn={},ri={exports:{}},ni,Os;function rT(){return Os||(Os=1,ni={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),ni}var ai={exports:{}},ii,Ls;function nT(){return Ls||(Ls=1,ii=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")}),ii}var Rs;function aT(){if(Rs)return ai.exports;Rs=1;var t=nT(),e=Array.prototype.concat,r=Array.prototype.slice,n=ai.exports=function(i){for(var o=[],s=0,l=i.length;s<l;s++){var u=i[s];t(u)?o=e.call(o,r.call(u)):o.push(u)}return o};return n.wrap=function(a){return function(){return a(n(arguments))}},ai.exports}var Fs;function iT(){if(Fs)return ri.exports;Fs=1;var t=rT(),e=aT(),r=Object.hasOwnProperty,n=Object.create(null);for(var a in t)r.call(t,a)&&(n[t[a]]=a);var i=ri.exports={to:{},get:{}};i.get=function(l){var u=l.substring(0,3).toLowerCase(),d,f;switch(u){case"hsl":d=i.get.hsl(l),f="hsl";break;case"hwb":d=i.get.hwb(l),f="hwb";break;default:d=i.get.rgb(l),f="rgb";break}return d?{model:f,value:d}:null},i.get.rgb=function(l){if(!l)return null;var u=/^#([a-f0-9]{3,4})$/i,d=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,f=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,h=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,v=/^(\w+)$/,c=[0,0,0,1],p,g,b;if(p=l.match(d)){for(b=p[2],p=p[1],g=0;g<3;g++){var y=g*2;c[g]=parseInt(p.slice(y,y+2),16)}b&&(c[3]=parseInt(b,16)/255)}else if(p=l.match(u)){for(p=p[1],b=p[3],g=0;g<3;g++)c[g]=parseInt(p[g]+p[g],16);b&&(c[3]=parseInt(b+b,16)/255)}else if(p=l.match(f)){for(g=0;g<3;g++)c[g]=parseInt(p[g+1],0);p[4]&&(p[5]?c[3]=parseFloat(p[4])*.01:c[3]=parseFloat(p[4]))}else if(p=l.match(h)){for(g=0;g<3;g++)c[g]=Math.round(parseFloat(p[g+1])*2.55);p[4]&&(p[5]?c[3]=parseFloat(p[4])*.01:c[3]=parseFloat(p[4]))}else return(p=l.match(v))?p[1]==="transparent"?[0,0,0,0]:r.call(t,p[1])?(c=t[p[1]],c[3]=1,c):null:null;for(g=0;g<3;g++)c[g]=o(c[g],0,255);return c[3]=o(c[3],0,1),c},i.get.hsl=function(l){if(!l)return null;var u=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,d=l.match(u);if(d){var f=parseFloat(d[4]),h=(parseFloat(d[1])%360+360)%360,v=o(parseFloat(d[2]),0,100),c=o(parseFloat(d[3]),0,100),p=o(isNaN(f)?1:f,0,1);return[h,v,c,p]}return null},i.get.hwb=function(l){if(!l)return null;var u=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,d=l.match(u);if(d){var f=parseFloat(d[4]),h=(parseFloat(d[1])%360+360)%360,v=o(parseFloat(d[2]),0,100),c=o(parseFloat(d[3]),0,100),p=o(isNaN(f)?1:f,0,1);return[h,v,c,p]}return null},i.to.hex=function(){var l=e(arguments);return"#"+s(l[0])+s(l[1])+s(l[2])+(l[3]<1?s(Math.round(l[3]*255)):"")},i.to.rgb=function(){var l=e(arguments);return l.length<4||l[3]===1?"rgb("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+")":"rgba("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+", "+l[3]+")"},i.to.rgb.percent=function(){var l=e(arguments),u=Math.round(l[0]/255*100),d=Math.round(l[1]/255*100),f=Math.round(l[2]/255*100);return l.length<4||l[3]===1?"rgb("+u+"%, "+d+"%, "+f+"%)":"rgba("+u+"%, "+d+"%, "+f+"%, "+l[3]+")"},i.to.hsl=function(){var l=e(arguments);return l.length<4||l[3]===1?"hsl("+l[0]+", "+l[1]+"%, "+l[2]+"%)":"hsla("+l[0]+", "+l[1]+"%, "+l[2]+"%, "+l[3]+")"},i.to.hwb=function(){var l=e(arguments),u="";return l.length>=4&&l[3]!==1&&(u=", "+l[3]),"hwb("+l[0]+", "+l[1]+"%, "+l[2]+"%"+u+")"},i.to.keyword=function(l){return n[l.slice(0,3)]};function o(l,u,d){return Math.min(Math.max(u,l),d)}function s(l){var u=Math.round(l).toString(16).toUpperCase();return u.length<2?"0"+u:u}return ri.exports}var oi={exports:{}},li,Ps;function oT(){return Ps||(Ps=1,li={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),li}var As;function gf(){if(As)return oi.exports;As=1;var t=oT(),e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);var n=oi.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var a in n)if(n.hasOwnProperty(a)){if(!("channels"in n[a]))throw new Error("missing channels property: "+a);if(!("labels"in n[a]))throw new Error("missing channel labels property: "+a);if(n[a].labels.length!==n[a].channels)throw new Error("channel and label counts mismatch: "+a);var i=n[a].channels,o=n[a].labels;delete n[a].channels,delete n[a].labels,Object.defineProperty(n[a],"channels",{value:i}),Object.defineProperty(n[a],"labels",{value:o})}n.rgb.hsl=function(l){var u=l[0]/255,d=l[1]/255,f=l[2]/255,h=Math.min(u,d,f),v=Math.max(u,d,f),c=v-h,p,g,b;return v===h?p=0:u===v?p=(d-f)/c:d===v?p=2+(f-u)/c:f===v&&(p=4+(u-d)/c),p=Math.min(p*60,360),p<0&&(p+=360),b=(h+v)/2,v===h?g=0:b<=.5?g=c/(v+h):g=c/(2-v-h),[p,g*100,b*100]},n.rgb.hsv=function(l){var u,d,f,h,v,c=l[0]/255,p=l[1]/255,g=l[2]/255,b=Math.max(c,p,g),y=b-Math.min(c,p,g),E=function(S){return(b-S)/6/y+1/2};return y===0?h=v=0:(v=y/b,u=E(c),d=E(p),f=E(g),c===b?h=f-d:p===b?h=1/3+u-f:g===b&&(h=2/3+d-u),h<0?h+=1:h>1&&(h-=1)),[h*360,v*100,b*100]},n.rgb.hwb=function(l){var u=l[0],d=l[1],f=l[2],h=n.rgb.hsl(l)[0],v=1/255*Math.min(u,Math.min(d,f));return f=1-1/255*Math.max(u,Math.max(d,f)),[h,v*100,f*100]},n.rgb.cmyk=function(l){var u=l[0]/255,d=l[1]/255,f=l[2]/255,h,v,c,p;return p=Math.min(1-u,1-d,1-f),h=(1-u-p)/(1-p)||0,v=(1-d-p)/(1-p)||0,c=(1-f-p)/(1-p)||0,[h*100,v*100,c*100,p*100]};function s(l,u){return Math.pow(l[0]-u[0],2)+Math.pow(l[1]-u[1],2)+Math.pow(l[2]-u[2],2)}return n.rgb.keyword=function(l){var u=e[l];if(u)return u;var d=1/0,f;for(var h in t)if(t.hasOwnProperty(h)){var v=t[h],c=s(l,v);c<d&&(d=c,f=h)}return f},n.keyword.rgb=function(l){return t[l]},n.rgb.xyz=function(l){var u=l[0]/255,d=l[1]/255,f=l[2]/255;u=u>.04045?Math.pow((u+.055)/1.055,2.4):u/12.92,d=d>.04045?Math.pow((d+.055)/1.055,2.4):d/12.92,f=f>.04045?Math.pow((f+.055)/1.055,2.4):f/12.92;var h=u*.4124+d*.3576+f*.1805,v=u*.2126+d*.7152+f*.0722,c=u*.0193+d*.1192+f*.9505;return[h*100,v*100,c*100]},n.rgb.lab=function(l){var u=n.rgb.xyz(l),d=u[0],f=u[1],h=u[2],v,c,p;return d/=95.047,f/=100,h/=108.883,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,v=116*f-16,c=500*(d-f),p=200*(f-h),[v,c,p]},n.hsl.rgb=function(l){var u=l[0]/360,d=l[1]/100,f=l[2]/100,h,v,c,p,g;if(d===0)return g=f*255,[g,g,g];f<.5?v=f*(1+d):v=f+d-f*d,h=2*f-v,p=[0,0,0];for(var b=0;b<3;b++)c=u+1/3*-(b-1),c<0&&c++,c>1&&c--,6*c<1?g=h+(v-h)*6*c:2*c<1?g=v:3*c<2?g=h+(v-h)*(2/3-c)*6:g=h,p[b]=g*255;return p},n.hsl.hsv=function(l){var u=l[0],d=l[1]/100,f=l[2]/100,h=d,v=Math.max(f,.01),c,p;return f*=2,d*=f<=1?f:2-f,h*=v<=1?v:2-v,p=(f+d)/2,c=f===0?2*h/(v+h):2*d/(f+d),[u,c*100,p*100]},n.hsv.rgb=function(l){var u=l[0]/60,d=l[1]/100,f=l[2]/100,h=Math.floor(u)%6,v=u-Math.floor(u),c=255*f*(1-d),p=255*f*(1-d*v),g=255*f*(1-d*(1-v));switch(f*=255,h){case 0:return[f,g,c];case 1:return[p,f,c];case 2:return[c,f,g];case 3:return[c,p,f];case 4:return[g,c,f];case 5:return[f,c,p]}},n.hsv.hsl=function(l){var u=l[0],d=l[1]/100,f=l[2]/100,h=Math.max(f,.01),v,c,p;return p=(2-d)*f,v=(2-d)*h,c=d*h,c/=v<=1?v:2-v,c=c||0,p/=2,[u,c*100,p*100]},n.hwb.rgb=function(l){var u=l[0]/360,d=l[1]/100,f=l[2]/100,h=d+f,v,c,p,g;h>1&&(d/=h,f/=h),v=Math.floor(6*u),c=1-f,p=6*u-v,(v&1)!==0&&(p=1-p),g=d+p*(c-d);var b,y,E;switch(v){default:case 6:case 0:b=c,y=g,E=d;break;case 1:b=g,y=c,E=d;break;case 2:b=d,y=c,E=g;break;case 3:b=d,y=g,E=c;break;case 4:b=g,y=d,E=c;break;case 5:b=c,y=d,E=g;break}return[b*255,y*255,E*255]},n.cmyk.rgb=function(l){var u=l[0]/100,d=l[1]/100,f=l[2]/100,h=l[3]/100,v,c,p;return v=1-Math.min(1,u*(1-h)+h),c=1-Math.min(1,d*(1-h)+h),p=1-Math.min(1,f*(1-h)+h),[v*255,c*255,p*255]},n.xyz.rgb=function(l){var u=l[0]/100,d=l[1]/100,f=l[2]/100,h,v,c;return h=u*3.2406+d*-1.5372+f*-.4986,v=u*-.9689+d*1.8758+f*.0415,c=u*.0557+d*-.204+f*1.057,h=h>.0031308?1.055*Math.pow(h,1/2.4)-.055:h*12.92,v=v>.0031308?1.055*Math.pow(v,1/2.4)-.055:v*12.92,c=c>.0031308?1.055*Math.pow(c,1/2.4)-.055:c*12.92,h=Math.min(Math.max(0,h),1),v=Math.min(Math.max(0,v),1),c=Math.min(Math.max(0,c),1),[h*255,v*255,c*255]},n.xyz.lab=function(l){var u=l[0],d=l[1],f=l[2],h,v,c;return u/=95.047,d/=100,f/=108.883,u=u>.008856?Math.pow(u,1/3):7.787*u+16/116,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,h=116*d-16,v=500*(u-d),c=200*(d-f),[h,v,c]},n.lab.xyz=function(l){var u=l[0],d=l[1],f=l[2],h,v,c;v=(u+16)/116,h=d/500+v,c=v-f/200;var p=Math.pow(v,3),g=Math.pow(h,3),b=Math.pow(c,3);return v=p>.008856?p:(v-16/116)/7.787,h=g>.008856?g:(h-16/116)/7.787,c=b>.008856?b:(c-16/116)/7.787,h*=95.047,v*=100,c*=108.883,[h,v,c]},n.lab.lch=function(l){var u=l[0],d=l[1],f=l[2],h,v,c;return h=Math.atan2(f,d),v=h*360/2/Math.PI,v<0&&(v+=360),c=Math.sqrt(d*d+f*f),[u,c,v]},n.lch.lab=function(l){var u=l[0],d=l[1],f=l[2],h,v,c;return c=f/360*2*Math.PI,h=d*Math.cos(c),v=d*Math.sin(c),[u,h,v]},n.rgb.ansi16=function(l){var u=l[0],d=l[1],f=l[2],h=1 in arguments?arguments[1]:n.rgb.hsv(l)[2];if(h=Math.round(h/50),h===0)return 30;var v=30+(Math.round(f/255)<<2|Math.round(d/255)<<1|Math.round(u/255));return h===2&&(v+=60),v},n.hsv.ansi16=function(l){return n.rgb.ansi16(n.hsv.rgb(l),l[2])},n.rgb.ansi256=function(l){var u=l[0],d=l[1],f=l[2];if(u===d&&d===f)return u<8?16:u>248?231:Math.round((u-8)/247*24)+232;var h=16+36*Math.round(u/255*5)+6*Math.round(d/255*5)+Math.round(f/255*5);return h},n.ansi16.rgb=function(l){var u=l%10;if(u===0||u===7)return l>50&&(u+=3.5),u=u/10.5*255,[u,u,u];var d=(~~(l>50)+1)*.5,f=(u&1)*d*255,h=(u>>1&1)*d*255,v=(u>>2&1)*d*255;return[f,h,v]},n.ansi256.rgb=function(l){if(l>=232){var u=(l-232)*10+8;return[u,u,u]}l-=16;var d,f=Math.floor(l/36)/5*255,h=Math.floor((d=l%36)/6)/5*255,v=d%6/5*255;return[f,h,v]},n.rgb.hex=function(l){var u=((Math.round(l[0])&255)<<16)+((Math.round(l[1])&255)<<8)+(Math.round(l[2])&255),d=u.toString(16).toUpperCase();return"000000".substring(d.length)+d},n.hex.rgb=function(l){var u=l.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!u)return[0,0,0];var d=u[0];u[0].length===3&&(d=d.split("").map(function(p){return p+p}).join(""));var f=parseInt(d,16),h=f>>16&255,v=f>>8&255,c=f&255;return[h,v,c]},n.rgb.hcg=function(l){var u=l[0]/255,d=l[1]/255,f=l[2]/255,h=Math.max(Math.max(u,d),f),v=Math.min(Math.min(u,d),f),c=h-v,p,g;return c<1?p=v/(1-c):p=0,c<=0?g=0:h===u?g=(d-f)/c%6:h===d?g=2+(f-u)/c:g=4+(u-d)/c+4,g/=6,g%=1,[g*360,c*100,p*100]},n.hsl.hcg=function(l){var u=l[1]/100,d=l[2]/100,f=1,h=0;return d<.5?f=2*u*d:f=2*u*(1-d),f<1&&(h=(d-.5*f)/(1-f)),[l[0],f*100,h*100]},n.hsv.hcg=function(l){var u=l[1]/100,d=l[2]/100,f=u*d,h=0;return f<1&&(h=(d-f)/(1-f)),[l[0],f*100,h*100]},n.hcg.rgb=function(l){var u=l[0]/360,d=l[1]/100,f=l[2]/100;if(d===0)return[f*255,f*255,f*255];var h=[0,0,0],v=u%1*6,c=v%1,p=1-c,g=0;switch(Math.floor(v)){case 0:h[0]=1,h[1]=c,h[2]=0;break;case 1:h[0]=p,h[1]=1,h[2]=0;break;case 2:h[0]=0,h[1]=1,h[2]=c;break;case 3:h[0]=0,h[1]=p,h[2]=1;break;case 4:h[0]=c,h[1]=0,h[2]=1;break;default:h[0]=1,h[1]=0,h[2]=p}return g=(1-d)*f,[(d*h[0]+g)*255,(d*h[1]+g)*255,(d*h[2]+g)*255]},n.hcg.hsv=function(l){var u=l[1]/100,d=l[2]/100,f=u+d*(1-u),h=0;return f>0&&(h=u/f),[l[0],h*100,f*100]},n.hcg.hsl=function(l){var u=l[1]/100,d=l[2]/100,f=d*(1-u)+.5*u,h=0;return f>0&&f<.5?h=u/(2*f):f>=.5&&f<1&&(h=u/(2*(1-f))),[l[0],h*100,f*100]},n.hcg.hwb=function(l){var u=l[1]/100,d=l[2]/100,f=u+d*(1-u);return[l[0],(f-u)*100,(1-f)*100]},n.hwb.hcg=function(l){var u=l[1]/100,d=l[2]/100,f=1-d,h=f-u,v=0;return h<1&&(v=(f-h)/(1-h)),[l[0],h*100,v*100]},n.apple.rgb=function(l){return[l[0]/65535*255,l[1]/65535*255,l[2]/65535*255]},n.rgb.apple=function(l){return[l[0]/255*65535,l[1]/255*65535,l[2]/255*65535]},n.gray.rgb=function(l){return[l[0]/100*255,l[0]/100*255,l[0]/100*255]},n.gray.hsl=n.gray.hsv=function(l){return[0,0,l[0]]},n.gray.hwb=function(l){return[0,100,l[0]]},n.gray.cmyk=function(l){return[0,0,0,l[0]]},n.gray.lab=function(l){return[l[0],0,0]},n.gray.hex=function(l){var u=Math.round(l[0]/100*255)&255,d=(u<<16)+(u<<8)+u,f=d.toString(16).toUpperCase();return"000000".substring(f.length)+f},n.rgb.gray=function(l){var u=(l[0]+l[1]+l[2])/3;return[u/255*100]},oi.exports}var si,Ns;function lT(){if(Ns)return si;Ns=1;var t=gf();function e(){for(var i={},o=Object.keys(t),s=o.length,l=0;l<s;l++)i[o[l]]={distance:-1,parent:null};return i}function r(i){var o=e(),s=[i];for(o[i].distance=0;s.length;)for(var l=s.pop(),u=Object.keys(t[l]),d=u.length,f=0;f<d;f++){var h=u[f],v=o[h];v.distance===-1&&(v.distance=o[l].distance+1,v.parent=l,s.unshift(h))}return o}function n(i,o){return function(s){return o(i(s))}}function a(i,o){for(var s=[o[i].parent,i],l=t[o[i].parent][i],u=o[i].parent;o[u].parent;)s.unshift(o[u].parent),l=n(t[o[u].parent][u],l),u=o[u].parent;return l.conversion=s,l}return si=function(i){for(var o=r(i),s={},l=Object.keys(o),u=l.length,d=0;d<u;d++){var f=l[d],h=o[f];h.parent!==null&&(s[f]=a(f,o))}return s},si}var ui,Is;function sT(){if(Is)return ui;Is=1;var t=gf(),e=lT(),r={},n=Object.keys(t);function a(o){var s=function(l){return l==null?l:(arguments.length>1&&(l=Array.prototype.slice.call(arguments)),o(l))};return"conversion"in o&&(s.conversion=o.conversion),s}function i(o){var s=function(l){if(l==null)return l;arguments.length>1&&(l=Array.prototype.slice.call(arguments));var u=o(l);if(typeof u=="object")for(var d=u.length,f=0;f<d;f++)u[f]=Math.round(u[f]);return u};return"conversion"in o&&(s.conversion=o.conversion),s}return n.forEach(function(o){r[o]={},Object.defineProperty(r[o],"channels",{value:t[o].channels}),Object.defineProperty(r[o],"labels",{value:t[o].labels});var s=e(o),l=Object.keys(s);l.forEach(function(u){var d=s[u];r[o][u]=i(d),r[o][u].raw=a(d)})}),ui=r,ui}var di,Bs;function uT(){if(Bs)return di;Bs=1;var t=iT(),e=sT(),r=[].slice,n=["keyword","gray","hex"],a={};Object.keys(e).forEach(function(v){a[r.call(e[v].labels).sort().join("")]=v});var i={};function o(v,c){if(!(this instanceof o))return new o(v,c);if(c&&c in n&&(c=null),c&&!(c in e))throw new Error("Unknown model: "+c);var p,g;if(v==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(v instanceof o)this.model=v.model,this.color=v.color.slice(),this.valpha=v.valpha;else if(typeof v=="string"){var b=t.get(v);if(b===null)throw new Error("Unable to parse color from string: "+v);this.model=b.model,g=e[this.model].channels,this.color=b.value.slice(0,g),this.valpha=typeof b.value[g]=="number"?b.value[g]:1}else if(v.length){this.model=c||"rgb",g=e[this.model].channels;var y=r.call(v,0,g);this.color=h(y,g),this.valpha=typeof v[g]=="number"?v[g]:1}else if(typeof v=="number")v&=16777215,this.model="rgb",this.color=[v>>16&255,v>>8&255,v&255],this.valpha=1;else{this.valpha=1;var E=Object.keys(v);"alpha"in v&&(E.splice(E.indexOf("alpha"),1),this.valpha=typeof v.alpha=="number"?v.alpha:0);var S=E.sort().join("");if(!(S in a))throw new Error("Unable to parse color from object: "+JSON.stringify(v));this.model=a[S];var T=e[this.model].labels,k=[];for(p=0;p<T.length;p++)k.push(v[T[p]]);this.color=h(k)}if(i[this.model])for(g=e[this.model].channels,p=0;p<g;p++){var R=i[this.model][p];R&&(this.color[p]=R(this.color[p]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}o.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(v){var c=this.model in t.to?this:this.rgb();c=c.round(typeof v=="number"?v:1);var p=c.valpha===1?c.color:c.color.concat(this.valpha);return t.to[c.model](p)},percentString:function(v){var c=this.rgb().round(typeof v=="number"?v:1),p=c.valpha===1?c.color:c.color.concat(this.valpha);return t.to.rgb.percent(p)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var v={},c=e[this.model].channels,p=e[this.model].labels,g=0;g<c;g++)v[p[g]]=this.color[g];return this.valpha!==1&&(v.alpha=this.valpha),v},unitArray:function(){var v=this.rgb().color;return v[0]/=255,v[1]/=255,v[2]/=255,this.valpha!==1&&v.push(this.valpha),v},unitObject:function(){var v=this.rgb().object();return v.r/=255,v.g/=255,v.b/=255,this.valpha!==1&&(v.alpha=this.valpha),v},round:function(v){return v=Math.max(v||0,0),new o(this.color.map(l(v)).concat(this.valpha),this.model)},alpha:function(v){return arguments.length?new o(this.color.concat(Math.max(0,Math.min(1,v))),this.model):this.valpha},red:u("rgb",0,d(255)),green:u("rgb",1,d(255)),blue:u("rgb",2,d(255)),hue:u(["hsl","hsv","hsl","hwb","hcg"],0,function(v){return(v%360+360)%360}),saturationl:u("hsl",1,d(100)),lightness:u("hsl",2,d(100)),saturationv:u("hsv",1,d(100)),value:u("hsv",2,d(100)),chroma:u("hcg",1,d(100)),gray:u("hcg",2,d(100)),white:u("hwb",1,d(100)),wblack:u("hwb",2,d(100)),cyan:u("cmyk",0,d(100)),magenta:u("cmyk",1,d(100)),yellow:u("cmyk",2,d(100)),black:u("cmyk",3,d(100)),x:u("xyz",0,d(100)),y:u("xyz",1,d(100)),z:u("xyz",2,d(100)),l:u("lab",0,d(100)),a:u("lab",1),b:u("lab",2),keyword:function(v){return arguments.length?new o(v):e[this.model].keyword(this.color)},hex:function(v){return arguments.length?new o(v):t.to.hex(this.rgb().round().color)},rgbNumber:function(){var v=this.rgb().color;return(v[0]&255)<<16|(v[1]&255)<<8|v[2]&255},luminosity:function(){for(var v=this.rgb().color,c=[],p=0;p<v.length;p++){var g=v[p]/255;c[p]=g<=.03928?g/12.92:Math.pow((g+.055)/1.055,2.4)}return .2126*c[0]+.7152*c[1]+.0722*c[2]},contrast:function(v){var c=this.luminosity(),p=v.luminosity();return c>p?(c+.05)/(p+.05):(p+.05)/(c+.05)},level:function(v){var c=this.contrast(v);return c>=7.1?"AAA":c>=4.5?"AA":""},isDark:function(){var v=this.rgb().color,c=(v[0]*299+v[1]*587+v[2]*114)/1e3;return c<128},isLight:function(){return!this.isDark()},negate:function(){for(var v=this.rgb(),c=0;c<3;c++)v.color[c]=255-v.color[c];return v},lighten:function(v){var c=this.hsl();return c.color[2]+=c.color[2]*v,c},darken:function(v){var c=this.hsl();return c.color[2]-=c.color[2]*v,c},saturate:function(v){var c=this.hsl();return c.color[1]+=c.color[1]*v,c},desaturate:function(v){var c=this.hsl();return c.color[1]-=c.color[1]*v,c},whiten:function(v){var c=this.hwb();return c.color[1]+=c.color[1]*v,c},blacken:function(v){var c=this.hwb();return c.color[2]+=c.color[2]*v,c},grayscale:function(){var v=this.rgb().color,c=v[0]*.3+v[1]*.59+v[2]*.11;return o.rgb(c,c,c)},fade:function(v){return this.alpha(this.valpha-this.valpha*v)},opaquer:function(v){return this.alpha(this.valpha+this.valpha*v)},rotate:function(v){var c=this.hsl(),p=c.color[0];return p=(p+v)%360,p=p<0?360+p:p,c.color[0]=p,c},mix:function(v,c){if(!v||!v.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof v);var p=v.rgb(),g=this.rgb(),b=c===void 0?.5:c,y=2*b-1,E=p.alpha()-g.alpha(),S=((y*E===-1?y:(y+E)/(1+y*E))+1)/2,T=1-S;return o.rgb(S*p.red()+T*g.red(),S*p.green()+T*g.green(),S*p.blue()+T*g.blue(),p.alpha()*b+g.alpha()*(1-b))}},Object.keys(e).forEach(function(v){if(n.indexOf(v)===-1){var c=e[v].channels;o.prototype[v]=function(){if(this.model===v)return new o(this);if(arguments.length)return new o(arguments,v);var p=typeof arguments[c]=="number"?c:this.valpha;return new o(f(e[this.model][v].raw(this.color)).concat(p),v)},o[v]=function(p){return typeof p=="number"&&(p=h(r.call(arguments),c)),new o(p,v)}}});function s(v,c){return Number(v.toFixed(c))}function l(v){return function(c){return s(c,v)}}function u(v,c,p){return v=Array.isArray(v)?v:[v],v.forEach(function(g){(i[g]||(i[g]=[]))[c]=p}),v=v[0],function(g){var b;return arguments.length?(p&&(g=p(g)),b=this[v](),b.color[c]=g,b):(b=this[v]().color[c],p&&(b=p(b)),b)}}function d(v){return function(c){return Math.max(0,Math.min(v,c))}}function f(v){return Array.isArray(v)?v:[v]}function h(v,c){for(var p=0;p<c;p++)typeof v[p]!="number"&&(v[p]=0);return v}return di=o,di}var Hs;function dT(){if(Hs)return xn;Hs=1,Object.defineProperty(xn,"__esModule",{value:!0});var t=uT(),e=21.247;function r(n,a){a===void 0&&(a=e);try{var i=t(n||void 0),o=i.lab().array(),s=(100-o[0])*((100-a)/100)+a;n=t.lab(s,o[1],o[2]).rgb().alpha(i.alpha()).toString()}catch{}return n}return xn.default=r,xn}var zs;function fT(){return zs||(zs=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkColor=void 0;var e=dT();Object.defineProperty(t,"getDarkColor",{enumerable:!0,get:function(){return e.default}})})(ti)),ti}fT();var vT=X("<option> </option>"),cT=X('<button type="button"> </button>'),hT=X('<button type="button"> </button>'),pT=X('<input type="text opacity-0 absolute z-[-1]"/> <div class="_10 svelte-1yn45nn" role="dialog" aria-label="Table size selector" tabindex="-1"><div><div class="flex items-start flex-col md:flex-row md:items-center table-selector-section svelte-1yn45nn"><div class="w-80 table-selector-label svelte-1yn45nn">Columnas</div> <div class="flex flex-wrap items-center"></div></div> <div class="flex items-start flex-col md:flex-row md:items-center table-selector-section svelte-1yn45nn"><div class="w-80 table-selector-label svelte-1yn45nn">Filas</div> <div class="flex flex-wrap items-center"></div></div></div></div>',1),gT=X('<div class="rooster-group svelte-1yn45nn"><button type="button" aria-label="Add row above" class="svelte-1yn45nn">⬆ Row</button> <button type="button" aria-label="Add row below" class="svelte-1yn45nn">⬇ Row</button> <button type="button" aria-label="Add column left" class="svelte-1yn45nn">⬅ Col</button> <button type="button" aria-label="Add column right" class="svelte-1yn45nn">➡ Col</button> <button type="button" aria-label="Delete row" class="svelte-1yn45nn">🗑 Row</button> <button type="button" aria-label="Delete column" class="svelte-1yn45nn">🗑 Col</button></div>'),mT=X('<div class="rooster-dialog-overlay svelte-1yn45nn" role="button" tabindex="0"><div class="rooster-dialog svelte-1yn45nn" role="dialog" tabindex="-1"><h3 class="svelte-1yn45nn">Insert Image</h3> <input type="text" placeholder="Image URL" class="rooster-dialog-input svelte-1yn45nn"/> <div class="rooster-dialog-actions svelte-1yn45nn"><button type="button" class="svelte-1yn45nn">Insert</button> <button type="button" class="svelte-1yn45nn">Cancel</button></div></div></div>'),bT=X('<div class="rooster-toolbar relative svelte-1yn45nn" role="toolbar" aria-label="Editor toolbar" tabindex="-1"><div class="rooster-group svelte-1yn45nn"><span>Size</span> <select class="svelte-1yn45nn"></select></div> <button type="button" aria-label="Bold"><strong>B</strong></button> <button type="button" aria-label="Italic"><em>I</em></button> <button type="button" aria-label="Insert table">⊞</button> <label class="rooster-group svelte-1yn45nn" aria-label="Text color"><span>A</span> <input type="color"/></label> <label class="rooster-group svelte-1yn45nn" aria-label="Background color"><span>F</span> <input type="color"/></label> <button type="button" aria-label="Align left">⬅</button> <button type="button" aria-label="Align center">⬍</button> <button type="button" aria-label="Align right">➡</button> <button type="button" aria-label="Underline"><u>U</u></button> <button type="button" aria-label="Strikethrough"><s>S</s></button> <button type="button" aria-label="Justify">☰</button> <button type="button" aria-label="Bulleted list">••</button> <button type="button" aria-label="Numbered list">1.</button> <button type="button" aria-label="Insert horizontal rule" class="svelte-1yn45nn">─</button> <button type="button" aria-label="Insert image" class="svelte-1yn45nn">🖼</button> <button type="button" aria-label="Clear format" class="svelte-1yn45nn">Clear</button> <button type="button" aria-label="Undo" class="svelte-1yn45nn">↶</button> <button type="button" aria-label="Redo" class="svelte-1yn45nn">↷</button> <!> <!></div> <!> <div class="rooster-editor-container svelte-1yn45nn" style="position: relative;"><div class="rooster-editor svelte-1yn45nn" role="textbox" aria-label="Rich text editor" aria-multiline="true" contenteditable="true" data-placeholder="Empieza a escribir contenido enriquecido…"></div></div>',1),yT=X("<div><!></div>");function ET(t,e){It(e,!0);const r=Ce(e,"saveOn",7),n=()=>r()&&e.save&&(r()[e.save]??"")||"";let a=Q(null),i=Q(null),o=Q(null),s=Q(qe(n())),l=Q(qe({})),u=Q(!1),d=Q(qe(["8pt","9pt","10pt","11pt","12pt","14pt","16pt","18pt","20pt","24pt","28pt","32pt"])),f=Q("16pt"),h=Q(0),v=Q("#000000"),c=Q("#ffffff"),p=Q("Arial"),g=n(),b=null,y=Q(!1),E=Q(!1),S=Q(""),T=Q(0),k=Q(0);const R=()=>m(o)?.core,H=A=>{A&&(m(d).includes(A)||F(d,[...m(d),A],!0))},U=(A,V)=>{const te=A?.trim()?A:"<p></p>",N=new DOMParser().parseFromString(te,"text/html").body;if(!N)return;const O=V?hn(V.environment.domToModelSettings.calculated,V.api.createEditorContext(V,!1)):cn();return on(N,O)};let q,W=!1;const J=A=>{const te=new DOMParser().parseFromString(A,"text/html");return te.querySelectorAll("div").forEach(N=>{const O=N;O.style.removeProperty("margin-top"),O.style.removeProperty("margin-bottom"),O.style.removeProperty("font-family"),O.style.removeProperty("font-size"),O.style.removeProperty("color")}),te.querySelectorAll("td, th").forEach(N=>{const O=N;O.style.removeProperty("width"),O.style.removeProperty("height"),O.style.removeProperty("border-width"),O.style.removeProperty("border-style"),O.style.removeProperty("border-color")}),te.body.innerHTML},x=A=>{const V=R();if(!V)return;const te=J(A),de=U(te,V);de&&(V.api.setContentModel(V,de,{ignoreSelection:!0}),V.api.triggerEvent(V,{eventType:"contentChanged",source:Ue.SetContent},!0),setTimeout(()=>{m(a)&&G(m(a))},0))},G=A=>{A.querySelectorAll("div").forEach(de=>{const _=de;_.style.removeProperty("margin-top"),_.style.removeProperty("margin-bottom"),_.style.removeProperty("font-family"),_.style.removeProperty("font-size"),_.style.removeProperty("color")}),A.querySelectorAll("td, th").forEach(de=>{const _=de;_.style.removeProperty("width"),_.style.removeProperty("height"),_.style.removeProperty("border-width"),_.style.removeProperty("border-style"),_.style.removeProperty("border-color")})},pe=()=>{if(!m(a))return;G(m(a));const A=m(a).innerHTML;A!==m(s)&&F(s,A,!0)},$=()=>{if(!m(o)||!m(a)){F(u,!1);return}const A=m(o).getDOMSelection();if(!A){F(u,!1);return}if(A.type==="table"){F(u,!0);return}if(A.type==="range"){const V=A.range,te=[V.startContainer,V.commonAncestorContainer];for(const de of te){let _=de;for(;_&&_!==m(a);){if(_.nodeType===Node.ELEMENT_NODE){const O=_.tagName?.toUpperCase();if(O==="TABLE"||O==="TD"||O==="TH"||O==="TR"||O==="TBODY"||O==="THEAD"||O==="TFOOT"){F(u,!0);return}}_=_.parentNode}}}F(u,!1)},re=()=>{if(!m(o)){F(l,{},!0),F(u,!1);return}F(l,l1(m(o))??{},!0);const A=m(l).fontSize;A&&(H(A),F(f,A,!0));const V=m(l).headingLevel??0;F(h,V,!0);const te=m(l).fontName;te&&F(p,te,!0),$()},we=()=>{b!==null&&cancelAnimationFrame(b),b=requestAnimationFrame(()=>{b=null,re()})},$e=()=>{let A=null,V=null;return{getName:()=>"svelte-sync",initialize:te=>{A=te,F(o,te,!0),pe(),re(),m(a)&&Mf&&(V=new MutationObserver(de=>{de.forEach(_=>{_.addedNodes.forEach(N=>{if(N.nodeType===Node.ELEMENT_NODE){const O=N;G(O),(O.tagName==="DIV"||O.tagName==="TD"||O.tagName==="TH")&&(O.tagName==="DIV"?(O.style.removeProperty("margin-top"),O.style.removeProperty("margin-bottom"),O.style.removeProperty("font-family"),O.style.removeProperty("font-size"),O.style.removeProperty("color")):(O.style.removeProperty("width"),O.style.removeProperty("height"),O.style.removeProperty("border-width"),O.style.removeProperty("border-style"),O.style.removeProperty("border-color")))}})})}),V.observe(m(a),{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style"]}))},dispose:()=>{V&&(V.disconnect(),V=null),A&&m(o)===A&&F(o,null),A=null},onPluginEvent:te=>{te.eventType==="contentChanged"&&(pe(),m(a)&&setTimeout(()=>{G(m(a))},0)),(te.eventType==="contentChanged"||te.eventType==="selectionChanged")&&(te.eventType==="selectionChanged"&&$(),we())}}},se=A=>{m(o)&&(m(o).focus(),A(m(o)),we())},ot=A=>{F(f,A,!0),se(V=>Ky(V,A))},bt=A=>{F(v,A,!0),se(V=>Wy(V,A))},ke=A=>{F(c,A,!0),se(V=>Gy(V,A))},fe=A=>{se(V=>n1(V,A))},Re=()=>{m(T)>0&&m(k)>0&&(se(A=>Ey(A,m(T),m(k))),F(E,!1),F(T,0),F(k,0))},lt=A=>{F(T,A,!0),m(T)>0&&m(k)>0&&Re()},ge=A=>{F(k,A,!0),m(T)>0&&m(k)>0&&Re()},Ne=()=>{F(E,!1),F(T,0),F(k,0)},et=()=>{if(m(S).trim()&&m(o)){const A=R();if(A){const V=document.createElement("img");V.src=m(S).trim(),V.style.maxWidth="100%",A.api.insertNode(A,V),F(y,!1),F(S,"")}}},Gt=()=>{if(m(o)){const A=R();if(A){const V=document.createElement("hr");A.api.insertNode(A,V)}}};_f(()=>{if(!m(a))return;const A=U(m(s)),V=$e(),te=new Q1,de=tT(m(a),[V,te],A);F(o,de,!0);const _=()=>{setTimeout(()=>{$()},0)};return m(a).addEventListener("click",_),m(a).addEventListener("focus",_),()=>{b!==null&&(cancelAnimationFrame(b),b=null),m(a)?.removeEventListener("click",_),m(a)?.removeEventListener("focus",_),de.dispose(),F(o,null)}}),nt(()=>{!r()||!e.save||m(s)!==g&&(g=m(s),r()[e.save]=m(s))}),nt(()=>{if(!r()||!e.save)return;const A=(r()[e.save]??"")||"";A!==m(s)&&(g=A,F(s,A,!0),m(o)&&x(A))});var st=yT(),Tt=z(st);{var dr=A=>{var V=bT(),te=Ct(V);te.__click=Y=>{m(E)&&Y.target.closest("._10")},te.__keydown=Y=>{Y.key==="Escape"&&m(E)};var de=z(te),_=D(z(de),2);_.__change=Y=>ot(Y.currentTarget.value),vt(_,21,()=>m(d),ct,(Y,Ie)=>{var Me=vT(),Be=z(Me,!0);I(Me);var tt={};ne(()=>{Le(Be,m(Ie)),tt!==(tt=m(Ie))&&(Me.value=(Me.__value=m(Ie))??"")}),j(Y,Me)}),I(_),I(de);var N=D(de,2);N.__click=()=>se(Id);let O;var oe=D(N,2);oe.__click=()=>se(Bd);let ve;var _e=D(oe,2);_e.__click=()=>{F(E,!m(E)),Gs().then(()=>q?.focus())};let ue;var Ee=D(_e,2),Fe=D(z(Ee),2);za(Fe),Fe.__input=Y=>bt(Y.currentTarget.value),I(Ee);var wt=D(Ee,2),kt=D(z(wt),2);za(kt),kt.__input=Y=>ke(Y.currentTarget.value),I(wt);var Zt=D(wt,2);Zt.__click=()=>fe("left");let yn;var En=D(Zt,2);En.__click=()=>fe("center");let Co;var Cn=D(En,2);Cn.__click=()=>fe("right");let So;var Sn=D(Cn,2);Sn.__click=()=>se(Hd);let To;var Tn=D(Sn,2);Tn.__click=()=>se(Uy);let wo;var wn=D(Tn,2);wn.__click=()=>fe("justify");let ko;var kn=D(wn,2);kn.__click=()=>se(Fd);let _o;var _n=D(kn,2);_n.__click=()=>se(Pd);let Mo;var La=D(_n,2);La.__click=Gt;var Ra=D(La,2);Ra.__click=()=>F(y,!0);var Fa=D(Ra,2);Fa.__click=()=>se(Gd);var Pa=D(Fa,2);Pa.__click=()=>{if(m(o)){const Y=R();Y&&(Y.api.undo(Y),we())}};var Aa=D(Pa,2);Aa.__click=()=>{if(m(o)){const Y=R();Y&&(Y.api.redo(Y),we())}};var Do=D(Aa,2);{var bf=Y=>{var Ie=pT(),Me=Ct(Ie);jt(Me,dt=>q=dt,()=>q);var Be=D(Me,2);Be.__mousedown=()=>W=!0,Be.__click=dt=>dt.stopPropagation(),Be.__keydown=dt=>{dt.key==="Escape"&&Ne()};var tt=z(Be),ut=z(tt),Kt=D(z(ut),2);vt(Kt,20,()=>Array(12),ct,(dt,Tf,Ia)=>{const _t=ye(()=>Ia+1);var Ye=cT();let Br;Ye.__click=()=>ge(m(_t));var Ba=z(Ye,!0);I(Ye),ne(()=>{Br=Z(Ye,1,"mr-4 mb-4 table-selector-box svelte-1yn45nn",null,Br,{selected:m(k)>=m(_t)}),wr(Ye,"aria-label",`Select ${m(_t)??""} columns`),Le(Ba,m(_t))}),j(dt,Ye)}),I(Kt),I(ut);var De=D(ut,2),We=D(z(De),2);vt(We,20,()=>Array(12),ct,(dt,Tf,Ia)=>{const _t=ye(()=>Ia+1);var Ye=hT();let Br;Ye.__click=()=>lt(m(_t));var Ba=z(Ye,!0);I(Ye),ne(()=>{Br=Z(Ye,1,"mr-4 mb-4 table-selector-box svelte-1yn45nn",null,Br,{selected:m(T)>=m(_t)}),wr(Ye,"aria-label",`Select ${m(_t)??""} rows`),Le(Ba,m(_t))}),j(dt,Ye)}),I(We),I(De),I(tt),I(Be),Gr("blur",Me,dt=>{if(W){W=!1,dt.target.focus();return}F(E,!1)}),j(Y,Ie)};le(Do,Y=>{m(E)&&Y(bf)})}var yf=D(Do,2);{var Ef=Y=>{var Ie=gT(),Me=z(Ie);Me.__click=()=>se(We=>vr(We,"insertAbove"));var Be=D(Me,2);Be.__click=()=>se(We=>vr(We,"insertBelow"));var tt=D(Be,2);tt.__click=()=>se(We=>vr(We,"insertLeft"));var ut=D(tt,2);ut.__click=()=>se(We=>vr(We,"insertRight"));var Kt=D(ut,2);Kt.__click=()=>se(We=>vr(We,"deleteRow"));var De=D(Kt,2);De.__click=()=>se(We=>vr(We,"deleteColumn")),I(Ie),ne(()=>{Me.disabled=!m(o),Be.disabled=!m(o),tt.disabled=!m(o),ut.disabled=!m(o),Kt.disabled=!m(o),De.disabled=!m(o)}),j(Y,Ie)};le(yf,Y=>{m(u)&&Y(Ef)})}I(te);var Oo=D(te,2);{var Cf=Y=>{var Ie=mT();Ie.__click=()=>F(y,!1),Ie.__keydown=De=>{(De.key==="Escape"||De.key==="Enter")&&F(y,!1)};var Me=z(Ie);Me.__click=De=>De.stopPropagation(),Me.__keydown=De=>{De.key==="Escape"&&F(y,!1)};var Be=D(z(Me),2);za(Be),Be.__keydown=De=>{De.key==="Enter"&&et()};var tt=D(Be,2),ut=z(tt);ut.__click=et;var Kt=D(ut,2);Kt.__click=()=>{F(y,!1),F(S,"")},I(tt),I(Me),I(Ie),ne(De=>ut.disabled=De,[()=>!m(S).trim()]),Ha(Be,()=>m(S),De=>F(S,De)),j(Y,Ie)};le(Oo,Y=>{m(y)&&Y(Cf)})}var Na=D(Oo,2),Sf=z(Na);jt(Sf,Y=>F(a,Y),()=>m(a)),I(Na),jt(Na,Y=>F(i,Y),()=>m(i)),ne(()=>{_.disabled=!m(o),N.disabled=!m(o),O=Z(N,1,"svelte-1yn45nn",null,O,{active:!!m(l).isBold}),oe.disabled=!m(o),ve=Z(oe,1,"svelte-1yn45nn",null,ve,{active:!!m(l).isItalic}),_e.disabled=!m(o),ue=Z(_e,1,"svelte-1yn45nn",null,ue,{_11:m(E)}),Fe.disabled=!m(o),kt.disabled=!m(o),Zt.disabled=!m(o),yn=Z(Zt,1,"svelte-1yn45nn",null,yn,{active:m(l).textAlign==="left"||!m(l).textAlign}),En.disabled=!m(o),Co=Z(En,1,"svelte-1yn45nn",null,Co,{active:m(l).textAlign==="center"}),Cn.disabled=!m(o),So=Z(Cn,1,"svelte-1yn45nn",null,So,{active:m(l).textAlign==="right"}),Sn.disabled=!m(o),To=Z(Sn,1,"svelte-1yn45nn",null,To,{active:!!m(l).isUnderline}),Tn.disabled=!m(o),wo=Z(Tn,1,"svelte-1yn45nn",null,wo,{active:!!m(l).isStrikeThrough}),wn.disabled=!m(o),ko=Z(wn,1,"svelte-1yn45nn",null,ko,{active:m(l).textAlign==="justify"}),kn.disabled=!m(o),_o=Z(kn,1,"svelte-1yn45nn",null,_o,{active:!!m(l).isBullet}),_n.disabled=!m(o),Mo=Z(_n,1,"svelte-1yn45nn",null,Mo,{active:!!m(l).isNumbering}),La.disabled=!m(o),Ra.disabled=!m(o),Fa.disabled=!m(o),Pa.disabled=!m(o),Aa.disabled=!m(o)}),kf(_,()=>m(f),Y=>F(f,Y)),Ha(Fe,()=>m(v),Y=>F(v,Y)),Ha(kt,()=>m(c),Y=>F(c,Y)),j(A,V)};le(Tt,A=>{A(dr)})}I(st),ne(()=>Z(st,1,`rooster-wrapper ${e.css??""}`,"svelte-1yn45nn")),j(t,st),Bt()}Ht(["click","keydown","change","input","mousedown"]);var CT=X("<span> </span>"),ST=X("<span> <br/> </span>"),TT=X("<button><!></button>"),wT=X("<div></div>");function mf(t,e){It(e,!0);const r=o=>{let s="";return(Array.isArray(o)?o[0]:(e.keyField?o?.[e.keyField]:0)||0)===e.selected&&(s+=" _3"),e.buttonCss&&(s+=" "+e.buttonCss),s},n=o=>Array.isArray(o)?Ae.deviceType===3&&Array.isArray(o[2])?o[2]:[o[1]]:e.valueField?[o[e.valueField]]:[""];var a=wT();let i;vt(a,21,()=>e.options,ct,(o,s)=>{const l=ye(()=>n(m(s)));var u=TT();u.__click=v=>{v.stopPropagation(),e.onSelect(m(s))};var d=z(u);{var f=v=>{var c=CT(),p=z(c,!0);I(c),ne(()=>Le(p,m(l)[0])),j(v,c)},h=v=>{var c=ST(),p=z(c,!0),g=D(p,2,!0);I(c),ne(()=>{Le(p,m(l)[0]),Le(g,m(l)[1])}),j(v,c)};le(d,v=>{m(l).length===1?v(f):v(h,!1)})}I(u),ne(v=>Z(u,1,`flex items-center ff-bold _2 ${v??""}`,"svelte-1stmgp7"),[()=>r(m(s))]),j(o,u)}),I(a),ne(()=>i=Z(a,1,`_1 pb-4 md:pb-0 flex items-center shrink-0 max-w-[100%] overflow-x-auto overflow-y-hidden ${e.css??""}`,"svelte-1stmgp7",i,{_5:e.useMobileGrid,"grid-cols-2":e.useMobileGrid&&e.options.length===2,"grid-cols-3":e.useMobileGrid&&e.options.length===3,"grid-cols-4":e.useMobileGrid&&e.options.length===4,"grid-cols-5":e.useMobileGrid&&e.options.length===5})),j(t,a),Bt()}Ht(["click"]);var kT=X('<button class="bx-red mr-8 lh-10" aria-label="Eliminar"><i class="icon-trash"></i></button>'),_T=X('<button class="bx-blue mr-8 lh-10" aria-label="Guardar"><i class="icon-floppy"></i> <span> </span></button>'),MT=X('<div><div class="flex items-center justify-between"><div> </div> <div class="shrink-0 flex items-center"><!> <!> <button class="bx-yellow" title="close"><i class="icon-cancel"></i></button></div></div> <!> <div><!></div></div>'),DT=X('<div class="w-page"><!></div>'),OT=X("<!> <!>",1);function xs(t,e){It(e,!0);let r;const n=350,a=ye(()=>Ro.sideLayerSize+"px"),i=ye(()=>Ae.showSideLayer>0&&Ae.deviceType!==3?`calc(var(--page-width) - ${m(a)} - 8px)`:void 0),o=v=>{Ae.deviceType===3&&document.startViewTransition?Gs().then(()=>{r&&r.style.setProperty("view-transition-name","mobile-side-layer"),setTimeout(()=>{r&&r.style.setProperty("view-transition-name","")},n),document.startViewTransition(()=>{Ae.showSideLayer=v})}):Ae.showSideLayer=v},s=()=>{o(0)};nt(()=>{e.type!=="side"||Ae.deviceType!==3||Ae.showSideLayer===e.id&&r&&(r.style.setProperty("view-transition-name","mobile-side-layer"),setTimeout(()=>{r&&r.style.setProperty("view-transition-name","")},n))}),nt(()=>{Ae.setSideLayer=o}),console.log("Env.sideLayerSize",Ro.sideLayerSize);var l=OT(),u=Ct(l);{var d=v=>{var c=MT(),p=z(c),g=z(p),b=z(g,!0);I(g);var y=D(g,2),E=z(y);{var S=J=>{var x=kT();x.__click=function(...G){e.onDelete?.apply(this,G)},j(J,x)};le(E,J=>{e.onDelete&&J(S)})}var T=D(E,2);{var k=J=>{var x=_T();x.__click=function(...$){e.onSave?.apply(this,$)};var G=D(z(x),2),pe=z(G,!0);I(G),I(x),ne(()=>Le(pe,e.saveButtonName)),j(J,x)};le(T,J=>{e.onSave&&J(k)})}var R=D(T,2);R.__click=J=>{J.stopPropagation(),s(),e.onClose&&(Ae.deviceType===3?setTimeout(()=>{e.onClose()},300):e.onClose())},I(y),I(p);var H=D(p,2);{var U=J=>{mf(J,{get options(){return e.options},get selected(){return e.selected},useMobileGrid:!0,onSelect:x=>{e.onSelect?.(x)},css:"mt-2"})};le(H,J=>{(e.options||[]).length>0&&J(U)})}var q=D(H,2),W=z(q);Zn(W,()=>e.children),I(q),I(c),jt(c,J=>r=J,()=>r),ne(()=>{Z(c,1,`_1 flex flex-col ${(e.css||"")??""}`,"svelte-n6zgrd"),wr(c,"data-layer-id",e.id),Lo(c,`width: ${m(a)??""};`),Z(g,1,`overflow-hidden text-nowrap mr-8 ${e.titleCss??""}`,"svelte-n6zgrd"),Le(b,e.title),Z(q,1,`_2 grow-1 ${e.contentCss??""}`,"svelte-n6zgrd")}),j(v,c)};le(u,v=>{Ae.showSideLayer===e.id&&e.type=="side"&&v(d)})}var f=D(u,2);{var h=v=>{var c=DT();let p;var g=z(c);Zn(g,()=>e.children),I(c),ne(()=>p=Lo(c,"",p,{width:m(i)})),j(v,c)};le(f,v=>{e.type=="content"&&v(h)})}j(t,l),Bt()}Ht(["click"]);var LT=X('<div><div class="svelte-1m1yl0c"></div></div> <div> <!></div> <div><div class="svelte-1m1yl0c"></div></div> <div><div class="svelte-1m1yl0c"></div></div>',1),RT=X('<div><div class="svelte-1m1yl0c"></div></div>'),FT=X("<input/>"),PT=X('<div class="fs15 mt-2 _10 svelte-1m1yl0c"> </div>'),AT=X('<div role="button" tabindex="0"><div class="h100 w100 flex items-center svelte-1m1yl0c"><!></div></div>'),NT=X('<div class="svelte-1m1yl0c">Cargando...</div>'),IT=X("<div><i></i></div>"),BT=X("<span> </span>"),HT=X('<div role="button" tabindex="0"><div></div></div>'),zT=X('<div role="button" tabindex="0"></div>'),xT=X("<div><!> <div><!> <!> <!></div> <!> <!> <!></div>");function Xn(t,e){It(e,!0);const r=Ce(e,"saveOn",15),n=Ce(e,"css",3,""),a=Ce(e,"options",19,()=>[]),i=Ce(e,"max",3,100),o=Ce(e,"notEmpty",3,!1),s=Ce(e,"required",3,!1),l=Ce(e,"disabled",3,!1),u=Ce(e,"clearOnSelect",3,!1),d=Ce(e,"avoidIDs",19,()=>[]),f=Ce(e,"inputCss",3,""),h=Ce(e,"showLoading",3,!1);let v=Q(!1),c=Q(qe([...a()])),p=Q(-1),g=Q(!1),b=Q(0),y=Q(""),E=!1,S,T=[];const k=ye(()=>Ae.deviceType===3),R=ye(()=>m(k)),H=ye(()=>l()||h());function U(_){m(R)?F(y,_,!0):S&&(S.value=_)}function q(){let _=e.selected;typeof _>"u"&&e.save&&r()&&(_=r()[e.save]);let N;return _&&(N=a().find(O=>O[e.keyId]===_)),N}function W(){return s()&&!l()}let J=Date.now();const x=(_,N)=>{const O=Date.now();if(O-J<80)return;J=O,o()&&!_&&(_=q()),_&&!u()?U(_[e.keyName]):U("");const oe=_?_[e.keyId]:null;W()&&F(b,oe?2:1,!0),u()?e.onChange&&e.onChange(_):r()&&e.save?(r()[e.save]||null)!==oe&&(r(r()[e.save]=oe,!0),e.onChange&&e.onChange(_)):typeof e.selected<"u"&&(e.selected||null)!==oe&&e.onChange&&e.onChange(_)},G=_=>{if(!_&&(d()?.length||0)===0)return[...a()];const N=new Set(d()||[]),O=[],oe=_.toLowerCase().split(" ").filter(ve=>ve.length>1);for(const ve of a())if(!(N.size>0&&N.has(ve[e.keyId])))if(oe.length===0)O.push(ve);else{const _e=ve[e.keyName];typeof _e=="string"&&Lf(_e.toLowerCase(),oe)&&O.push(ve)}return O};function pe(_){_.stopPropagation();const N=_.target,O=String(N.value||"").toLowerCase();js(()=>{T=String(S.value).split(" "),F(c,G(O),!0)},120)}function $(_){console.log("avoid hover:: ",m(g)),_.stopPropagation();let N=m(c).length;if(N>i()&&(N=i()),!(!m(v)||m(c).length===0)){if(_.key==="ArrowUp"){let O=(m(p)||0)-1;O<0&&(O=N),F(p,O,!0),m(g)||F(g,!0)}else if(_.key==="ArrowDown"){let O=(m(p)||0)+1;O>N&&(O=1),F(p,O,!0),m(g)||F(g,!0)}}}function re(_){x(_),S&&S.blur(),F(v,!1)}let we=ye(()=>`${Mt.input} p-rel${n()?` ${n()}`:""}${e.label?"":" no-label"}`);function $e(){return m(b)?m(b)===2?'<i class="v-icon icon-ok c-green"></i>':m(b)===1?'<i class="v-icon icon-attention c-red"></i>':null:null}nt(()=>{const _=q();U(_?_[e.keyName]:""),W()&&F(b,_?2:1,!0)}),nt(()=>{F(c,G(""),!0)});const se=()=>{Ae.showMobileSearchLayer={options:m(c),keyName:e.keyName,keyID:e.keyId,onSelect:_=>{re(_)},onRemove:_=>{}}};var ot=xT(),bt=z(ot);{var ke=_=>{var N=LT(),O=Ct(N),oe=D(O,2),ve=z(oe,!0),_e=D(ve);No(_e,()=>$e()||""),I(oe);var ue=D(oe,2),Ee=D(ue,2);ne(()=>{Z(O,1,Lt(Mt.input_lab_cell_left),"svelte-1m1yl0c"),Z(oe,1,Lt(Mt.input_lab),"svelte-1m1yl0c"),Le(ve,e.label),Z(ue,1,Lt(Mt.input_lab_cell_right),"svelte-1m1yl0c"),Z(Ee,1,Lt(Mt.input_shadow_layer),"svelte-1m1yl0c")}),j(_,N)};le(bt,_=>{e.label&&_(ke)})}var fe=D(bt,2),Re=z(fe);{var lt=_=>{var N=RT();ne(()=>Z(N,1,Lt(Mt.input_div_1),"svelte-1m1yl0c")),j(_,N)};le(Re,_=>{e.label&&_(lt)})}var ge=D(Re,2);{var Ne=_=>{var N=FT();N.__keyup=pe,N.__keydown=O=>{O.stopPropagation(),console.log(O),$(O)},jt(N,O=>S=O,()=>S),ne(()=>{Z(N,1,`w-full ${Mt.input_inp} ${f()}`,"svelte-1m1yl0c"),wr(N,"placeholder",h()?"":e.placeholder||":: seleccione ::"),N.disabled=m(H)||m(k)}),Gr("paste",N,pe),Gr("cut",N,pe),Gr("focus",N,O=>{O.stopPropagation(),m(v)||(T=[],F(c,G(""),!0),F(v,!0))}),Gr("blur",N,O=>{if(O.stopPropagation(),console.log("avoidBlur 2",E),E){E=!1,S.focus();return}let oe=String(S.value||"").toLowerCase();const ve=a().find(_e=>String(_e[e.keyName]||"").toLowerCase()===oe);x(ve),F(v,!1)}),j(_,N)},et=_=>{var N=AT();N.__keydown=ue=>{(ue.key==="Enter"||ue.key===" ")&&se()},N.__click=ue=>{ue.stopPropagation(),se()};var O=z(N),oe=z(O);{var ve=ue=>{var Ee=Ks();ne(()=>Le(Ee,m(y))),j(ue,Ee)},_e=ue=>{var Ee=PT(),Fe=z(Ee,!0);I(Ee),ne(()=>Le(Fe,e.placeholder||"")),j(ue,Ee)};le(oe,ue=>{m(y)?ue(ve):ue(_e,!1)})}I(O),I(N),ne(()=>Z(N,1,`w-full flex items-center ${Mt.input_inp} ${f()}`,"svelte-1m1yl0c")),j(_,N)};le(ge,_=>{m(R)?_(et,!1):_(Ne)})}var Gt=D(ge,2);{var st=_=>{var N=fi(),O=Ct(N);No(O,()=>$e()||""),j(_,N)};le(Gt,_=>{e.label||_(st)})}I(fe);var Tt=D(fe,2);{var dr=_=>{var N=NT();j(_,N)};le(Tt,_=>{h()&&_(dr)})}var A=D(Tt,2);{var V=_=>{var N=IT(),O=z(N);I(N),ne(()=>{Z(N,1,`absolute bottom-8 right-6 pointer-events-none ${m(v)&&!e.icon?"show":""}`,"svelte-1m1yl0c"),Z(O,1,Lt(e.icon||"icon-down-open-1"),"svelte-1m1yl0c")}),j(_,N)};le(A,_=>{m(H)||_(V)})}var te=D(A,2);{var de=_=>{var N=zT();N.__mousedown=O=>{O.stopPropagation(),E=!0,console.log("avoidBlur 1",E)},N.__mousemove=function(...O){(m(g)?oe=>{console.log("hover aqui:: ",m(p)),oe.stopPropagation(),m(g)&&(F(p,-1),F(g,!1))}:void 0)?.apply(this,O)},vt(N,21,()=>m(c),ct,(O,oe,ve)=>{const _e=ye(()=>String(m(oe)[e.keyName]));var ue=HT();ue.__click=Fe=>{Fe.stopPropagation(),re(m(oe))};var Ee=z(ue);vt(Ee,21,()=>Pf(m(_e),T),ct,(Fe,wt)=>{var kt=BT();let Zt;var yn=z(kt,!0);I(kt),ne(()=>{Zt=Z(kt,1,Lt(m(wt).highl?"_8":""),"svelte-1m1yl0c",Zt,{"mr-4":m(wt).isEnd}),Le(yn,m(wt).text)}),j(Fe,kt)}),I(Ee),I(ue),ne(()=>Z(ue,1,`flex ai-center _highlight${m(p)===ve?" _selected":""}`,"svelte-1m1yl0c")),j(O,ue)}),I(N),ne(()=>Z(N,1,`p-4 _1 left-0 z-40 w-full${m(p)>=0?" on-arrow":""}`,"svelte-1m1yl0c")),j(_,N)};le(te,_=>{m(v)&&!m(R)&&_(de)})}I(ot),ne(()=>{Z(ot,1,Lt(m(we)),"svelte-1m1yl0c"),Z(fe,1,`${Mt.input_div} flex w-full`,"svelte-1m1yl0c")}),j(t,ot),Bt()}Ht(["keyup","keydown","click","mousedown","mousemove"]);var UT=X('<div class="m-2 px-8 min-w-56 h-32 lh-10 flex _3 svelte-vrzsuu"> <button class="_4 absolute w-28 h-28 rounded right-2 svelte-vrzsuu" aria-label="eliminar"><i class="icon-trash"></i></button></div>'),GT=X("<div><!> <div></div></div>");function KT(t,e){It(e,!0);const r=Ce(e,"saveOn",15),n=Ce(e,"css",3,""),a=Ce(e,"options",19,()=>[]);let i=Q(qe([]));const o=()=>{if(xa.has(a()))return;const v=new Map,c=new Map;for(const p of a())v.set(p[e.keyId],p),c.set(p[e.keyName].toLowerCase(),p);xa.set(a(),{idToRecord:v,valueToRecord:c})};o(),nt(()=>{a()?.length>0&&o()});const s=()=>{r()&&e.save&&r(r()[e.save]=m(i),!0),e.onChange&&e.onChange(m(i))};let l;nt(()=>{r()&&e.save&&r()!==l&&(l=r(),o(),Yn(()=>{F(i,r()[e.save]||[],!0)}))});const u=v=>(xa.get(a())?.idToRecord||new Map).get(v)||{[e.keyName]:`ID-${v}`,[e.keyId]:v};var d=GT(),f=z(d);{let v=ye(()=>"s1 "+e.inputCss);Xn(f,{get options(){return a()},get keyId(){return e.keyId},get keyName(){return e.keyName},clearOnSelect:!0,get avoidIDs(){return m(i)},get placeholder(){return e.label},get css(){return m(v)},onChange:c=>{if(!c)return;const p=c[e.keyId];m(i).includes(p)||(m(i).push(p),s())}})}var h=D(f,2);vt(h,21,()=>m(i),ct,(v,c)=>{const p=ye(()=>u(m(c)));var g=UT(),b=z(g),y=D(b);y.__click=E=>{E.stopPropagation(),F(i,m(i).filter(S=>S!==m(c)),!0),s()},I(g),ne(()=>Le(b,`${m(p)[e.keyName]??""} `)),j(v,g)}),I(h),I(d),ne(()=>{Z(d,1,Lt(n()),"svelte-vrzsuu"),Z(h,1,`p-4 min-h-40 _2 flex flex-wrap ${e.cardCss??""}`,"svelte-vrzsuu")}),j(t,d),Bt()}Ht(["click"]);var WT=X('<button class="bx-red mr-8 lh-10" aria-label="Eliminar"><i class="icon-trash"></i></button>'),VT=X('<button class="bx-blue mr-8 lh-10"><i class="icon-floppy"></i> <span> </span></button>'),jT=X('<div class="_1 fixed top-0 left-0 flex items-center justify-center svelte-1bxxaoh"><div><div><div class="flex items-center ff-bold h2"><!></div> <div class="flex items-center"><!> <!> <button class="bx-yellow h3 lh-10" aria-label="Cerrar"><i class="icon-cancel"></i></button></div></div> <div><!></div></div></div>');function qT(t,e){It(e,!0);let r=Ce(e,"css",3,""),n=Ce(e,"isEdit",3,!1),a=Q(!1),i=Q(void 0);nt(()=>{const c=Df.includes(e.id);m(a)!==c&&(c?(F(a,!0),Yn(()=>{setTimeout(()=>{m(i)&&m(i).classList.add("show")},0)})):Yn(()=>{m(i)?.classList?.remove("show"),setTimeout(()=>{F(a,!1)},300)}))});function o(c){c.stopPropagation(),e.onClose&&e.onClose(),Ws(e.id)}function s(c){e.onDelete&&(e.onDelete(),c.stopPropagation())}function l(c){e.onSave&&(e.onSave(),c.stopPropagation())}function u(c){return typeof c=="function"}const d=new Map([[1,"w-600 max-w-[64vw]"],[2,"w-650 max-w-[66vw]"],[3,"w-700 max-w-[68vw]"],[4,"w-750 max-w-[72vw]"],[5,"w-800 max-w-[75vw]"],[6,"w-850 max-w-[78vw]"],[7,"w-900 max-w-[82vw]"],[8,"w-950 max-w-[84vw]"],[9,"w-1000 max-w-[88vw]"]]);var f=fi(),h=Ct(f);{var v=c=>{Nf(c,{children:(p,g)=>{var b=jT(),y=z(b),E=z(y),S=z(E),T=z(S);{var k=$=>{var re=fi(),we=Ct(re);Zn(we,()=>e.title),j($,re)},R=$=>{var re=Ks();ne(()=>Le(re,e.title)),j($,re)};le(T,$=>{u(e.title)?$(k):$(R,!1)})}I(S);var H=D(S,2),U=z(H);{var q=$=>{var re=WT();re.__click=s,j($,re)};le(U,$=>{e.onDelete&&$(q)})}var W=D(U,2);{var J=$=>{var re=VT();re.__click=l;var we=D(z(re),2),$e=z(we,!0);I(we),I(re),ne(()=>{wr(re,"aria-label",n()?"Actualizar":"Guardar"),Le($e,n()?"Actualizar":"Guardar")}),j($,re)};le(W,$=>{e.onSave&&$(J)})}var x=D(W,2);x.__click=o,I(H),I(E);var G=D(E,2),pe=z(G);Zn(pe,()=>e.children??wf),I(G),I(y),I(b),jt(b,$=>F(i,$),()=>m(i)),ne($=>{Z(y,1,`_2 pt-50 min-h-460 flex flex-col relative ${r()??""} ${$??""}`,"svelte-1bxxaoh"),Z(E,1,`_3 h-50 py-0 px-12 flex absolute w-full top-0 left-0 items-center justify-between mb-auto ${e.headCss??""}`,"svelte-1bxxaoh"),Z(G,1,`w-full grow py-6 px-10 ${e.bodyCss??""}`,"svelte-1bxxaoh")},[()=>d.get(e.size)]),j(p,b)},$$slots:{default:!0}})};le(h,c=>{m(a)&&c(v)})}j(t,f),Bt()}Ht(["click"]);class XT extends Vs{route="productos";useCache={min:5,ver:9};#e=Q(qe([]));get productos(){return m(this.#e)}set productos(e){F(this.#e,e,!0)}#t=Q(qe(new Map));get productosMap(){return m(this.#t)}set productosMap(e){F(this.#t,e,!0)}handler(e){console.log("productos result::",e);for(const r of e)r.Image=r.Images?.[0],r.CategoriasIDs=r.CategoriasIDs||[];this.productos=e,this.productosMap=new Map(e.map(r=>[r.ID,r]))}constructor(){super(),this.fetch()}}const YT=t=>Oi({data:t,route:"productos",refreshRoutes:["productos"]});class ZT extends Vs{route="listas-compartidas2";useCache={min:5,ver:6};#e=Q(qe([]));get Records(){return m(this.#e)}set Records(e){F(this.#e,e,!0)}#t=Q(qe(new Map));get RecordsMap(){return m(this.#t)}set RecordsMap(e){F(this.#t,e,!0)}#r=Q(qe(new Map));get ListaRecordsMap(){return m(this.#r)}set ListaRecordsMap(e){F(this.#r,e,!0)}get(e){return this.RecordsMap.get(e)}handler(e){console.log("result getted::",e),this.Records=[],this.ListaRecordsMap=new Map;for(const[r,n]of Object.entries(e)){const a=parseInt(r.split("_")[1]);for(const i of n)if(i.ss){if(this.Records.push(i),[1,2].includes(a)){const o=new Map((i.Images||[]).filter(s=>s).map(s=>[parseInt(s.split("-")[1]),s]));i.Images=[];for(const s of[1,2,3])i.Images.push(o.get(s)||"")}this.ListaRecordsMap.has(i.ListaID)?this.ListaRecordsMap.get(i.ListaID)?.push(i):this.ListaRecordsMap.set(i.ListaID,[i])}}this.RecordsMap=new Map(this.Records.map(r=>[r.ID,r]))}addNew(e){const r=this.ListaRecordsMap.get(e.ListaID)||[];r.unshift(e),this.ListaRecordsMap.set(e.ListaID,[...r]),this.ListaRecordsMap=new Map(this.ListaRecordsMap),this.RecordsMap.set(e.ID,e),this.Records.push(e)}constructor(e=[]){super(),e.length>0&&(this.route=`listas-compartidas2?ids=${e.join(",")}`),e&&this.fetch()}}const JT=t=>Oi({data:t,route:"listas-compartidas",refreshRoutes:["listas-compartidas2"]});var QT=X('<div class="_1 px-12 py-10 w-250 min-h-140 svelte-u9lhhq" role="button" tabindex="0"><div class="min-h-70 _2 mb-2 svelte-u9lhhq"></div> <div class="fs17 ff-semibold"> </div> <div class="fs15"> </div></div>'),$T=X('<div class="grid grid-cols-12 gap-10 p-6"><!> <!> <!></div>'),ew=X('<div class="w-full flex flex-wrap gap-12"></div> <!>',1);function Us(t,e){It(e,!0);const r=Ce(e,"listas",7),n=ye(()=>(console.log("listas getted:",Vt(r())),r().ListaRecordsMap.get(e.origin)||[]));let a=Q(qe({}));const i=[151,152,153];let o=Q(qe([{_id:151},{_id:152},{_id:153}]));const s=async c=>{if(console.log("form a enviar 1::",Vt(m(a)),c),(m(a).Nombre||"").length<4||!m(a).ListaID){qr.failure("Debe colocar un nombre de al menos 4 caracteres.");return}yt.standard("Guardando categoría..."),m(a).Images=m(a).Images||[],m(a).ss=c?0:1;for(let y=0;y<i.length;y++){const E=i[y];if(Fo.has(E)){yt.change(`Guardando Imagen ${y+1}`);let T=(await Fo.get(E)?.())?.imageName||"";T.includes("/")&&(T=T.split("/")[1]),m(a).Images[y]=T}else m(a).Images[y]=m(a).Images?.[y]||""}console.log("form a enviar 2::",Vt(m(a))),yt.change("Guardando categoría...");let p;try{p=await JT([m(a)])}catch(y){qr.failure(y);return}const g=m(n).find(y=>y.ID===m(a).ID);let b=[...m(n)];g&&c?b=b.filter(y=>y.ID!==m(a).ID):g?Object.assign(g,m(a)):(m(a).ID=p[0].NewID,b.push(m(a)),r().RecordsMap.set(m(a).ID,m(a))),console.log("newCategorias",b.length,"|",m(n).length),r().ListaRecordsMap.set(e.origin,b),r().ListaRecordsMap=new Map(r().ListaRecordsMap),Of(),yt.remove()},l=()=>{F(a,{ListaID:e.origin},!0),Po(2)};nt(()=>{console.log("form a enviar::",Vt(m(a)))});const u=c=>{F(a,{...c},!0),F(o,i.map((p,g)=>({_id:p,src:(m(a).Images||[])[g]||""})),!0),console.log("categoría getted:",Vt(m(a)),Vt(m(o))),Po(2)};var d={newRecord:l},f=ew(),h=Ct(f);vt(h,21,()=>m(n),ct,(c,p)=>{var g=QT();g.__keydown=T=>{T.stopPropagation(),(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),u(m(p)))},g.__click=T=>{T.stopPropagation(),u(m(p))};var b=D(z(g),2),y=z(b,!0);I(b);var E=D(b,2),S=z(E,!0);I(E),I(g),ne(()=>{Le(y,m(p).Nombre),Le(S,m(p).Descripcion)}),j(c,g)}),I(h);var v=D(h,2);{let c=ye(()=>m(a).ID>0?()=>{s(!0)}:void 0);qT(v,{title:"CATEGORÍA",id:2,size:6,onClose:()=>{Ws(2)},onSave:()=>{s()},get onDelete(){return m(c)},children:(p,g)=>{var b=$T(),y=z(b);je(y,{label:"Nombre",css:"col-span-12",get saveOn(){return m(a)},save:"Nombre",required:!0});var E=D(y,2);je(E,{label:"Descripción",css:"col-span-12 mb-16",get saveOn(){return m(a)},save:"Descripcion"});var S=D(E,2);vt(S,17,()=>m(o),ct,(T,k,R)=>{Un(T,{clearOnUpload:!0,get id(){return m(k)._id},folder:"img-public",get src(){return m(k).src},size:2,cardCss:"w-full h-180 p-4 col-span-4",types:["avif","webp"],saveAPI:"producto-categoria-image",hideUploadButton:!0,hideForm:!0,onChange:H=>{Object.assign(m(k),H)},setDataToSend:H=>{H.Order=R+1}})}),I(b),j(p,b)},$$slots:{default:!0}})}return j(t,f),Bt(d)}Ht(["keydown","click"]);var tw=X('<div class="grid grid-cols-24 items-start gap-x-10 gap-y-10 mt-6 md:mt-16"><!> <div class="col-span-24 md:col-span-9 md:row-span-4"><!></div> <!> <!> <!> <!> <!> <!> <!> <!> <div class="col-span-24 md:col-span-5"><!></div> <!> <!> <div class="ff-bold h3 col-span-24 ml-8">Sub-Unidades</div> <!> <!> <!> <!> <!></div>'),rw=X('<div class="grid grid-cols-2 md:grid-cols-4 items-start gap-x-10 gap-y-10 mt-16"><!> <!></div>'),nw=X("<!> <!> <!>",1),aw=X('<div class="grid grid-cols-12 md:flex md:flex-row items-center mb-8"><!> <div class="i-search w-full md:w-200 md:ml-12 col-span-5"><div><i class="icon-search"></i></div> <input type="text"/></div> <button class="bx-green ml-auto col-span-7"><i class="icon-plus"></i><span class="hidden md:block">Nuevo</span></button></div> <!> <!> <!> <!>',1);function kw(t,e){It(e,!0);let r=Q("");const n=new XT,a=new ZT([1,2]);let i=Q(1),o=Q(1),s=Q(qe({})),l=null,u=null,d=[{header:"ID",css:"c-blue text-center",headerCss:"w-48",getValue:c=>c.ID},{header:"Producto",highlight:!0,getValue:c=>c.Nombre},{header:"Categorías",highlight:!0,getValue:c=>{const p=[];for(const g of c.CategoriasIDs){const b=a.get(g)?.Nombre||`Categoría-${g}`;p.push(b)}return p.join(", ")}},{header:"Precio",css:"text-right",getValue:c=>Ao(c.Precio/100,2)},{header:"Descuento",css:"text-right",getValue:c=>c.Descuento?String(c.Descuento)+"%":""},{header:"Precio Final",css:"text-right",getValue:c=>Ao(c.PrecioFinal/100,2)},{header:"Sub Unidades",css:"text-right",getValue:c=>c.SbnUnidad?`${c.SbnCantidad} x ${c.SbnUnidad}`:""}];const f=ye(()=>a.ListaRecordsMap.get(1)||[]),h=async()=>{if((m(s).Nombre?.length||0)<4){qr.failure("El nombre debe tener al menos 4 caracteres.");return}console.log("productor a enviar:",Vt(m(s))),yt.standard("Guardando producto...");try{var c=await YT([m(s)])}catch(g){qr.failure(g),yt.remove();return}yt.remove();const p=n.productos.find(g=>g.ID===m(s).ID);p&&Object.assign(p,m(s)),Ae.setSideLayer(0)};nt(()=>{console.log("productor form:",Vt(m(s)))});const v=async c=>{yt.standard("Eliminando Imagen...");try{await Oi({data:{ProductoID:m(s).ID,ImageToDelete:c},route:"producto-image",refreshRoutes:["productos"]})}catch(p){qr.failure(`Error al eliminar imagen: ${p}`),yt.remove();return}yt.remove(),m(s).Images=(m(s).Images||[]).filter(p=>p.n!==c)};Ff(t,{sideLayerSize:780,title:"Productos",children:(c,p)=>{var g=aw(),b=Ct(g),y=z(b);mf(y,{get selected(){return m(i)},css:"col-span-12 mb-6 md:mb-0",options:[[1,"Productos"],[2,"Categorías"],[3,"Marcas"]],useMobileGrid:!0,onSelect:x=>{Ae.setSideLayer(0),F(s,{ID:0},!0),F(i,x[0],!0)}});var E=D(y,2),S=D(z(E),2);S.__keyup=x=>{const G=String(x.target.value||"");js(()=>{F(r,G,!0)},150)},I(E);var T=D(E,2);T.__click=x=>{x.stopPropagation(),m(i)===2?l?.newRecord():m(i)===2?u?.newRecord():Ae.setSideLayer(1)},I(b);var k=D(b,2);{var R=x=>{xs(x,{type:"content",children:(G,pe)=>{{let $=ye(()=>m(s)?.ID);Af(G,{get columns(){return d},get data(){return n.productos},get filterText(){return m(r)},get selected(){return m($)},isSelected:(re,we)=>re.ID===we,getFilterContent:re=>re.Nombre,onRowClick:re=>{F(s,{...re},!0),m(s).CategoriasIDs=[...re.CategoriasIDs||[]],m(s).Propiedades=[...re.Propiedades||[]],Ae.setSideLayer(1)}})}},$$slots:{default:!0}})};le(k,x=>{m(i)===1&&x(R)})}var H=D(k,2);{let x=ye(()=>m(s)?.Nombre||"");xs(H,{css:"px-8 py-8 md:px-14 md:py-10",get title(){return m(x)},type:"side",titleCss:"h2 mb-6",contentCss:"px-0 md:px-0",id:1,options:[[1,"Información",["Informa-","ción"]],[2,"Ficha"],[3,"Presentaciones",["Presenta-","ciones"]],[4,"Fotos"]],get selected(){return m(o)},onSelect:G=>F(o,G[0],!0),onClose:()=>{F(s,{},!0)},onSave:()=>{h()},children:(G,pe)=>{var $=nw(),re=Ct($);{var we=ke=>{var fe=tw(),Re=z(fe);je(Re,{label:"Nombre",get saveOn(){return m(s)},css:"col-span-24",required:!0,save:"Nombre"});var lt=D(Re,2),ge=z(lt);{let Ee=ye(()=>m(s).Image?.n);Un(ge,{saveAPI:"producto-image",clearOnUpload:!0,types:["avif","webp"],folder:"img-productos",size:2,get src(){return m(Ee)},cardCss:"w-full h-180  p-4",setDataToSend:Fe=>{Fe.ProductoID=m(s).ID},onUploaded:(Fe,wt)=>{Fe.includes("/")&&(Fe=Fe.split("/")[1]),m(s).Image={n:Fe,d:wt},m(s).Images=m(s).Images||[],m(s).Images.unshift(m(s).Image)}})}I(lt);var Ne=D(lt,2);je(Ne,{label:"Precio Base",get saveOn(){return m(s)},css:"col-span-12 md:col-span-5",save:"Precio",type:"number",baseDecimals:2});var et=D(Ne,2);je(et,{label:"Descuento",get saveOn(){return m(s)},css:"col-span-12 md:col-span-5",save:"Descuento",postValue:"%",type:"number"});var Gt=D(et,2);je(Gt,{label:"Precio Final",get saveOn(){return m(s)},css:"col-span-12 md:col-span-5",save:"PrecioFinal",type:"number",baseDecimals:2});var st=D(Gt,2);Xn(st,{label:"Moneda",get saveOn(){return m(s)},css:"col-span-12 md:col-span-5",save:"MonedaID",keyId:"i",keyName:"v",options:[{i:1,v:"PEN (S/.)"},{i:2,v:"USD ($)"}]});var Tt=D(st,2);je(Tt,{label:"Peso",get saveOn(){return m(s)},css:"col-span-12 md:col-span-5",save:"Peso",type:"number"});var dr=D(Tt,2);Xn(dr,{label:"Unidad",get saveOn(){return m(s)},css:"col-span-12 md:col-span-5",save:"UnidadID",keyId:"i",keyName:"v",options:[{i:1,v:"Kg"},{i:2,v:"g"},{i:3,v:"Libras"}]});var A=D(dr,2);je(A,{label:"Volumen",get saveOn(){return m(s)},css:"col-span-12 md:col-span-5",save:"Volumen",type:"number"});var V=D(A,2);Xn(V,{label:"Marca",get saveOn(){return m(s)},css:"col-span-12 md:col-span-10 mb-2",save:"MarcaID",keyId:"i",keyName:"v",options:[{i:1,v:"PEN (S/.)"},{i:2,v:"g"},{i:3,v:"Libras"}]});var te=D(V,2),de=z(te);zf(de,{save:"Params",get saveOn(){return m(s)},type:"multiple",options:[{i:1,v:"SKU Individual"}],keyId:"i",keyName:"v"}),I(te);var _=D(te,2);je(_,{get saveOn(){return m(s)},save:"Descripcion",css:"col-span-24 mb-4",label:"Descripción Corta"});var N=D(_,2);KT(N,{css:"col-span-24 flex items-start",label:"CATEGORÍAS ::",get options(){return m(f)},keyId:"ID",keyName:"Nombre",cardCss:"grow",inputCss:"w-[35%] md:w-180",save:"CategoriasIDs",get saveOn(){return m(s)},set saveOn(Ee){F(s,Ee,!0)}});var O=D(N,4);je(O,{get saveOn(){return m(s)},save:"SbnUnidad",css:"col-span-12 md:col-span-6",label:"Nombre"});var oe=D(O,2);je(oe,{get saveOn(){return m(s)},save:"SbnPrecio",baseDecimals:2,css:"col-span-12 md:col-span-6",label:"Precio Base",type:"number"});var ve=D(oe,2);je(ve,{get saveOn(){return m(s)},save:"SbnDescuento",postValue:"%",css:"col-span-12 md:col-span-6",label:"Descuento",type:"number"});var _e=D(ve,2);je(_e,{get saveOn(){return m(s)},save:"SbnPreciFinal",baseDecimals:2,css:"col-span-12 md:col-span-6",label:"Precio Final",type:"number"});var ue=D(_e,2);je(ue,{get saveOn(){return m(s)},save:"SbnCantidad",css:"col-span-12 md:col-span-6",label:"Cantidad",type:"number"}),I(fe),j(ke,fe)};le(re,ke=>{m(o)===1&&ke(we)})}var $e=D(re,2);{var se=ke=>{ET(ke,{get saveOn(){return m(s)},save:"ContentHTML",css:"mt-12"})};le($e,ke=>{m(o)===2&&ke(se)})}var ot=D($e,2);{var bt=ke=>{var fe=rw(),Re=z(fe);Un(Re,{saveAPI:"producto-image",clearOnUpload:!0,types:["avif","webp"],folder:"img-productos",cardCss:"w-full h-170 p-4",setDataToSend:ge=>{ge.ProductoID=m(s).ID},onUploaded:(ge,Ne)=>{ge.includes("/")&&(ge=ge.split("/")[1]),m(s).Image={n:ge,d:Ne},m(s).Images=m(s).Images||[],m(s).Images.unshift(m(s).Image)}});var lt=D(Re,2);vt(lt,17,()=>m(s).Images||[],ct,(ge,Ne)=>{{let et=ye(()=>m(Ne)?.n);Un(ge,{saveAPI:"producto-image",size:2,clearOnUpload:!0,types:["avif","webp"],folder:"img-productos",cardCss:"w-full h-170 p-4",get src(){return m(et)},onDelete:()=>{Rf("ELIMINAR IMAGEN",`Eliminar la imagen ${m(Ne).d?`"${m(Ne).d}"`:"seleccionada"}`,"SI","NO",()=>{v(m(Ne).n)})}})}}),I(fe),j(ke,fe)};le(ot,ke=>{m(o)===4&&ke(bt)})}j(G,$)},$$slots:{default:!0}})}var U=D(H,2);{var q=x=>{jt(Us(x,{get listas(){return a},origin:1}),G=>l=G,()=>l)};le(U,x=>{m(i)===2&&x(q)})}var W=D(U,2);{var J=x=>{jt(Us(x,{get listas(){return a},origin:2}),G=>u=G,()=>u)};le(W,x=>{m(i)===3&&x(J)})}j(c,g)},$$slots:{default:!0}}),Bt()}Ht(["keyup","click"]);export{kw as component};
