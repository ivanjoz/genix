import{d as _,t as b,i as l}from"./web-B9EQUxsk.js";import{t as O,f as U,N as p,L as f}from"./main-CyvPQj02.js";import{a as v,c as t}from"./solid-DoXAfIeo.js";import{I as o}from"./Input-HJvxZB2P.js";import{s as g,M as A}from"./Modals-DWfAM6fW.js";import{Q as I}from"./QTable-BPKrYQPg.js";import{a as S,P as k}from"./app-DjKDYt5Z.js";import{a as E,b as N,e as V,h as L}from"./empresas-D3Tg-fkn.js";import"./http-BxXqqoH2.js";import"./store-DHPf-lLy.js";import"./main-CFEycXvd.js";var q=b('<div class=h100><div class="flex ai-center jc-between mb-06"><div class="search-c4 mr-16 w16rem"><div><i class=icon-search></i></div><input class=w100 autocomplete=off type=text></div><div class="flex ai-center"><button class="bn1 b-green"><i class=icon-plus>'),D=b('<div class="flex-wrap ai-start w100-10">'),M=b('<button class="bnr2 b-blue b-card-1"><i class=icon-pencil>');function X(){E();const[d,C]=N(),[x]=V(),[T,$]=v(""),[r,h]=v({}),w=async a=>{const e=r();if((e.usuario?.length||0)<4||(e.nombres?.length||0)<4){p.failure("El usuario y el nombre deben tener al menos 4 caracteres.");return}if(e.password1&&(e.password1=e.password1.trim()),e.password2&&(e.password2=e.password2.trim()),!e.id||e.password1){let i="";if((e.password1.length||0)<6?i="El password tiene menos de 6 caracteres.":e.password1!==e.password2&&(i="Los password no coinciden."),i){p.failure(i);return}}f.standard("Creando /Actualizando Usuario...");try{var c=await L(e)}catch(i){p.failure(i),f.remove();return}let n=[...d().usuarios];if(e.id){const i=d().usuarios.find(u=>u.id===e.id);i&&Object.assign(i,e),a&&(n=n.filter(u=>u.id!==e.id))}else e.id=c.id,n.unshift(e);f.remove(),C({...d(),usuarios:n}),g([])};return t(k,{title:"Usuarios",fetchLoading:!0,get children(){return[(()=>{var a=q(),e=a.firstChild,c=e.firstChild,n=c.firstChild,i=n.nextSibling,u=c.nextSibling,y=u.firstChild;return i.$$keyup=s=>{s.stopPropagation(),O(()=>{$((s.target.value||"").toLowerCase().trim())},150)},y.$$click=s=>{s.stopPropagation(),h({ss:1}),g([1])},l(a,t(I,{get data(){return d()?.usuarios||[]},css:"w100",maxHeight:"calc(80vh - 13rem)",style:{height:"100%"},columns:[{header:"ID",headerStyle:{width:"3.4rem"},css:"c",getValue:s=>s.id},{header:"Usuario",cardCss:"h3 ff-bold c-purple",getValue:s=>s.usuario,cardColumn:[1,1]},{header:"Nombres",cardColumn:[2,1],getValue:s=>s.nombres+" "+s.apellidos},{header:"Email",cardColumn:[3,1],cardCss:"h5 c-steel",getValue:s=>s.email},{header:"Estado",cardColumn:[3,2],getValue:s=>s.ss,cardCss:"h5 c-steel"},{header:"Actualizado",headerStyle:{width:"9rem"},css:"nowrap",getValue:s=>U(s.upd,"Y-m-d h:n")},{header:"...",headerStyle:{width:"2.6rem"},css:"t-c",cardColumn:[1,2],render:(s,z)=>{const P=m=>{m.stopPropagation(),g([1]),h({...s})};return(()=>{var m=M();return m.$$click=P,m})()}}]}),null),a})(),t(A,{id:1,css:"w56-78 in-s2",get title(){return(r()?.id>0?"Actualizar":"Guardar")+" Usuario"},onSave:()=>{console.log("usuario a guardar::",r()),w()},onDelete:()=>{w(!0)},get children(){var a=D();return l(a,t(o,{get saveOn(){return r()},save:"usuario",css:"w-12x mb-10",label:"Usuario",required:!0,get disabled(){return r()?.id>0}}),null),l(a,t(o,{get saveOn(){return r()},save:"nombres",css:"w-12x mb-10",label:"Nombres",required:!0}),null),l(a,t(o,{get saveOn(){return r()},save:"apellidos",css:"w-12x mb-10",label:"Apellidos"}),null),l(a,t(o,{get saveOn(){return r()},save:"documentoNro",css:"w-12x mb-10",label:"NÂº Documento"}),null),l(a,t(o,{get saveOn(){return r()},save:"cargo",css:"w-12x mb-10",label:"Cargo"}),null),l(a,t(o,{get saveOn(){return r()},save:"email",css:"w-12x mb-10",label:"Email"}),null),l(a,t(S,{get saveOn(){return r()},save:"perfilesIDs",css:"w100 mb-10 ai-start",label:"",placeholder:"Perfiles",get options(){return x().perfiles},keys:"id.nombre",inputCss:"w-07x"}),null),l(a,t(o,{get saveOn(){return r()},save:"password1",css:"w-12x mb-10",label:"Password",type:"password",get required(){return!r().id},get placeholder(){return r().id>0?"SIN CAMBIAR":""}}),null),l(a,t(o,{get saveOn(){return r()},save:"password2",get required(){return!r().id},css:"w-12x mb-10",label:"Password (Repetir)",type:"password"}),null),a}})]}})}_(["keyup","click"]);export{X as default};
