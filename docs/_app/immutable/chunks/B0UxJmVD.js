import{e as r,g as n,i as c,h as u}from"./CaHRSXkO.js";import{G as d,a as f,P as i}from"./-eHy24N1.js";import{N as h}from"./mKPjCyIt.js";class m extends d{route="cajas";useCache={min:1,ver:1};#a=r(n([]));get Cajas(){return c(this.#a)}set Cajas(o){u(this.#a,o,!0)}#e=r(n(new Map));get CajasMap(){return c(this.#e)}set CajasMap(o){u(this.#e,o,!0)}handler(o){console.log("result cajas::",o),this.Cajas=o.Cajas||[];for(let e of this.Cajas)e.SaldoCurrent=e.SaldoCurrent||0;this.CajasMap=new Map(this.Cajas.map(e=>[e.ID,e]))}constructor(){super(),this.fetch()}}const g=a=>i({data:a,route:"cajas",refreshRoutes:["cajas"]}),j=(a,o)=>new Map(a.map(e=>[e[o],e])),v=async a=>{let o=`caja-movimientos?caja-id=${a.CajaID}`;if((!a.fechaInicio||!a.fechaFin)&&!a.lastRegistros)throw"No se encontró una fecha de inicio o fin.";a.fechaInicio&&a.fechaFin&&(o+=`&fecha-hora-inicio=${a.fechaInicio}`,o+=`&fecha-hora-fin=${a.fechaFin+1}`),a.lastRegistros&&(o+=`&last-registros=${a.lastRegistros}`);let e;try{e=await f({route:o})}catch(t){throw console.log("Error:",t),h.failure(t),t}const s=j(e.usuarios,"id");for(let t of e.movimientos)t.Usuario=s.get(t.CreatedBy);return e.movimientos},M=a=>i({data:a,route:"caja-movimiento",refreshRoutes:["cajas"]}),R=a=>i({data:a,route:"caja-cuadre",refreshRoutes:["cajas"]}),w=async a=>{let o=`caja-cuadres?caja-id=${a.CajaID}`;if((!a.fechaInicio||!a.fechaFin)&&!a.lastRegistros)throw"No se encontró una fecha de inicio o fin.";a.fechaInicio&&a.fechaFin&&(o+=`&fecha-hora-inicio=${a.fechaInicio*24*60*60}`,o+=`&fecha-hora-fin=${(a.fechaFin+1)*24*60*60}`),a.lastRegistros&&(o+=`&last-registros=${a.lastRegistros}`);let e;try{e=await f({route:o})}catch(t){throw console.log("Error:",t),h.failure(t),t}console.log("Result Cajas::",e);const s=j(e.usuarios,"id");for(const t of e.cuadres||[])t.Usuario=s.get(t.CreatedBy);return e.cuadres},y=[{id:1,name:"Caja"},{id:2,name:"Cuenta Bancaria"}],I=[{id:1,name:"-",group:1},{id:2,name:"Cuadre Físico",group:1},{id:3,name:"Transferencia",group:2,isNegative:!0},{id:4,name:"Retiro",group:2,isNegative:!0},{id:5,name:"Pérdida",group:2,isNegative:!0},{id:6,name:"Pago",group:2,isNegative:!0},{id:7,name:"Cobro",group:2}];export{m as C,w as a,y as b,I as c,R as d,M as e,v as g,g as p};
