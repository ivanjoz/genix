import"./DsnmJJEf.js";import{p as Fe,e as x,g as Se,l as ye,h as r,f as S,c as w,s as b,i as o,u as V,r as h,t as m,b as f,d as We,a as we,x as je,aA as be,aB as Ge}from"./Bf0lWsRu.js";import{s as A}from"./WwA8pLij.js";import{i as C}from"./D7jGWfSg.js";import{e as Je,i as Qe}from"./CA0Nq6W4.js";import{h as ke}from"./B9_QpWQw.js";import{b as Xe,a as Ye}from"./BWVkWQLM.js";import{s as v,c as p}from"./C7iUW-It.js";import{d as Ze,e as U}from"./Cu2BEfFs.js";import{b as xe}from"./CPRIj_W5.js";import{p as g}from"./DEnCy23-.js";import{i as $e,h as et}from"./B0A7VF9y.js";import{t as tt}from"./DP6SISrU.js";import{C as Ce}from"./CUNP7WoD.js";import{s as k}from"./BMRmn4k7.js";import{S as it}from"./9nVZToYO.js";var ot=S("<div><div></div></div> <div> <!></div> <div><div></div></div> <div><div></div></div>",1),at=S("<div><div></div></div>"),nt=S("<input/>"),rt=S('<div class="fs15 mt-2 _10 SearchSelect_ooe2rh"> </div>'),lt=S('<div role="button" tabindex="0"><div class="h100 w100 flex items-center"><!></div></div>'),st=S("<div>Cargando...</div>"),ct=S("<div><i></i></div>"),dt=S("<span> </span>"),vt=S('<div role="button" tabindex="0"><div></div></div>'),ft=S('<div role="button" tabindex="0"><!></div>'),ut=S("<div><!> <div><!> <!> <!></div> <!> <!> <!></div>");function Vt(pe,i){Fe(i,!0);const P=g(i,"saveOn",15),Y=g(i,"css",3,""),D=g(i,"options",19,()=>[]);g(i,"max",3,100);const De=g(i,"notEmpty",3,!1),Le=g(i,"required",3,!1),Z=g(i,"disabled",3,!1),$=g(i,"clearOnSelect",3,!1),ee=g(i,"avoidIDs",19,()=>[]),te=g(i,"inputCss",3,""),z=g(i,"showLoading",3,!1);let L=x(!1),y=x(Se([...D()])),s=x(-1),N=x(!1),I=x(0),H=x(""),O=!1,ie=x(!1),u,E,K=x(Se([]));const oe=V(()=>Ce.deviceType===3),F=V(()=>o(oe)),ae=V(()=>Z()||z());function Pe(){if(u){const e=u.getBoundingClientRect(),t=window.innerHeight;r(ie,e.top>t/2)}}function R(e){o(F)?r(H,e,!0):u&&(u.value=e)}function ne(){let e=i.selected;typeof e>"u"&&i.save&&P()&&(e=P()[i.save]);let t;return e&&(t=D().find(a=>a[i.keyId]===e)),t}function re(){return Le()&&!Z()}let le=Date.now();const se=(e,t)=>{const a=Date.now();if(a-le<80)return;le=a,De()&&!e&&(e=ne()),e&&!$()?R(e[i.keyName]):R("");const l=e?e[i.keyId]:null;re()&&r(I,l?2:1,!0),$()?i.onChange&&i.onChange(e):P()&&i.save?(P()[i.save]||null)!==l&&(P(P()[i.save]=l,!0),i.onChange&&i.onChange(e)):typeof i.selected<"u"&&(i.selected||null)!==l&&i.onChange&&i.onChange(e)},W=e=>{if(console.log("options filtered::",i.label,D()),!e&&(ee()?.length||0)===0)return[...D()];const t=new Set(ee()||[]),a=[],l=e.toLowerCase().split(" ").filter(c=>c.length>1);for(const c of D())if(!(t.size>0&&t.has(c[i.keyId])))if(l.length===0)a.push(c);else{const d=c[i.keyName];typeof d=="string"&&$e(d.toLowerCase(),l)&&a.push(c)}return console.log("options filtered 2::",i.label,D(),a),a};function j(e){e.stopPropagation();const t=e.target,a=String(t.value||"").toLowerCase();tt(()=>{r(K,String(u.value).toLowerCase().split(" "),!0),r(y,W(a),!0),r(s,-1)},120)}function Ne(e){console.log("avoid hover:: ",o(N)),e.stopPropagation(),!(!o(L)||o(y).length===0)&&(e.key==="ArrowUp"?(e.preventDefault(),r(s,o(s)<=0?o(y).length-1:o(s)-1,!0),r(N,!0),E?.scrollToIndex(o(s),{align:"auto"})):e.key==="ArrowDown"?(e.preventDefault(),r(s,o(s)>=o(y).length-1?0:o(s)+1,!0),r(N,!0),E?.scrollToIndex(o(s),{align:"auto"})):e.key==="Enter"&&o(s)>=0&&(e.preventDefault(),G(o(y)[o(s)])))}function G(e){se(e),u&&u.blur(),r(L,!1)}let Ve=V(()=>`${k.input} p-rel${Y()?` ${Y()}`:""}${i.label?"":" no-label"}`);function ce(){return o(I)?o(I)===2?'<i class="v-icon icon-ok c-green"></i>':o(I)===1?'<i class="v-icon icon-attention c-red"></i>':null:null}ye(()=>{const e=ne();R(e?e[i.keyName]:""),re()&&r(I,e?2:1,!0)}),ye(()=>{r(y,W(""),!0),r(s,-1)});const de=()=>{Ce.showMobileSearchLayer={options:o(y),keyName:i.keyName,keyID:i.keyId,onSelect:e=>{G(e)},onRemove:e=>{}}};var T=ut(),ve=w(T);{var Ie=e=>{var t=ot(),a=we(t),l=b(a,2),c=w(l,!0),d=b(c);ke(d,()=>ce()||""),h(l);var n=b(l,2),_=b(n,2);m(()=>{v(a,1,p(k.input_lab_cell_left),"SearchSelect_ooe2rh"),v(l,1,p(k.input_lab),"SearchSelect_ooe2rh"),A(c,i.label),v(n,1,p(k.input_lab_cell_right),"SearchSelect_ooe2rh"),v(_,1,p(k.input_shadow_layer),"SearchSelect_ooe2rh")}),f(e,t)};C(ve,e=>{i.label&&e(Ie)})}var q=b(ve,2),fe=w(q);{var Oe=e=>{var t=at();m(()=>v(t,1,p(k.input_div_1),"SearchSelect_ooe2rh")),f(e,t)};C(fe,e=>{i.label&&e(Oe)})}var ue=b(fe,2);{var Be=e=>{var t=nt();t.__keyup=j,t.__keydown=a=>{a.stopPropagation(),console.log(a),Ne(a)},xe(t,a=>u=a,()=>u),m(()=>{v(t,1,`w-full ${k.input_inp} ${te()}`,"SearchSelect_ooe2rh"),Ye(t,"placeholder",z()?"":i.placeholder||":: seleccione ::"),t.disabled=o(ae)||o(oe)}),U("paste",t,j),U("cut",t,j),U("focus",t,a=>{a.stopPropagation(),o(L)||(Pe(),r(K,[],!0),r(y,W(""),!0),r(L,!0))}),U("blur",t,a=>{if(a.stopPropagation(),console.log("avoidBlur 2",O),O){O=!1,u.focus();return}let l=String(u.value||"").toLowerCase();const c=D().find(d=>String(d[i.keyName]||"").toLowerCase()===l);se(c),r(L,!1)}),f(e,t)},Ee=e=>{var t=lt();t.__keydown=n=>{(n.key==="Enter"||n.key===" ")&&de()},t.__click=n=>{n.stopPropagation(),de()};var a=w(t),l=w(a);{var c=n=>{var _=Ge();m(()=>A(_,o(H))),f(n,_)},d=n=>{var _=rt(),J=w(_,!0);h(_),m(()=>A(J,i.placeholder||"")),f(n,_)};C(l,n=>{o(H)?n(c):n(d,!1)})}h(a),h(t),m(()=>v(t,1,`w-full flex items-center ${k.input_inp} ${te()}`,"SearchSelect_ooe2rh")),f(e,t)};C(ue,e=>{o(F)?e(Ee,!1):e(Be)})}var Re=b(ue,2);{var Te=e=>{var t=je(),a=we(t);ke(a,()=>ce()||""),f(e,t)};C(Re,e=>{i.label||e(Te)})}h(q);var _e=b(q,2);{var qe=e=>{var t=st();f(e,t)};C(_e,e=>{z()&&e(qe)})}var he=b(_e,2);{var Me=e=>{var t=ct(),a=w(t);h(t),m(()=>{v(t,1,`absolute bottom-8 right-6 pointer-events-none ${o(L)&&!i.icon?"show":""}`),v(a,1,p(i.icon||"icon-down-open-1"),"SearchSelect_ooe2rh")}),f(e,t)};C(he,e=>{o(ae)||e(Me)})}var Ae=b(he,2);{var Ue=e=>{var t=ft();let a;t.__mousedown=d=>{d.stopPropagation(),O=!0,console.log("avoidBlur 1",O)},t.__mousemove=function(...d){(o(N)?n=>{console.log("hover aqui:: ",o(s)),n.stopPropagation(),o(N)&&(r(s,-1),r(N,!1))}:void 0)?.apply(this,d)};let l;var c=w(t);xe(it(c,{get items(){return o(y)},renderItem:(n,_=be,J=be)=>{const ze=V(()=>String(_()[i.keyName])),He=V(()=>et(o(ze),o(K)));var B=vt();B.__click=Q=>{Q.stopPropagation(),G(_())};var me=w(B);Je(me,21,()=>o(He),Qe,(Q,X)=>{var M=dt();let ge;var Ke=w(M,!0);h(M),m(()=>{ge=v(M,1,p(o(X).highl?"_8":""),"SearchSelect_ooe2rh",ge,{"mr-4":o(X).isEnd}),A(Ke,o(X).text)}),f(Q,M)}),h(me),h(B),m(()=>v(B,1,`flex ai-center _highlight${o(s)===J()?" _selected":""}`,"SearchSelect_ooe2rh")),f(n,B)},$$slots:{renderItem:!0}}),n=>E=n,()=>E),h(t),m(d=>{a=v(t,1,`_1 p-4 left-0 z-320 ${o(s)>=0?" on-arrow":""} ${(i.optionsCss||"w-full")??""}`,"SearchSelect_ooe2rh",a,{"open-up":o(ie)}),l=Xe(t,"",l,d)},[()=>({height:Math.min(o(y).length*36+10,300)+"px"})]),f(e,t)};C(Ae,e=>{o(L)&&!o(F)&&e(Ue)})}h(T),m(()=>{v(T,1,p(o(Ve)),"SearchSelect_ooe2rh"),v(q,1,`${k.input_div} flex w-full`,"SearchSelect_ooe2rh")}),f(pe,T),We()}Ze(["keyup","keydown","click","mousedown","mousemove"]);export{Vt as S};
