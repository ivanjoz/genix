const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/C5M5Z0tA.js","../chunks/VsnTSXou.js","../chunks/DYIxaJ3V.js","../chunks/DFk3ZLs7.js","../chunks/qGdyMQBc.js","../chunks/DnWPx8w7.js","../chunks/gRL2JDx1.js","../chunks/DZK3YR5a.js","../chunks/xnXzbNNK.js"])))=>i.map(i=>d[i]);
import"../chunks/DsnmJJEf.js";import{p as _e,a2 as U,at as oe,g as ne,h as Ne,a3 as h,f as D,d as g,k as t,aH as H,r as u,s as d,t as M,b as y,c as he,a as ye,aq as ut,au as Qe,b5 as ot,a4 as mt}from"../chunks/xxzRbNoF.js";import{d as Ie,s as He,e as Ge}from"../chunks/CR64gONK.js";import{s as ge,a as fe,I as Q}from"../chunks/Coui7NVm.js";import{i as F}from"../chunks/Dlky6Ld2.js";import{e as pe,i as we}from"../chunks/DYyZyIdl.js";import{b as Le}from"../chunks/BezaTGJA.js";import{s as ee}from"../chunks/Dh4QK2gy.js";import{s as P,b as We,c as ce,a as Ze}from"../chunks/BtvgxEYs.js";import{p as q}from"../chunks/BiWXNKKg.js";import{_ as Se}from"../chunks/PPVm8Dsz.js";import{a as ft,o as gt}from"../chunks/tZ8tr9i3.js";import{C as W,E as $e,W as Je,o as _t,b as nt,i as et,d as ht,e as tt,h as at}from"../chunks/CFEalmJ9.js";import{i as bt,N as Ee,L as ve,C as yt}from"../chunks/DgGjUfh2.js";import{G as lt,a as Xe}from"../chunks/irG5Eixq.js";import{I as je}from"../chunks/CL4Ivink.js";import{P as pt}from"../chunks/DPuKOyj_.js";import{h as st}from"../chunks/B6XpzTLd.js";import{h as wt,t as dt}from"../chunks/VsnTSXou.js";import{V as It}from"../chunks/b8IW__Wg.js";import{P as xt}from"../chunks/tcPj4XLa.js";var Dt=D('<i class="icon-ok"></i>'),St=D('<div class="flex items-center"><button><!></button> <label> </label></div>'),kt=D("<div></div>");function Ct(A,e){_e(e,!0);const r=q(e,"saveOn",15);let _=U(oe([]));const o=a=>{const S=a[e.keyId];e.type=="multiple"?t(_).includes(S)?h(_,t(_).filter(k=>k!==S),!0):t(_).push(S):t(_).includes(S)?h(_,[],!0):h(_,[S],!0),r()&&e.save&&(e.type==="multiple"?r(r()[e.save]=t(_),!0):r(r()[e.save]=t(_)[0]||void 0,!0))};let n;ne(()=>{!r()||!e.save||n!==r()&&(n=r(),Ne(()=>{e.type==="multiple"?h(_,r()[e.save]||[],!0):h(_,[r()[e.save]||[]],!0)}))});var b=kt();pe(b,21,()=>e.options,we,(a,S)=>{const k=H(()=>t(_).includes(t(S)[e.keyId]));var I=St(),z=g(I);let G;z.__click=f=>{f.stopPropagation(),o(t(S))};var p=g(z);{var s=f=>{var w=Dt();y(f,w)};F(p,f=>{t(k)&&f(s)})}u(z);var c=d(z,2),m=g(c,!0);u(c),u(I),M(()=>{G=P(z,1,"flex mr-4 pt-1 items-center p-0 lh-10 justify-center rounded-[4px] shrink-0 w-28 h-26 _1 svelte-vp2fnd",null,G,{_2:t(k)}),We(z,"aria-label",t(S)[e.keyName]),ee(m,t(S)[e.keyName])}),y(a,I)}),u(b),M(()=>P(b,1,`flex ${e.css??""}`,"svelte-vp2fnd")),y(A,b),he()}Ie(["click"]);var Lt=D("<div></div>");function Ot(A,e){_e(e,!0);const r=q(e,"saveOn",7);let _,o,n;ne(()=>{if(r()&&e.save&&r()!==n&&o){n=r();const a=o;Ne(()=>{a.html.set(r()[e.save]||"")})}}),ft(async()=>{if(!_)return;const a=await Se(()=>import("../chunks/C5M5Z0tA.js").then(I=>I.f),__vite__mapDeps([0,1,2]),import.meta.url);await Promise.all([Se(()=>import("../chunks/DFk3ZLs7.js").then(I=>I.c),__vite__mapDeps([3,1,2]),import.meta.url),Se(()=>import("../chunks/qGdyMQBc.js").then(I=>I.f),__vite__mapDeps([4,1,2]),import.meta.url),Se(()=>import("../chunks/DnWPx8w7.js").then(I=>I.t),__vite__mapDeps([5,1,2]),import.meta.url),Se(()=>import("../chunks/gRL2JDx1.js").then(I=>I.l),__vite__mapDeps([6,1,2]),import.meta.url),Se(()=>import("../chunks/DZK3YR5a.js").then(I=>I.p),__vite__mapDeps([7,1,2]),import.meta.url),Se(()=>import("../chunks/xnXzbNNK.js").then(I=>I.a),__vite__mapDeps([8,1,2]),import.meta.url)]);const S=a.default,k=new S(_,{toolbarButtons:["bold","italic","fontSize","textColor","backgroundColor","align","outdent","indent","underline","insertHR","lineHeight","formatOLSimple","insertTable","html"],fontSize:["14","16","18","20","24","28"],fontSizeSelection:!0,fontFamilySelection:!0,colorsBackground:["#15E67F","#E3DE8C","#D8A076","#D83762","#76B6D8","REMOVE","#1C7A90","#249CB8","#4ABED9","#FBD75B","#FBE571","#FFFFFF"],colorsStep:6,colorsText:["#15E67F","#E3DE8C","#D8A076","#D83762","#76B6D8","REMOVE","#1C7A90","#249CB8","#4ABED9","#FBD75B","#FBE571","#FFFFFF"],events:{contentChanged:()=>{r()&&e.save&&(r()[e.save]=k.html.get()),console.log("Se asignó el HTML::",ge(r()))},initialized:()=>{r()&&e.save&&k.html.set(r()[e.save]||"")}}});o=k}),gt(()=>{o?.destroy(),o=void 0});var b=Lt();Le(b,a=>_=a,()=>_),M(()=>P(b,1,e.css)),y(A,b),he()}var Pt=D("<button> </button>"),Mt=D("<div></div>");function ct(A,e){_e(e,!0);const r=n=>{let b="flex items-center ff-bold _1";return(Array.isArray(n)?n[0]:n?.[e.keyField]||0)===e.selected&&(b+=" _2"),e.buttonCss&&(b+=" "+e.buttonCss),b},_=n=>Array.isArray(n)?n[1]:e.valueField?n[e.valueField]:"";var o=Mt();pe(o,21,()=>e.options,we,(n,b)=>{var a=Pt();a.__click=k=>{k.stopPropagation(),e.onSelect(t(b))};var S=g(a,!0);u(a),M((k,I)=>{P(a,1,k,"svelte-1stmgp7"),ee(S,I)},[()=>ce(r(t(b))),()=>_(t(b))]),y(n,a)}),u(o),M(()=>P(o,1,`pb-4 md:pb-0 flex items-center shrink-0 max-w-[100%] overflow-x-auto overflow-y-hidden ${e.css??""}`,"svelte-1stmgp7")),y(A,o),he()}Ie(["click"]);var Rt=D('<button class="bx-red mr-8 lh-10" aria-label="Eliminar"><i class="icon-trash"></i></button>'),Et=D('<button class="bx-blue mr-8 lh-10" aria-label="Guardar"><i class="icon-floppy"></i> <span> </span></button>'),Nt=D('<div><div class="flex items-center justify-between"><div> </div> <div class="shrink-0 flex items-center"><!> <!> <button class="bx-yellow" title="close"><i class="icon-cancel"></i></button></div></div> <!> <div><!></div></div>'),Tt=D('<div class="w-page"><!></div>'),Ft=D("<!> <!>",1);function rt(A,e){_e(e,!0);let r;const _=350,o=H(()=>$e.sideLayerSize+"px"),n=H(()=>W.showSideLayer>0&&W.deviceType!==3?`calc(var(--page-width) - ${t(o)} - 8px)`:void 0),b=p=>{W.deviceType===3&&document.startViewTransition?ut().then(()=>{r&&r.style.setProperty("view-transition-name","mobile-side-layer"),setTimeout(()=>{r&&r.style.setProperty("view-transition-name","")},_),document.startViewTransition(()=>{W.showSideLayer=p})}):W.showSideLayer=p},a=()=>{b(0)};ne(()=>{e.type!=="side"||W.deviceType!==3||W.showSideLayer===e.id&&r&&(r.style.setProperty("view-transition-name","mobile-side-layer"),setTimeout(()=>{r&&r.style.setProperty("view-transition-name","")},_))}),ne(()=>{W.setSideLayer=b}),console.log("Env.sideLayerSize",$e.sideLayerSize);var S=Ft(),k=ye(S);{var I=p=>{var s=Nt(),c=g(s),m=g(c),f=g(m,!0);u(m);var w=d(m,2),C=g(w);{var R=B=>{var x=Rt();x.__click=function(...N){e.onDelete?.apply(this,N)},y(B,x)};F(C,B=>{e.onDelete&&B(R)})}var E=d(C,2);{var X=B=>{var x=Et();x.__click=function(...O){e.onSave?.apply(this,O)};var N=d(g(x),2),me=g(N,!0);u(N),u(x),M(()=>ee(me,e.saveButtonName)),y(B,x)};F(E,B=>{e.onSave&&B(X)})}var re=d(E,2);re.__click=B=>{B.stopPropagation(),a(),e.onClose&&(W.deviceType===3?setTimeout(()=>{e.onClose()},300):e.onClose())},u(w),u(c);var K=d(c,2);{var te=B=>{ct(B,{get options(){return e.options},get selected(){return e.selected},onSelect:x=>{e.onSelect?.(x)}})};F(K,B=>{(e.options||[]).length>0&&B(te)})}var le=d(K,2),ue=g(le);He(ue,()=>e.children),u(le),u(s),Le(s,B=>r=B,()=>r),M(()=>{P(s,1,`_1 flex flex-col ${(e.css||"")??""}`,"svelte-n6zgrd"),We(s,"data-layer-id",e.id),Ze(s,`width: ${t(o)??""};`),P(m,1,`overflow-hidden text-nowrap mr-8 ${e.titleCss??""}`,"svelte-n6zgrd"),ee(f,e.title),P(le,1,`_2 grow-1 ${e.contentCss??""}`,"svelte-n6zgrd")}),y(p,s)};F(k,p=>{W.showSideLayer===e.id&&e.type=="side"&&p(I)})}var z=d(k,2);{var G=p=>{var s=Tt();let c;var m=g(s);He(m,()=>e.children),u(s),M(()=>c=Ze(s,"",c,{width:t(n)})),y(p,s)};F(z,p=>{e.type=="content"&&p(G)})}y(A,S),he()}Ie(["click"]);var At=D('<div><div class="svelte-1m1yl0c"></div></div> <div> <!></div> <div><div class="svelte-1m1yl0c"></div></div> <div><div class="svelte-1m1yl0c"></div></div>',1),Vt=D('<div><div class="svelte-1m1yl0c"></div></div>'),zt=D("<input/>"),Bt=D('<div class="fs15 mt-2 _10 svelte-1m1yl0c"> </div>'),Ut=D('<div role="button" tabindex="0"><div class="h100 w100 flex items-center svelte-1m1yl0c"><!></div></div>'),Gt=D('<div class="svelte-1m1yl0c">Cargando...</div>'),jt=D("<div><i></i></div>"),qt=D("<span> </span>"),Ht=D('<div role="button" tabindex="0"><div></div></div>'),Wt=D('<div role="button" tabindex="0"></div>'),Kt=D("<div><!> <div><!> <!> <!></div> <!> <!> <!></div>");function qe(A,e){_e(e,!0);const r=q(e,"saveOn",15),_=q(e,"css",3,""),o=q(e,"options",19,()=>[]),n=q(e,"max",3,100),b=q(e,"notEmpty",3,!1),a=q(e,"required",3,!1),S=q(e,"disabled",3,!1),k=q(e,"clearOnSelect",3,!1),I=q(e,"avoidIDs",19,()=>[]),z=q(e,"inputCss",3,""),G=q(e,"showLoading",3,!1);let p=U(!1),s=U(oe([...o()])),c=U(-1),m=U(!1),f=U(0),w=U(""),C=!1,R,E=[];const X=H(()=>W.deviceType===3),re=H(()=>t(X)),K=H(()=>S()||G());function te(i){t(re)?h(w,i,!0):R&&(R.value=i)}function le(){let i=e.selected;typeof i>"u"&&e.save&&r()&&(i=r()[e.save]);let l;return i&&(l=o().find(v=>v[e.keyId]===i)),l}function ue(){return a()&&!S()}let B=Date.now();const x=(i,l)=>{const v=Date.now();if(v-B<80)return;B=v,b()&&!i&&(i=le()),i&&!k()?te(i[e.keyName]):te("");const T=i?i[e.keyId]:null;ue()&&h(f,T?2:1,!0),k()?e.onChange&&e.onChange(i):r()&&e.save?(r()[e.save]||null)!==T&&(r(r()[e.save]=T,!0),e.onChange&&e.onChange(i)):typeof e.selected<"u"&&(e.selected||null)!==T&&e.onChange&&e.onChange(i)},N=i=>{if(!i&&(I()?.length||0)===0)return[...o()];const l=new Set(I()||[]),v=[],T=i.toLowerCase().split(" ").filter(j=>j.length>1);for(const j of o())if(!(l.size>0&&l.has(j[e.keyId])))if(T.length===0)v.push(j);else{const $=j[e.keyName];typeof $=="string"&&bt($.toLowerCase(),T)&&v.push(j)}return v};function me(i){i.stopPropagation();const l=i.target,v=String(l.value||"").toLowerCase();dt(()=>{E=String(R.value).split(" "),h(s,N(v),!0)},120)}function O(i){console.log("avoid hover:: ",t(m)),i.stopPropagation();let l=t(s).length;if(l>n()&&(l=n()),!(!t(p)||t(s).length===0)){if(i.key==="ArrowUp"){let v=(t(c)||0)-1;v<0&&(v=l),h(c,v,!0),t(m)||h(m,!0)}else if(i.key==="ArrowDown"){let v=(t(c)||0)+1;v>l&&(v=1),h(c,v,!0),t(m)||h(m,!0)}}}function L(i){x(i),R&&R.blur(),h(p,!1)}let de=H(()=>`${fe.input} p-rel${_()?` ${_()}`:""}${e.label?"":" no-label"}`);function xe(){return t(f)?t(f)===2?'<i class="v-icon icon-ok c-green"></i>':t(f)===1?'<i class="v-icon icon-attention c-red"></i>':null:null}ne(()=>{const i=le();te(i?i[e.keyName]:""),ue()&&h(f,i?2:1,!0)}),ne(()=>{h(s,N(""),!0)});const Te=()=>{W.showMobileSearchLayer={options:t(s),keyName:e.keyName,keyID:e.keyId,onSelect:i=>{L(i)},onRemove:i=>{}}};var ke=Kt(),Fe=g(ke);{var Y=i=>{var l=At(),v=ye(l),T=d(v,2),j=g(T,!0),$=d(j);st($,()=>xe()||""),u(T);var V=d(T,2),J=d(V,2);M(()=>{P(v,1,ce(fe.input_lab_cell_left),"svelte-1m1yl0c"),P(T,1,ce(fe.input_lab),"svelte-1m1yl0c"),ee(j,e.label),P(V,1,ce(fe.input_lab_cell_right),"svelte-1m1yl0c"),P(J,1,ce(fe.input_shadow_layer),"svelte-1m1yl0c")}),y(i,l)};F(Fe,i=>{e.label&&i(Y)})}var ae=d(Fe,2),be=g(ae);{var De=i=>{var l=Vt();M(()=>P(l,1,ce(fe.input_div_1),"svelte-1m1yl0c")),y(i,l)};F(be,i=>{e.label&&i(De)})}var Z=d(be,2);{var ie=i=>{var l=zt();l.__keyup=me,l.__keydown=v=>{v.stopPropagation(),console.log(v),O(v)},Le(l,v=>R=v,()=>R),M(()=>{P(l,1,`w-full ${fe.input_inp} ${z()}`,"svelte-1m1yl0c"),We(l,"placeholder",G()?"":e.placeholder||":: seleccione ::"),l.disabled=t(K)||t(X)}),Ge("paste",l,me),Ge("cut",l,me),Ge("focus",l,v=>{v.stopPropagation(),t(p)||(E=[],h(s,N(""),!0),h(p,!0))}),Ge("blur",l,v=>{if(v.stopPropagation(),console.log("avoidBlur 2",C),C){C=!1,R.focus();return}let T=String(R.value||"").toLowerCase();const j=o().find($=>String($[e.keyName]||"").toLowerCase()===T);x(j),h(p,!1)}),y(i,l)},Ce=i=>{var l=Ut();l.__keydown=V=>{(V.key==="Enter"||V.key===" ")&&Te()},l.__click=V=>{V.stopPropagation(),Te()};var v=g(l),T=g(v);{var j=V=>{var J=ot();M(()=>ee(J,t(w))),y(V,J)},$=V=>{var J=Bt(),se=g(J,!0);u(J),M(()=>ee(se,e.placeholder||"")),y(V,J)};F(T,V=>{t(w)?V(j):V($,!1)})}u(v),u(l),M(()=>P(l,1,`w-full flex items-center ${fe.input_inp} ${z()}`,"svelte-1m1yl0c")),y(i,l)};F(Z,i=>{t(re)?i(Ce,!1):i(ie)})}var Ae=d(Z,2);{var Ve=i=>{var l=Qe(),v=ye(l);st(v,()=>xe()||""),y(i,l)};F(Ae,i=>{e.label||i(Ve)})}u(ae);var Oe=d(ae,2);{var ze=i=>{var l=Gt();y(i,l)};F(Oe,i=>{G()&&i(ze)})}var Pe=d(Oe,2);{var Be=i=>{var l=jt(),v=g(l);u(l),M(()=>{P(l,1,`absolute bottom-8 right-6 pointer-events-none ${t(p)&&!e.icon?"show":""}`,"svelte-1m1yl0c"),P(v,1,ce(e.icon||"icon-down-open-1"),"svelte-1m1yl0c")}),y(i,l)};F(Pe,i=>{t(K)||i(Be)})}var Me=d(Pe,2);{var Ke=i=>{var l=Wt();l.__mousedown=v=>{v.stopPropagation(),C=!0,console.log("avoidBlur 1",C)},l.__mousemove=function(...v){(t(m)?T=>{console.log("hover aqui:: ",t(c)),T.stopPropagation(),t(m)&&(h(c,-1),h(m,!1))}:void 0)?.apply(this,v)},pe(l,21,()=>t(s),we,(v,T,j)=>{const $=H(()=>String(t(T)[e.keyName]));var V=Ht();V.__click=se=>{se.stopPropagation(),L(t(T))};var J=g(V);pe(J,21,()=>wt(t($),E),we,(se,Re)=>{var Ue=qt();let Ye;var vt=g(Ue,!0);u(Ue),M(()=>{Ye=P(Ue,1,ce(t(Re).highl?"_8":""),"svelte-1m1yl0c",Ye,{"mr-4":t(Re).isEnd}),ee(vt,t(Re).text)}),y(se,Ue)}),u(J),u(V),M(()=>P(V,1,`flex ai-center _highlight${t(c)===j?" _selected":""}`,"svelte-1m1yl0c")),y(v,V)}),u(l),M(()=>P(l,1,`p-4 _1 left-0 z-40 w-full${t(c)>=0?" on-arrow":""}`,"svelte-1m1yl0c")),y(i,l)};F(Me,i=>{t(p)&&!t(re)&&i(Ke)})}u(ke),M(()=>{P(ke,1,ce(t(de)),"svelte-1m1yl0c"),P(ae,1,`${fe.input_div} flex w-full`,"svelte-1m1yl0c")}),y(A,ke),he()}Ie(["keyup","keydown","click","mousedown","mousemove"]);var Jt=D('<div class="m-2 px-8 min-w-56 h-32 lh-10 flex _3 svelte-vrzsuu"> <button class="_4 absolute w-28 h-28 rounded right-2 svelte-vrzsuu" aria-label="eliminar"><i class="icon-trash"></i></button></div>'),Qt=D("<div><!> <div></div></div>");function Xt(A,e){_e(e,!0);const r=q(e,"saveOn",15),_=q(e,"css",3,""),o=q(e,"options",19,()=>[]);let n=U(oe([]));const b=()=>{if(Je.has(o()))return;const p=new Map,s=new Map;for(const c of o())p.set(c[e.keyId],c),s.set(c[e.keyName].toLowerCase(),c);Je.set(o(),{idToRecord:p,valueToRecord:s})};b(),ne(()=>{o()?.length>0&&b()});const a=()=>{r()&&e.save&&r(r()[e.save]=t(n),!0),e.onChange&&e.onChange(t(n))};let S;ne(()=>{r()&&e.save&&r()!==S&&(S=r(),b(),Ne(()=>{h(n,r()[e.save]||[],!0)}))});const k=p=>(Je.get(o())?.idToRecord||new Map).get(p)||{[e.keyName]:`ID-${p}`,[e.keyId]:p};var I=Qt(),z=g(I);{let p=H(()=>"s1 "+e.inputCss);qe(z,{get options(){return o()},get keyId(){return e.keyId},get keyName(){return e.keyName},clearOnSelect:!0,get avoidIDs(){return t(n)},get placeholder(){return e.label},get css(){return t(p)},onChange:s=>{if(!s)return;const c=s[e.keyId];t(n).includes(c)||(t(n).push(c),a())}})}var G=d(z,2);pe(G,21,()=>t(n),we,(p,s)=>{const c=H(()=>k(t(s)));var m=Jt(),f=g(m),w=d(f);w.__click=C=>{C.stopPropagation(),h(n,t(n).filter(R=>R!==t(s)),!0),a()},u(m),M(()=>ee(f,`${t(c)[e.keyName]??""} `)),y(p,m)}),u(G),u(I),M(()=>{P(I,1,ce(_()),"svelte-vrzsuu"),P(G,1,`p-4 min-h-40 _2 flex flex-wrap ${e.cardCss??""}`,"svelte-vrzsuu")}),y(A,I),he()}Ie(["click"]);var Yt=D('<button class="bx-red mr-8 lh-10" aria-label="Eliminar"><i class="icon-trash"></i></button>'),Zt=D('<button class="bx-blue mr-8 lh-10"><i class="icon-floppy"></i> <span> </span></button>'),$t=D('<div class="_1 fixed top-0 left-0 flex items-center justify-center svelte-1bxxaoh"><div><div><div class="flex items-center ff-bold h2"><!></div> <div class="flex items-center"><!> <!> <button class="bx-yellow h3 lh-10" aria-label="Cerrar"><i class="icon-cancel"></i></button></div></div> <div><!></div></div></div>');function ea(A,e){_e(e,!0);let r=q(e,"css",3,""),_=q(e,"isEdit",3,!1),o=U(!1),n=U(void 0);ne(()=>{const s=_t.includes(e.id);t(o)!==s&&(s?(h(o,!0),Ne(()=>{setTimeout(()=>{t(n)&&t(n).classList.add("show")},0)})):Ne(()=>{t(n)?.classList?.remove("show"),setTimeout(()=>{h(o,!1)},300)}))});function b(s){s.stopPropagation(),e.onClose&&e.onClose(),nt(e.id)}function a(s){e.onDelete&&(e.onDelete(),s.stopPropagation())}function S(s){e.onSave&&(e.onSave(),s.stopPropagation())}function k(s){return typeof s=="function"}const I=new Map([[1,"w-600 max-w-[64vw]"],[2,"w-650 max-w-[66vw]"],[3,"w-700 max-w-[68vw]"],[4,"w-750 max-w-[72vw]"],[5,"w-800 max-w-[75vw]"],[6,"w-850 max-w-[78vw]"],[7,"w-900 max-w-[82vw]"],[8,"w-950 max-w-[84vw]"],[9,"w-1000 max-w-[88vw]"]]);var z=Qe(),G=ye(z);{var p=s=>{xt(s,{children:(c,m)=>{var f=$t(),w=g(f),C=g(w),R=g(C),E=g(R);{var X=O=>{var L=Qe(),de=ye(L);He(de,()=>e.title),y(O,L)},re=O=>{var L=ot();M(()=>ee(L,e.title)),y(O,L)};F(E,O=>{k(e.title)?O(X):O(re,!1)})}u(R);var K=d(R,2),te=g(K);{var le=O=>{var L=Yt();L.__click=a,y(O,L)};F(te,O=>{e.onDelete&&O(le)})}var ue=d(te,2);{var B=O=>{var L=Zt();L.__click=S;var de=d(g(L),2),xe=g(de,!0);u(de),u(L),M(()=>{We(L,"aria-label",_()?"Actualizar":"Guardar"),ee(xe,_()?"Actualizar":"Guardar")}),y(O,L)};F(ue,O=>{e.onSave&&O(B)})}var x=d(ue,2);x.__click=b,u(K),u(C);var N=d(C,2),me=g(N);He(me,()=>e.children??mt),u(N),u(w),u(f),Le(f,O=>h(n,O),()=>t(n)),M(O=>{P(w,1,`_2 pt-50 min-h-460 flex flex-col relative ${r()??""} ${O??""}`,"svelte-1bxxaoh"),P(C,1,`_3 h-50 py-0 px-12 flex absolute w-full top-0 left-0 items-center justify-between mb-auto ${e.headCss??""}`,"svelte-1bxxaoh"),P(N,1,`w-full grow py-6 px-10 ${e.bodyCss??""}`,"svelte-1bxxaoh")},[()=>I.get(e.size)]),y(c,f)},$$slots:{default:!0}})};F(G,s=>{t(o)&&s(p)})}y(A,z),he()}Ie(["click"]);class ta extends lt{route="productos";useCache={min:5,ver:9};#e=U(oe([]));get productos(){return t(this.#e)}set productos(e){h(this.#e,e,!0)}#t=U(oe(new Map));get productosMap(){return t(this.#t)}set productosMap(e){h(this.#t,e,!0)}handler(e){console.log("productos result::",e);for(const r of e)r.Image=r.Images?.[0],r.CategoriasIDs=r.CategoriasIDs||[];this.productos=e,this.productosMap=new Map(e.map(r=>[r.ID,r]))}constructor(){super(),this.fetch()}}const aa=A=>Xe({data:A,route:"productos",refreshRoutes:["productos"]});class sa extends lt{route="listas-compartidas2";useCache={min:5,ver:6};#e=U(oe([]));get Records(){return t(this.#e)}set Records(e){h(this.#e,e,!0)}#t=U(oe(new Map));get RecordsMap(){return t(this.#t)}set RecordsMap(e){h(this.#t,e,!0)}#a=U(oe(new Map));get ListaRecordsMap(){return t(this.#a)}set ListaRecordsMap(e){h(this.#a,e,!0)}get(e){return this.RecordsMap.get(e)}handler(e){console.log("result getted::",e),this.Records=[],this.ListaRecordsMap=new Map;for(const[r,_]of Object.entries(e)){const o=parseInt(r.split("_")[1]);for(const n of _)if(n.ss){if(this.Records.push(n),[1,2].includes(o)){const b=new Map((n.Images||[]).filter(a=>a).map(a=>[parseInt(a.split("-")[1]),a]));n.Images=[];for(const a of[1,2,3])n.Images.push(b.get(a)||"")}this.ListaRecordsMap.has(n.ListaID)?this.ListaRecordsMap.get(n.ListaID)?.push(n):this.ListaRecordsMap.set(n.ListaID,[n])}}this.RecordsMap=new Map(this.Records.map(r=>[r.ID,r]))}addNew(e){const r=this.ListaRecordsMap.get(e.ListaID)||[];r.unshift(e),this.ListaRecordsMap.set(e.ListaID,[...r]),this.ListaRecordsMap=new Map(this.ListaRecordsMap),this.RecordsMap.set(e.ID,e),this.Records.push(e)}constructor(e=[]){super(),e.length>0&&(this.route=`listas-compartidas2?ids=${e.join(",")}`),e&&this.fetch()}}const ra=A=>Xe({data:A,route:"listas-compartidas",refreshRoutes:["listas-compartidas2"]});var ia=D('<div class="_1 px-12 py-10 w-250 min-h-140 svelte-u9lhhq" role="button" tabindex="0"><div class="min-h-70 _2 mb-2 svelte-u9lhhq"></div> <div class="fs17 ff-semibold"> </div> <div class="fs15"> </div></div>'),oa=D('<div class="grid grid-cols-12 gap-10 p-6"><!> <!> <!></div>'),na=D('<div class="w-full flex flex-wrap gap-12"></div> <!>',1);function it(A,e){_e(e,!0);const r=q(e,"listas",7),_=H(()=>(console.log("listas getted:",ge(r())),r().ListaRecordsMap.get(e.origin)||[]));let o=U(oe({}));const n=[151,152,153];let b=U(oe([{_id:151},{_id:152},{_id:153}]));const a=async s=>{if(console.log("form a enviar 1::",ge(t(o)),s),(t(o).Nombre||"").length<4||!t(o).ListaID){Ee.failure("Debe colocar un nombre de al menos 4 caracteres.");return}ve.standard("Guardando categoría..."),t(o).Images=t(o).Images||[],t(o).ss=s?0:1;for(let w=0;w<n.length;w++){const C=n[w];if(et.has(C)){ve.change(`Guardando Imagen ${w+1}`);let E=(await et.get(C)?.())?.imageName||"";E.includes("/")&&(E=E.split("/")[1]),t(o).Images[w]=E}else t(o).Images[w]=t(o).Images?.[w]||""}console.log("form a enviar 2::",ge(t(o))),ve.change("Guardando categoría...");let c;try{c=await ra([t(o)])}catch(w){Ee.failure(w);return}const m=t(_).find(w=>w.ID===t(o).ID);let f=[...t(_)];m&&s?f=f.filter(w=>w.ID!==t(o).ID):m?Object.assign(m,t(o)):(t(o).ID=c[0].NewID,f.push(t(o)),r().RecordsMap.set(t(o).ID,t(o))),console.log("newCategorias",f.length,"|",t(_).length),r().ListaRecordsMap.set(e.origin,f),r().ListaRecordsMap=new Map(r().ListaRecordsMap),ht(),ve.remove()},S=()=>{h(o,{ListaID:e.origin},!0),tt(2)};ne(()=>{console.log("form a enviar::",ge(t(o)))});const k=s=>{h(o,{...s},!0),h(b,n.map((c,m)=>({_id:c,src:(t(o).Images||[])[m]||""})),!0),console.log("categoría getted:",ge(t(o)),ge(t(b))),tt(2)};var I={newRecord:S},z=na(),G=ye(z);pe(G,21,()=>t(_),we,(s,c)=>{var m=ia();m.__keydown=E=>{E.stopPropagation(),(E.key==="Enter"||E.key===" ")&&(E.preventDefault(),k(t(c)))},m.__click=E=>{E.stopPropagation(),k(t(c))};var f=d(g(m),2),w=g(f,!0);u(f);var C=d(f,2),R=g(C,!0);u(C),u(m),M(()=>{ee(w,t(c).Nombre),ee(R,t(c).Descripcion)}),y(s,m)}),u(G);var p=d(G,2);{let s=H(()=>t(o).ID>0?()=>{a(!0)}:void 0);ea(p,{title:"CATEGORÍA",id:2,size:6,onClose:()=>{nt(2)},onSave:()=>{a()},get onDelete(){return t(s)},children:(c,m)=>{var f=oa(),w=g(f);Q(w,{label:"Nombre",css:"col-span-12",get saveOn(){return t(o)},save:"Nombre",required:!0});var C=d(w,2);Q(C,{label:"Descripción",css:"col-span-12 mb-16",get saveOn(){return t(o)},save:"Descripcion"});var R=d(C,2);pe(R,17,()=>t(b),we,(E,X,re)=>{je(E,{clearOnUpload:!0,get id(){return t(X)._id},folder:"img-public",get src(){return t(X).src},size:2,cardCss:"w-full h-180 p-4 col-span-4",types:["avif","webp"],saveAPI:"producto-categoria-image",hideUploadButton:!0,hideForm:!0,onChange:K=>{Object.assign(t(X),K)},setDataToSend:K=>{K.Order=re+1}})}),u(f),y(c,f)},$$slots:{default:!0}})}return y(A,z),he(I)}Ie(["keydown","click"]);var la=D('<div class="grid grid-cols-24 items-start gap-x-10 gap-y-10 mt-6 md:mt-16"><!> <div class="col-span-24 md:col-span-9 md:row-span-4"><!></div> <!> <!> <!> <!> <!> <!> <!> <!> <div class="col-span-24 md:col-span-5"><!></div> <!> <!> <div class="ff-bold h3 col-span-24 ml-8">Sub-Unidades</div> <!> <!> <!> <!> <!></div>'),da=D('<div class="grid grid-cols-2 md:grid-cols-4 items-start gap-x-10 gap-y-10 mt-16"><!> <!></div>'),ca=D("<!> <!> <!>",1),va=D('<div class="grid grid-cols-12 md:flex md:flex-row items-center mb-8"><!> <div class="i-search w-full md:w-200 md:ml-12 col-span-5"><div><i class="icon-search"></i></div> <input type="text"/></div> <button class="bx-green ml-auto col-span-7"><i class="icon-plus"></i><span class="hidden md:block">Nuevo</span></button></div> <!> <!> <!> <!>',1);function Ea(A,e){_e(e,!0);let r=U("");const _=new ta,o=new sa([1,2]);let n=U(1),b=U(1),a=U(oe({})),S=null,k=null,I=[{header:"ID",css:"c-blue text-center",headerCss:"w-48",getValue:s=>s.ID},{header:"Producto",highlight:!0,getValue:s=>s.Nombre},{header:"Categorías",highlight:!0,getValue:s=>{const c=[];for(const m of s.CategoriasIDs){const f=o.get(m)?.Nombre||`Categoría-${m}`;c.push(f)}return c.join(", ")}},{header:"Precio",css:"text-right",getValue:s=>at(s.Precio/100,2)},{header:"Descuento",css:"text-right",getValue:s=>s.Descuento?String(s.Descuento)+"%":""},{header:"Precio Final",css:"text-right",getValue:s=>at(s.PrecioFinal/100,2)},{header:"Sub Unidades",css:"text-right",getValue:s=>s.SbnUnidad?`${s.SbnCantidad} x ${s.SbnUnidad}`:""}];const z=H(()=>o.ListaRecordsMap.get(1)||[]),G=async()=>{if((t(a).Nombre?.length||0)<4){Ee.failure("El nombre debe tener al menos 4 caracteres.");return}console.log("productor a enviar:",ge(t(a))),ve.standard("Guardando producto...");try{var s=await aa([t(a)])}catch(m){Ee.failure(m),ve.remove();return}ve.remove();const c=_.productos.find(m=>m.ID===t(a).ID);c&&Object.assign(c,t(a)),W.setSideLayer(0)};ne(()=>{console.log("productor form:",ge(t(a)))});const p=async s=>{ve.standard("Eliminando Imagen...");try{await Xe({data:{ProductoID:t(a).ID,ImageToDelete:s},route:"producto-image",refreshRoutes:["productos"]})}catch(c){Ee.failure(`Error al eliminar imagen: ${c}`),ve.remove();return}ve.remove(),t(a).Images=(t(a).Images||[]).filter(c=>c.n!==s)};pt(A,{sideLayerSize:780,title:"Productos",children:(s,c)=>{var m=va(),f=ye(m),w=g(f);ct(w,{get selected(){return t(n)},css:"col-span-12 mb-6 md:mb-0",options:[[1,"Productos"],[2,"Categorías"],[3,"Marcas"]],onSelect:x=>{W.setSideLayer(0),h(a,{ID:0},!0),h(n,x[0],!0)}});var C=d(w,2),R=d(g(C),2);R.__keyup=x=>{const N=String(x.target.value||"");dt(()=>{h(r,N,!0)},150)},u(C);var E=d(C,2);E.__click=x=>{x.stopPropagation(),t(n)===2?S?.newRecord():t(n)===2?k?.newRecord():W.setSideLayer(1)},u(f);var X=d(f,2);{var re=x=>{rt(x,{type:"content",children:(N,me)=>{{let O=H(()=>t(a)?.ID);It(N,{get columns(){return I},get data(){return _.productos},get filterText(){return t(r)},get selected(){return t(O)},isSelected:(L,de)=>L.ID===de,getFilterContent:L=>L.Nombre,onRowClick:L=>{h(a,{...L},!0),t(a).CategoriasIDs=[...L.CategoriasIDs||[]],t(a).Propiedades=[...L.Propiedades||[]],W.setSideLayer(1)}})}},$$slots:{default:!0}})};F(X,x=>{t(n)===1&&x(re)})}var K=d(X,2);{let x=H(()=>t(a)?.Nombre||"");rt(K,{css:"px-8 py-8 md:px-14 md:py-10",get title(){return t(x)},type:"side",titleCss:"h2 mb-6",contentCss:"px-0 md:px-0",id:1,options:[[1,"Información"],[2,"Ficha"],[3,"Parámetros"],[4,"Fotos"]],get selected(){return t(b)},onSelect:N=>h(b,N[0],!0),onClose:()=>{h(a,{},!0)},onSave:()=>{G()},children:(N,me)=>{var O=ca(),L=ye(O);{var de=Y=>{var ae=la(),be=g(ae);Q(be,{label:"Nombre",get saveOn(){return t(a)},css:"col-span-24",required:!0,save:"Nombre"});var De=d(be,2),Z=g(De);{let J=H(()=>t(a).Image?.n);je(Z,{saveAPI:"producto-image",clearOnUpload:!0,types:["avif","webp"],folder:"img-productos",size:2,get src(){return t(J)},cardCss:"w-full h-180  p-4",setDataToSend:se=>{se.ProductoID=t(a).ID},onUploaded:(se,Re)=>{se.includes("/")&&(se=se.split("/")[1]),t(a).Image={n:se,d:Re},t(a).Images=t(a).Images||[],t(a).Images.unshift(t(a).Image)}})}u(De);var ie=d(De,2);Q(ie,{label:"Precio Base",get saveOn(){return t(a)},css:"col-span-12 md:col-span-5",save:"Precio",type:"number",baseDecimals:2});var Ce=d(ie,2);Q(Ce,{label:"Descuento",get saveOn(){return t(a)},css:"col-span-12 md:col-span-5",save:"Descuento",postValue:"%",type:"number"});var Ae=d(Ce,2);Q(Ae,{label:"Precio Final",get saveOn(){return t(a)},css:"col-span-12 md:col-span-5",save:"PrecioFinal",type:"number",baseDecimals:2});var Ve=d(Ae,2);qe(Ve,{label:"Moneda",get saveOn(){return t(a)},css:"col-span-12 md:col-span-5",save:"MonedaID",keyId:"i",keyName:"v",options:[{i:1,v:"PEN (S/.)"},{i:2,v:"USD ($)"}]});var Oe=d(Ve,2);Q(Oe,{label:"Peso",get saveOn(){return t(a)},css:"col-span-12 md:col-span-5",save:"Peso",type:"number"});var ze=d(Oe,2);qe(ze,{label:"Unidad",get saveOn(){return t(a)},css:"col-span-12 md:col-span-5",save:"UnidadID",keyId:"i",keyName:"v",options:[{i:1,v:"Kg"},{i:2,v:"g"},{i:3,v:"Libras"}]});var Pe=d(ze,2);Q(Pe,{label:"Volumen",get saveOn(){return t(a)},css:"col-span-12 md:col-span-5",save:"Volumen",type:"number"});var Be=d(Pe,2);qe(Be,{label:"Marca",get saveOn(){return t(a)},css:"col-span-12 md:col-span-10 mb-2",save:"MarcaID",keyId:"i",keyName:"v",options:[{i:1,v:"PEN (S/.)"},{i:2,v:"g"},{i:3,v:"Libras"}]});var Me=d(Be,2),Ke=g(Me);Ct(Ke,{save:"Params",get saveOn(){return t(a)},type:"multiple",options:[{i:1,v:"SKU Individual"}],keyId:"i",keyName:"v"}),u(Me);var i=d(Me,2);Q(i,{get saveOn(){return t(a)},save:"Descripcion",css:"col-span-24 mb-4",label:"Descripción Corta"});var l=d(i,2);Xt(l,{css:"col-span-24 flex items-start",label:"CATEGORÍAS ::",get options(){return t(z)},keyId:"ID",keyName:"Nombre",cardCss:"grow",inputCss:"w-[35%] md:w-180",save:"CategoriasIDs",get saveOn(){return t(a)},set saveOn(J){h(a,J,!0)}});var v=d(l,4);Q(v,{get saveOn(){return t(a)},save:"SbnUnidad",css:"col-span-12 md:col-span-6",label:"Nombre"});var T=d(v,2);Q(T,{get saveOn(){return t(a)},save:"SbnPrecio",baseDecimals:2,css:"col-span-12 md:col-span-6",label:"Precio Base",type:"number"});var j=d(T,2);Q(j,{get saveOn(){return t(a)},save:"SbnDescuento",postValue:"%",css:"col-span-12 md:col-span-6",label:"Descuento",type:"number"});var $=d(j,2);Q($,{get saveOn(){return t(a)},save:"SbnPreciFinal",baseDecimals:2,css:"col-span-12 md:col-span-6",label:"Precio Final",type:"number"});var V=d($,2);Q(V,{get saveOn(){return t(a)},save:"SbnCantidad",css:"col-span-12 md:col-span-6",label:"Cantidad",type:"number"}),u(ae),y(Y,ae)};F(L,Y=>{t(b)===1&&Y(de)})}var xe=d(L,2);{var Te=Y=>{Ot(Y,{get saveOn(){return t(a)},save:"ContentHTML",css:"mt-12"})};F(xe,Y=>{t(b)===2&&Y(Te)})}var ke=d(xe,2);{var Fe=Y=>{var ae=da(),be=g(ae);je(be,{saveAPI:"producto-image",clearOnUpload:!0,types:["avif","webp"],folder:"img-productos",cardCss:"w-full h-170 p-4",setDataToSend:Z=>{Z.ProductoID=t(a).ID},onUploaded:(Z,ie)=>{Z.includes("/")&&(Z=Z.split("/")[1]),t(a).Image={n:Z,d:ie},t(a).Images=t(a).Images||[],t(a).Images.unshift(t(a).Image)}});var De=d(be,2);pe(De,17,()=>t(a).Images||[],we,(Z,ie)=>{{let Ce=H(()=>t(ie)?.n);je(Z,{saveAPI:"producto-image",size:2,clearOnUpload:!0,types:["avif","webp"],folder:"img-productos",cardCss:"w-full h-170 p-4",get src(){return t(Ce)},onDelete:()=>{yt("ELIMINAR IMAGEN",`Eliminar la imagen ${t(ie).d?`"${t(ie).d}"`:"seleccionada"}`,"SI","NO",()=>{p(t(ie).n)})}})}}),u(ae),y(Y,ae)};F(ke,Y=>{t(b)===4&&Y(Fe)})}y(N,O)},$$slots:{default:!0}})}var te=d(K,2);{var le=x=>{Le(it(x,{get listas(){return o},origin:1}),N=>S=N,()=>S)};F(te,x=>{t(n)===2&&x(le)})}var ue=d(te,2);{var B=x=>{Le(it(x,{get listas(){return o},origin:2}),N=>k=N,()=>k)};F(ue,x=>{t(n)===3&&x(B)})}y(s,m)},$$slots:{default:!0}}),he()}Ie(["keyup","click"]);export{Ea as component};
