import"./DsnmJJEf.js";import{p as Ae,e as C,g as he,l as ye,h as r,f as m,c as w,s as y,i as a,u as O,r as f,t as u,b as c,d as He,a as we,x as Ke,ax as je}from"./DsnVzSLI.js";import{s as U}from"./00GtM8hT.js";import{i as S}from"./tZVUs-sg.js";import{e as be,i as Fe}from"./kj_n-KZc.js";import{h as ke}from"./trZv5SJJ.js";import{s as v,c as P,b as Je}from"./Dfx1yjcr.js";import{d as We,e as z}from"./BzG9rrjb.js";import{b as Ge}from"./cribf4_g.js";import{p as _}from"./Dgo9tfmS.js";import{i as Qe,h as Xe}from"./CAaV5v2W.js";import{t as Ye}from"./DP6SISrU.js";import{C as xe}from"./Bz9XdVJx.js";import{s as b}from"./BMRmn4k7.js";var Ze=m('<div><div class="svelte-1m1yl0c"></div></div> <div> <!></div> <div><div class="svelte-1m1yl0c"></div></div> <div><div class="svelte-1m1yl0c"></div></div>',1),$e=m('<div><div class="svelte-1m1yl0c"></div></div>'),et=m("<input/>"),tt=m('<div class="fs15 mt-2 _10 svelte-1m1yl0c"> </div>'),it=m('<div role="button" tabindex="0"><div class="h100 w100 flex items-center svelte-1m1yl0c"><!></div></div>'),at=m('<div class="svelte-1m1yl0c">Cargando...</div>'),ot=m("<div><i></i></div>"),lt=m("<span> </span>"),nt=m('<div role="button" tabindex="0"><div></div></div>'),rt=m('<div role="button" tabindex="0"></div>'),st=m("<div><!> <div><!> <!> <!></div> <!> <!> <!></div>");function Ct(Ce,i){Ae(i,!0);const V=_(i,"saveOn",15),G=_(i,"css",3,""),L=_(i,"options",19,()=>[]),Q=_(i,"max",3,100),Se=_(i,"notEmpty",3,!1),Pe=_(i,"required",3,!1),X=_(i,"disabled",3,!1),Y=_(i,"clearOnSelect",3,!1),Z=_(i,"avoidIDs",19,()=>[]),$=_(i,"inputCss",3,""),A=_(i,"showLoading",3,!1);let p=C(!1),N=C(he([...L()])),k=C(-1),x=C(!1),I=C(0),H=C(""),R=!1,ee=C(!1),d,q=C(he([]));const te=O(()=>xe.deviceType===3),K=O(()=>a(te)),ie=O(()=>X()||A());function Le(){if(d){const e=d.getBoundingClientRect(),t=window.innerHeight;r(ee,e.top>t/2)}}function B(e){a(K)?r(H,e,!0):d&&(d.value=e)}function ae(){let e=i.selected;typeof e>"u"&&i.save&&V()&&(e=V()[i.save]);let t;return e&&(t=L().find(o=>o[i.keyId]===e)),t}function oe(){return Pe()&&!X()}let le=Date.now();const ne=(e,t)=>{const o=Date.now();if(o-le<80)return;le=o,Se()&&!e&&(e=ae()),e&&!Y()?B(e[i.keyName]):B("");const l=e?e[i.keyId]:null;oe()&&r(I,l?2:1,!0),Y()?i.onChange&&i.onChange(e):V()&&i.save?(V()[i.save]||null)!==l&&(V(V()[i.save]=l,!0),i.onChange&&i.onChange(e)):typeof i.selected<"u"&&(i.selected||null)!==l&&i.onChange&&i.onChange(e)},j=e=>{if(console.log("options filtered::",i.label,L()),!e&&(Z()?.length||0)===0)return[...L()];const t=new Set(Z()||[]),o=[],l=e.toLowerCase().split(" ").filter(n=>n.length>1);for(const n of L())if(!(t.size>0&&t.has(n[i.keyId])))if(l.length===0)o.push(n);else{const g=n[i.keyName];typeof g=="string"&&Qe(g.toLowerCase(),l)&&o.push(n)}return console.log("options filtered 2::",i.label,L(),o),o};function F(e){e.stopPropagation();const t=e.target,o=String(t.value||"").toLowerCase();Ye(()=>{r(q,String(d.value).toLowerCase().split(" "),!0),r(N,j(o),!0)},120)}function pe(e){console.log("avoid hover:: ",a(x)),e.stopPropagation();let t=a(N).length;if(t>Q()&&(t=Q()),!(!a(p)||a(N).length===0)){if(e.key==="ArrowUp"){let o=(a(k)||0)-1;o<0&&(o=t),r(k,o,!0),a(x)||r(x,!0)}else if(e.key==="ArrowDown"){let o=(a(k)||0)+1;o>t&&(o=1),r(k,o,!0),a(x)||r(x,!0)}}}function re(e){ne(e),d&&d.blur(),r(p,!1)}let Ne=O(()=>`${b.input} p-rel${G()?` ${G()}`:""}${i.label?"":" no-label"}`);function se(){return a(I)?a(I)===2?'<i class="v-icon icon-ok c-green"></i>':a(I)===1?'<i class="v-icon icon-attention c-red"></i>':null:null}ye(()=>{const e=ae();B(e?e[i.keyName]:""),oe()&&r(I,e?2:1,!0)}),ye(()=>{r(N,j(""),!0)});const ve=()=>{xe.showMobileSearchLayer={options:a(N),keyName:i.keyName,keyID:i.keyId,onSelect:e=>{re(e)},onRemove:e=>{}}},De=O(()=>a(q).join("_"));var E=st(),ce=w(E);{var Oe=e=>{var t=Ze(),o=we(t),l=y(o,2),n=w(l,!0),g=y(n);ke(g,()=>se()||""),f(l);var s=y(l,2),h=y(s,2);u(()=>{v(o,1,P(b.input_lab_cell_left),"svelte-1m1yl0c"),v(l,1,P(b.input_lab),"svelte-1m1yl0c"),U(n,i.label),v(s,1,P(b.input_lab_cell_right),"svelte-1m1yl0c"),v(h,1,P(b.input_shadow_layer),"svelte-1m1yl0c")}),c(e,t)};S(ce,e=>{i.label&&e(Oe)})}var M=y(ce,2),de=w(M);{var Ve=e=>{var t=$e();u(()=>v(t,1,P(b.input_div_1),"svelte-1m1yl0c")),c(e,t)};S(de,e=>{i.label&&e(Ve)})}var fe=y(de,2);{var Ie=e=>{var t=et();t.__keyup=F,t.__keydown=o=>{o.stopPropagation(),console.log(o),pe(o)},Ge(t,o=>d=o,()=>d),u(()=>{v(t,1,`w-full ${b.input_inp} ${$()}`,"svelte-1m1yl0c"),Je(t,"placeholder",A()?"":i.placeholder||":: seleccione ::"),t.disabled=a(ie)||a(te)}),z("paste",t,F),z("cut",t,F),z("focus",t,o=>{o.stopPropagation(),a(p)||(Le(),r(q,[],!0),r(N,j(""),!0),r(p,!0))}),z("blur",t,o=>{if(o.stopPropagation(),console.log("avoidBlur 2",R),R){R=!1,d.focus();return}let l=String(d.value||"").toLowerCase();const n=L().find(g=>String(g[i.keyName]||"").toLowerCase()===l);ne(n),r(p,!1)}),c(e,t)},Re=e=>{var t=it();t.__keydown=s=>{(s.key==="Enter"||s.key===" ")&&ve()},t.__click=s=>{s.stopPropagation(),ve()};var o=w(t),l=w(o);{var n=s=>{var h=je();u(()=>U(h,a(H))),c(s,h)},g=s=>{var h=tt(),D=w(h,!0);f(h),u(()=>U(D,i.placeholder||"")),c(s,h)};S(l,s=>{a(H)?s(n):s(g,!1)})}f(o),f(t),u(()=>v(t,1,`w-full flex items-center ${b.input_inp} ${$()}`,"svelte-1m1yl0c")),c(e,t)};S(fe,e=>{a(K)?e(Re,!1):e(Ie)})}var qe=y(fe,2);{var Be=e=>{var t=Ke(),o=we(t);ke(o,()=>se()||""),c(e,t)};S(qe,e=>{i.label||e(Be)})}f(M);var ue=y(M,2);{var Ee=e=>{var t=at();c(e,t)};S(ue,e=>{A()&&e(Ee)})}var _e=y(ue,2);{var Me=e=>{var t=ot(),o=w(t);f(t),u(()=>{v(t,1,`absolute bottom-8 right-6 pointer-events-none ${a(p)&&!i.icon?"show":""}`,"svelte-1m1yl0c"),v(o,1,P(i.icon||"icon-down-open-1"),"svelte-1m1yl0c")}),c(e,t)};S(_e,e=>{a(ie)||e(Me)})}var Te=y(_e,2);{var Ue=e=>{var t=rt();let o;t.__mousedown=l=>{l.stopPropagation(),R=!0,console.log("avoidBlur 1",R)},t.__mousemove=function(...l){(a(x)?n=>{console.log("hover aqui:: ",a(k)),n.stopPropagation(),a(x)&&(r(k,-1),r(x,!1))}:void 0)?.apply(this,l)},be(t,23,()=>a(N),l=>l[i.keyId]+a(De),(l,n,g)=>{const s=O(()=>String(a(n)[i.keyName])),h=O(()=>Xe(a(s),a(q)));var D=nt();D.__click=J=>{J.stopPropagation(),re(a(n))};var me=w(D);be(me,21,()=>a(h),Fe,(J,W)=>{var T=lt();let ge;var ze=w(T,!0);f(T),u(()=>{ge=v(T,1,P(a(W).highl?"_8":""),"svelte-1m1yl0c",ge,{"mr-4":a(W).isEnd}),U(ze,a(W).text)}),c(J,T)}),f(me),f(D),u(()=>v(D,1,`flex ai-center _highlight${a(k)===a(g)?" _selected":""}`,"svelte-1m1yl0c")),c(l,D)}),f(t),u(()=>o=v(t,1,`p-4 _1 left-0 z-320 ${a(k)>=0?" on-arrow":""} ${(i.optionsCss||"w-full")??""}`,"svelte-1m1yl0c",o,{"open-up":a(ee)})),c(e,t)};S(Te,e=>{a(p)&&!a(K)&&e(Ue)})}f(E),u(()=>{v(E,1,P(a(Ne)),"svelte-1m1yl0c"),v(M,1,`${b.input_div} flex w-full`,"svelte-1m1yl0c")}),c(Ce,E),He()}We(["keyup","keydown","click","mousedown","mousemove"]);export{Ct as S};
