import{a as c,g as $,c as s,d as y,i,b as I,t as h,o as _,e as D}from"./web-D2t8vN-4.js";import{c as S,x as k,S as P,t as N,f as V,a as u,P as U,N as f,L as d}from"./app-wv8zGSIX.js";import{D as g}from"./Datepicker-D3ng-pXR.js";import{Q as E}from"./QTable-Ek_A2ckd.js";import{u as L,c as O,g as A}from"./ventas-BJz7dHQd.js";var H=h('<div class="flex ai-center jc-between mb-06"><div class="flex ai-center w100-10"><button class="bn1 b-blue ml-10"><i class=icon-search></i></button></div><div class="search-c4 mr-16 w14rem ml-auto"><div><i class=icon-search></i></div><input class=w100 autocomplete=off type=text>'),Q=h("<span>");function J(){const l=S(O,"id"),m=k.getFechaUnix(),p=m-7,[r,v]=c({fechaFin:m,fechaInicio:p}),[n]=L(),[C,b]=c([]),[j,x]=c(""),w=async()=>{const e=r();if(console.log("form::",e),!e.CajaID||!e.fechaInicio||!e.fechaFin){f.failure("Debe seleccionar una caja y un rango de fechas.");return}d.standard("Consultando registros...");let a;try{a=await A(e)}catch(t){f.failure(t);return}d.remove(),b(a),console.log("movimientos obtenidos: ",a)};return $(_(()=>[n()],()=>{(n()?.Cajas||[]).length>0&&v({...r(),CajaID:n().Cajas[0].ID})})),s(U,{title:"Almacén Stock",get children(){return[(()=>{var e=H(),a=e.firstChild,t=a.firstChild,F=a.nextSibling,M=F.firstChild,T=M.nextSibling;return a.style.setProperty("max-width","64rem"),i(a,s(P,{get saveOn(){return r()},save:"CajaID",css:"w-08x mb-02 mr-12",label:"Cajas & Bancos",keys:"ID.Nombre",get options(){return n()?.Cajas||[]},placeholder:"",required:!0,onChange:o=>{}}),t),i(a,s(g,{label:"Fecha Inicio",css:"w-045x",save:"fechaInicio",get saveOn(){return r()}}),t),i(a,s(g,{label:"Fecha Fin",css:"w-045x",save:"fechaFin",get saveOn(){return r()}}),t),t.$$click=o=>{o.stopPropagation(),w()},T.$$keyup=o=>{o.stopPropagation(),N(()=>{x((o.target.value||"").toLowerCase().trim())},150)},e})(),s(E,{get data(){return C()},css:"w100",tableCss:"w-page-t w100",maxHeight:"calc(100vh - 8rem - 12px)",makeFilter:e=>[l.get(e.Tipo)?.name||"",e.Usuario?.usuario].join(" "),get filterText(){return j()},columns:[{header:"Fecha Hora",getValue:e=>V(e.Created,"d-M h:n")},{header:"Tipo Mov.",getValue:e=>l.get(e.Tipo)?.name||""},{header:"Monto",css:"ff-mono t-r",render:e=>(()=>{var a=Q();return i(a,()=>u(e.Monto/100,2)),I(()=>D(a,e.Monto<0?"c-red":"")),a})()},{header:"Saldo Final",css:"ff-mono t-r",getValue:e=>u(e.SaldoFinal/100,2)},{header:"Nº Documento",getValue:e=>""},{header:"Usuario",css:"t-c",getValue:e=>e.Usuario?.usuario||""}]})]}})}y(["click","keyup"]);export{J as default};
