import"../chunks/DsnmJJEf.js";import{p as K,e as N,g as Q,d as W,f as M,a as X,c as p,s as o,h as i,r as v,i as s,b as V,u}from"../chunks/CaHRSXkO.js";import{d as Z}from"../chunks/EZdBy8tr.js";import{I as d}from"../chunks/C7ON8eMg.js";import{M as ee}from"../chunks/Cy8QULqO.js";import{P as se}from"../chunks/DJR_f_3I.js";import{S as re}from"../chunks/D77QhMHQ.js";import{V as ae}from"../chunks/4If3JN7J.js";import{t as te,N as _,n as k}from"../chunks/DP6SISrU.js";import{C as L,c as oe}from"../chunks/6ShiOQ4x.js";import{f as ie}from"../chunks/Qs3Znu_W.js";import{U as le,P as ne,p as de}from"../chunks/CSxnijyA.js";var ue=M('<div class="grid grid-cols-24 gap-10 p-6"><!> <!> <!> <!> <!> <!> <!> <!> <!></div>'),ce=M('<div class="h-full"><div class="flex items-center justify-between mb-6"><div class="i-search mr-16 w-256"><div><i class="icon-search"></i></div> <input class="w-full" autocomplete="off" type="text"/></div> <div class="flex items-center"><button class="bx-green" aria-label="Agregar usuario"><i class="icon-plus"></i></button></div></div> <!></div> <!>',1);function ye(q,z){K(z,!0);const m=new le,D=new ne;let C=N(""),e=N(Q({}));async function O(a){const r=s(e);if((r.usuario?.length||0)<4||(r.nombres?.length||0)<4){_.failure("El usuario y el nombre deben tener al menos 4 caracteres.");return}if(r.password1&&(r.password1=r.password1.trim()),r.password2&&(r.password2=r.password2.trim()),!r.id||r.password1){let l="";if((r.password1?.length||0)<6?l="El password tiene menos de 6 caracteres.":r.password1!==r.password2&&(l="Los password no coinciden."),l){_.failure(l);return}}k.Loading.standard("Creando/Actualizando Usuario...");try{const l=await de(r);a?m.removeUsuario(r.id):(r.id||(r.id=l.id),m.updateUsuario(r)),oe(1)}catch(l){_.failure(l)}k.Loading.remove()}const T=[{header:"ID",headerCss:"w-54",cellCss:"text-center ff-bold",getValue:a=>a.id},{header:"Usuario",highlight:!0,cellCss:"px-6 c-purple",getValue:a=>a.usuario},{header:"Nombres",highlight:!0,getValue:a=>`${a.nombres} ${a.apellidos||""}`},{header:"Email",cellCss:"px-6",getValue:a=>a.email},{header:"Estado",headerCss:"w-80",cellCss:"text-center",getValue:a=>a.ss},{header:"Actualizado",headerCss:"w-144",cellCss:"px-6 nowrap",getValue:a=>ie(a.upd,"Y-m-d h:n")},{header:"...",headerCss:"w-42",cellCss:"t-c",id:"actions",buttonEditHandler:a=>{i(e,{...a},!0),L.openModal(1)}}];se(q,{title:"Usuarios",children:(a,r)=>{var l=ce(),g=X(l),f=p(g),h=p(f),F=o(p(h),2);F.__keyup=n=>{n.stopPropagation(),te(()=>{i(C,(n.target.value||"").toLowerCase().trim(),!0)},150)},v(h);var $=o(h,2),R=p($);R.__click=n=>{n.stopPropagation(),i(e,{ss:1},!0),L.openModal(1)},v($),v(f);var j=o(f,2);ae(j,{get columns(){return T},get data(){return m.usuarios},css:"w-full",maxHeight:"calc(80vh - 13rem)",get filterText(){return s(C)},getFilterContent:n=>[n.usuario,n.nombres,n.apellidos,n.email].filter(w=>w).join(" ").toLowerCase()}),v(g);var H=o(g,2);{let n=u(()=>(s(e)?.id>0?"Actualizar":"Guardar")+" Usuario"),w=u(()=>s(e)?.id>0),B=u(()=>s(e)?.id>0?()=>O(!0):void 0);ee(H,{id:1,size:5,get title(){return s(n)},get isEdit(){return s(w)},onSave:()=>O(),get onDelete(){return s(B)},children:(G,pe)=>{var b=ue(),x=p(b);{let t=u(()=>s(e)?.id>0);d(x,{save:"usuario",css:"col-span-12",label:"Usuario",required:!0,get disabled(){return s(t)},get saveOn(){return s(e)},set saveOn(c){i(e,c,!0)}})}var y=o(x,2);d(y,{save:"nombres",css:"col-span-12",label:"Nombres",required:!0,get saveOn(){return s(e)},set saveOn(t){i(e,t,!0)}});var P=o(y,2);d(P,{save:"apellidos",css:"col-span-12",label:"Apellidos",get saveOn(){return s(e)},set saveOn(t){i(e,t,!0)}});var U=o(P,2);d(U,{save:"documentoNro",css:"col-span-12",label:"NÂº Documento",get saveOn(){return s(e)},set saveOn(t){i(e,t,!0)}});var E=o(U,2);d(E,{save:"cargo",css:"col-span-12",label:"Cargo",get saveOn(){return s(e)},set saveOn(t){i(e,t,!0)}});var S=o(E,2);d(S,{save:"email",css:"col-span-12",label:"Email",get saveOn(){return s(e)},set saveOn(t){i(e,t,!0)}});var A=o(S,2);re(A,{save:"perfilesIDs",css:"col-span-24",get options(){return D.perfiles},keyId:"id",keyName:"nombre",label:"PERFILES ::",get saveOn(){return s(e)},set saveOn(t){i(e,t,!0)}});var I=o(A,2);{let t=u(()=>!s(e).id),c=u(()=>s(e).id>0?"SIN CAMBIAR":"");d(I,{save:"password1",css:"col-span-12",label:"Password",type:"password",get required(){return s(t)},get placeholder(){return s(c)},get saveOn(){return s(e)},set saveOn(J){i(e,J,!0)}})}var Y=o(I,2);{let t=u(()=>!s(e).id);d(Y,{save:"password2",css:"col-span-12",label:"Password (Repetir)",type:"password",get required(){return s(t)},get saveOn(){return s(e)},set saveOn(c){i(e,c,!0)}})}v(b),V(G,b)},$$slots:{default:!0}})}V(a,l)},$$slots:{default:!0}}),W()}Z(["keyup","click"]);export{ye as component};
