import"./DsnmJJEf.js";import{A as ae,aI as ie,aJ as re,aK as ne,x as S,aq as le,F as _e,h as J,a6 as se,aL as ue,p as ve,a2 as W,at as fe,g as de,k as m,f as C,t as V,b as y,c as ce,s as h,d as M,a3 as w,r as E,au as oe,a as j,aM as be,av as me}from"./CoEcz8eb.js";import{s as z}from"./C1K6KTtW.js";import{i as N}from"./CZCr84qS.js";import{h as G}from"./DPaJEl9x.js";import{s as c,c as x,b as O,r as he}from"./BxqDrd8s.js";import{d as ge,e as H}from"./CIpRkWH_.js";import{p as we}from"./B7OHwWN5.js";const ye=[];function xe(e,t=!1,n=!1){return p(e,new Map,"",ye,null,n)}function p(e,t,n,f,s=null,r=!1){if(typeof e=="object"&&e!==null){var d=t.get(e);if(d!==void 0)return d;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(ae(e)){var _=Array(e.length);t.set(e,_),s!==null&&t.set(s,_);for(var v=0;v<e.length;v+=1){var b=e[v];v in e&&(_[v]=p(b,t,n,f,null,r))}return _}if(ie(e)===re){_={},t.set(e,_),s!==null&&t.set(s,_);for(var k in e)_[k]=p(e[k],t,n,f,null,r);return _}if(e instanceof Date)return structuredClone(e);if(typeof e.toJSON=="function"&&!r)return p(e.toJSON(),t,n,f,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch{return e}}function Q(e,t,n=t){var f=new WeakSet;ne(e,"input",async s=>{var r=s?e.defaultValue:e.value;if(r=q(e)?A(r):r,n(r),S!==null&&f.add(S),await le(),r!==(r=t())){var d=e.selectionStart,_=e.selectionEnd,v=e.value.length;if(e.value=r??"",_!==null){var b=e.value.length;d===_&&_===v&&b>v?(e.selectionStart=b,e.selectionEnd=b):(e.selectionStart=d,e.selectionEnd=Math.min(_,b))}}}),(_e&&e.defaultValue!==e.value||J(t)==null&&e.value)&&(n(q(e)?A(e.value):e.value),S!==null&&f.add(S)),se(()=>{var s=t();if(e===document.activeElement){var r=ue??S;if(f.has(r))return}q(e)&&s===A(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function q(e){var t=e.type;return t==="number"||t==="range"}function A(e){return e===""?null:+e}const ke="_input_1w6ug_1",Se="_input_lab_1w6ug_17",Ve="_input_div_1w6ug_29",Ce="_input_div_1_1w6ug_46",Ie="_input_inp_1w6ug_64",Me="_input_lab_cell_left_1w6ug_85",Ee="_input_lab_cell_right_1w6ug_86",Ne="_input_shadow_layer_1w6ug_127",Oe="_input_post_value_1w6ug_301",o={input:ke,input_lab:Se,input_div:Ve,input_div_1:Ce,input_inp:Ie,input_lab_cell_left:Me,input_lab_cell_right:Ee,input_shadow_layer:Ne,input_post_value:Oe};var pe=C("<div><div></div></div> <div> <!></div> <div><div></div></div>",1),De=C("<textarea></textarea>"),qe=C("<input/>"),Ae=C("<div> </div>"),Je=C("<div><!> <div><div></div></div> <div><div><div></div></div> <!> <!> <!></div></div>");function ze(e,t){ve(t,!0);const n=we(t,"saveOn",7),f=t.baseDecimals?10**t.baseDecimals:0,s=()=>{if(!t.required||t.disabled)return 0;if(!n()||!t.save)return 1;const i=n()[t.save];let a=!t.required;return t.validator?a=t.validator(i):(i||i===0)&&(a=!0),a?2:1};let r=W(""),d=W(fe(s())),_=0;const v=(i,a)=>{i.stopPropagation();let u=i.target.value;if(t.type==="number"){if(!a&&!u&&i.key==="-")return;isNaN(u)?u=void 0:u=parseFloat(u)}t.transform&&a&&(u=t.transform(u)),J(()=>{if(n()&&t.save){let g=u;f&&typeof g=="number"&&(g=Math.round(g*f)),n()[t.save]=g,w(d,s(),!0)}}),w(r,u,!0)},b=()=>{if(m(d)){if(m(d)===2)return'<i class="v-icon icon-ok c-green"></i>';if(m(d)===1)return'<i class="v-icon icon-attention c-red"></i>'}else return null;return null};let k;de(()=>{!n()||!t.save||k!==n()&&(k=n(),n()[t.save]!==m(r)&&J(()=>{const i=n()[t.save];w(r,typeof i=="number"?i:i||"",!0),f&&typeof m(r)=="number"&&w(r,m(r)/f),w(d,s(),!0)}))});let F=oe(()=>`${o.input} p-rel`+(t.css?" "+t.css:""));var I=Je(),K=M(I);{var R=i=>{var a=pe(),l=j(a),u=h(l,2),g=M(u,!0),ee=h(g);G(ee,()=>b()||""),E(u);var te=h(u,2);V(()=>{c(l,1,x(o.input_lab_cell_left)),c(u,1,x(o.input_lab)),z(g,t.label),c(te,1,x(o.input_lab_cell_right))}),y(i,a)};N(K,i=>{t.label&&i(R)})}var T=h(K,2),D=h(T,2),L=M(D),P=h(L,2);{var X=i=>{var a=De();be(a),a.__keyup=l=>{v(l)},V(()=>{c(a,1,`w-full ${o.input_inp} ${t.inputCss||""}`),O(a,"placeholder",t.placeholder||""),a.disabled=t.disabled,O(a,"rows",t.rows)}),H("blur",a,l=>{console.log("input saveon:",xe(n())),v(l,!0),t.onChange}),Q(a,()=>m(r),l=>w(r,l)),y(i,a)},Y=i=>{var a=qe();he(a),a.__keyup=l=>{v(l)},V(()=>{c(a,1,`w-full ${o.input_inp} ${(t.inputCss||"")??""}`),O(a,"type",t.type||"text"),O(a,"placeholder",t.placeholder||""),a.disabled=t.disabled}),H("blur",a,l=>{v(l,!0),t.onChange}),Q(a,()=>m(r),l=>w(r,l)),y(i,a)};N(P,i=>{t.useTextArea?i(X):i(Y,!1)})}var U=h(P,2);{var Z=i=>{var a=me(),l=j(a);G(l,()=>b()||""),y(i,a)};N(U,i=>{t.label||i(Z)})}var B=h(U,2);{var $=i=>{var a=Ae(),l=M(a,!0);E(a),V(()=>{c(a,1,o.input_post_value),z(l,t.postValue)}),y(i,a)};N(B,i=>{t.postValue&&i($)})}E(D),E(I),V(()=>{c(I,1,x(m(F))),c(T,1,x(o.input_shadow_layer)),c(D,1,`${o.input_div} flex w-full`),c(L,1,x(o.input_div_1))}),y(e,I),ce()}ge(["keyup"]);export{ze as I,xe as a,Q as b,o as s};
