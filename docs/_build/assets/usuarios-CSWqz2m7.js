import{a as v,c as t,d as _,i,t as b}from"./web-D7Y7EE6c.js";import{t as O,f as U,I as o,g as A,P as I,N as p,L as g}from"./app-DUJ9K0SH.js";import{s as f,M as S}from"./Modals-CKgl12JL.js";import{Q as k}from"./QTable-CvEM_gjE.js";import{a as E,b as N,e as V,h as L}from"./empresas-BPLc5_U6.js";var q=b('<div class=h100><div class="flex ai-center jc-between mb-06"><div class="search-c4 mr-16 w16rem"><div><i class=icon-search></i></div><input class=w100 autocomplete=off type=text></div><div class="flex ai-center"><button class="bn1 b-green"><i class=icon-plus>'),D=b('<div class="flex-wrap ai-start w100-10">'),M=b('<button class="bnr2 b-blue b-card-1"><i class=icon-pencil>');function G(){E();const[d,C]=N(),[x]=V(),[T,$]=v(""),[r,h]=v({}),w=async a=>{const e=r();if((e.usuario?.length||0)<4||(e.nombres?.length||0)<4){p.failure("El usuario y el nombre deben tener al menos 4 caracteres.");return}if(e.password1&&(e.password1=e.password1.trim()),e.password2&&(e.password2=e.password2.trim()),!e.id||e.password1){let l="";if((e.password1.length||0)<6?l="El password tiene menos de 6 caracteres.":e.password1!==e.password2&&(l="Los password no coinciden."),l){p.failure(l);return}}g.standard("Creando /Actualizando Usuario...");try{var c=await L(e)}catch(l){p.failure(l),g.remove();return}let n=[...d().usuarios];if(e.id){const l=d().usuarios.find(u=>u.id===e.id);l&&Object.assign(l,e),a&&(n=n.filter(u=>u.id!==e.id))}else e.id=c.id,n.unshift(e);g.remove(),C({...d(),usuarios:n}),f([])};return t(I,{title:"Usuarios",fetchLoading:!0,get children(){return[(()=>{var a=q(),e=a.firstChild,c=e.firstChild,n=c.firstChild,l=n.nextSibling,u=c.nextSibling,y=u.firstChild;return l.$$keyup=s=>{s.stopPropagation(),O(()=>{$((s.target.value||"").toLowerCase().trim())},150)},y.$$click=s=>{s.stopPropagation(),h({ss:1}),f([1])},i(a,t(k,{get data(){return d()?.usuarios||[]},css:"w100",maxHeight:"calc(80vh - 13rem)",style:{height:"100%"},columns:[{header:"ID",headerStyle:{width:"3.4rem"},css:"c",getValue:s=>s.id},{header:"Usuario",cardCss:"h3 ff-bold c-purple",getValue:s=>s.usuario,cardColumn:[1,1]},{header:"Nombres",cardColumn:[2,1],getValue:s=>s.nombres+" "+s.apellidos},{header:"Email",cardColumn:[3,1],cardCss:"h5 c-steel",getValue:s=>s.email},{header:"Estado",cardColumn:[3,2],getValue:s=>s.ss,cardCss:"h5 c-steel"},{header:"Actualizado",headerStyle:{width:"9rem"},css:"nowrap",getValue:s=>U(s.upd,"Y-m-d h:n")},{header:"...",headerStyle:{width:"2.6rem"},css:"t-c",cardColumn:[1,2],render:(s,z)=>{const P=m=>{m.stopPropagation(),f([1]),h({...s})};return(()=>{var m=M();return m.$$click=P,m})()}}]}),null),a})(),t(S,{id:1,css:"w56-78 in-s2",get title(){return(r()?.id>0?"Actualizar":"Guardar")+" Usuario"},onSave:()=>{console.log("usuario a guardar::",r()),w()},onDelete:()=>{w(!0)},get children(){var a=D();return i(a,t(o,{get saveOn(){return r()},save:"usuario",css:"w-12x mb-10",label:"Usuario",required:!0,get disabled(){return r()?.id>0}}),null),i(a,t(o,{get saveOn(){return r()},save:"nombres",css:"w-12x mb-10",label:"Nombres",required:!0}),null),i(a,t(o,{get saveOn(){return r()},save:"apellidos",css:"w-12x mb-10",label:"Apellidos"}),null),i(a,t(o,{get saveOn(){return r()},save:"documentoNro",css:"w-12x mb-10",label:"NÂº Documento"}),null),i(a,t(o,{get saveOn(){return r()},save:"cargo",css:"w-12x mb-10",label:"Cargo"}),null),i(a,t(o,{get saveOn(){return r()},save:"email",css:"w-12x mb-10",label:"Email"}),null),i(a,t(A,{get saveOn(){return r()},save:"perfilesIDs",css:"w100 mb-10 ai-start",label:"",placeholder:"Perfiles",get options(){return x().perfiles},keys:"id.nombre",inputCss:"w-07x"}),null),i(a,t(o,{get saveOn(){return r()},save:"password1",css:"w-12x mb-10",label:"Password",type:"password",get required(){return!r().id},get placeholder(){return r().id>0?"SIN CAMBIAR":""}}),null),i(a,t(o,{get saveOn(){return r()},save:"password2",get required(){return!r().id},css:"w-12x mb-10",label:"Password (Repetir)",type:"password"}),null),a}})]}})}_(["keyup","click"]);export{G as default};
