import"../chunks/DsnmJJEf.js";import{e as G,g as q,i as o,h as x,p as F,d as J,f as w,c as r,s as u,az as K,r as t,u as Q,b as h,a as X,t as Z}from"../chunks/Bf0lWsRu.js";import{s as P}from"../chunks/WwA8pLij.js";import{i as ee}from"../chunks/D7jGWfSg.js";import{d as ae}from"../chunks/Cu2BEfFs.js";import{P as re}from"../chunks/Cjl-14FK.js";import{V as te}from"../chunks/9nVZToYO.js";import{C as R,f as E}from"../chunks/B0A7VF9y.js";import{G as se,P as L,f as $,E as oe,g as ie}from"../chunks/CUNP7WoD.js";import{n as f}from"../chunks/DP6SISrU.js";class le extends se{route="backups";useCache={min:0,ver:1};keyID="Name";#e=G(q([]));get backups(){return o(this.#e)}set backups(n){x(this.#e,n,!0)}handler(n){n.sort((v,a)=>v.Name>a.Name?1:-1),this.backups=n||[]}constructor(){super(),this.fetch()}refreshBackups(){this.fetch()}}const ce=()=>L({data:{},route:"backup-create",successMessage:"Backup generado exitosamente",errorMessage:"Error al generar el backup"}),ue=m=>L({data:{Name:m},route:"backup-restore",successMessage:"Backup restaurado exitosamente",errorMessage:"Error al restaurar el backup"});var ne=w('<div class="w-full c-red ff-bold flex-wrap box-error-ms mt-16">Seleccione un Backup</div>'),de=w('<div class="flex w-full justify-between"><div><div class="w-full flex-wrap ff-semibold"> </div> <div class="text-gray-600 mt-4"> </div></div> <button class="bx-purple" aria-label="Descargar backup"><i class="icon-download"></i></button></div> <div class="flex justify-center w-full mt-16"><button class="bx-blue">Restaurar <i class="icon-database"></i></button></div>',1),pe=w('<div class="w-full grid gap-20" style="grid-template-columns: 4fr 3fr;"><div><div class="flex items-center justify-between mb-6"><div class="h2 ff-bold">Backups</div> <div class="flex items-center"><button class="bx-green mr-8" aria-label="Generar backup"><i class="icon-plus"></i></button> <button class="bx-blue" aria-label="Subir backup"><i class="icon-upload"></i></button></div></div> <!></div> <div style="margin-left: 20px;"><div class="mb-6 h2 ff-bold">Restore</div> <div class="_1 w-full rounded-[8px] min-h-160 py-12 px-16 page_1iwwhm7"><!></div></div></div>');function Ne(m,n){F(n,!0);const v=new le;let a=G(null);const M=async()=>{f.Loading.standard("Generando Backup...");try{await ce(),v.refreshBackups()}catch{}f.Loading.remove()},V=async e=>{f.Loading.standard("Restaurando Backup...");try{await ue(e),await ie(26,{})}catch{}f.Loading.remove()},j=e=>{const b=["backups",1,e.Name].join("/"),d=oe.S3_URL+b;console.log("url to download::",d);const i=document.createElement("a");i.setAttribute("download",e.Name),i.href=d,i.setAttribute("target","_blank"),i.click(),i.remove()},z=[{header:"Created",headerCss:"w-176",cellCss:"px-6 nowrap",getValue:e=>E(e.upd,"Y-m-d h:n")},{header:"Nombre",highlight:!0,cellCss:"px-6",getValue:e=>e.Name},{header:"Tamaño",headerCss:"w-120",cellCss:"text-center",getValue:e=>`${$(e.Size/1e3/1e3,2)} mb`}];re(m,{title:"Backups & Restore",children:(e,b)=>{var d=pe(),i=r(d),g=r(i),N=u(r(g),2),T=r(N);T.__click=s=>{s.stopPropagation(),R("Generar Backup","¿Desea generar el backup ahora?","SI","NO",()=>{M()})},K(2),t(N),t(g);var A=u(g,2);{let s=Q(()=>o(a)||void 0);te(A,{get data(){return v.backups},get columns(){return z},css:"selectable w-full",tableCss:"cursor-pointer",maxHeight:"calc(80vh - 13rem)",get selected(){return o(s)},isSelected:(l,c)=>!c||typeof c=="number"?!1:l.Name===c.Name,onRowClick:l=>{o(a)?.Name===l.Name?x(a,null):x(a,l,!0)}})}t(i);var B=u(i,2),y=u(r(B),2),D=r(y);{var I=s=>{var l=ne();h(s,l)},O=s=>{var l=de(),c=X(l),k=r(c),_=r(k),H=r(_,!0);t(_);var S=u(_,2),Y=r(S);t(S),t(k);var U=u(k,2);U.__click=p=>{p.stopPropagation(),j(o(a))},t(c);var C=u(c,2),W=r(C);W.__click=p=>{p.stopPropagation(),R("Restaurar Backup",`Restaurar el backup realizado el ${E(o(a).upd,"Y-m-d h:n")}`,"SI","NO",()=>{V(o(a).Name)})},t(C),Z(p=>{P(H,o(a).Name),P(Y,`${p??""} mb`)},[()=>$(o(a).Size/1e3/1e3,2)]),h(s,l)};ee(D,s=>{o(a)?s(O,!1):s(I)})}t(y),t(B),t(d),h(e,d)},$$slots:{default:!0}}),J()}ae(["click"]);export{Ne as component};
