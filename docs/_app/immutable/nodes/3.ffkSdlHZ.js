import"../chunks/DsnmJJEf.js";import{e as G,g as q,i as o,h,p as F,d as J,f as x,c as a,s as u,av as K,r,u as Q,b as _,a as X,t as Z}from"../chunks/DsnVzSLI.js";import{s as P}from"../chunks/00GtM8hT.js";import{i as ee}from"../chunks/tZVUs-sg.js";import{d as ae}from"../chunks/BzG9rrjb.js";import{P as re}from"../chunks/DQXXBHmb.js";import{V as te}from"../chunks/lFulS-eH.js";import{C as R,f as E}from"../chunks/CAaV5v2W.js";import{G as se,P as L,f as $,E as oe}from"../chunks/Bz9XdVJx.js";import{n as m}from"../chunks/DP6SISrU.js";class ie extends se{route="backups";useCache={min:0,ver:1};keyID="Name";#e=G(q([]));get backups(){return o(this.#e)}set backups(d){h(this.#e,d,!0)}handler(d){this.backups=d||[]}constructor(){super(),this.fetch()}refreshBackups(){this.fetch()}}const le=()=>L({data:{},route:"backup-create",successMessage:"Backup generado exitosamente",errorMessage:"Error al generar el backup"}),ce=v=>L({data:{Name:v},route:"backup-restore",successMessage:"Backup restaurado exitosamente",errorMessage:"Error al restaurar el backup"});var ue=x('<div class="w-full c-red ff-bold flex-wrap box-error-ms mt-16">Seleccione un Backup</div>'),ne=x('<div class="flex w-full justify-between"><div><div class="w-full flex-wrap ff-semibold"> </div> <div class="text-gray-600 mt-4"> </div></div> <button class="bx-purple" aria-label="Descargar backup"><i class="icon-download"></i></button></div> <div class="flex justify-center w-full mt-16"><button class="bx-blue">Restaurar <i class="icon-database"></i></button></div>',1),de=x('<div class="w-full grid gap-20" style="grid-template-columns: 4fr 3fr;"><div><div class="flex items-center justify-between mb-6"><div class="h2 ff-bold">Backups</div> <div class="flex items-center"><button class="bx-green mr-8" aria-label="Generar backup"><i class="icon-plus"></i></button> <button class="bx-blue" aria-label="Subir backup"><i class="icon-upload"></i></button></div></div> <!></div> <div style="margin-left: 20px;"><div class="mb-6 h2 ff-bold">Restore</div> <div class="_1 w-full rounded-[8px] min-h-160 py-12 px-16 svelte-1eupo6o"><!></div></div></div>');function we(v,d){F(d,!0);const w=new ie;let t=G(null);const V=async()=>{m.Loading.standard("Generando Backup...");try{await le(),w.refreshBackups()}catch{}m.Loading.remove()},j=async e=>{m.Loading.standard("Restaurando Backup...");try{await ce(e)}catch{}m.Loading.remove()},M=e=>{const f=["backups",1,e.Name].join("/"),n=oe.S3_URL+f;console.log("url to download::",n);const i=document.createElement("a");i.setAttribute("download",e.Name),i.href=n,i.setAttribute("target","_blank"),i.click(),i.remove()},T=[{header:"Created",headerCss:"w-176",cellCss:"px-6 nowrap",getValue:e=>E(e.upd,"Y-m-d h:n")},{header:"Nombre",highlight:!0,cellCss:"px-6",getValue:e=>e.Name},{header:"Tamaño",headerCss:"w-120",cellCss:"text-center",getValue:e=>`${$(e.Size/1e3/1e3,2)} mb`}];re(v,{title:"Backups & Restore",children:(e,f)=>{var n=de(),i=a(n),b=a(i),B=u(a(b),2),z=a(B);z.__click=s=>{s.stopPropagation(),R("Generar Backup","¿Desea generar el backup ahora?","SI","NO",()=>{V()})},K(2),r(B),r(b);var A=u(b,2);{let s=Q(()=>o(t)||void 0);te(A,{get data(){return w.backups},get columns(){return T},css:"selectable w-full",tableCss:"cursor-pointer",maxHeight:"calc(80vh - 13rem)",get selected(){return o(s)},isSelected:(l,c)=>!c||typeof c=="number"?!1:l.Name===c.Name,onRowClick:l=>{o(t)?.Name===l.Name?h(t,null):h(t,l,!0)}})}r(i);var y=u(i,2),N=u(a(y),2),D=a(N);{var I=s=>{var l=ue();_(s,l)},O=s=>{var l=ne(),c=X(l),k=a(c),g=a(k),H=a(g,!0);r(g);var S=u(g,2),Y=a(S);r(S),r(k);var U=u(k,2);U.__click=p=>{p.stopPropagation(),M(o(t))},r(c);var C=u(c,2),W=a(C);W.__click=p=>{p.stopPropagation(),R("Restaurar Backup",`Restaurar el backup realizado el ${E(o(t).upd,"Y-m-d h:n")}`,"SI","NO",()=>{j(o(t).Name)})},r(C),Z(p=>{P(H,o(t).Name),P(Y,`${p??""} mb`)},[()=>$(o(t).Size/1e3/1e3,2)]),_(s,l)};ee(D,s=>{o(t)?s(O,!1):s(I)})}r(N),r(y),r(n),_(e,n)},$$slots:{default:!0}}),J()}ae(["click"]);export{we as component};
