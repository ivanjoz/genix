import"./DsnmJJEf.js";import{a6 as ve,aK as de,aL as ue,aM as Z,R as w,at as ce,y as B,m as q,a9 as p,aN as oe,p as _e,e as z,g as me,l as G,i as c,f as S,c as N,s as g,r as O,t as x,b as k,d as be,h,a as H,aO as he,x as ge,u as ye}from"./CaHRSXkO.js";import{s as Q}from"./CrFq4NBa.js";import{i as M}from"./BLuAT40e.js";import{h as X}from"./CwQGQ51v.js";import{s as m,c as C,b as E,r as ke}from"./ZZ_SO04P.js";import{d as xe,e as K}from"./EZdBy8tr.js";import{p as Ce}from"./DdsaxoiY.js";import{s as b}from"./BMRmn4k7.js";const Se=[];function Ve(e,a=!1,n=!1){return D(e,new Map,"",Se,null,n)}function D(e,a,n,s,v=null,i=!1){if(typeof e=="object"&&e!==null){var o=a.get(e);if(o!==void 0)return o;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(ve(e)){var f=Array(e.length);a.set(e,f),v!==null&&a.set(v,f);for(var u=0;u<e.length;u+=1){var _=e[u];u in e&&(f[u]=D(_,a,n,s,null,i))}return f}if(de(e)===ue){f={},a.set(e,f),v!==null&&a.set(v,f);for(var V in e)f[V]=D(e[V],a,n,s,null,i);return f}if(e instanceof Date)return structuredClone(e);if(typeof e.toJSON=="function"&&!i)return D(e.toJSON(),a,n,s,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch{return e}}function Y(e,a,n=a){var s=new WeakSet;Z(e,"input",async v=>{var i=v?e.defaultValue:e.value;if(i=T(e)?F(i):i,n(i),w!==null&&s.add(w),await ce(),i!==(i=a())){var o=e.selectionStart,f=e.selectionEnd,u=e.value.length;if(e.value=i??"",f!==null){var _=e.value.length;o===f&&f===u&&_>u?(e.selectionStart=_,e.selectionEnd=_):(e.selectionStart=o,e.selectionEnd=Math.min(f,_))}}}),(B&&e.defaultValue!==e.value||q(a)==null&&e.value)&&(n(T(e)?F(e.value):e.value),w!==null&&s.add(w)),p(()=>{var v=a();if(e===document.activeElement){var i=oe??w;if(s.has(i))return}T(e)&&v===F(e.value)||e.type==="date"&&!v&&!e.value||v!==e.value&&(e.value=v??"")})}function Re(e,a,n=a){Z(e,"change",s=>{var v=s?e.defaultChecked:e.checked;n(v)}),(B&&e.defaultChecked!==e.checked||q(a)==null)&&n(e.checked),p(()=>{var s=a();e.checked=!!s})}function T(e){var a=e.type;return a==="number"||a==="range"}function F(e){return e===""?null:+e}var we=S("<div><div></div></div> <div> <!></div> <div><div></div></div> <div><div></div></div>",1),Me=S("<div><div></div></div>"),Ie=S("<textarea></textarea>"),Ne=S("<input/>"),Oe=S("<div> </div>"),Ee=S("<div><!> <div><!> <!> <!> <!></div></div>");function Ue(e,a){_e(a,!0);const n=Ce(a,"saveOn",15),s=a.baseDecimals?10**a.baseDecimals:0,v=()=>{if(!a.required||a.disabled)return 0;if(!n()||!a.save)return 1;const r=n()[a.save];let t=!a.required;return a.validator?t=a.validator(r):(r||r===0)&&(t=!0),t?2:1};let i=z(""),o=z(me(v())),f=0,u=null;const _=(r,t)=>{r.stopPropagation();let d=r.target.value;if(a.type==="number"){if(!t&&!d&&r.key==="-")return;isNaN(d)?d=void 0:d=parseFloat(d)}if(t&&a.validator&&!a.validator(d)){h(i,u,!0),n()&&a.save&&(s&&typeof c(i)=="number"&&h(i,Math.round(c(i)*s),!0),n(n()[a.save]=c(i),!0));return}a.transform&&t&&(d=a.transform(d)),q(()=>{if(n()&&a.save){let y=d;s&&typeof y=="number"&&(y=Math.round(y*s)),n(n()[a.save]=y,!0),h(o,v(),!0)}}),t||(f=1),h(i,d,!0)},V=()=>{if(c(o)){if(c(o)===2)return'<i class="v-icon icon-ok c-green"></i>';if(c(o)===1)return'<i class="v-icon icon-attention c-red"></i>'}else return null;return null};let A;const L=()=>{q(()=>{const r=n()[a.save];h(i,typeof r=="number"?r:r||"",!0),s&&typeof c(i)=="number"&&h(i,c(i)/s),h(o,v(),!0)})};G(()=>{!n()||!a.save||A!==n()&&(A=n(),n()[a.save]!==c(i)&&L())}),G(()=>{a.dependencyValue&&L()});let $=ye(()=>`${b.input} p-rel${a.css?` ${a.css}`:""}${a.label?"":" no-label"}`);var I=Ee(),P=N(I);{var ee=r=>{var t=we(),l=H(t),d=g(l,2),y=N(d,!0),fe=g(y);X(fe,()=>V()||""),O(d);var j=g(d,2),se=g(j,2);x(()=>{m(l,1,C(b.input_lab_cell_left)),m(d,1,C(b.input_lab)),Q(y,a.label),m(j,1,C(b.input_lab_cell_right)),m(se,1,C(b.input_shadow_layer))}),k(r,t)};M(P,r=>{a.label&&r(ee)})}var J=g(P,2),R=N(J);{var ae=r=>{var t=Me();x(()=>m(t,1,C(b.input_div_1))),k(r,t)};M(R,r=>{a.label&&r(ae)})}var U=g(R,2);{var te=r=>{var t=Ie();he(t),t.__keyup=l=>{_(l)},x(()=>{m(t,1,`w-full ${b.input_inp} ${a.inputCss||""}`),E(t,"placeholder",a.placeholder||""),t.disabled=a.disabled,E(t,"rows",a.rows)}),K("blur",t,l=>{console.log("input saveon:",Ve(n())),_(l,!0),a.onChange&&f&&(a.onChange(),f=0)}),Y(t,()=>c(i),l=>h(i,l)),k(r,t)},re=r=>{var t=Ne();ke(t),t.__keyup=l=>{_(l)},x(()=>{m(t,1,`w-full ${b.input_inp} ${(a.inputCss||"")??""}`),E(t,"type",a.type||"search"),E(t,"placeholder",a.placeholder||""),t.disabled=a.disabled}),K("focus",t,l=>{u=l.target.value}),K("blur",t,l=>{_(l,!0),a.onChange&&f&&(a.onChange(),f=0),u=null}),Y(t,()=>c(i),l=>h(i,l)),k(r,t)};M(U,r=>{a.useTextArea?r(te):r(re,!1)})}var W=g(U,2);{var ie=r=>{var t=ge(),l=H(t);X(l,()=>V()||""),k(r,t)};M(W,r=>{a.label||r(ie)})}var ne=g(W,2);{var le=r=>{var t=Oe(),l=N(t,!0);O(t),x(()=>{m(t,1,b.input_post_value),Q(l,a.postValue)}),k(r,t)};M(ne,r=>{a.postValue&&r(le)})}O(J),O(I),x(()=>{m(I,1,C(c($))),m(J,1,`${b.input_div} flex w-full`)}),k(e,I),be()}xe(["keyup"]);export{Ue as I,Re as b,Ve as s};
