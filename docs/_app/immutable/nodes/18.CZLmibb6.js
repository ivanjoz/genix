import"../chunks/DsnmJJEf.js";import{bl as Cf,b6 as Sf,p as tt,e as Z,g as Ze,l as Lt,i as g,u as W,h as P,f as Y,c as j,r as G,t as se,b as K,d as rt,a as Me,s as B,x as zt,bm as fr,av as Ws,at as Tf,m as wf,aw as ko}from"../chunks/CaHRSXkO.js";import{d as jt,e as Qt,s as kf}from"../chunks/EZdBy8tr.js";import{b as _f,s as Ne,I as He}from"../chunks/C7ON8eMg.js";import{i as ue}from"../chunks/BLuAT40e.js";import{e as Dt,i as Ht}from"../chunks/cG-FGtBW.js";import{b as Rt}from"../chunks/D1kHjzM_.js";import{C as Df}from"../chunks/CLBGR4fI.js";import{o as Mf}from"../chunks/B723hspN.js";import{s as ft}from"../chunks/CrFq4NBa.js";import{h as Of}from"../chunks/CwQGQ51v.js";import{s as $e,b as fe,d as yt,r as dt,a as bt,c as Er}from"../chunks/ZZ_SO04P.js";import{p as q}from"../chunks/DdsaxoiY.js";import{l as Lf,m as aa,f as ia,e as gi,c as Rf,i as _o,C as Pn,P as Ff}from"../chunks/DtXTy_F4.js";import{p as Ga,N as ln,L as Mt,C as Do}from"../chunks/C277PxC_.js";import{I as Zn}from"../chunks/BeAlYVvE.js";import{L as Mo}from"../chunks/Dmtk3Aq1.js";import{O as Pf}from"../chunks/CNc0pvaA.js";import{P as Af}from"../chunks/CdY_1qrk.js";import{S as Nf}from"../chunks/DyQiI6_8.js";import{S as Jn}from"../chunks/CVoJ4bp_.js";import{V as Vs}from"../chunks/CfB0PGuL.js";import{t as If}from"../chunks/DP6SISrU.js";import{c as Rr}from"../chunks/COsv-rOU.js";import{s as nr}from"../chunks/BMRmn4k7.js";import{M as js}from"../chunks/CndOcZL7.js";import{p as Oo,a as Bf,P as xf,L as Hf,b as zf}from"../chunks/C9Uo9afc.js";function Lo(t,e){Cf(window,["resize"],()=>Sf(()=>e(window[t])))}const Uf=["#000000","#333333","#666666","#8B0000","#CC0000","#DC143C","#800080","#4B0082","#A020F0","#696969","#483D8B","#B8860B","#000080","#0047AB","#007BFF","#008080","#228B22","#556B2F","#CC5500","#8B4513","#996600","#FF1493","#00CED1","#FF4500"],Gf=["#000000","#333333","#666666","#8B0000","#CC0000","#DC143C","#800080","#4B0082","#A020F0","#696969","#483D8B","#B8860B","#000080","#0047AB","#007BFF","#008080","#228B22","#556B2F","#CC5500","#8B4513","#996600","#FF1493","#00CED1","#FF4500"],Kf=[{id:12,name:"12"},{id:14,name:"14"},{id:16,name:"16"},{id:18,name:"18"},{id:20,name:"20"}],Wf=`<svg width="800px" height="800px" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
  <polygon fill="var(--ci-primary-color, #000000)" points="176 184 208 184 208 136 304 136 304 368 264 368 264 400 408 400 408 368 368 368 368 136 464 136 464 184 496 184 496 104 176 104 176 184" class="ci-primary"/>
  <polygon fill="var(--ci-primary-color, #000000)" points="16 280 48 280 48 248 104 248 104 400 72 400 72 432 184 432 184 400 152 400 152 248 216 248 216 280 248 280 248 216 16 216 16 280" class="ci-primary"/>
</svg>`,Vf='<svg fill="#000000" width="800px" height="800px" viewBox="0 0 14 14" role="img" focusable="false" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"><path d="M 7.5291661,11.795909 C 7.4168129,11.419456 7.3406864,10.225625 7.3406864,9.29222 c 0,-0.11438 -0.029767,-0.221667 -0.081573,-0.314893 0.051933,-0.115773 0.08132,-0.24358 0.08132,-0.378226 l 0,-1.709364 c 0,-0.511733 -0.416226,-0.927959 -0.9279585,-0.927959 l -0.8772919,0 C 5.527203,5.856265 5.52163,5.751005 5.518336,5.648406 5.514666,5.556066 5.513396,5.470313 5.513016,5.385826 5.511876,5.296776 5.5132694,5.224073 5.517196,5.160866 5.524666,5.024193 5.541009,4.891827 5.565076,4.773647 5.591043,4.646981 5.619669,4.564774 5.630689,4.535134 c 0.0019,-0.0052 0.0038,-0.01013 0.00557,-0.01533 0.00709,-0.02039 0.0133,-0.03559 0.017227,-0.04446 C 6.0127121,3.789698 5.750766,2.938499 5.0665137,2.5737 4.8642273,2.466034 4.6367344,2.409034 4.4084814,2.408147 4.1801018,2.409034 3.9526089,2.466037 3.7504492,2.5737 3.066197,2.938499 2.8042508,3.789698 3.1634768,4.475344 c 0.00393,0.0087 0.01026,0.02394 0.017227,0.04446 0.00177,0.0052 0.00367,0.01013 0.00557,0.01533 0.01102,0.02951 0.039647,0.111847 0.065613,0.238513 0.024067,0.11818 0.040533,0.250546 0.04788,0.387219 0.00393,0.06321 0.00532,0.135914 0.00418,0.22496 -5.066e-4,0.08449 -0.00165,0.17024 -0.00532,0.26258 -0.00329,0.102599 -0.00887,0.207859 -0.016847,0.313372 l -0.8772919,0 c -0.5117324,0 -0.9279584,0.416226 -0.9279584,0.927959 l 0,1.709364 c 0,0.134646 0.029387,0.262453 0.08132,0.378226 -0.051807,0.09323 -0.081573,0.200513 -0.081573,0.314893 0,0.933278 -0.076126,2.127236 -0.1884796,2.503689 C 1.0571435,11.985782 1.0131902,12.254315 1.0562568,12.453434 1.1748167,13 1.7477291,13 1.9359554,13 c 0.437506,0 1.226258,-0.07676 1.2595712,-0.08005 0.05092,-0.0051 0.1001932,-0.01596 0.1468065,-0.03179 0.049907,0.01241 0.1018398,0.01913 0.1546597,0.01925 l 0.9114918,0.0044 0.9114918,-0.0044 c 0.05282,-1.27e-4 0.1047532,-0.007 0.1546598,-0.01925 0.046613,0.01583 0.095886,0.02673 0.1468064,0.03179 C 5.6547556,12.92315 6.4436346,13 6.8810138,13 c 0.1882264,0 0.7612654,0 0.8796986,-0.546566 0.043067,-0.199119 -7.6e-4,-0.467652 -0.2315463,-0.657525 z m -1.833117,0.502486 -0.3480794,-1.518478 -0.1741664,1.503658 -1.6846638,-7.6e-4 -0.3680927,-0.885399 0,0.900979 c 0,0 -1.7672504,0.173279 -1.3861111,0 0.3811394,-0.173154 0.3811394,-2.980082 0.3811394,-2.980082 l 2.2924095,0 2.2924095,0 c 0,0 0,2.806928 0.3811394,2.980082 0.381266,0.173279 -1.3859844,0 -1.3859844,0 z M 10.219055,1 7.3387864,1 5.8932688,5.377719 l 0.9449318,0 c 0.3536527,0 0.6674055,0.17138 0.8650052,0.434593 l 0.04864,-0.18392 0.9107318,-2.702555 0.2962729,-0.0016 0.9543051,2.889769 -2.2085564,0 C 7.839499,5.994632 7.9204389,6.217692 7.9204389,6.459878 l 0,1.257038 2.3962751,0 0.423193,1.60917 2.218563,0 L 10.219055,1 Z"/></svg>',jf=`<svg width="800px" height="800px" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
  <title>text-color-solid</title>
  <g id="Layer_2" data-name="Layer 2">
    <g id="invisible_box" data-name="invisible box">
      <rect width="48" height="48" fill="none"/>
    </g>
    <g id="Q3_icons" data-name="Q3 icons">
      <path d="M43,3H5A2,2,0,0,0,3,5V43a2,2,0,0,0,2,2H43a2,2,0,0,0,2-2V5A2,2,0,0,0,43,3ZM33.4,37l-2.6-6H17.2l-2.6,6H10.2L21.5,11h5L37.8,37ZM18.9,27H29.1L24,14.9Z"/>
    </g>
  </g>
</svg>`;var mi=function(t,e){return mi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},mi(t,e)};function Ai(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");mi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var C=function(){return C=Object.assign||function(e){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},C.apply(this,arguments)};function qf(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(r=0)),r;)try{if(n=1,a&&(i=u[0]&2?a.return:u[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,u[1])).done)return i;switch(a=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,a=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(d){u=[6,d],a=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Wt(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function L(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(s){o={error:s}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function I(t,e,r){if(r||arguments.length===2)for(var n=0,a=e.length,i;n<a;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}function Gr(t){var e={blockGroupType:"Document",blocks:[]};return t&&(e.format=t),e}function fn(t){switch(t.blockType){case"Paragraph":return t.segments.length==0;case"Table":return t.rows.every(function(e){return e.cells.length==0});case"BlockGroup":return Ni(t);case"Entity":return!1;default:return!1}}function Ni(t){switch(t.blockGroupType){case"FormatContainer":return t.tagName=="div"?!1:t.blocks.every(fn);case"ListItem":return t.blocks.every(fn);case"Document":case"General":case"TableCell":return!1;default:return!0}}function qs(t,e){var r;switch(t.segmentType){case"Text":return!t.text&&(!e||!(!((r=t.link)===null||r===void 0)&&r.format.name));default:return!1}}function Xf(t){return Jf(t)?Ni(t):Zf(t)?fn(t):Yf(t)?qs(t):!1}function Yf(t){return typeof t.segmentType=="string"}function Zf(t){return typeof t.blockType=="string"}function Jf(t){return typeof t.blockGroupType=="string"}var Xs=["marginRight","marginLeft","paddingRight","paddingLeft"],Ys=["direction","textAlign","htmlAlign"],Ii=Xs.concat(Ys),Qf=["backgroundColor","direction","textAlign","htmlAlign","lineHeight","textIndent","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft"];function Pr(t,e,r,n){var a,i,o;try{for(var s=Wt(r),l=s.next();!l.done;l=s.next()){var u=l.value;e[u]!==void 0&&(Object.assign(t,(o={},o[u]=e[u],o)),n&&delete e[u])}}catch(d){a={error:d}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(a)throw a.error}}}function D(t){t.cachedElement&&delete t.cachedElement,$f(t)?t.rows.forEach(function(r){delete r.cachedElement}):ec(t)&&t.levels.forEach(function(r){return delete r.cachedElement});var e=t;return e}function Bi(t,e){var r=D(t),n=[r,[],[]];return e&&e.forEach(function(a){var i=t.segments.indexOf(a);i>=0&&(n[1].push(r.segments[i]),n[2].push(i))}),n}function vt(t,e,r){var n,a=L(Bi(t,[e]),3),i=a[0],o=a[1],s=a[2],l=o[0]==e?o[0]:null;return r&&l&&r(o[0],i,s[0]),[i,l,(n=s[0])!==null&&n!==void 0?n:-1]}function $f(t){return t.blockType=="Table"}function ec(t){return t.blockGroupType=="ListItem"}function ie(t){return Object.keys(t)}function cr(t,e){if(t==e)return!0;var r=ie(t),n=ie(e);return r.length==n.length&&r.every(function(a){return t[a]==e[a]})}function qt(t){return{segmentType:"Br",format:C({},t)}}var tc=["pre","pre-wrap","break-spaces"];function yn(t){return!!t&&tc.indexOf(t)>=0}var rc=/^[\r\n\t ]*$/;function Zs(t){return rc.test(t)}var ur=" ",bi=" ",nc=/^\u0020+/,Js=/\u0020+$/;function ac(t){var e=xi();t.segments.forEach(function(r){Qs(t,r,e)}),$s(t,e.textSegments,e.lastInlineSegment),eu(t,e.lastTextSegment,e.lastInlineSegment)}function ic(t,e,r){r===void 0&&(r=!1);var n=xi();n.ignoreTrailingSpaces=r,Qs(t,e,n)}function xi(t){return Object.assign(t??{},{textSegments:[],ignoreLeadingSpaces:!0,ignoreTrailingSpaces:!0,lastInlineSegment:void 0,lastTextSegment:void 0})}function Qs(t,e,r){switch(e.segmentType){case"Br":$s(t,r.textSegments,r.lastInlineSegment),eu(t,r.lastTextSegment,r.lastInlineSegment),xi(r);break;case"Entity":case"General":case"Image":r.lastInlineSegment=e,r.ignoreLeadingSpaces=!1;break;case"Text":r.textSegments.push(e),r.lastInlineSegment=e,r.lastTextSegment=e;var n=e.text.substring(0,1),a=e.text.substr(-1);Zs(e.text)||(n==ur&&vt(t,e,function(i){i.text=i.text.replace(nc,r.ignoreLeadingSpaces?"":bi)}),a==ur&&vt(t,e,function(i){i.text=i.text.replace(Js,r.ignoreTrailingSpaces?ur:bi)})),r.ignoreLeadingSpaces=a==ur;break}}function $s(t,e,r){e.forEach(function(n){if(n!=r){var a=n.text;a.substr(-1)==bi&&a.length>1&&a.substr(-2,1)!=ur&&vt(t,n,function(i){i.text=a.substring(0,a.length-1)+ur})}})}function eu(t,e,r){e&&e==r&&e?.text.substr(-1)==ur&&vt(t,e,function(n){n.text=n.text.replace(Js,"")})}function tu(t){var e=t.segments;if(!t.isImplicit&&e.length>0){var r=e[e.length-1],n=e[e.length-2];if(r.segmentType=="SelectionMarker"&&(!n||n.segmentType=="Br"))D(t).segments.push(qt(r.format));else if(e.length>1&&e[e.length-1].segmentType=="Br"){var a=e.filter(function(i){return i.segmentType!="SelectionMarker"});a.length>1&&a[a.length-2].segmentType!="Br"&&D(t).segments.pop()}oc(t)}yn(t.format.whiteSpace)||ac(t),sc(t),lc(t),dc(t)}function oc(t){t.format.whiteSpace&&t.segments.every(function(e){return e.segmentType=="Br"||e.segmentType=="SelectionMarker"})&&delete D(t).format.whiteSpace}function lc(t){for(var e=t.segments.length-1;e>=0;e--)qs(t.segments[e],!0)&&D(t).segments.splice(e,1)}function sc(t){var e=t.segments.find(function(i){return i.segmentType=="SelectionMarker"});if(e){var r=t.segments.indexOf(e),n=t.segments[r-1],a=t.segments[r+1];(n&&!n.link&&cr(n.format,e.format)&&(!a||!a.link&&cr(a.format,e.format))&&e.link||!n&&e.link&&a&&!a.link&&cr(a.format,e.format))&&vt(t,e,function(i){delete i.link})}}var uc=["fontFamily","fontSize","textColor"];function dc(t){if(!t.decorator){var e=t.segments.filter(function(a){return a.segmentType!="SelectionMarker"}),r=t.segmentFormat||{},n=!1;uc.forEach(function(a){n=fc(e,r,a)||n}),n&&(D(t).segmentFormat=r)}}function fc(t,e,r){var n,a=(n=t[0])===null||n===void 0?void 0:n.format;return a?.[r]&&t.every(function(i){return i.format[r]==a[r]})&&e[r]!=a[r]?(e[r]=a[r],!0):!1}function et(t){t.blockType=="Paragraph"&&t.isImplicit&&(D(t).isImplicit=!1)}function Hi(t,e,r){var n,a,i,o=(a=t?.blocks.indexOf(e))!==null&&a!==void 0?a:-1;o>=0&&(e.blocks.forEach(et),t&&((i=D(t))===null||i===void 0||(n=i.blocks).splice.apply(n,I([o,1],L(e.blocks.map(function(s){var l=D(s);return r&&Pr(l.format,e.format,r),l})),!1))))}function Et(t){for(var e=t.blocks.length-1;e>=0;e--){var r=t.blocks[e];switch(r.blockType){case"BlockGroup":r.blockGroupType=="ListItem"&&r.levels.length==0?(e+=r.blocks.length,Hi(t,r,Ii)):Et(r);break;case"Paragraph":tu(r);break;case"Table":for(var n=0;n<r.rows.length;n++)for(var a=0;a<r.rows[n].cells.length;a++)r.rows[n].cells[a]&&Et(r.rows[n].cells[a]);break}fn(r)&&D(t).blocks.splice(e,1)}}function En(t,e){var r,n=Gr(e.defaultFormat);return((r=e.selection)===null||r===void 0?void 0:r.type)=="range"&&e.selection.isReverted&&(n.hasRevertedRangeSelection=!0),e.domIndexer&&e.allowCacheElement&&(n.persistCache=!0),e.elementProcessors.child(n,t,e),Et(n),n}function F(t,e){return!!t&&t.nodeType==Node[e]}function it(t){return[].slice.call(t)}function zi(t,e,r,n){n.modelHandlers.blockGroupChildren(t,e,r,n);var a=cc(t,n);return r.hasRevertedRangeSelection&&a?.type=="range"&&(a.isReverted=!0),n.domIndexer&&n.allowCacheElement&&(r.persistCache=!0),e.normalize(),a}function cc(t,e){var r=e.regularSelection,n=r.start,a=r.end,i=e.tableSelection,o=e.imageSelection,s,l;if(o)return o;if((s=n&&Ro(n))&&(l=a&&Ro(a))){var u=t.createRange();return u.setStart(s.container,s.offset),u.setEnd(l.container,l.offset),{type:"range",range:u,isReverted:!1}}else return i||null}function Ro(t){var e,r,n,a,i,o;if(t.block&&(t.segment?F(t.segment,"TEXT_NODE")?o={container:t.segment,offset:(n=(e=t.offset)!==null&&e!==void 0?e:(r=t.segment.nodeValue)===null||r===void 0?void 0:r.length)!==null&&n!==void 0?n:0}:t.segment.parentNode&&(o={container:t.segment.parentNode,offset:it(t.segment.parentNode.childNodes).indexOf(t.segment)+1}):o={container:t.block,offset:0}),o&&F(o.container,"DOCUMENT_FRAGMENT_NODE")){var s=o.container.childNodes;if(s.length>o.offset)o={container:s[o.offset],offset:0};else if(o.container.lastChild){var l=o.container.lastChild;o={container:l,offset:F(l,"TEXT_NODE")?(i=(a=l.nodeValue)===null||a===void 0?void 0:a.length)!==null&&i!==void 0?i:0:l.childNodes.length}}else o=void 0}return o}var vc="________________________________________",hc={onDivider:function(t){return t.tagName=="hr"?vc:""},onEntityBlock:function(){return""},onEntitySegment:function(t){var e;return(e=t.wrapper.textContent)!==null&&e!==void 0?e:""},onGeneralSegment:function(t){var e;return(e=t.element.textContent)!==null&&e!==void 0?e:""},onImage:function(){return" "},onText:function(t){return t.text},onParagraph:function(){return!0},onTable:function(){return!0},onBlockGroup:function(){return!0}};function pc(t,e,r){e===void 0&&(e=`\r
`);var n=[],a=Object.assign({},hc,r);return yi(t,n,a),n.join(e)}function yi(t,e,r){r.onBlockGroup(t)&&t.blocks.forEach(function(n){switch(n.blockType){case"Paragraph":if(r.onParagraph(n)){var a="";n.segments.forEach(function(i){switch(i.segmentType){case"Br":e.push(a),a="";break;case"Entity":a+=r.onEntitySegment(i);break;case"General":a+=r.onGeneralSegment(i);break;case"Text":a+=r.onText(i);break;case"Image":a+=r.onImage(i);break}}),a&&e.push(a)}break;case"Divider":e.push(r.onDivider(n));break;case"Entity":e.push(r.onEntityBlock(n));break;case"Table":r.onTable(n)&&n.rows.forEach(function(i){return i.cells.forEach(function(o){yi(o,e,r)})});break;case"BlockGroup":yi(n,e,r);break}})}function Ke(t,e){t.blocks.push(e)}function je(t,e,r,n){var a={blockType:"Paragraph",segments:[],format:C({},e)};return r&&Object.keys(r).length>0&&(a.segmentFormat=C({},r)),t&&(a.isImplicit=!0),n&&(a.decorator={tagName:n.tagName,format:C({},n.format)}),a}function wa(t,e,r){var n=t.blocks[t.blocks.length-1];if(n?.blockType=="Paragraph")return D(n);var a=je(!0,e,r);return Ke(t,a),a}function ht(t,e,r,n){var a=wa(t,r,n),i=a.segments[a.segments.length-1];return r?.textIndent&&(r.isTextIndentApplied&&a.segments.length==0?delete a.format.textIndent:r.isTextIndentApplied=!0,delete a.format.isTextIndentApplied),e.segmentType=="SelectionMarker"?(!i||!i.isSelected||!e.isSelected)&&a.segments.push(e):(e.isSelected&&i?.segmentType=="SelectionMarker"&&i.isSelected&&a.segments.pop(),a.segments.push(e)),a}function Ui(t,e){(e.format.href||e.format.name)&&(t.link={format:C({},e.format),dataset:C({},e.dataset)})}function Gi(t,e){e.format.fontFamily&&(t.code={format:C({},e.format)})}function ka(t,e){Ui(t,e.link),Gi(t,e.code)}function Ge(t){return{segmentType:"SelectionMarker",isSelected:!0,format:C({},t)}}function ru(t,e,r,n){var a=t.blocks[t.blocks.length-1],i=!a||a.blockType!="Paragraph"?{}:a.decorator?{fontFamily:a.decorator.format.fontFamily,fontSize:a.decorator.format.fontSize}:a.segmentFormat?{fontFamily:a.segmentFormat.fontFamily,fontSize:a.segmentFormat.fontSize}:{},o=e.pendingFormat&&e.pendingFormat.insertPoint.node===r&&e.pendingFormat.insertPoint.offset===n?e.pendingFormat.format:void 0,s=Object.assign({},e.defaultFormat,i,e.segmentFormat,o),l=Ge(s);return ka(l,e),l}function Nr(t,e,r,n){var a=ru(t,e,r,n);ht(t,a,e.blockFormat,a.format)}function Cn(t,e){var r,n=((r=t.selection)===null||r===void 0?void 0:r.type)=="range"?t.selection.range:null,a=n?.startContainer==e?n.startOffset:-1,i=n?.endContainer==e?n.endOffset:-1;return[a,i]}var gc=function(t,e,r){for(var n=L(Cn(r,e),2),a=n[0],i=n[1],o=0,s=e.firstChild;s;s=s.nextSibling)oa(o,r,t,a,i,e),Ki(t,s,r),o++;oa(o,r,t,a,i,e)};function Ki(t,e,r){F(e,"ELEMENT_NODE")&&(e.style.display!="none"||r.processNonVisibleElements)?r.elementProcessors.element(t,e,r):F(e,"TEXT_NODE")&&r.elementProcessors["#text"](t,e,r)}function oa(t,e,r,n,a,i){var o;t==n&&(e.isInSelection=!0,Nr(r,e,i,t)),t==a&&((o=e.selection)===null||o===void 0?void 0:o.type)=="range"&&(e.selection.range.collapsed||Nr(r,e,i,t),e.isInSelection=!1)}function nu(t,e,r,n,a){return e===void 0&&(e=!0),{segmentType:"Entity",blockType:"Entity",format:C({},r),entityFormat:{id:a,entityType:n,isReadonly:e},wrapper:t}}var Pe={display:"block"},mc={address:Pe,article:Pe,aside:Pe,b:{fontWeight:"bold"},blockquote:{display:"block",marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},br:Pe,center:{display:"block",textAlign:"center"},dd:{display:"block",marginInlineStart:"40px"},div:Pe,dl:{display:"block",marginTop:"1em",marginBottom:"1em"},dt:Pe,em:{fontStyle:"italic"},fieldset:Pe,figcaption:Pe,figure:Pe,footer:Pe,form:Pe,h1:{display:"block",fontWeight:"bold",fontSize:"2em"},h2:{display:"block",fontWeight:"bold",fontSize:"1.5em"},h3:{display:"block",fontWeight:"bold",fontSize:"1.17em"},h4:{display:"block",fontWeight:"bold"},h5:{display:"block",fontWeight:"bold",fontSize:"0.83em"},h6:{display:"block",fontWeight:"bold",fontSize:"0.67em"},header:Pe,hr:Pe,i:{fontStyle:"italic"},li:{display:"list-item"},main:Pe,nav:Pe,ol:C(C({},Pe),{paddingInlineStart:"40px"}),p:{display:"block",marginTop:"1em",marginBottom:"1em"},pre:{display:"block",fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"},s:{textDecoration:"line-through"},section:Pe,strike:{textDecoration:"line-through"},strong:{fontWeight:"bold"},sub:{verticalAlign:"sub",fontSize:"smaller"},sup:{verticalAlign:"super",fontSize:"smaller"},table:{display:"table",boxSizing:"border-box"},td:{display:"table-cell"},th:{display:"table-cell",fontWeight:"bold"},u:{textDecoration:"underline"},ul:C(C({},Pe),{paddingInlineStart:"40px"})};function _a(t){var e=t.tagName.toLowerCase();return mc[e]||{}}var bc=["block","list-item","table","table-cell","flex"];function Xt(t){var e=t.style.display=="none"?null:t.style.display,r=e||_a(t).display||"";return bc.indexOf(r)>=0}function U(t,e,r,n){var a=_a(t);e.forEach(function(i){i?.(r,t,n,a)})}var yc=["backgroundColor"],Ec=["marginLeft","marginRight","paddingLeft","paddingRight"];function Oe(t,e,r){var n=t.segmentFormat,a=t.blockFormat,i=t.link,o=t.code,s=t.blockDecorator,l=e.segment,u=e.paragraph,d=e.link,f=e.code,v=e.blockDecorator;try{t.segmentFormat=Fo(n,l),t.blockFormat=Fo(a,u),t.link=Cc(i,d),t.code=Sc(o,f),t.blockDecorator=Tc(s,v),r()}finally{t.segmentFormat=n,t.blockFormat=a,t.link=i,t.code=o,t.blockDecorator=s}}function Cc(t,e){switch(e){case"linkDefault":return{format:{underline:!0},dataset:{}};case"empty":return{format:{},dataset:{}};case"cloneFormat":default:return{dataset:t.dataset,format:C({},t.format)}}}function Sc(t,e){switch(e){case"codeDefault":return{format:{fontFamily:"monospace"}};case"empty":return{format:{}};default:return t}}function Tc(t,e){switch(e){case"empty":return{format:{},tagName:""};default:return t}}function Fo(t,e){switch(e){case"empty":return{};case void 0:return t;default:var r=C({},t);if(ie(t).forEach(function(a){(e=="shallowCloneForBlock"&&yc.indexOf(a)>=0||e=="shallowCloneForGroup"&&Ec.indexOf(a)>=0)&&delete r[a]}),e=="shallowClone"||e=="shallowCloneForGroup"){var n=t;n.textIndent&&(delete r.isTextIndentApplied,n.isTextIndentApplied=!0)}return r}}var wc=function(t,e,r){var n=Xt(e)||e.style.display=="inline-block"&&e.style.width=="100%";Oe(r,{segment:n?"empty":void 0,paragraph:"empty"},function(){var a,i=nu(e,!0,r.segmentFormat);if(U(e,r.formatParsers.entity,i.entityFormat,r),r.isInSelection&&(i.isSelected=!0),n)Ke(t,i);else{var o=ht(t,i);(a=r.domIndexer)===null||a===void 0||a.onSegment(e,o,[i])}})};function kc(t,e){return e===void 0&&(e=0),{height:e,format:C({},t),cells:[]}}function au(t,e){for(var r=[],n=0;n<t;n++)r.push(kc());return{blockType:"Table",rows:r,format:C({},e),widths:[],dataset:{}}}function Vt(t,e,r,n,a){var i=typeof t=="number"?t>1:!!t,o=typeof e=="number"?e>1:!!e;return{blockGroupType:"TableCell",blocks:[],format:C({},n),spanLeft:i,spanAbove:o,isHeader:!!r,dataset:C({},a)}}function _c(t){return t.getBoundingClientRect()}function Wi(t){return t?t.type=="range"?t.range.commonAncestorContainer:t.type=="table"?t.table:t.type=="image"?t.image:void 0:void 0}function re(t,e){var r;return((r=t?.tagName)===null||r===void 0?void 0:r.toLocaleLowerCase())==e}var Dc=/(-?\d+(\.\d+)?)([a-z]+|%)/,Mc=96,Oc=16;function Je(t,e,r){t===void 0&&(t=""),r===void 0&&(r="px");var n=Dc.exec(t),a=0;if(n){var i=L(n,4);i[0];var o=i[1];i[2];var s=i[3],l=parseFloat(o);switch(s){case"px":a=l;break;case"pt":a=iu(l);break;case"em":a=An(e)*l;break;case"ex":a=An(e)*l/2;break;case"%":a=An(e)*l/100;break;case"in":a=l*Mc;break;case"rem":a=(An(e)||Oc)*l;break}}return a>0&&r=="pt"&&(a=Lc(a)),a}function An(t){var e,r;if(typeof t>"u")return 0;if(typeof t=="number")return t;var n=(r=(e=t.ownerDocument.defaultView)===null||e===void 0?void 0:e.getComputedStyle(t).fontSize)!==null&&r!==void 0?r:"",a=parseFloat(n),i=iu(a);return i}function iu(t){return Math.round(t*4e3/3)/1e3}function Lc(t){return Math.round(t*3e3/4)/1e3}var Rc=function(t,e,r){Oe(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},function(){var n,a;U(e,r.formatParsers.block,r.blockFormat,r);var i=au(e.rows.length,r.blockFormat),o=((n=r.selection)===null||n===void 0?void 0:n.type)=="table"?r.selection:null,s=o?.table,l=s==e,u=Ac(e,r);r.allowCacheElement&&(i.cachedElement=e),(a=r.domIndexer)===null||a===void 0||a.onTable(e,i),U(e,r.formatParsers.table,i.format,r),U(e,r.formatParsers.tableBorder,i.format,r),U(e,r.formatParsers.segmentOnBlock,r.segmentFormat,r),U(e,r.formatParsers.dataset,i.dataset,r),Ke(t,i);for(var d=[0],f=Pc(e,r,d),v=[0],c=r.zoomScale||1,h=function(b){var y=e.rows[b],E=i.rows[b],S=y.parentNode;F(S,"ELEMENT_NODE")&&(re(S,"tbody")||re(S,"thead")||re(S,"tfoot"))?U(S,r.formatParsers.tableRow,E.format,r):r.allowCacheElement&&(E.cachedElement=y),U(y,r.formatParsers.tableRow,E.format,r),Oe(r,{paragraph:"shallowClone",segment:"shallowClone"},function(){var k=y.parentElement,R=k&&Nc(k);R&&(U(k,r.formatParsers.block,r.blockFormat,r),U(k,r.formatParsers.segmentOnBlock,r.segmentFormat,r)),U(y,r.formatParsers.block,r.blockFormat,r),U(y,r.formatParsers.segmentOnBlock,r.segmentFormat,r),E.height=parseInt(y.style.height)||0;for(var M=function(J,z){for(;E.cells[z];z++);var O=y.cells[J],V=r.isInSelection;if(u){var ne=z+O.colSpan,oe=b+O.rowSpan,he=d[ne]===void 0,Re=v[oe]===void 0;if(he||Re){var Te=_c(O);if(Te.width>0||Te.height>0){if(he){var ee=d[z];d[ne]=(typeof ee=="number"?ee:0)+Te.width/c}Re&&(v[oe]=v[b]+Te.height/c)}}}Oe(r,{paragraph:"shallowClone",segment:"shallowClone"},function(){U(O,r.formatParsers.block,r.blockFormat,r),U(O,r.formatParsers.segmentOnTableCell,r.segmentFormat,r);var le=C({},r.blockFormat),Zt={};U(O,r.formatParsers.tableCell,le,r),U(O,r.formatParsers.tableBorder,le,r),U(O,r.formatParsers.dataset,Zt,r);for(var pt=1;pt<=(O.colSpan==0?1:O.colSpan);pt++,z++)for(var pe=1;pe<=(O.rowSpan==0?R?Fc(k,O):1:O.rowSpan);pe++){var Ie=pt==1&&pe==1,ke=Vt(pt>1,pe>1,O.tagName=="TH",le);ke.dataset=C({},Zt);var qe=i.rows[b+pe-1];if(qe&&(qe.cells[z]=ke),Ie){r.allowCacheElement&&!f&&(ke.cachedElement=O);var Be=r.listFormat,ze=Be.listParent,Xe=Be.levels;r.listFormat.listParent=void 0,r.listFormat.levels=[];try{r.elementProcessors.child(ke,O,r)}finally{r.listFormat.listParent=ze,r.listFormat.levels=Xe}}var st=r.isInSelection;(V&&st||l&&o&&b>=o.firstRow&&b<=o.lastRow&&z>=o.firstColumn&&z<=o.lastColumn)&&(ke.isSelected=!0)}}),w=z},w,A=0,N=0;A<y.cells.length;A++)M(A,N),N=w});for(var T=0;T<E.cells.length;T++)E.cells[T]||(E.cells[T]=Vt(!1,!1,!1,r.blockFormat))},p=0;p<e.rows.length;p++)h(p);i.widths=Po(d);var m=Po(v);i.rows.forEach(function(b,y){m[y]>0&&(b.height=m[y])})})};function Fc(t,e){for(var r=t.rows.length,n=-1,a=0;a<t.rows.length;a++){for(var i=t.rows[a],o=0;o<i.cells.length;o++)if(i.cells[o]===e){n=a;break}if(n!==-1)break}return r-n}function Po(t){for(var e=[],r=0,n=t.length-1;n>=0;n--){var a=t[n];if(typeof a=="number"){r=a;break}}for(var n=t.length-2;n>=0;n--){var a=t[n];a===void 0?e[n]=0:(e[n]=r-a,r=a)}return e}function Pc(t,e,r){for(var n,a,i=0,o=!1,s=t.firstChild;s;s=s.nextSibling)if(F(s,"ELEMENT_NODE")&&s.tagName=="COLGROUP"){o=!0;for(var l=s.firstChild;l;l=l.nextSibling)if(F(l,"ELEMENT_NODE")&&l.tagName=="COL"){var u={};U(l,e.formatParsers.tableColumn,u,e);for(var d=0;d<parseInt((n=l.getAttribute("span"))!==null&&n!==void 0?n:"1");d++)if(u.width===void 0)r.push(void 0);else{var f=Je((a=u.width)!==null&&a!==void 0?a:"",void 0,"px");r.push(f+i),i+=f}}}return o}function Ac(t,e){switch(e.recalculateTableSize){case!0:case"all":return!0;case"selected":var r=Wi(e.selection);return!!r&&(r==t||t.contains(r)||r.contains(t));default:return!1}}function Nc(t){return re(t,"tbody")||re(t,"thead")||re(t,"tfoot")}function la(t,e){var r=!1;if(e.isOptional&&typeof t>"u"||e.allowNull&&t===null)r=!0;else{if(!e.isOptional&&typeof t>"u"||!e.allowNull&&t===null)return!1;switch(e.type){case"string":r=typeof t=="string"&&(typeof e.value>"u"||t===e.value);break;case"number":r=typeof t=="number"&&(typeof e.value>"u"||Ic(e.value,t))&&(typeof e.minValue>"u"||t>=e.minValue)&&(typeof e.maxValue>"u"||t<=e.maxValue);break;case"boolean":r=typeof t=="boolean"&&(typeof e.value>"u"||t===e.value);break;case"array":r=Array.isArray(t)&&(typeof e.minLength>"u"||t.length>=e.minLength)&&(typeof e.maxLength>"u"||t.length<=e.maxLength)&&t.every(function(n){return la(n,e.itemDef)});break;case"object":r=typeof t=="object"&&ie(e.propertyDef).every(function(n){return la(t[n],e.propertyDef[n])});break}}return r}function Ic(t,e){return Math.abs(t-e)<.001}var sa="editingInfo";function Da(t,e){var r=t.dataset[sa],n=null;try{n=JSON.parse(r)}catch{}return!e||la(n,e)?n:null}function Ma(t,e,r){var n=Da(t,r);return e&&(n=e(n),n?(!r||la(n,r))&&(t.dataset[sa]=JSON.stringify(n)):delete t.dataset[sa]),n}function ou(t){return!!t.dataset[sa]}var Bc=/^[.|\-|_|\d]/;function Ir(t){return t&&(t.match(Bc)?'[id="'+t+'"]':"#"+t)}function Ft(t,e,r){if(t){for(;!r&&t.firstChild;)t.removeChild(t.firstChild);for(;e?.firstChild;)t.appendChild(e.firstChild)}}function vr(t,e){var r=t.ownerDocument.createElement(e);return Ft(r,t),t.appendChild(r),r}function Sn(t,e,r){var n,a=t.createElement(r);return(n=e.parentNode)===null||n===void 0||n.insertBefore(a,e),a.appendChild(e),a}function lu(t){var e=t?t.parentNode:null;if(!e)return null;for(;t.firstChild;)e.insertBefore(t.firstChild,t);return e.removeChild(t),e}function $(t,e,r,n){e.forEach(function(a){a?.(r,t,n)})}var Tn="_Entity",xc="."+Tn,Ei="_EType_",Ci="_EId_",Si="_EReadonly_",Vi="​",ji="entityDelimiterBefore",qi="entityDelimiterAfter",su="_E_EBlockEntityContainer",Hc="."+su;function Ct(t){return F(t,"ELEMENT_NODE")&&t.classList.contains(Tn)}function Xi(t,e){return e.findClosestElementAncestor(t,xc)}function uu(t,e){return e.findClosestElementAncestor(t,Hc)}function du(t){return it(t.querySelectorAll("."+Tn))}function hr(t){var e=!1,r={};return t.classList.forEach(function(n){e=zc(n,r)||e}),e||(r.isFakeEntity=!0,r.isReadonly=!t.isContentEditable),r}function zc(t,e){if(t==Tn)return!0;t.indexOf(Ei)==0?e.entityType=t.substring(Ei.length):t.indexOf(Ci)==0?e.id=t.substring(Ci.length):t.indexOf(Si)==0&&(e.isReadonly=t.substring(Si.length)=="1")}function fu(t){var e;return t.isFakeEntity?"":Tn+" "+Ei+((e=t.entityType)!==null&&e!==void 0?e:"")+" "+(t.id?""+Ci+t.id+" ":"")+Si+(t.isReadonly?"1":"0")}function Ut(t,e){var r=e===void 0||e,n=e===void 0||!e;return re(t,"span")&&(n&&t.classList.contains(qi)||r&&t.classList.contains(ji))&&t.textContent===Vi}function wn(t){return re(t,"div")&&t.classList.contains(su)}function Yi(t,e,r,n){var a=L(Uc(e),2),i=a[0],o=a[1];return i||(i=No(t,e,!0),n&&r&&$(i,n.formatAppliers.segment,r,n)),o||(o=No(t,e,!1),n&&r&&$(o,n.formatAppliers.segment,r,n)),[i,o]}function Uc(t){var e=[],r=t.nextElementSibling,n=t.previousElementSibling;return e.push(Ao(r,qi),Ao(n,ji)),e}function Ao(t,e){return t?.classList.contains(e)&&t.textContent==Vi?t:void 0}function No(t,e,r){var n,a=t.createElement("span");return a.className=r?qi:ji,a.appendChild(t.createTextNode(Vi)),(n=e.parentNode)===null||n===void 0||n.insertBefore(a,r?e.nextSibling:e),a}function pr(t,e,r,n){var a;if(e.parentNode==t){for(var i=Ct(e);r&&r!=e&&(i||!Ct(r));){var o=r.nextSibling;(a=r.parentNode)===null||a===void 0||a.removeChild(r),F(r,"ELEMENT_NODE")&&n?.removedBlockElements.push(r),r=o}r&&r==e?r=r.nextSibling:t.insertBefore(e,r)}else t.insertBefore(e,r);return r}function Le(t){var e=t||{left:0,right:0,top:0,bottom:0},r=e.left,n=e.right,a=e.top,i=e.bottom;return r===0&&n===0&&a===0&&i===0?null:{left:Math.round(r),right:Math.round(n),top:Math.round(a),bottom:Math.round(i)}}function Gc(t,e,r,n,a,i){a===void 0&&(a=0),i===void 0&&(i=!1);var o,s=0;a!=0&&(o=Ka(r,o),s=Math.max(0,Math.min(a*o,(e.bottom-e.top-n.bottom+n.top)/2)));var l=n.top-s,u=n.bottom+s,d=u-l,f=function(){o=Ka(r,o),t.scrollTop-=(e.top-l)/o},v=function(){o=Ka(r,o),t.scrollTop+=(u-e.bottom)/o},c=l<e.top,h=u>e.bottom;d>e.bottom-e.top?i?f():v():i?c?f():h&&v():h?v():c&&f()}function Ka(t,e){return e===void 0?t.calculateZoomScale():e}function Zi(t,e){var r=t,n=r.__roosterjsHiddenProperty;return n?n[e]:void 0}function Ji(t,e,r){var n=t,a=n.__roosterjsHiddenProperty||{};a[e]=r,n.__roosterjsHiddenProperty=a}var cu="undeletable";function Kc(t,e){Ji(t,cu,e)}function vu(t){return!!Zi(t,cu)}function gr(t,e,r){return{listType:t,format:C({},e),dataset:C({},r)}}function kn(t,e){var r=Ge(e);return r.isSelected=!1,{blockType:"BlockGroup",blockGroupType:"ListItem",blocks:[],levels:t?t.map(function(n){return gr(n.listType,n.format,n.dataset)}):[],formatHolder:r,format:{}}}function Qi(t,e){return{blockType:"BlockGroup",blockGroupType:"FormatContainer",tagName:t,blocks:[],format:C({},e)}}function We(t,e,r,n){var a={segmentType:"Text",text:t,format:C({},e)};return r&&Ui(a,r),n&&Gi(a,n),a}function Wc(t,e){return{segmentType:"Image",src:t,format:C({},e),dataset:{}}}function hu(t,e){return{tagName:t.toLocaleLowerCase(),format:C({},e)}}function Vc(t,e){return{blockType:"BlockGroup",blockGroupType:"General",segmentType:"General",format:C({},e),blocks:[],element:t}}function jc(t){return{blockType:"BlockGroup",blockGroupType:"General",element:t,blocks:[],format:{}}}function qc(t,e){return{blockType:"Divider",tagName:t,format:C({},e)}}function Xc(t){var e=Gr(t),r=je(!1,void 0,t);return r.segments.push(Ge(t),qt(t)),e.blocks.push(r),e}function sn(t,e,r){var n,a;if(e){var i=wa(t,r.blockFormat);(!Zs(e)||((n=i?.segments.length)!==null&&n!==void 0?n:0)>0||yn(i?.format.whiteSpace))&&(a=We(e,r.segmentFormat),r.isInSelection&&(a.isSelected=!0),ka(a,r),ht(t,a,r.blockFormat))}return a}function pu(t){return t.blockGroupType=="General"&&t.segmentType=="General"}function Yc(t){for(var e=null,r=0;r<t.segments.length;r++){var n=t.segments[r];n.segmentType!="Text"?e=null:!e||!Zc(e,n)?e=n:(e.text+=n.text,t.segments.splice(r,1),r--)}}function Zc(t,e){return!!t.isSelected==!!e.isSelected&&cr(t.format,e.format)&&Jc(t.link,e.link)&&Qc(t.code,e.code)}function Jc(t,e){return!t&&!e||t&&e&&cr(t.format,e.format)&&cr(t.dataset,e.dataset)}function Qc(t,e){return!t&&!e||t&&e&&cr(t.format,e.format)}var $c={a:{underline:!0,textColor:void 0},blockquote:{marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},code:{fontFamily:"monospace"},dd:{marginLeft:"40px"},dl:{marginTop:"1em",marginBottom:"1em"},h1:{fontWeight:"bold",fontSize:"2em"},h2:{fontWeight:"bold",fontSize:"1.5em"},h3:{fontWeight:"bold",fontSize:"1.17em"},h4:{fontWeight:"bold",fontSize:"1em"},h5:{fontWeight:"bold",fontSize:"0.83em"},h6:{fontWeight:"bold",fontSize:"0.67em"},p:{marginTop:"1em",marginBottom:"1em"},pre:{fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"},th:{fontWeight:"bold"}},ev=function(t,e,r,n,a){var i=n.modelHandlers;switch(r.blockType){case"Table":a=i.table(t,e,r,n,a);break;case"Paragraph":a=i.paragraph(t,e,r,n,a);break;case"Entity":a=i.entityBlock(t,e,r,n,a);break;case"Divider":a=i.divider(t,e,r,n,a);break;case"BlockGroup":switch(r.blockGroupType){case"General":a=i.generalBlock(t,e,r,n,a);break;case"FormatContainer":a=i.formatContainer(t,e,r,n,a);break;case"ListItem":a=i.listItem(t,e,r,n,a);break}break}return a},tv=function(t,e,r,n){var a,i=n.listFormat,o=i.nodeStack,s=e.firstChild;try{for(r.blocks.forEach(function(u,d){var f;(d==0||u.blockType!="BlockGroup"||u.blockGroupType!="ListItem")&&(i.nodeStack=[]),s=n.modelHandlers.block(t,e,u,n,s),u.blockType=="Entity"&&((f=n.domIndexer)===null||f===void 0||f.onBlockEntity(u,r))});s;){var l=s.nextSibling;F(s,"ELEMENT_NODE")&&n.rewriteFromModel.removedBlockElements.push(s),(a=s.parentNode)===null||a===void 0||a.removeChild(s),s=l}}finally{i.nodeStack=o}};function Oa(t,e,r,n,a,i){var o;e.firstChild||(a.regularSelection.current.segment=e),$(r,a.formatAppliers.styleBasedSegment,n.format,a),i?.push(e),a.modelHandlers.segmentDecorator(t,r,n,a,i),$(r,a.formatAppliers.elementBasedSegment,n.format,a),(o=a.onNodeCreated)===null||o===void 0||o.call(a,n,e)}var rv=function(t,e,r,n,a){var i=t.createElement("br"),o=t.createElement("span");o.appendChild(i),e.appendChild(o),Oa(t,i,o,r,n,a)},nv=function(t,e,r,n,a){var i,o=n.allowCacheElement?r.cachedElement:void 0;return o&&!r.isSelected?a=pr(e,o,a,n.rewriteFromModel):(o=t.createElement(r.tagName),n.allowCacheElement&&(r.cachedElement=o),e.insertBefore(o,a),n.rewriteFromModel.addedBlockElements.push(o),$(o,n.formatAppliers.divider,r.format,n),r.size&&o.setAttribute("size",r.size)),(i=n.onNodeCreated)===null||i===void 0||i.call(n,r,o),a},Io="_E_EBlockEntityContainer",av=function(t,e,r,n,a){var i,o,s=r.entityFormat,l=r.wrapper;$(l,n.formatAppliers.entity,s,n);var u=n.addDelimiterForEntity&&l.style.display=="inline-block"&&l.style.width=="100%",d=(i=l.parentElement)===null||i===void 0?void 0:i.classList.contains(Io),f=d&&u?l.parentElement:l;if(a=pr(e,f,a,n.rewriteFromModel),u){if(!d){var v=Sn(t,l,"div");v.classList.add(Io)}Yi(t,l,gu(n),n)}return(o=n.onNodeCreated)===null||o===void 0||o.call(n,r,l),a},iv=function(t,e,r,n,a){var i,o=r.entityFormat,s=r.wrapper,l=r.format;if(e.appendChild(s),a?.push(s),ie(l).length>0){var u=Sn(t,s,"span");$(u,n.formatAppliers.segment,l,n)}if($(s,n.formatAppliers.entity,o,n),n.addDelimiterForEntity&&o.isReadonly){var d=L(Yi(t,s,gu(n),n),2),f=d[0],v=d[1];a&&(a.push(f,v),f.firstChild&&a.push(f.firstChild),v.firstChild&&a.push(v.firstChild)),n.regularSelection.current.segment=f}else n.regularSelection.current.segment=s;(i=n.onNodeCreated)===null||i===void 0||i.call(n,r,s)};function gu(t){var e;return C(C({},(e=t.pendingFormat)===null||e===void 0?void 0:e.format),t.defaultFormat)}function $t(t,e,r){var n=typeof e=="string"?t.defaultContentModelFormatMap[e]:e;if(n){var a=t.implicitFormat;try{t.implicitFormat=C(C({},a),n),r()}finally{t.implicitFormat=a}}else r()}var ov={fontFamily:"monospace",whiteSpace:"pre"},lv=function(t,e,r,n,a){var i,o=n.allowCacheElement?r.cachedElement:void 0;if(o)a=pr(e,o,a,n.rewriteFromModel),n.modelHandlers.blockGroupChildren(t,o,r,n);else if(!Ni(r)){var s=t.createElement(r.tagName);n.allowCacheElement&&(r.cachedElement=s),e.insertBefore(s,a),n.rewriteFromModel.addedBlockElements.push(s),$t(n,r.tagName,function(){$(s,n.formatAppliers.container,r.format,n),$(s,n.formatAppliers.segmentOnBlock,r.format,n),$(s,n.formatAppliers.container,r.format,n)}),r.tagName=="pre"?$t(n,ov,function(){n.modelHandlers.blockGroupChildren(t,s,r,n)}):n.modelHandlers.blockGroupChildren(t,s,r,n),o=s}return o&&((i=n.onNodeCreated)===null||i===void 0||i.call(n,r,o)),a},sv=function(t,e,r,n,a){var i,o=r.element;return a&&o.parentNode==e?a=pr(e,o,a,n.rewriteFromModel):(o=o.cloneNode(),r.element=o,$(o,n.formatAppliers.general,r.format,n),e.insertBefore(o,a),n.rewriteFromModel.addedBlockElements.push(o)),(i=n.onNodeCreated)===null||i===void 0||i.call(n,r,o),n.modelHandlers.blockGroupChildren(t,o,r,n),a},uv=function(t,e,r,n,a){var i,o=r.element.cloneNode();if(r.element=o,e.appendChild(o),F(o,"ELEMENT_NODE")){var s=Sn(t,o,"span");Oa(t,o,s,r,n,a),$(o,n.formatAppliers.general,r.format,n),(i=n.onNodeCreated)===null||i===void 0||i.call(n,r,o)}n.modelHandlers.blockGroupChildren(t,o,r,n)},dv=function(t,e,r,n,a){var i=t.createElement("img"),o=document.createElement("span");e.appendChild(o),o.appendChild(i),i.src=r.src,r.alt&&(i.alt=r.alt),r.title&&(i.title=r.title),$(i,n.formatAppliers.image,r.format,n),$(i,n.formatAppliers.dataset,r.dataset,n);var s=r.format,l=s.width,u=s.height,d=l?Je(l):0,f=u?Je(u):0;d>0&&(i.width=d),f>0&&(i.height=f),r.isSelectedAsImageSelection&&(n.imageSelection={type:"image",image:i}),Oa(t,i,o,r,n,a)};function mu(t,e,r,n){e&&Ma(t,function(a){return e.applierFunction(a,r,n),a},e.metadataDefinition)}var fv=function(t,e,r,n,a){var i,o,s,l=0,u=n.listFormat.nodeStack;for(u.length==0&&u.push({node:e});l<r.levels.length&&l+1<u.length;l++){var d=u[l+1],f=r.levels[l];if(d.listType!=f.listType||((i=d.dataset)===null||i===void 0?void 0:i.editingInfo)!=f.dataset.editingInfo||f.listType=="OL"&&typeof f.format.startNumberOverride=="number"||f.listType=="UL"&&f.format.listStyleType!=((o=d.format)===null||o===void 0?void 0:o.listStyleType))break}for(u.splice(l+1);l<r.levels.length;l++){var v=r.levels[l],c=t.createElement(v.listType||"UL"),h=u[u.length-1].node;h.insertBefore(c,l==0?a:null),u.push(C({node:c},v)),$(c,n.formatAppliers.listLevelThread,v.format,n),mu(v,n.metadataAppliers.listLevel,v.format,n),$(c,n.formatAppliers.listLevel,v.format,n),$(c,n.formatAppliers.dataset,v.dataset,n),(s=n.onNodeCreated)===null||s===void 0||s.call(n,v,c)}return a},cv=new Set(["div","span","p","section","article","aside","header","footer","main","nav","address","blockquote","pre","figure","figcaption","hgroup"]);function vv(t){if(!t)return!1;var e=t.tagName.toLowerCase();return cv.has(e)}var hv="role",pv="presentation",gv=function(t,e,r,n,a){var i,o;a=n.modelHandlers.list(t,e,r,n,a);var s=n.listFormat.nodeStack,l=((i=s?.[s?.length-1])===null||i===void 0?void 0:i.node)||e,u=t.createElement("li"),d=r.levels[r.levels.length-1];l.insertBefore(u,a?.parentNode==l?a:null),n.rewriteFromModel.addedBlockElements.push(u),d?($(u,n.formatAppliers.segment,r.formatHolder.format,n),$(u,n.formatAppliers.listItemThread,d.format,n),mu(d,n.metadataAppliers.listItem,r.format,n),$(u,n.formatAppliers.listItemElement,r.format,n),$t(n,r.formatHolder.format,function(){n.modelHandlers.blockGroupChildren(t,u,r,n)})):(r.blocks.forEach(et),n.modelHandlers.blockGroupChildren(t,u,r,n),lu(u));for(var f=0;f<u.children.length;f++){var v=u.children.item(f);vv(v)&&v.setAttribute(hv,pv)}return(o=n.onNodeCreated)===null||o===void 0||o.call(n,r,u),a},mv=["SPAN","B","EM","I","U","SUB","SUP","STRIKE","S","A","CODE"];function bv(t){for(var e=t.firstChild;e;){var r=e.nextSibling;if(r&&F(e,"ELEMENT_NODE")&&F(r,"ELEMENT_NODE")&&e.tagName==r.tagName&&mv.indexOf(e.tagName)>=0&&yv(e,r)){for(;r.firstChild;)e.appendChild(r.firstChild);r.parentNode.removeChild(r)}else e=r}}function yv(t,e){var r=t.attributes,n=e.attributes;if(r.length!=n.length)return!1;for(var a=0;a<r.length;a++)if(r[a].name!=n[a].name||r[a].value!=n[a].value)return!1;return!0}function Ev(t){for(var e=t.firstChild;e;)if(F(e,"ELEMENT_NODE")&&e.tagName=="SPAN"&&e.attributes.length==0){var r=e,n=e.nextSibling;for(e=e.nextSibling;r.lastChild;){var a=r.lastChild;t.insertBefore(a,n),n=a}t.removeChild(r)}else e=e.nextSibling}function bu(t,e){if(!Ct(t)){Ev(t),bv(t);for(var r=t.firstChild;r;r=r.nextSibling)bu(r,e);Cv(t,e)}}function Cv(t,e){var r,n,a,i,o=null,s,l,u=e.regularSelection;for(s=t.firstChild,l=s?s.nextSibling:null;s;s=l,l=s?s.nextSibling:null)if(!F(s,"TEXT_NODE"))o=null;else if(!o)o=s;else{var d=(n=(r=o.nodeValue)===null||r===void 0?void 0:r.length)!==null&&n!==void 0?n:0;(a=e.domIndexer)===null||a===void 0||a.onMergeText(o,s),o.nodeValue+=(i=s.nodeValue)!==null&&i!==void 0?i:"",u&&(Bo(u.start,o,s,d),Bo(u.end,o,s,d)),t.removeChild(s)}}function Bo(t,e,r,n){t&&t.offset==null&&(t.segment==e?t.offset=n:t.segment==r&&(t.segment=e))}var Sv="div",Tv=function(t,e,r,n,a){var i,o=n.allowCacheElement?r.cachedElement:void 0;return o&&r.segments.every(function(s){return s.segmentType!="General"&&!s.isSelected})?a=pr(e,o,a,n.rewriteFromModel):$t(n,((i=r.decorator)===null||i===void 0?void 0:i.tagName)||null,function(){var s,l,u,d,f,v=!r.isImplicit||!!r.decorator||ie(r.format).length>0&&r.segments.some(function(p){return p.segmentType!="SelectionMarker"}),c=v?C(C({},((s=r.decorator)===null||s===void 0?void 0:s.format)||{}),r.segmentFormat):{};o=t.createElement(((l=r.decorator)===null||l===void 0?void 0:l.tagName)||Sv),e.insertBefore(o,a),n.regularSelection.current={block:v?o:o.parentNode,segment:null};var h=function(){var p=o;if(p){var m=r.segments[0];m?.segmentType=="SelectionMarker"&&n.modelHandlers.text(t,p,C(C({},m),{segmentType:"Text",text:""}),n,[]),r.segments.forEach(function(b){var y=[];n.modelHandlers.segment(t,p,b,n,y),y.forEach(function(E){var S;(S=n.domIndexer)===null||S===void 0||S.onSegment(E,r,[b])})})}};v?($t(n,c,h),$(o,n.formatAppliers.block,r.format,n),$(o,n.formatAppliers.container,r.format,n),$(o,n.formatAppliers.segmentOnBlock,c,n),(u=n.paragraphMap)===null||u===void 0||u.applyMarkerToDom(o,r)):h(),bu(o,n),a=o.nextSibling,o&&((d=n.onNodeCreated)===null||d===void 0||d.call(n,r,o),(f=n.domIndexer)===null||f===void 0||f.onParagraph(o)),v?(n.allowCacheElement&&(r.cachedElement=o),n.rewriteFromModel.addedBlockElements.push(o)):(lu(o),o=void 0)}),a},wv=function(t,e,r,n,a){var i=n.regularSelection;switch(r.isSelected&&!i.start&&(i.start=C({},i.current)),r.segmentType){case"Text":n.modelHandlers.text(t,e,r,n,a);break;case"Br":n.modelHandlers.br(t,e,r,n,a);break;case"Image":n.modelHandlers.image(t,e,r,n,a);break;case"General":n.modelHandlers.generalSegment(t,e,r,n,a);break;case"Entity":n.modelHandlers.entitySegment(t,e,r,n,a);break}r.isSelected&&i.start&&(i.end=C({},i.current))},kv=function(t,e,r,n){var a=r.code,i=r.link;F(e,"ELEMENT_NODE")&&(i&&$t(n,"a",function(){var o,s=vr(e,"a");$(s,n.formatAppliers.link,i.format,n),$(s,n.formatAppliers.dataset,i.dataset,n),(o=n.onNodeCreated)===null||o===void 0||o.call(n,i,s)}),a&&$t(n,"code",function(){var o,s=vr(e,"code");$(s,n.formatAppliers.code,a.format,n),(o=n.onNodeCreated)===null||o===void 0||o.call(n,a,s)}))},_v=function(t,e,r,n,a){var i,o,s,l,u,d,f;if(fn(r))return a;var v=n.allowCacheElement?r.cachedElement:void 0;v?(a=pr(e,v,a,n.rewriteFromModel),Ft(v)):(v=t.createElement("table"),n.allowCacheElement&&(r.cachedElement=v),e.insertBefore(v,a),n.rewriteFromModel.addedBlockElements.push(v),$(v,n.formatAppliers.block,r.format,n),$(v,n.formatAppliers.table,r.format,n),$(v,n.formatAppliers.tableBorder,r.format,n),$(v,n.formatAppliers.dataset,r.dataset,n)),(i=n.onNodeCreated)===null||i===void 0||i.call(n,r,v);var c=t.createElement("tbody");v.appendChild(c);for(var h=0;h<r.rows.length;h++){var p=r.rows[h];if(p.cells.length!=0){var m=n.allowCacheElement&&p.cachedElement||t.createElement("tr");c.appendChild(m),Ft(m),p.cachedElement||(n.allowCacheElement&&(p.cachedElement=m),$(m,n.formatAppliers.tableRow,p.format,n)),(o=n.onNodeCreated)===null||o===void 0||o.call(n,p,m);for(var b=function(E){var S=p.cells[E];if(S.isSelected){var T=n.tableSelection||{type:"table",table:v,firstColumn:E,lastColumn:E,firstRow:h,lastRow:h};T.table==v&&(T.lastColumn=Math.max(T.lastColumn,E),T.lastRow=Math.max(T.lastRow,h)),n.tableSelection=T}if(!S.spanAbove&&!S.spanLeft){var k=S.isHeader?"th":"td",R=n.allowCacheElement&&S.cachedElement||t.createElement(k);m.appendChild(R);for(var M=1,w=1,A=r.widths[E],N=p.height;!((l=(s=r.rows[h+M])===null||s===void 0?void 0:s.cells[E])===null||l===void 0)&&l.spanAbove;M++)N+=r.rows[h+M].height;for(;!((u=p.cells[E+w])===null||u===void 0)&&u.spanLeft;w++)A+=r.widths[E+w];M>1&&(R.rowSpan=M),w>1&&(R.colSpan=w),(!S.cachedElement||S.format.useBorderBox&&ou(r))&&(A>0&&!R.style.width&&(R.style.width=A+"px"),N>0&&!R.style.height&&(R.style.height=N+"px")),$t(n,k,function(){S.cachedElement||(n.allowCacheElement&&(S.cachedElement=R),$(R,n.formatAppliers.block,S.format,n),$(R,n.formatAppliers.tableCell,S.format,n),$(R,n.formatAppliers.tableCellBorder,S.format,n),$(R,n.formatAppliers.dataset,S.dataset,n)),n.modelHandlers.blockGroupChildren(t,R,S,n)}),(d=n.onNodeCreated)===null||d===void 0||d.call(n,S,R)}},y=0;y<p.cells.length;y++)b(y)}}return(f=n.domIndexer)===null||f===void 0||f.onTable(v,r),a},Dv=function(t,e,r,n,a){var i=t.createTextNode(r.text),o=t.createElement("span");e.appendChild(o),o.appendChild(i),n.formatAppliers.text.forEach(function(s){return s(r.format,i,n)}),Oa(t,i,o,r,n,a)},xo={block:ev,blockGroupChildren:tv,br:rv,entityBlock:av,entitySegment:iv,generalBlock:sv,generalSegment:uv,divider:nv,image:dv,list:fv,listItem:gv,paragraph:Tv,formatContainer:lv,segment:wv,segmentDecorator:kv,table:_v,text:Dv},Mv={parse:function(t,e){var r=e.getAttribute("aria-describedby"),n=e.getAttribute("title");r&&(t.ariaDescribedBy=r),n&&(t.title=n)},apply:function(t,e){t.ariaDescribedBy&&e.setAttribute("aria-describedby",t.ariaDescribedBy),t.title&&e.setAttribute("title",t.title)}},yu=["inactiveborder","activeborder","inactivecaptiontext","inactivecaption","activecaption","appworkspace","infobackground","background","buttonhighlight","buttonshadow","captiontext","infotext","menutext","menu","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedfhadow","windowtext","windowframe","window"],Ov="rgb(0, 0, 0)",Lv=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/,Rv=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/,Fv=/^rgb\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,Pv=/^rgba\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\s*\)$/,Eu=/^\s*var\(\s*(\-\-[a-zA-Z0-9\-_]+)\s*(?:,\s*(.*))?\)\s*$/,Ti="var(",Av=")",Nv="--darkColor";function Br(t,e,r,n,a){var i=(e?t.style.backgroundColor:t.style.color)||t.getAttribute(e?"bgcolor":"color")||a;if(i&&yu.indexOf(i)>-1)i=e?void 0:Ov;else if(n&&i){var o=i.startsWith(Ti)?Eu.exec(i):null;o?i=o[2]||"":r&&(i=Bv(i,n.knownColors)||"")}return i}function xr(t,e,r,n,a){var i,o,s=e&&e.startsWith(Ti)?Eu.exec(e):null,l=L(s??[],3);l[0];var u=l[1],d=l[2];if(e=d??e,a&&e){var f=r?"background":"text",v=u||a.generateColorKey(e,void 0,f,t),c=((o=(i=a.knownColors)===null||i===void 0?void 0:i[v])===null||o===void 0?void 0:o.darkModeColor)||a.getDarkColor(e,void 0,f,t);a.updateKnownColor(n,v,{lightModeColor:e,darkModeColor:c}),e=n?""+Ti+v+", "+e+Av:e}t.removeAttribute(r?"bgcolor":"color"),t.style.setProperty(r?"background-color":"color",e||null)}var Iv=function(t){return Nv+"_"+t.replace(/[^\d\w]/g,"_")};function wi(t){t=(t||"").trim();var e;return(e=t.match(Lv))?[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]:(e=t.match(Rv))?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:(e=t.match(Fv)||t.match(Pv))?[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]:null}function Bv(t,e){var r=wi(t);if(r&&e){var n=ie(e).find(function(a){var i=wi(e[a].darkModeColor);return i&&i[0]==r[0]&&i[1]==r[1]&&i[2]==r[2]});if(n)return e[n].lightModeColor}return null}function La(t,e,r,n){return!!t&&t!="inherit"&&!!(t!=e||r||n&&t!=n)}var xv={parse:function(t,e,r,n){var a=Br(e,!0,!!r.isDarkMode,r.darkColorHandler)||n.backgroundColor;La(a,"transparent",void 0,n.backgroundColor)&&(t.backgroundColor=a)},apply:function(t,e,r){t.backgroundColor&&xr(e,t.backgroundColor,!0,!!r.isDarkMode,r.darkColorHandler)}},Hv={parse:function(t,e,r,n){var a=e.style.fontWeight||n.fontWeight;La(a,"400",t.fontWeight,n.fontWeight)&&(t.fontWeight=a)},apply:function(t,e,r){if(!(typeof t.fontWeight>"u")){var n=r.implicitFormat.fontWeight;(n&&n!=t.fontWeight||!n&&t.fontWeight&&t.fontWeight!="normal")&&(t.fontWeight=="bold"?vr(e,"b"):e.style.fontWeight=t.fontWeight||"normal")}}},zv={parse:function(t,e){var r;((r=e.style)===null||r===void 0?void 0:r.boxSizing)=="border-box"&&(t.useBorderBox=!0)},apply:function(t,e){t.useBorderBox&&(e.style.boxSizing="border-box")}},_n=["borderTop","borderRight","borderBottom","borderLeft"],Ho=["borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth"],Cu=["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"],Uv=_n.concat(Cu),Gv={parse:function(t,e,r,n){_n.forEach(function(i,o){var s,l=e.style[i],u=(s=n[Ho[o]])!==null&&s!==void 0?s:"0px",d=e.style[Ho[o]];d=="0"&&(d="0px"),l&&d!=u&&(t[i]=l=="none"?"":l)});var a=e.style.borderRadius;a?t.borderRadius=a:Cu.forEach(function(i){var o=e.style[i];o&&(t[i]=o)})},apply:function(t,e){Uv.forEach(function(r){var n=t[r];n&&(e.style[r]=n)}),t.borderRadius&&(e.style.borderRadius=t.borderRadius)}},Kv={parse:function(t,e){var r;!((r=e.style)===null||r===void 0)&&r.boxShadow&&(t.boxShadow=e.style.boxShadow)},apply:function(t,e){t.boxShadow&&(e.style.boxShadow=t.boxShadow)}},Wv={parse:function(t,e){var r=e.dataset;ie(r).forEach(function(n){t[n]=r[n]||""})},apply:function(t,e){ie(t).forEach(function(r){e.dataset[r]=t[r]})}},Ra={parse:function(t,e,r,n){var a=e.style.direction||e.dir||n.direction;a&&(t.direction=a=="rtl"?"rtl":"ltr")},apply:function(t,e){t.direction&&(e.style.direction=t.direction),t.direction=="rtl"&&re(e,"table")&&(e.style.justifySelf="flex-end")}},Vv={parse:function(t,e){var r=e.style.display;r&&(t.display=r)},apply:function(t,e){t.display&&(e.style.display=t.display)}},jv={parse:function(t,e){Object.assign(t,hr(e))},apply:function(t,e){t.isFakeEntity||(e.className=fu(t)),t.isReadonly?e.contentEditable="false":e.removeAttribute("contenteditable")}},qv={parse:function(t,e){var r=e.style.float||e.getAttribute("align");r&&(t.float=r)},apply:function(t,e){t.float&&(e.style.float=t.float)}},Xv={parse:function(t,e,r,n){var a=e.style.fontFamily||n.fontFamily;a&&a!="inherit"&&(t.fontFamily=a)},apply:function(t,e,r){t.fontFamily&&t.fontFamily!=r.implicitFormat.fontFamily&&(e.style.fontFamily=t.fontFamily)}},Yv={parse:function(t,e,r,n){var a=e.style.verticalAlign||n.verticalAlign,i=e.style.fontSize||n.fontSize;Su(i,a)&&(t.superOrSubScriptSequence=(t.superOrSubScriptSequence||"").split(" ").concat(a).join(" ").trim())},apply:function(t,e){t.superOrSubScriptSequence&&t.superOrSubScriptSequence.split(" ").reverse().forEach(function(r){var n=r=="super"?"sup":r=="sub"?"sub":null;n&&vr(e,n)})}};function Su(t,e){return t=="smaller"&&(e=="sub"||e=="super")}var Zv={parse:function(t,e,r,n){var a=e.style.fontSize||n.fontSize,i=e.style.verticalAlign||n.verticalAlign;a&&!Su(a,i)&&a!="inherit"&&(e.style.fontSize?t.fontSize=Qv(a,r.segmentFormat.fontSize,r):n.fontSize&&(t.fontSize=a))},apply:function(t,e,r){t.fontSize&&t.fontSize!=r.implicitFormat.fontSize&&(e.style.fontSize=t.fontSize)}},Jv={"xx-small":"6.75pt","x-small":"7.5pt",small:"9.75pt",medium:"12pt",large:"13.5pt","x-large":"18pt","xx-large":"24pt","xxx-large":"36pt"};function Qv(t,e,r){var n=Jv[t],a=t.endsWith("rem");if(n)return n;if(t=="smaller"||t=="larger"||t.endsWith("em")||t.endsWith("%")||a){if(!e&&!a)return;var i=a?r.rootFontSize:Je(e);if(i)switch(t){case"smaller":return Math.round(i*500/6)/100+"px";case"larger":return Math.round(i*600/5)/100+"px";default:return Je(t,i,"px")+"px"}}else return t=="inherit"||t=="revert"||t=="unset"?void 0:t}var Tu={start:{ltr:"left",rtl:"right"},center:{ltr:"center",rtl:"center"},end:{ltr:"right",rtl:"left"},initial:{ltr:"initial",rtl:"initial"},justify:{ltr:"justify",rtl:"justify"}};function wu(t,e){switch(t){case"center":return"center";case"left":return e=="rtl"?"end":"start";case"right":return e=="rtl"?"start":"end";case"start":case"end":return t;case"justify":case"initial":return t;default:return}}var $v={parse:function(t,e,r,n){if(!e.style.textAlign){Ra.parse(t,e,r,n);var a=e.getAttribute("align");a&&(t.htmlAlign=wu(a,t.direction),delete t.textAlign,delete r.blockFormat.textAlign)}},apply:function(t,e){var r=t.direction=="rtl"?"rtl":"ltr";t.htmlAlign&&e.setAttribute("align",Tu[t.htmlAlign][r])}},eh={parse:function(t,e){e.id&&(t.id=e.id)},apply:function(t,e){t.id&&(e.id=t.id)}};function th(t){return Zi(t,"imageState")}function rh(t,e){Ji(t,"imageState",e)}var nh={parse:function(t,e){var r=th(e);r&&(t.imageState=r)},apply:function(t,e){t.imageState&&rh(e,t.imageState)}},ah={parse:function(t,e,r,n){var a=e.style.fontStyle||n.fontStyle;a=="italic"||a=="oblique"?t.italic=!0:(a=="initial"||a=="normal")&&(t.italic=!1)},apply:function(t,e,r){if(!(typeof t.italic>"u")){var n=r.implicitFormat.italic;!!n!=!!t.italic&&(t.italic?vr(e,"i"):e.style.fontStyle="normal")}}},ih={parse:function(t,e,r,n){var a=e.style.letterSpacing||n.letterSpacing;La(a,"normal",t.letterSpacing,n.letterSpacing)&&(t.letterSpacing=a)},apply:function(t,e){t.letterSpacing&&(e.style.letterSpacing=t.letterSpacing)}},oh={parse:function(t,e,r,n){var a=e.style.lineHeight||n.lineHeight;a&&a!="inherit"&&(t.lineHeight=a)},apply:function(t,e){t.lineHeight&&(e.style.lineHeight=t.lineHeight)}},lh={parse:function(t,e){if(re(e,"a")){var r=e.name,n=e.getAttribute("href"),a=e.target,i=e.rel,o=e.id,s=e.className,l=e.title;r&&(t.name=r),n&&(t.href=n),a&&(t.target=a),o&&(t.anchorId=o),i&&(t.relationship=i),l&&(t.anchorTitle=l),s&&(t.anchorClass=s)}},apply:function(t,e){re(e,"a")&&(t.href||t.name)&&(t.href&&(e.href=t.href),t.name&&(e.name=t.name),t.target&&(e.target=t.target),t.anchorId&&(e.id=t.anchorId),t.anchorClass&&(e.className=t.anchorClass),t.anchorTitle&&(e.title=t.anchorTitle),t.relationship&&(e.rel=t.relationship))}},sh={parse:function(t,e,r,n){var a=r.listFormat,i=a.levels.length,o=e.style.display||n.display;o&&o!="list-item"?t.displayForDummyItem=o:zo(e)&&i>0&&(a.threadItemCounts[i-1]++,a.threadItemCounts.splice(i),a.levels.forEach(function(s){delete s.format.startNumberOverride}))},apply:function(t,e,r){var n;if(t.displayForDummyItem)e.style.display=t.displayForDummyItem;else if(zo(e)){var a=r.listFormat,i=a.threadItemCounts,o=a.nodeStack.length-2;o>=0&&(i.splice(o+1),i[o]=((n=i[o])!==null&&n!==void 0?n:0)+1)}}};function zo(t){return re(t,"li")&&F(t.parentNode,"ELEMENT_NODE")&&re(t.parentNode,"ol")}var uh={parse:function(t,e,r){if(re(e,"ol")){var n=r.listFormat,a=n.threadItemCounts,i=n.levels,o=i.length;(e.start==1||typeof a[o]=="number"&&e.start!=a[o]+1)&&(t.startNumberOverride=e.start),a[o]=e.start-1}},apply:function(t,e,r){var n=r.listFormat,a=n.threadItemCounts,i=n.nodeStack,o=i.length-2;if(o>=0&&re(e,"ol")){var s=t.startNumberOverride;typeof s=="number"?a[o]=s-1:typeof a[o]!="number"&&(a[o]=0),a.splice(o+1),e.start=a[o]+1}}},dh={parse:function(t,e){var r=e.style.listStylePosition,n=e.style.listStyleType;r&&(t.listStylePosition=r),n&&(t.listStyleType=n)},apply:function(t,e){t.listStylePosition&&(e.style.listStylePosition=t.listStylePosition),t.listStyleType&&(e.style.listStyleType=t.listStyleType)}},Uo=["marginTop","marginRight","marginBottom","marginLeft"],fh={ltr:{marginRight:"marginInlineEnd",marginLeft:"marginInlineStart"},rtl:{marginRight:"marginInlineStart",marginLeft:"marginInlineEnd"}},ch={marginLeft:"marginRight",marginRight:"marginLeft",marginTop:"marginTop",marginBottom:"marginBottom"},vh={parse:function(t,e,r,n){Uo.forEach(function(a){var i,o,s=fh[(i=t.direction)!==null&&i!==void 0?i:"ltr"][a],l=e.style[a]||n[a]||(s?(o=n[s])===null||o===void 0?void 0:o.toString():"");if(l)switch(a){case"marginTop":case"marginBottom":t[a]=l;break;case"marginLeft":case"marginRight":t[a]=t[a]?Je(t[a]||"",e)+Je(l,e)+"px":l;break}})},apply:function(t,e,r){Uo.forEach(function(n){var a=t[n],i=t.direction=="rtl"?ch[n]:n;a!=r.implicitFormat[i]&&(e.style[n]=a||"0")})}},Go=["paddingTop","paddingRight","paddingBottom","paddingLeft"],hh={paddingLeft:"paddingInlineStart"},ph={paddingRight:"paddingInlineStart"},gh={parse:function(t,e,r,n){Ra.parse(t,e,r,n),Go.forEach(function(a){var i,o,s=e.style[a],l=(t.direction=="rtl"?ph:hh)[a],u=((o=(i=n[a])!==null&&i!==void 0?i:l?n[l]:void 0)!==null&&o!==void 0?o:"0px")+"";s||(s=u),(!s||s=="0")&&(s="0px"),s&&s!=u&&(t[a]=s)})},apply:function(t,e,r){Go.forEach(function(n){var a=t[n],i=void 0;(e.tagName=="OL"||e.tagName=="UL")&&(t.direction=="rtl"&&n=="paddingRight"||t.direction!="rtl"&&n=="paddingLeft")&&(i="40px"),a&&a!=i&&(e.style[n]=a)})}},mh={parse:function(t,e){var r=e.getAttribute("role");r&&(t.role=r)},apply:function(t,e){t.role&&e.setAttribute("role",t.role)}},bh=/[\d\.]+%/,yh={parse:function(t,e,r){var n=e.style.width||Ko(e,"width"),a=e.style.height||Ko(e,"height"),i=e.style.maxWidth,o=e.style.maxHeight,s=e.style.minWidth,l=e.style.minHeight;n&&(t.width=n),a&&(t.height=a),i&&(t.maxWidth=i),o&&(t.maxHeight=o),s&&(t.minWidth=s),l&&(t.minHeight=l)},apply:function(t,e){t.width&&(e.style.width=t.width),t.height&&(e.style.height=t.height),t.maxWidth&&(e.style.maxWidth=t.maxWidth),t.maxHeight&&(e.style.maxHeight=t.maxHeight),t.minWidth&&(e.style.minWidth=t.minWidth),t.minHeight&&(e.style.minHeight=t.minHeight)}};function Ko(t,e){var r=t.getAttribute(e),n=parseInt(r||"");return r&&bh.test(r)?r:Number.isNaN(n)||n==0?void 0:n+"px"}var Eh={parse:function(t,e,r,n){var a=e.style.textDecoration||n.textDecoration;a?.indexOf("line-through")>=0&&(t.strikethrough=!0)},apply:function(t,e){t.strikethrough&&vr(e,"s")}},Ch={parse:function(t,e){var r=e.style.tableLayout;r&&r!="inherit"&&(t.tableLayout=r)},apply:function(t,e){t.tableLayout&&(e.style.tableLayout=t.tableLayout)}},Wo="collapse",Vo="separate",Sh="cellPadding",Th={parse:function(t,e){if(e.style.borderCollapse==Wo)t.borderCollapse=!0;else{var r=e.getAttribute(Sh);r&&(t.borderCollapse=!0)}e.style.borderCollapse==Vo&&(t.borderSeparate=!0)},apply:function(t,e){t.borderCollapse?(e.style.borderCollapse=Wo,e.style.borderSpacing="0",e.style.boxSizing="border-box"):t.borderSeparate&&(e.style.borderCollapse=Vo,e.style.borderSpacing="0",e.style.boxSizing="border-box")}},wh={parse:function(t,e,r,n){var a;Ra.parse(t,e,r,n);var i=e.style.textAlign||n.textAlign;e.tagName=="LI"&&((a=e.parentElement)===null||a===void 0?void 0:a.style.display)==="flex"&&e.parentElement.style.flexDirection==="column"&&e.style.alignSelf&&(i=e.style.alignSelf),i&&(t.textAlign=wu(i,t.direction))},apply:function(t,e){var r=t.direction=="rtl"?"rtl":"ltr";if(t.textAlign){var n=e.parentElement,a=n?.tagName;e.tagName=="LI"&&n&&(a=="OL"||a=="UL")?(e.style.alignSelf=t.textAlign,e.parentElement.style.flexDirection="column",e.parentElement.style.display="flex"):e.style.textAlign=Tu[t.textAlign][r]}}},kh={parse:function(t,e,r,n){var a=Br(e,!1,!!r.isDarkMode,r.darkColorHandler)||n.color;a&&a!="inherit"&&(t.textColor=a)},apply:function(t,e,r){var n=r.implicitFormat.textColor;t.textColor&&t.textColor!=n&&xr(e,t.textColor,!1,!!r.isDarkMode,r.darkColorHandler)}},_h={parse:function(t,e){e.style.color&&delete t.textColor},apply:function(){}},Dh={parse:function(t,e){var r=e.style.textIndent;r&&(t.textIndent=r)},apply:function(t,e){t.textIndent&&(e.style.textIndent=t.textIndent)}},Mh={parse:function(t,e){re(e,"a")&&vu(e)&&(t.undeletable=!0)},apply:function(t,e){t.undeletable&&re(e,"a")&&Kc(e,!0)}},Oh={parse:function(t,e,r,n){var a=e.style.textDecoration||n.textDecoration;a?.indexOf("underline")>=0?t.underline=!0:e.tagName=="A"&&a=="none"&&(t.underline=!1)},apply:function(t,e,r){if(!(typeof t.underline>"u")){var n=r.implicitFormat.underline;!!n!=!!t.underline&&(t.underline?vr(e,"u"):e.style.textDecoration="none")}}},Lh={parse:function(t,e){var r=e.style.verticalAlign||e.getAttribute("valign");switch(r){case"baseline":case"initial":case"super":case"sub":case"text-top":case"text-bottom":case"top":t.verticalAlign="top";break;case"bottom":t.verticalAlign="bottom";break;case"middle":t.verticalAlign="middle";break}},apply:function(t,e){t.verticalAlign&&(e.style.verticalAlign=t.verticalAlign)}},Rh={parse:function(t,e,r,n){var a=e.style.whiteSpace||n.whiteSpace;La(a,"normal",t.whiteSpace,n.whiteSpace)&&(t.whiteSpace=a)},apply:function(t,e,r){var n=r.implicitFormat.whiteSpace;t.whiteSpace!=n&&(e.style.whiteSpace=t.whiteSpace||"normal")}},Fh={parse:function(t,e,r,n){var a=e.style.wordBreak||n.wordBreak;a&&(t.wordBreak=a)},apply:function(t,e){t.wordBreak&&(e.style.wordBreak=t.wordBreak)}},ua={aria:Mv,backgroundColor:xv,bold:Hv,border:Gv,borderBox:zv,boxShadow:Kv,dataset:Wv,direction:Ra,display:Vv,float:qv,fontFamily:Xv,fontSize:Zv,entity:jv,htmlAlign:$v,id:eh,imageState:nh,italic:ah,letterSpacing:ih,lineHeight:oh,link:lh,listItemThread:sh,listLevelThread:uh,listStyle:dh,margin:vh,padding:gh,role:mh,size:yh,strike:Eh,superOrSubScript:Yv,tableLayout:Ch,tableSpacing:Th,textAlign:wh,textColor:kh,textColorOnTableCell:_h,textIndent:Dh,undeletableLink:Mh,underline:Oh,verticalAlign:Lh,whiteSpace:Rh,wordBreak:Fh},Nn=["letterSpacing","fontFamily","fontSize"],In=["strike","underline","superOrSubScript","italic","bold"],Wa=["direction","textAlign","textIndent","lineHeight","whiteSpace"],jo=["backgroundColor","margin","padding","border"],da={block:Wa,listItemThread:["listItemThread"],listLevelThread:["listLevelThread"],listItemElement:I(I([],L(Wa),!1),["direction","textAlign","lineHeight","margin","listStyle"],!1),listLevel:["direction","textAlign","margin","padding","listStyle","backgroundColor"],styleBasedSegment:I(I([],L(Nn),!1),["textColor","backgroundColor","lineHeight"],!1),elementBasedSegment:In,segment:I(I(I([],L(Nn),!1),L(In),!1),["textColor","backgroundColor","lineHeight"],!1),segmentOnBlock:I(I(I([],L(Nn),!1),L(In),!1),["textColor"],!1),segmentOnTableCell:I(I(I([],L(Nn),!1),L(In),!1),["textColorOnTableCell"],!1),tableCell:["border","backgroundColor","padding","verticalAlign","wordBreak","textColor","htmlAlign","size"],tableRow:["backgroundColor"],tableColumn:["size"],table:["aria","id","border","backgroundColor","display","htmlAlign","margin","size","tableLayout","textColor","direction","role"],tableBorder:["borderBox","tableSpacing"],tableCellBorder:["borderBox"],image:["id","size","margin","padding","borderBox","border","boxShadow","display","float","verticalAlign","imageState"],link:["link","textColor","underline","display","margin","padding","backgroundColor","border","size","textAlign","undeletableLink"],segmentUnderLink:["textColor"],code:["fontFamily","display"],dataset:["dataset"],divider:I(I(I([],L(Wa),!1),L(jo),!1),["display","size","htmlAlign"],!1),container:I(I([],L(jo),!1),["htmlAlign","size","display","id"],!1),entity:["entity"],general:["textColor","backgroundColor"]},ku=ie(ua).reduce(function(t,e){return t[e]=ua[e].parse,t},{}),_u=ie(ua).reduce(function(t,e){return t[e]=ua[e].apply,t},{});function Fa(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return $i(Du(e),t)}function $i(t,e){return Object.assign({},e,Ph(),Ah(),Nh(),t)}function Ph(){return{regularSelection:{current:{block:null,segment:null}}}}function Ah(){return{listFormat:{threadItemCounts:[],nodeStack:[]},implicitFormat:{}}}function Nh(){return{rewriteFromModel:{addedBlockElements:[],removedBlockElements:[]}}}function Du(t){return{modelHandlers:Object.assign.apply(Object,I([{},xo],L(t.map(function(e){return e?.modelHandlerOverride})),!1)),formatAppliers:Ih(t.map(function(e){return e?.formatApplierOverride}),t.map(function(e){return e?.additionalFormatAppliers})),defaultModelHandlers:xo,defaultFormatAppliers:_u,metadataAppliers:Object.assign.apply(Object,I([{}],L(t.map(function(e){return e?.metadataAppliers})),!1)),defaultContentModelFormatMap:Object.assign.apply(Object,I([{},$c],L(t.map(function(e){return e?.defaultContentModelFormatOverride})),!1))}}function Ih(t,e){t===void 0&&(t=[]),e===void 0&&(e=[]);var r=Object.assign.apply(Object,I([{}],L(t),!1)),n=ie(da).reduce(function(a,i){var o,s=(o=da[i].map(function(l){return r[l]===void 0?_u[l]:r[l]})).concat.apply(o,I([],L(e.map(function(l){var u;return(u=l?.[i])!==null&&u!==void 0?u:[]})),!1));return a[i]=s,a},{text:[]});return e.forEach(function(a){a?.text&&(n.text=n.text.concat(a.text))}),n}var Bh=function(t,e,r){var n,a=qt(r.segmentFormat),i=L(Cn(r,e),2),o=i[0],s=i[1];o>=0&&(r.isInSelection=!0),r.isInSelection&&(a.isSelected=!0);var l=ht(t,a,r.blockFormat);s>=0&&(r.isInSelection=!1),(n=r.domIndexer)===null||n===void 0||n.onSegment(e,l,[a])},Mu=["marginLeft","marginRight","paddingLeft","paddingRight"],rn=function(t,e,r){Oe(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},function(){U(e,r.formatParsers.block,r.blockFormat,r),U(e,r.formatParsers.segmentOnBlock,r.segmentFormat,r);var n=C({},r.blockFormat);U(e,r.formatParsers.container,n,r);var a=_a(e).display=="block"?e.tagName.toLowerCase():"div",i=Qi(a,n);if(Mu.forEach(function(s){delete r.blockFormat[s]}),r.elementProcessors.child(i,e,r),e.style.fontSize&&parseInt(e.style.fontSize)==0&&(i.zeroFontSize=!0),xh(i)){var o=i.blocks[0];i.zeroFontSize&&(o.segmentFormat=Object.assign({},o.segmentFormat,{fontSize:"0"})),Object.assign(o.format,i.format),et(o),Ke(t,o)}else Ke(t,i)}),Ke(t,je(!0,r.blockFormat))};function xh(t){var e=t.blocks[0];return t.tagName=="div"&&t.blocks.length==1&&e.blockType=="Paragraph"&&e.isImplicit}var Hh=["A","CODE"];function eo(t,e,r,n){var a,i=r.blockDecorator.tagName?r.blockDecorator:void 0,o=Hh.indexOf(e.tagName)>=0;U(e,r.formatParsers.block,r.blockFormat,r);var s=C({},r.blockFormat);if(U(e,r.formatParsers.container,s,r),Mu.forEach(function(u){s[u]&&(r.blockFormat[u]=s[u])}),!o){var l=je(!1,s,n,i);(a=r.paragraphMap)===null||a===void 0||a.assignMarkerToModel(e,l),Ke(t,l)}r.elementProcessors.child(t,e,r)}var zh=["marginBottom","marginTop","paddingBottom","paddingTop","paddingLeft","paddingRight","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth","width","height","maxWidth","maxHeight","minWidth","minHeight"],Uh=["id"],Gh=["H1","H2","H3","H4","H5","H6","P","A"],Kh=["A","CODE"],xe=function(t,e,r){var n=Xt(e);if((n||e.style.display=="inline-block")&&Wh(e))rn(t,e,r);else if(wn(e))r.elementProcessors.child(t,e,r);else if(n){var a=r.blockDecorator.tagName?r.blockDecorator:void 0,i=Kh.indexOf(e.tagName)>=0;Oe(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},function(){var o={};U(e,r.formatParsers.segmentOnBlock,o,r),Object.assign(r.segmentFormat,o),eo(t,e,r,o)}),n&&!i&&Ke(t,je(!0,r.blockFormat,void 0,a))}else Oe(r,{segment:"shallowClone",paragraph:"shallowClone",link:"cloneFormat"},function(){U(e,r.formatParsers.segment,r.segmentFormat,r),r.link.format.href&&e.tagName!="A"&&U(e,r.formatParsers.segmentUnderLink,r.link.format,r),r.elementProcessors.child(t,e,r)})};function Wh(t,e){if(Gh.indexOf(t.tagName)>=0)return!1;var r=t.style,n=_a(t),a=r.getPropertyValue("background-color");return!!(a&&a!="transparent"||zh.some(function(i){return parseInt(r[i]||n[i]||"")>0})||Uh.some(function(i){return t.hasAttribute(i)})||r.marginLeft=="auto"||r.marginRight=="auto"||t.getAttribute("align"))}var Vh=function(t,e,r){Oe(r,{code:"codeDefault"},function(){U(e,r.formatParsers.code,r.code.format,r),xe(t,e,r)})},jh=function(t,e,r){var n,a,i=((n=r.selection)===null||n===void 0?void 0:n.type)=="range"?r.selection.range:null;i&&(e.contains(i.startContainer)&&(r.isInSelection=!0,Nr(t,r)),((a=r.selection)===null||a===void 0?void 0:a.type)=="range"&&e.contains(i.endContainer)&&(r.selection.range.collapsed||Nr(t,r),r.isInSelection=!1))},qh=function(t,e,r){var n=e.tagName.toLowerCase(),a=Xh(e,r)||Yh(e,r)||r.elementProcessors[n]||n.indexOf(":")>=0&&r.elementProcessors.child||r.elementProcessors["*"];a(t,e,r)};function Xh(t,e){return Ct(t)||t.contentEditable=="false"?e.elementProcessors.entity:null}function Yh(t,e){return Ut(t)?e.elementProcessors.delimiter:null}var Qr=["10px","13px","16px","18px","24px","32px","48px"];function Zh(t){var e=parseInt(t||"");if(!Number.isNaN(e))return e<1?Qr[0]:e>Qr.length?Qr[Qr.length-1]:Qr[e-1]}var Jh=function(t,e,r){Oe(r,{segment:Xt(e)?"shallowCloneForBlock":"shallowClone"},function(){var n=e.getAttribute("face"),a=Zh(e.getAttribute("size")),i=e.getAttribute("color"),o=r.segmentFormat;n&&(o.fontFamily=n),a&&(o.fontSize=a),i&&(o.textColor=i),U(e,r.formatParsers.segment,r.segmentFormat,r),r.elementProcessors.child(t,e,r)})},Qh=function(t,e,r){var n=jc(e),a=r.isInSelection;Oe(r,{segment:"empty",paragraph:"empty",link:"empty"},function(){Ke(t,n),U(e,r.formatParsers.general,n.format,r),r.elementProcessors.child(n,e,r)}),a&&r.isInSelection&&(n.isSelected=!0)},$h=function(t,e,r){var n,a=Vc(e,r.segmentFormat),i=r.isInSelection;ka(a,r);var o=ht(t,a);(n=r.domIndexer)===null||n===void 0||n.onSegment(e,o,[a]),Oe(r,{segment:"empty"},function(){U(e,r.formatParsers.general,a.format,r),r.elementProcessors.child(a,e,r)}),i&&r.isInSelection&&(a.isSelected=!0)},ep=function(t,e,r){var n=Xt(e)?Qh:$h;n(t,e,r)},Cr=function(t,e,r){Oe(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone",blockDecorator:"empty"},function(){var n={};U(e,r.formatParsers.segmentOnBlock,n,r),ie(n).forEach(function(a){delete r.segmentFormat[a]}),r.blockDecorator=hu(e.tagName,n),eo(t,e,r)}),Ke(t,je(!0,r.blockFormat))},tp=function(t,e,r){Oe(r,{paragraph:"shallowClone"},function(){U(e,r.formatParsers.divider,r.blockFormat,r);var n=qc("hr",r.blockFormat);e.size&&(n.size=e.size),r.isInSelection&&(n.isSelected=!0),Ke(t,n)})},rp=function(t,e,r){Oe(r,{segment:"shallowClone"},function(){var n,a,i,o=r.segmentFormat,s=(n=e.getAttribute("src"))!==null&&n!==void 0?n:"";U(e,r.formatParsers.segment,o,r),U(e,r.formatParsers.image,o,r),U(e,r.formatParsers.block,r.blockFormat,r);var l=Wc(s,o),u=e.alt,d=e.title;U(e,r.formatParsers.dataset,l.dataset,r),ka(l,r),u&&(l.alt=u),d&&(l.title=d),r.isInSelection&&(l.isSelected=!0),((a=r.selection)===null||a===void 0?void 0:a.type)=="image"&&r.selection.image==e&&(l.isSelectedAsImageSelection=!0,l.isSelected=!0);var f=ht(t,l);(i=r.domIndexer)===null||i===void 0||i.onSegment(e,f,[l])})},np=function(t,e,r){var n=e.getAttribute("name"),a=e.getAttribute("href");if(n||a){var i=!!n&&!a,o={link:i?"empty":"linkDefault"};Oe(r,o,function(){if(U(e,r.formatParsers.link,r.link.format,r),U(e,r.formatParsers.dataset,r.link.dataset,r),i&&!e.firstChild){var s=We("",r.segmentFormat,{dataset:r.link.dataset,format:r.link.format});r.isInSelection&&(s.isSelected=!0),ht(t,s)}else xe(t,e,r)})}else xe(t,e,r)},ap=function(t,e,r){var n,a=r.listFormat;if(a.listParent&&a.levels.length>0)Oe(r,{segment:"shallowCloneForBlock"},function(){U(e,r.formatParsers.segmentOnBlock,r.segmentFormat,r);var s=kn(a.levels,r.segmentFormat);U(e,r.formatParsers.listItemElement,s.format,r),a.listParent.blocks.push(s),U(e,r.formatParsers.listItemThread,s.levels[s.levels.length-1].format,r),r.elementProcessors.child(s,e,r);var l=s.blocks[0];s.blocks.length==1&&l.blockType=="Paragraph"&&l.isImplicit&&(Object.assign(s.format,l.format),l.format={})});else{var i=(n=a.listParent)===null||n===void 0?void 0:n.blocks,o=i?.[i?.length-1];r.elementProcessors["*"](o?.blockType=="BlockGroup"?o:t,e,r)}},qo=function(t,e,r){Oe(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},function(){var n=gr(e.tagName,r.blockFormat),a=r.listFormat;U(e,r.formatParsers.dataset,n.dataset,r),U(e,r.formatParsers.listLevelThread,n.format,r),U(e,r.formatParsers.listLevel,n.format,r),U(e,r.formatParsers.segment,r.segmentFormat,r);var i=a.listParent;a.listParent=a.listParent||t,a.levels.push(n);try{r.elementProcessors.child(t,e,r)}finally{a.levels.pop(),a.listParent=i}})},ip=function(t,e,r){Oe(r,{blockDecorator:"empty",segment:"shallowCloneForBlock",paragraph:"shallowClone"},function(){r.blockDecorator=hu(e.tagName);var n={};U(e,r.formatParsers.segmentOnBlock,n,r),Object.assign(r.segmentFormat,n),eo(t,e,r,n)}),Ke(t,je(!0,r.blockFormat))},op=function(t,e,r){r.formatParsers.text.length>0?Oe(r,{segment:"shallowClone"},function(){r.formatParsers.text.forEach(function(n){n(r.segmentFormat,e,r),Xo(t,e,r)})}):Xo(t,e,r)};function Xo(t,e,r){var n,a=wa(t,r.blockFormat),i=a.segments.length;r.elementProcessors.textWithSelection(t,e,r);var o=a.segments.slice(i);(n=r.domIndexer)===null||n===void 0||n.onSegment(e,a,o.filter(function(s){return s?.segmentType=="Text"}))}var lp=function(t,e,r){var n=e.nodeValue||"",a=Cn(r,e),i=a[0],o=a[1];if(i>=0){var s=n.substring(0,i);sn(t,s,r),r.isInSelection=!0,Nr(t,r,e,i),n=n.substring(i),o-=i}if(o>=0){var s=n.substring(0,o);sn(t,s,r),r.selection&&(r.selection.type!="range"||!r.selection.range.collapsed)&&Nr(t,r,e,a[1]),r.isInSelection=!1,n=n.substring(o)}sn(t,n,r)},Yo={a:np,b:xe,blockquote:xe,br:Bh,code:Vh,dd:rn,del:xe,div:xe,dl:rn,dt:rn,em:xe,font:Jh,i:xe,img:rp,h1:Cr,h2:Cr,h3:Cr,h4:Cr,h5:Cr,h6:Cr,hr:tp,li:ap,ol:qo,p:ip,pre:rn,s:xe,section:xe,span:xe,strike:xe,strong:xe,sub:xe,sup:xe,table:Rc,u:xe,ul:qo,"*":ep,"#text":op,textWithSelection:lp,element:qh,entity:wc,child:gc,delimiter:jh};function Dn(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return Mn(Ou(e),t)}function Mn(t,e){return Object.assign({},e,sp(),up(e?.isRootRtl),dp(),t)}function sp(){return{isInSelection:!1}}function up(t){var e=t?{direction:"rtl"}:{};return{blockFormat:e,segmentFormat:{},listFormat:{levels:[],threadItemCounts:[]}}}function dp(){return{link:{format:{},dataset:{}},code:{format:{}},blockDecorator:{format:{},tagName:""}}}function Ou(t){return{elementProcessors:Object.assign.apply(Object,I([{},Yo],L(t.map(function(e){return e?.processorOverride})),!1)),formatParsers:fp(t.map(function(e){return e?.formatParserOverride}),t.map(function(e){return e?.additionalFormatParsers})),defaultElementProcessors:Yo,defaultFormatParsers:ku,processNonVisibleElements:t.some(function(e){return!!e?.processNonVisibleElements})}}function fp(t,e){t===void 0&&(t=[]),e===void 0&&(e=[]);var r=Object.assign.apply(Object,I([{}],L(t),!1)),n=ie(da).reduce(function(a,i){var o,s=(o=da[i].map(function(l){return r[l]===void 0?ku[l]:r[l]})).concat.apply(o,I([],L(e.map(function(l){var u;return(u=l?.[i])!==null&&u!==void 0?u:[]})),!1));return a[i]=s,a},{text:[]});return e.forEach(function(a){a?.text&&(n.text=n.text.concat(a.text))}),n}function cp(t,e){var r,n,a=document.createElement("span"),i=We("text",t),o=Mn(e.domToModelSettings.calculated),s=$i(e.modelToDomSettings.calculated),l=Gr();s.modelHandlers.segment(a.ownerDocument,a,i,s,[]),o.elementProcessors.element(l,a,o);var u=wa(l);return(n=(r=u.segments[0])===null||r===void 0?void 0:r.format)!==null&&n!==void 0?n:t}var x={Min:1,Decimal:1,DecimalDash:2,DecimalParenthesis:3,DecimalDoubleParenthesis:4,LowerAlpha:5,LowerAlphaParenthesis:6,LowerAlphaDoubleParenthesis:7,LowerAlphaDash:8,UpperAlpha:9,UpperAlphaParenthesis:10,UpperAlphaDoubleParenthesis:11,UpperAlphaDash:12,LowerRoman:13,LowerRomanParenthesis:14,LowerRomanDoubleParenthesis:15,LowerRomanDash:16,UpperRoman:17,UpperRomanParenthesis:18,UpperRomanDoubleParenthesis:19,UpperRomanDash:20,Max:20},vp=65,Va={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};function to(t,e){switch(t){case x.LowerAlpha:case x.LowerAlphaDash:case x.LowerAlphaDoubleParenthesis:case x.LowerAlphaParenthesis:return Zo(e,!0);case x.UpperAlpha:case x.UpperAlphaDash:case x.UpperAlphaDoubleParenthesis:case x.UpperAlphaParenthesis:return Zo(e,!1);case x.LowerRoman:case x.LowerRomanDash:case x.LowerRomanDoubleParenthesis:case x.LowerRomanParenthesis:return Jo(e,!0);case x.UpperRoman:case x.UpperRomanDash:case x.UpperRomanDoubleParenthesis:case x.UpperRomanParenthesis:return Jo(e,!1);default:return e+""}}function Zo(t,e){var r="";for(t--;t>=0;)r=String.fromCharCode(t%26+vp)+r,t=Math.floor(t/26)-1;return e?r.toLowerCase():r}function Jo(t,e){var r,n,a="";try{for(var i=Wt(ie(Va)),o=i.next();!o.done;o=i.next()){var s=o.value,l=Math.floor(t/Va[s]);t=t-l*Va[s],a=a+s.repeat(l)}}catch(u){r={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return e?a.toLocaleLowerCase():a}var Se={Min:1,Disc:1,Dash:2,Square:3,ShortArrow:4,LongArrow:5,UnfilledArrow:6,Hyphen:7,DoubleLongArrow:8,Circle:9,BoxShadow:10,Xrhombus:11,CheckMark:12,Max:12},Qo=[x.Decimal,x.LowerAlpha,x.LowerRoman],$o=[Se.Disc,Se.Circle,Se.Square],hp={"lower-alpha":x.LowerAlpha,"lower-latin":x.LowerAlpha,"upper-alpha":x.UpperAlpha,"upper-latin":x.UpperAlpha,"lower-roman":x.LowerRoman,"upper-roman":x.UpperRoman},pp={disc:Se.Disc,circle:Se.Circle,square:Se.Square};function ro(t,e,r,n){var a=e.orderedStyleType,i=e.unorderedStyleType,o=e.applyListStyleFromLevel;return t=="OL"?typeof a=="number"?a:o?Qo[r%Qo.length]:n?hp[n]:void 0:typeof i=="number"?i:o?$o[r%$o.length]:n?pp[n]:void 0}function Lu(t){return!!t&&(t=="bold"||t=="bolder"||parseInt(t)>=600)}function gp(t,e){var r,n,a=t.createRange();return(n=(r=el(e,a))!==null&&r!==void 0?r:el(e=mp(e),a))!==null&&n!==void 0?n:bp(e.node)}function mp(t){for(var e=t.node,r=t.offset;e.lastChild;)r==e.childNodes.length?(e=e.lastChild,r=e.childNodes.length):(e=e.childNodes[r],r=0);return{node:e,offset:r}}function el(t,e){var r=t.node,n=t.offset;e.setStart(r,n),e.setEnd(r,n);var a=Le(e.getBoundingClientRect());if(a)return a;var i=e.getClientRects&&e.getClientRects();return i&&i.length==1?Le(i[0]):null}function bp(t){return F(t,"ELEMENT_NODE")&&t.getBoundingClientRect?Le(t.getBoundingClientRect()):null}var yp="Control",Ep="Alt",Cp="Meta",Sp=new Set(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"]);function Hr(t){var e=t.ctrlKey||t.key===yp,r=t.altKey||t.key===Ep,n=t.metaKey||t.key===Cp;return e||r||n}function Pa(t){return!Hr(t)&&!!t.key&&t.key.length==1}function no(t){return Sp.has(t.key)}var Tp=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"],wp=/^(thin|medium|thick|[\d\.]+\w*)$/;function Ru(t){var e={},r=(t||"").replace(/, /g,",").split(" ");return r.forEach(function(n){Tp.indexOf(n)>=0&&!e.style?e.style=n:wp.test(n)&&!e.width?e.width=n:n&&!e.color&&(e.color=n)}),e}function Fu(t){return[t.width||"",t.style||"",t.color||""].join(" ").trim()||"none"}var kp=/[\u2000\u2009\u200a​\u200b​\u202f\u205f​\u3000\s\t\r\n]/gm,_p='.,?!:"()[]\\/';function fa(t){return _p.indexOf(t)>=0}function ca(t){var e,r=(e=t?.charCodeAt(0))!==null&&e!==void 0?e:0;return r==160||r==32||kp.test(t)}function Pu(t,e){return t.replace(e?/^\u0020+/:/\u0020+$/," ")}function cn(t){var e=it(t.rows),r=e.map(function(n){return[]});return e.forEach(function(n,a){for(var i=0,o=0;i<n.cells.length;i++){for(;r[a][o]!==void 0;o++);for(var s=n.cells[i],l=0;l<s.colSpan;l++,o++)for(var u=0;u<s.rowSpan;u++)r[a+u]&&(r[a+u][o]=l==0?u==0?s:"spanTop":u==0?"spanLeft":"spanBoth")}for(var d=0;d<r[a].length;d++)r[a][d]=r[a][d]||null}),r}function Dp(t,e){try{if(t){var r=new FileReader;r.onload=function(){e(r.result)},r.onerror=function(){e(null)},r.readAsDataURL(t)}}catch{e(null)}}function va(t,e,r,n){var a=r=="lightToDark",i=function(o){var s=Br(o,!1,!a,n),l=Br(o,!0,!a,n);xr(o,s,!1,a,n),xr(o,l,!0,a,n)};Au(t,i,e)}function Au(t,e,r){r&&tl(t)&&e(t);for(var n=t.firstChild;n;n=n.nextSibling)tl(n)&&e(n),Au(n,e)}function tl(t){var e=t;return t.nodeType==Node.ELEMENT_NODE&&!!e.style}function Mp(t){for(var e=/(".*?")|('.*?')/g,r=e.exec(t),n=0,a=[];r;)rl(t,a,n,r.index),n=r.index+r[0].length,a.push(r[0]),r=e.exec(t);return rl(t,a,n,t.length),a.join(", ")}function rl(t,e,r,n){var a=t.substring(r,n).split(",");a.forEach(function(i){i=i.trim(),i&&(/[^a-zA-Z0-9\-]/.test(i)?e.push('"'+i+'"'):e.push(i))})}var ar,nl=(ar={},ar["text/html"]=function(t,e){return t.rawHtml=e},ar["text/plain"]=function(t,e){return t.text=e},ar["text/*"]=function(t,e,r){return!!r&&(t.customValues[r]=e)},ar["text/link-preview"]=Lp,ar["text/uri-list"]=function(t,e){return t.text=e},ar);function Op(t,e){var r={types:[],text:"",image:null,files:[],rawHtml:null,customValues:{},pasteNativeEvent:!0};return Promise.all((t||[]).map(function(n){var a=n.type;if(a.indexOf("image/")==0&&!r.image&&n.kind=="file")return r.types.push(a),r.image=n.getAsFile(),new Promise(function(s){r.image?Dp(r.image,function(l){r.imageDataUri=l,s()}):s()});if(n.kind=="file")return new Promise(function(s){var l=n.getAsFile();l&&(r.types.push(a),r.files.push(l)),s()});var i=Rp(a,e),o=nl[a]||(i?nl["text/*"]:null);return new Promise(function(s){return o?n.getAsString(function(l){r.types.push(a),o(r,l,i),s()}):s()})})).then(function(){return r})}function Lp(t,e){try{t.customValues["link-preview"]=e,t.linkPreview=JSON.parse(e)}catch{}}function Rp(t,e){var r=t.indexOf("text/")==0?t.substring(5):null,n=e&&r?e.indexOf(r):-1;return r&&n>=0?r:void 0}function Fp(t,e,r){var n=t.eventDataCache&&t.eventDataCache.hasOwnProperty(e)?t.eventDataCache[e]:r(t);return t.eventDataCache=t.eventDataCache||{},t.eventDataCache[e]=n,n}function Pp(t){return Zi(t,"paragraphMarker")}function Ap(t,e){Ji(t,"paragraphMarker",e)}var Np=["BR","HR","IMG"];function Ip(t,e,r,n,a){var i={text:r?e:e.toLowerCase(),matchCase:r,wholeWord:n,result:[],paragraphText:"",indexes:[],editableOnly:!0};return i.text&&Nu(t,i),i.result}function al(t){return Xt(t)||Np.indexOf(t.tagName)>=0}function Nu(t,e){for(var r=!e.editableOnly||t.isContentEditable,n=t.firstChild;n;n=n.nextSibling)if(F(n,"TEXT_NODE")&&r){var a=e.matchCase?n.nodeValue||"":(n.nodeValue||"").toLowerCase();a&&(e.paragraphText+=a,e.indexes.push({node:n,length:a.length}))}else F(n,"ELEMENT_NODE")&&(e.paragraphText&&al(n)&&il(t.ownerDocument,e),Nu(n,e));e.paragraphText&&al(t)&&il(t.ownerDocument,e)}function il(t,e){for(var r,n=0;(r=e.paragraphText.indexOf(e.text,n))>-1;){if(!e.wholeWord||(r==0||ol(e.paragraphText[r-1]))&&(r+e.text.length==e.paragraphText.length||ol(e.paragraphText[r+e.text.length]))){var a=ll(e.indexes,r,!1),i=ll(e.indexes,r+e.text.length,!0);if(a&&i){var o=t.createRange();o.setStart(a.node,a.offset),o.setEnd(i.node,i.offset),e.result.push(o)}}n=r+e.text.length}e.paragraphText="",e.indexes=[]}function ol(t){return ca(t)||fa(t)}function ll(t,e,r){for(var n=0,a=0;a<t.length;a++){var i=t[a].length;if(r?n+i>=e:n+i>e)return{node:t[a].node,offset:e-n};n+=i}return null}function St(t,e){var r=t;return r?.blockGroupType==e}function lt(t,e,r){var n=t.blockGroupType=="Document"?t.persistCache:!1,a=n?e:function(i,o,s,l){var u;return!((u=s)===null||u===void 0)&&u.cachedElement&&delete s.cachedElement,e(i,o,s,l)};nn([t],a,r)}function nn(t,e,r,n,a){for(var i=t[0],o=r?.includeListFormatHolder||"allSegments",s=r?.contentUnderSelectedTableCell||"include",l=r?.contentUnderSelectedGeneralElement||"contentOnly",u=!1,d=!1,f=0;f<i.blocks.length;f++){var v=i.blocks[f];switch(v.blockType){case"BlockGroup":var c=I([v],L(t),!1);if(v.blockGroupType=="General"){var h=a||v.isSelected,p=!h||l=="both"||l=="contentOnly",m=h&&(l=="both"||l=="generalElementOnly"||v.blocks.length==0);if(p&&nn(c,e,r,n,h)||m&&e(t,n,v))return!0}else if(nn(c,e,r,n,a))return!0;break;case"Table":var b=v.rows,y=b.every(function(J){return J.cells.every(function(z){return z.isSelected})});if(s!="include"&&y){if(e(t,n,v))return!0}else for(var E=0;E<b.length;E++)for(var S=b[E],T=0;T<S.cells.length;T++){var k=S.cells[T];if(k){var R={table:v,rowIndex:E,colIndex:T,isWholeTableSelected:y};if(k.isSelected&&e(t,R))return!0;if(!k.isSelected||s!="ignoreForTableOrCell"){var M=I([k],L(t),!1),h=a||k.isSelected;if(nn(M,e,r,R,h))return!0}}}break;case"Paragraph":for(var w=[],A=0;A<v.segments.length;A++){var N=v.segments[A],h=a||N.isSelected;if(N.segmentType=="General"){var p=!h||l=="both"||l=="contentOnly",m=h&&(l=="both"||l=="generalElementOnly"||N.blocks.length==0);if(p&&nn(I([N],L(t),!1),e,r,n,h))return!0;m&&w.push(N)}else h&&w.push(N);h?u=!0:d=!0}if(w.length>0&&e(t,n,v,w))return!0;break;case"Divider":case"Entity":if((a||v.isSelected)&&e(t,n,v))return!0;break}}return!!(o!="never"&&i.blockGroupType=="ListItem"&&u&&(!d||o=="anySegment")&&e(t,n,void 0,[i.formatHolder]))}function ot(t,e,r,n){r===void 0&&(r=[]);for(var a=0;a<t.length;a++){var i=t[a];if(e.indexOf(i.blockGroupType)>=0)return a;if(r.indexOf(i.blockGroupType)>=0)return-1}return-1}function On(t,e,r,n){var a=ao(t,{includeListFormatHolder:e?"allSegments":"never"}),i=[];return a.forEach(function(o){var s=o.segments,l=o.block,u=o.path;if(s)if(e&&!l&&s.length==1&&u[0].blockGroupType=="ListItem"&&s[0]==u[0].formatHolder){var d=u[0];n&&D(d),i.push([d.formatHolder,null,u])}else l?.blockType=="Paragraph"&&(n&&D(l),s.forEach(function(f){(r||f.segmentType!="Entity"||!f.entityFormat.isReadonly)&&i.push([f,l,u])}));else l?.blockType=="Entity"&&r&&i.push([l,null,u])}),i}function Bp(t,e,r){var n=On(t,e);return n.map(function(a){return a[0]})}function Ln(t,e,r,n,a){var i=[],o=[e],s=ao(t,{includeListFormatHolder:"never",contentUnderSelectedTableCell:"ignoreForTable"});return Iu(s),s.forEach(function(l){for(var u=l.path,d=l.block,f=function(h){var p=ot(u,o[h],r);if(p>=0)return i.filter(function(m){return m.block==u[p]}).length<=0&&i.push({parent:u[p+1],block:u[p],path:u.slice(p+1)}),"break";if(h==o.length-1&&d)return i.push({parent:u[0],block:d,path:u}),"break"},v=0;v<o.length;v++){var c=f(v);if(c==="break")break}}),i}function vn(t){var e=ao(t,{includeListFormatHolder:"never"}),r,n=[];return Iu(e),e.forEach(function(a){var i=a.block,o=a.tableContext,s=a.path;if(!r){if(i?.blockType=="Table")r=i,n=I([],L(s),!1);else if(o?.table){r=o.table;var l=s.filter(function(d){return d.blocks.indexOf(o.table)>=0})[0],u=s.indexOf(l);n=u>=0?s.slice(u):[]}}}),[r,n]}function xp(t){var e;return Ln(t,["ListItem"],["TableCell"]).forEach(function(r){!e&&St(r.block,"ListItem")&&(e=r.block)}),e}function ao(t,e){var r=[];return lt(t,function(n,a,i,o){r.push({path:n,tableContext:a,block:i,segments:o})},e),r}function Iu(t){t.length>1&&sl(t,!1)&&t.pop(),t.length>1&&sl(t,!0)&&t.shift()}function sl(t,e){var r,n=t[e?0:t.length-1];if(((r=n.block)===null||r===void 0?void 0:r.blockType)=="Paragraph"&&n.segments&&n.segments.length>0){var a=n.block.segments,i=n.segments[0];return n.segments.length==1&&i.segmentType=="SelectionMarker"&&i==a[e?a.length-1:0]}else return!1}function Hp(t){return t.isSelected||t.segmentType=="General"&&t.blocks.some(Aa)}function Aa(t){switch(t.blockType){case"Paragraph":return t.segments.some(Hp);case"Table":return t.rows.some(function(e){return e.cells.some(ha)});case"BlockGroup":return ha(t);case"Divider":case"Entity":return!!t.isSelected;default:return!1}}function ha(t){return!!(t.blockGroupType=="TableCell"&&t.isSelected||t.blocks.some(Aa))}function Tt(t){var e=-1,r=-1,n=-1,a=-1,i=!1;return t.rows.forEach(function(o,s){return o.cells.forEach(function(l,u){ha(l)&&(i=!0,e<0&&(e=s),r<0&&(r=u),n=Math.max(n,s),a=Math.max(a,u))})}),i?{firstRow:e,firstColumn:r,lastRow:n,lastColumn:a}:null}function Ot(t,e,r){hn(t,!1,e||null,r||null)}function hn(t,e,r,n){return ki(e,t,r,n,function(a){pu(t)&&Na(t,a)&&io(D(t),a);var i=[];t.blocks.forEach(function(l,u){a=zp(l,a,r,n),l.blockType=="Paragraph"&&l.segments.length==0&&l.isImplicit&&i.push(u)});var o;if(i.length>0)for(var s=D(t);(o=i.pop())!==void 0;)o>=0&&s.blocks.splice(o,1);return a})}function zp(t,e,r,n){switch(t.blockType){case"BlockGroup":return hn(t,e,r,n);case"Table":return Up(t,e,r,n);case"Divider":case"Entity":return ki(e,t,r,n,function(s){if(Na(t,s)){var l=D(t);s?l.isSelected=!0:delete l.isSelected}return s});case"Paragraph":var a=[];if(t.segments.forEach(function(s,l){e=ki(e,s,r,n,function(u){return Gp(t,s,u,a,r,n,l)})}),a.length>0)for(var i=D(t),o=void 0;(o=a.pop())!==void 0;)o>=0&&i.segments.splice(o,1);return e;default:return e}}function Up(t,e,r,n){var a=ul(t,r),i=n?ul(t,n):a;if(e)t.rows.forEach(function(f){return f.cells.forEach(function(v){var c=e;e=hn(v,e,r,n),c&&e&&(D(v).isSelected=!0)})});else for(var o=0;o<t.rows.length;o++)for(var s=t.rows[o],l=0;l<s.cells.length;l++){var u=t.rows[o].cells[l],d=o>=a.row&&o<=i.row&&l>=a.col&&l<=i.col;Na(u,d)&&io(D(u),d),d||hn(u,!1,r,n)}return e}function ul(t,e){var r=-1,n=e?t.rows.findIndex(function(a){return(r=a.cells.indexOf(e))>=0}):-1;return{row:n,col:r}}function Gp(t,e,r,n,a,i,o){switch(e.segmentType){case"SelectionMarker":return(!r||e!=a&&e!=i)&&n.push(o),r;case"General":return ja(t,e,r),e!=a&&e!=i?hn(e,r,a,i):r;case"Image":var s=a==e&&(!i||i==e);return ja(t,e,r,!e.isSelectedAsImageSelection!=!s?function(l){return l.isSelectedAsImageSelection=s}:void 0),r;default:return ja(t,e,r),r}}function ja(t,e,r,n){(n||Na(e,r))&&vt(t,e,function(a){io(a,r),n?.(a)})}function Na(t,e){return!t.isSelected!=!e}function io(t,e){return e?t.isSelected=!0:delete t.isSelected,e}function ki(t,e,r,n,a){return t=t||e==r,t=a(t),t&&!!n&&e!=n}function pn(t,e){var r=Fn(t,e||{});return t.format&&(r.format=Object.assign({},t.format)),r}function Kp(t,e){switch(t.blockType){case"BlockGroup":switch(t.blockGroupType){case"FormatContainer":return Yp(t,e);case"General":return xu(t,e);case"ListItem":return Zp(t,e)}break;case"Divider":return Qp(t,e);case"Entity":return Bu(t,e);case"Paragraph":return Vp(t,e);case"Table":return jp(t,e)}}function Wp(t,e){switch(t.segmentType){case"Br":return Kr(t);case"Entity":return Bu(t,e);case"General":return e0(t,e);case"Image":return $p(t);case"SelectionMarker":return Hu(t);case"Text":return t0(t)}}function Gt(t){return{format:Object.assign({},t.format)}}function Rn(t){return{dataset:Object.assign({},t.dataset)}}function mr(t){var e=t.blockType;return Object.assign({blockType:e},Gt(t))}function Fn(t,e){var r=t.blockGroupType,n=t.blocks;return{blockGroupType:r,blocks:n.map(function(a){return Kp(a,e)})}}function Kr(t){var e=t.segmentType,r=t.isSelected,n=t.code,a=t.link,i=Object.assign({segmentType:e,isSelected:r},Gt(t));return n&&(i.code=Gt(n)),a&&(i.link=Object.assign(Gt(a),Rn(a))),i}function Bu(t,e){var r=t.wrapper,n=t.entityFormat;return Object.assign({wrapper:Yt(r,"entity",e),entityFormat:C({},n)},mr(t),Kr(t))}function Vp(t,e){var r=t.cachedElement,n=t.segments,a=t.isImplicit,i=t.decorator,o=t.segmentFormat,s=Object.assign({cachedElement:Yt(r,"cache",e),isImplicit:a,segments:n.map(function(l){return Wp(l,e)}),segmentFormat:o?C({},o):void 0},mr(t),Gt(t));return i&&(s.decorator=Object.assign({tagName:i.tagName},Gt(i))),s}function jp(t,e){var r=t.cachedElement,n=t.widths,a=t.rows;return Object.assign({cachedElement:Yt(r,"cache",e),widths:Array.from(n),rows:a.map(function(i){return qp(i,e)})},mr(t),Rn(t))}function qp(t,e){var r=t.height,n=t.cells,a=t.cachedElement;return Object.assign({height:r,cachedElement:Yt(a,"cache",e),cells:n.map(function(i){return Xp(i,e)})},Gt(t))}function Xp(t,e){var r=t.cachedElement,n=t.isSelected,a=t.spanAbove,i=t.spanLeft,o=t.isHeader;return Object.assign({cachedElement:Yt(r,"cache",e),isSelected:n,spanAbove:a,spanLeft:i,isHeader:o},Fn(t,e),Gt(t),Rn(t))}function Yp(t,e){var r=t.tagName,n=t.cachedElement,a=Object.assign({tagName:r,cachedElement:Yt(n,"cache",e)},mr(t),Fn(t,e));return t.zeroFontSize&&(a.zeroFontSize=!0),a}function Zp(t,e){var r=t.formatHolder,n=t.levels,a=t.cachedElement;return Object.assign({formatHolder:Hu(r),levels:n.map(Jp),cachedElement:Yt(a,"cache",e)},mr(t),Fn(t,e))}function Jp(t){var e=t.listType;return Object.assign({listType:e},Gt(t),Rn(t))}function Qp(t,e){var r=t.tagName,n=t.isSelected,a=t.cachedElement;return Object.assign({isSelected:n,tagName:r,cachedElement:Yt(a,"cache",e)},mr(t))}function xu(t,e){var r=t.element;return Object.assign({element:Yt(r,"general",e)},mr(t),Fn(t,e))}function Hu(t){return Object.assign({isSelected:t.isSelected},Kr(t))}function $p(t){var e=t.src,r=t.alt,n=t.title,a=t.isSelectedAsImageSelection;return Object.assign({src:e,alt:r,title:n,isSelectedAsImageSelection:a},Kr(t),Rn(t))}function e0(t,e){return Object.assign(xu(t,e),Kr(t))}function t0(t){var e=t.text;return Object.assign({text:e},Kr(t))}function Yt(t,e,r){var n=r.includeCachedElement;if(t)if(n){if(n===!0)return t;var a=n(t,e);if((e=="general"||e=="entity")&&!a)throw new Error("Entity and General Model must has wrapper element");return a}else return e=="cache"?void 0:t.cloneNode(!0);else return}function pa(t,e,r,n,a){return{type:"number",isOptional:t,value:e,maxValue:n,minValue:r,allowNull:a}}function Ar(t,e,r){return{type:"boolean",isOptional:t,value:e,allowNull:r}}function zu(t,e,r){return{type:"string",isOptional:t,value:e,allowNull:r}}function Ia(t,e,r){return{type:"object",isOptional:e,propertyDef:t,allowNull:r}}var r0=Ia({bgColorOverride:Ar(!0),vAlignOverride:Ar(!0),borderOverride:Ar(!0)},!1,!0);function oo(t,e){return Ma(t,e,r0)}var Uu=20,Gu=80,Ku="#ffffff",Wu="#000000";function Vu(t,e,r,n){if(e){t.format.backgroundColor=e;var a=ju(e);a<Uu?t.format.textColor=Ku:a>Gu?t.format.textColor=Wu:delete t.format.textColor,a0(t)}else delete t.format.backgroundColor,delete t.format.textColor,n0(t)}function n0(t){t.blocks.forEach(function(e){var r,n;if(e.blockType=="Paragraph"){var a=D(e);!((r=a.segmentFormat)===null||r===void 0)&&r.textColor&&dl((n=a.segmentFormat)===null||n===void 0?void 0:n.textColor,t.format.backgroundColor||"")&&delete a.segmentFormat.textColor,a.segments.forEach(function(i){i.format.textColor&&dl(i.format.textColor,t.format.backgroundColor||"")&&delete i.format.textColor})}})}function a0(t){t.format.textColor&&t.blocks.forEach(function(e){var r;if(e.blockType=="Paragraph"){var n=D(e);!((r=n.segmentFormat)===null||r===void 0)&&r.textColor||(n.segmentFormat=C(C({},n.segmentFormat),{textColor:t.format.textColor})),n.segments.forEach(function(a){var i;!((i=a.format)===null||i===void 0)&&i.textColor||(a.format=C(C({},a.format),{textColor:t.format.textColor}))})}})}function dl(t,e){var r=ju(e);return[Ku,"rgb(255,255,255)"].indexOf(t)>-1&&(r>Gu||e=="")||[Wu,"rgb(0,0,0)"].indexOf(t)>-1&&(r<Uu||e=="")}function ju(t){var e=wi(t);if(e){var r=e[0]/255,n=e[1]/255,a=e[2]/255;return(Math.max(r,n,a)+Math.min(r,n,a))*50}else return 255}var ut={Min:0,Default:0,ListWithSideBorders:1,NoHeaderBorders:2,NoSideBorders:3,FirstColumnHeaderExternal:4,EspecialType1:5,EspecialType2:6,EspecialType3:7,Clear:8,Max:8},ir=zu(!1,void 0,!0),Bn=Ar(!1),qu=Ia({topBorderColor:ir,bottomBorderColor:ir,verticalBorderColor:ir,hasHeaderRow:Bn,headerRowColor:ir,hasFirstColumn:Bn,hasBandedColumns:Bn,hasBandedRows:Bn,bgColorEven:ir,bgColorOdd:ir,tableBorderFormat:pa(!1,void 0,ut.Min,ut.Max),verticalAlign:ir},!1,!0);function i0(t){return Da(t,qu)}function Xu(t,e){return Ma(t,e,qu)}var mt,o0={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:ut.Default,verticalAlign:null};function Ba(t,e,r){var n=D(t),a=n.rows;Xu(n,function(i){var o=C(C(C({},o0),i),e),s=l0(a,!r);return s0(a,o,s),u0(a,o),d0(a,o,s),o})}function l0(t,e){var r={bgColorOverrides:[],vAlignOverrides:[],borderOverrides:[]};return t.forEach(function(n){var a=[],i=[],o=[];r.bgColorOverrides.push(a),r.vAlignOverrides.push(i),r.borderOverrides.push(o),n.cells.forEach(function(s){oo(D(s),function(l){return l&&e?(a.push(!1),delete l.bgColorOverride):a.push(!!l?.bgColorOverride),i.push(!!l?.vAlignOverride),o.push(!!l?.borderOverride),l})})}),r}var fl=(mt={},mt[ut.Default]=function(t){return[!1,!1,!1,!1]},mt[ut.ListWithSideBorders]=function(t){var e=t.lastColumn,r=t.firstColumn;return[!1,!e,!1,!r]},mt[ut.FirstColumnHeaderExternal]=function(t){var e=t.firstColumn,r=t.firstRow,n=t.lastColumn,a=t.lastRow;return[!r,!n&&!e||e&&r,!a&&!r,!e]},mt[ut.NoHeaderBorders]=function(t){var e=t.firstRow,r=t.firstColumn,n=t.lastColumn;return[e,e||n,!1,e||r]},mt[ut.NoSideBorders]=function(t){var e=t.firstColumn,r=t.lastColumn;return[!1,r,!1,e]},mt[ut.EspecialType1]=function(t){var e=t.firstRow,r=t.firstColumn;return[r&&!e,e,r&&!e,e&&!r]},mt[ut.EspecialType2]=function(t){var e=t.firstRow,r=t.firstColumn;return[!e,e||!r,!e,!r]},mt[ut.EspecialType3]=function(t){var e=t.firstColumn,r=t.firstRow;return[!0,r||!e,!r,!0]},mt[ut.Clear]=function(){return[!0,!0,!0,!0]},mt);function s0(t,e,r){var n=e.hasBandedRows,a=e.hasBandedColumns,i=e.bgColorOdd,o=e.bgColorEven,s=e.hasFirstColumn;t.forEach(function(l,u){l.cells.forEach(function(d,f){var v,c=D(d);if(!r.borderOverrides[u][f]&&typeof e.tableBorderFormat=="number"){var h=(v=fl[e.tableBorderFormat])===null||v===void 0?void 0:v.call(fl,{firstRow:u===0,lastRow:u===t.length-1,firstColumn:f===0,lastColumn:f===l.cells.length-1}),p=[e.topBorderColor,e.verticalBorderColor,e.bottomBorderColor,e.verticalBorderColor];h?.forEach(function(b,y){var E=!b&&p[y]||"";c.format[_n[y]]=Fu({style:Yu(E),width:"1px",color:E})})}if(!r.bgColorOverrides[u][f]){var m=void 0;s&&f==0&&u>0?m=null:m=(n||a)&&(a&&f%2!=0||n&&u%2!=0)?i:o,Vu(c,m)}e.verticalAlign&&!r.vAlignOverrides[u][f]&&(c.format.verticalAlign=e.verticalAlign),c.isHeader=!1})})}function u0(t,e){e.hasFirstColumn&&t.forEach(function(r,n){r.cells.forEach(function(a,i){var o=D(a);if(i===0)switch(o.isHeader=!0,n){case 0:o.isHeader=!!e.hasHeaderRow,o.isHeader&&(o.format.fontWeight="bold");break;case t.length-1:dr(o.format,"borderTop");break;case 1:dr(o.format,"borderBottom");break;default:dr(o.format,"borderTop"),dr(o.format,"borderBottom");break}})})}function d0(t,e,r){var n;if(e.hasHeaderRow){var a=0;(n=t[a])===null||n===void 0||n.cells.forEach(function(i,o){var s=D(i);s.isHeader=!0,s.format.fontWeight="bold",e.headerRowColor&&(r.bgColorOverrides[a][o]||Vu(s,e.headerRowColor),dr(s.format,"borderTop",e.headerRowColor),dr(s.format,"borderRight",e.headerRowColor),dr(s.format,"borderLeft",e.headerRowColor))})}}function dr(t,e,r){var n=Ru(t[e]);n.color=r||"",n.style=Yu(n.color),t[e]=Fu(n)}function Yu(t){return!t||t=="transparent"?"none":"solid"}function Zu(t,e,r,n,a){var i=t.indexOf(e);switch(e.blockType){case"Table":case"Divider":return r?t.splice(i,1,r):t.splice(i,1),!0;case"Entity":var o=e.isSelected?"overwrite":a=="forward"?"removeFromStart":a=="backward"?"removeFromEnd":void 0;return o!==void 0&&(r?t.splice(i,1,r):t.splice(i,1),n?.deletedEntities.push({entity:e,operation:o})),!0;case"BlockGroup":switch(e.blockGroupType){case"General":return r?(t.splice(i,1,r),!0):!1;case"ListItem":case"FormatContainer":return t.splice(i,1),!0}}return!1}function f0(t,e){for(var r=I([],L(t),!1),n=0,a=e?0:r.length-1,i="notDeleted";a>=0&&a<r.length&&i!="done";a+=e?1:-1)switch(r[a]){case"‍":case"⃣":case"︎":case"️":i="notDeleted",n++;break;default:i=="notDeleted"?(i="waiting",n++):i=="waiting"&&(i="done");break}return r.splice(e?0:r.length-n,n),r.join("")}function ga(t,e,r,n,a){var i=L(vt(t,e),3),o=i[0],s=i[1],l=i[2],u=o.segments,d=yn(o.format.whiteSpace),f=n=="forward",v=n=="backward";switch(d||c0(o,u,l),s?.segmentType){case"Br":case"Image":case"SelectionMarker":return $r(u,l,n,a),!0;case"Entity":var c=s.isSelected?"overwrite":f?"removeFromStart":v?"removeFromEnd":void 0;return c!==void 0&&($r(u,l,n,a),r?.deletedEntities.push({entity:s,operation:c})),!0;case"Text":if(s.text.length==0||s.isSelected)s.text="",$r(u,l,n,a);else if(n){var h=s.text;h=f0(h,f),d||(h=Pu(h,f)),s.text=h,h==""&&$r(u,l,n,a)}return!0;case"General":return s.isSelected?($r(u,l,n,a),!0):!1;default:return!1}}function $r(t,e,r,n){var a,i=t.splice(e,1)[0];if(!((a=i.link)===null||a===void 0)&&a.format.undeletable)if(delete i.isSelected,n)n.push(i);else{var o=void 0;switch(r){case"forward":o=e>0&&t[e-1].segmentType=="SelectionMarker"?e-1:e;break;case"backward":o=e<t.length&&t[e].segmentType=="SelectionMarker"?e+1:e;break;default:o=e}t.splice(o,0,i)}}function c0(t,e,r){for(var n,a=r-1;((n=e[a])===null||n===void 0?void 0:n.segmentType)=="SelectionMarker";)a--;var i=e[a];i&&ic(t,i)}function Ju(t,e){var r,n=(r=t.format)!==null&&r!==void 0?r:{},a={fontFamily:n.fontFamily,fontSize:n.fontSize,textColor:n.textColor,backgroundColor:n.backgroundColor,letterSpacing:n.letterSpacing,lineHeight:n.lineHeight,fontWeight:e?n.fontWeight:void 0,italic:e?n.italic:void 0,underline:e?n.underline:void 0};return v0(a)}var v0=function(t){var e={};return Object.keys(t).filter(function(r){var n=t[r];n!==void 0&&(e[r]=n)}),e},h0={contentUnderSelectedTableCell:"ignoreForTableOrCell",contentUnderSelectedGeneralElement:"generalElementOnly",includeListFormatHolder:"never"};function p0(t,e){var r={deleteResult:"notDeleted",insertPoint:null,formatContext:e,undeletableSegments:[]};return lt(t,function(n,a,i,o){var s=je(!0,void 0,t.format),l=t.format,u=0;if(o&&i?.blockType=="Paragraph"){var d=L(Bi(i,o),3),f=d[0],v=d[1],c=d[2];if(v[0]){s=f,u=c[0],l=Ju(v[0],!0);var h=!r.lastParagraph;r.lastParagraph=s,r.lastTableContext=a,v.forEach(function(R,M){M==0&&!r.insertPoint&&R.segmentType=="SelectionMarker"?r.insertPoint=cl(R,f,n,a):ga(f,R,r.formatContext,void 0,h?void 0:r.undeletableSegments)&&(r.deleteResult="range")}),r.deleteResult=="range"&&et(f)}}else if(i){var p=D(n[0]).blocks;Zu(p,i,s,r.formatContext)&&(r.deleteResult="range")}else if(a){var m=a.table,b=a.colIndex,y=a.rowIndex,E=D(m),S=E.rows[y],T=D(S.cells[b]);n=I([T],L(n),!1),s.segments.push(qt(t.format)),T.blocks=[s],r.deleteResult="range"}if(!r.insertPoint){var k=Ge(l);et(s),s.segments.splice(u,0,k),r.insertPoint=cl(k,s,n,a)}},h0),r}function cl(t,e,r,n){return{marker:t,paragraph:e,path:r,tableContext:n}}function Qu(t,e){t.forEach(function(r){r&&g0(e)&&r(e)})}function g0(t){return!!t.insertPoint}function Wr(t,e,r){e===void 0&&(e=[]);var n=p0(t,r),a=e.filter(function(i){return!!i});return Qu(a,n),m0(n),n}function m0(t){var e,r,n=t.insertPoint,a=t.deleteResult,i=t.lastParagraph,o=t.lastTableContext,s=t.undeletableSegments;if(n&&a!="notDeleted"&&a!="nothingToDelete"&&i&&i!=n.paragraph&&o==n.tableContext){var l=D(i),u=D(n.paragraph);s&&(e=l.segments).unshift.apply(e,I([],L(s),!1)),(r=u.segments).push.apply(r,I([],L(l.segments),!1)),l.segments=[]}}var lo={backgroundColor:"",fontFamily:"",fontSize:"",fontWeight:"",italic:!1,letterSpacing:"",lineHeight:"",strikethrough:!1,superOrSubScriptSequence:"",textColor:"",underline:!1},un=30,gn=22;function xa(t,e){var r,n=D(t),a=n.format;(!a.borderCollapse||!a.useBorderBox)&&(a.borderCollapse=!0,a.useBorderBox=!0),n.rows.forEach(function(v,c){v.cells.forEach(function(h,p){var m=D(h);if(m.blocks.length==0){var b=m.format.textColor?C(C({},e),{textColor:m.format.textColor}):e;Ke(m,je(void 0,void 0,b)),ht(m,qt(b))}c==0?m.spanAbove=!1:c>0&&p>0&&m.isHeader&&(m.isHeader=!1),p==0&&(m.spanLeft=!1),m.format.useBorderBox=!0}),v.height<gn&&(v.height=gn)});for(var i=Math.max.apply(Math,I([],L(n.rows.map(function(v){return v.cells.length})),!1)),o=0;o<i;o++)n.widths[o]===void 0?n.widths[o]=b0(i):n.widths[o]<un&&(n.widths[o]=un);for(var s=((r=n.rows[0])===null||r===void 0?void 0:r.cells.length)||0,l=function(v){n.rows.forEach(function(c){var h=c.cells[v],p=c.cells[v-1];h&&p&&h.spanLeft&&vl(p,h)}),n.rows.every(function(c){var h;return(h=c.cells[v])===null||h===void 0?void 0:h.spanLeft})&&(n.rows.forEach(function(c){return c.cells.splice(v,1)}),n.widths.splice(v-1,2,n.widths[v-1]+n.widths[v]))},u=s-1;u>0;u--)l(u);for(var d=function(v){var c=n.rows[v];c.cells.forEach(function(h,p){var m,b=(m=n.rows[v-1])===null||m===void 0?void 0:m.cells[p];b&&h.spanAbove&&vl(b,h)}),c.cells.every(function(h){return h.spanAbove})&&(n.rows[v-1].height+=c.height,n.rows.splice(v,1))},f=n.rows.length-1;f>0;f--)d(f)}function b0(t){return t<=4?120:t<=6?100:70}function vl(t,e){var r,n=e.blocks.every(function(a){return a.blockType=="Paragraph"&&y0(a.segments)});n||((r=D(t).blocks).push.apply(r,I([],L(e.blocks),!1)),D(e).blocks=[])}function y0(t){return t=t.filter(function(e){return e.segmentType!="SelectionMarker"}),t.length==0||t.length==1&&t[0].segmentType=="Br"}var E0=["h1","h2","h3","h4","h5","h6"],C0=ie(lo);function so(t,e,r,n){var a,i=(a=n?.insertPosition)!==null&&a!==void 0?a:Wr(t,[],r).insertPoint,o=n||{},s=o.addParagraphAfterMergedContent,l=o.mergeFormat,u=o.mergeTable;if(s&&!u){var d=i||{},f=d.paragraph,v=d.marker,c=je(!1,f?.format,v?.format);Ke(e,c)}if(i){if(l&&l!="none"){var h=C(C({},t.format||{}),i.marker.format);Qn(e,h,l)}for(var p=0;p<e.blocks.length;p++){var m=e.blocks[p];switch(m.blockType){case"Paragraph":S0(i,m,p==0,r,n);break;case"Divider":an(i,m);break;case"Entity":an(i,m),r?.newEntities.push(m);break;case"Table":e.blocks.length==1&&u?T0(i,m,e):an(i,m);break;case"BlockGroup":switch(m.blockGroupType){case"General":case"FormatContainer":an(i,m);break;case"ListItem":w0(i,m);break}break}}}return Et(t),i}function S0(t,e,r,n,a){var i=t.paragraph,o=t.marker,s=r?i:uo(t,e.format),l=s.segments.indexOf(o);if(a?.mergeFormat=="none"&&r&&(s.segments.forEach(function(c){c.format=C(C({},s.segmentFormat||{}),c.format)}),delete s.segmentFormat),l>=0)for(var u=0;u<e.segments.length;u++){var d=e.segments[u];s.segments.splice(l+u,0,d),n&&(d.segmentType=="Entity"&&n.newEntities.push(d),d.segmentType=="Image"&&n.newImages.push(d))}if(e.decorator&&(s.decorator=C({},e.decorator),E0.indexOf(s.decorator.tagName)>-1)){var f=ie(s.decorator.format),v=ie(s.segmentFormat||{});f.forEach(function(c){var h;v.indexOf(c)>-1&&((h=s.segmentFormat)===null||h===void 0||delete h[c])})}r?s.format=C(C({},s.format),e.format):s.format=e.format}function T0(t,e,r){var n,a,i=t.tableContext,o=t.marker;if(i&&r.blocks.length==1&&r.blocks[0]==e){for(var s=i.table,l=i.colIndex,u=i.rowIndex,d=D(s),f=0;f<e.rows.length;f++)for(var v=0;v<e.rows[f].cells.length;v++){var c=e.rows[f].cells[v];if(f==0&&l+v>=d.rows[0].cells.length)for(var h=0;h<d.rows.length;h++){var p=(n=d.rows[h])===null||n===void 0?void 0:n.cells[l+v-1];d.rows[h].cells[l+v]=Vt(!1,!1,p?.isHeader,p?.format)}if(v==0&&u+f>=d.rows.length){d.rows[u+f]||(d.rows[u+f]={cells:[],format:{},height:0});for(var h=0;h<d.rows[u].cells.length;h++){var m=(a=d.rows[u+f-1])===null||a===void 0?void 0:a.cells[h];d.rows[u+f].cells[h]=Vt(!1,!1,!1,m?.format)}}var b=d.rows[u+f].cells[l+v];if(d.rows[u+f].cells[l+v]=c,f==0&&v==0){var y=Ge(o.format),E=ht(c,y);t.path[0]==b&&(t.path[0]=c,t.marker=y,t.paragraph=E)}}xa(d,t.marker.format),Ba(d,void 0,!0)}else an(t,e)}function w0(t,e){uo(t,e.format);var r=t.path,n=t.paragraph,a=ot(r,["ListItem"],["TableCell"]),i=r[a],o=r[a+1],s=o.blocks.indexOf(i||n);s>=0&&D(o).blocks.splice(s,0,e),i&&i?.levels.forEach(function(l,u){e.levels[u]=C({},l)})}function uo(t,e){var r=t.paragraph,n=t.marker,a=t.path,i=r.segments.indexOf(n),o=a[0].blocks.indexOf(r),s=je(!1,C(C({},r.format),e),r.segmentFormat);i>=0&&(s.segments=r.segments.splice(i)),o>=0&&D(a[0]).blocks.splice(o+1,0,s);var l=ot(a,["ListItem"],["FormatContainer","TableCell"]),u=a[l];if(u){var d=l>=0?a[l+1]:null,f=d?d.blocks.indexOf(u):-1;if(f>=0&&d){var v=kn(u.levels,u.formatHolder.format);o>=0&&(v.blocks=u.blocks.splice(o+1)),f>=0&&D(d).blocks.splice(f+1,0,v),a[l]=v}}return t.paragraph=s,s}function an(t,e){var r=t.path,n=e.blockType!=="Paragraph"?{}:e.format,a=uo(t,n),i=r[0].blocks.indexOf(a);i>=0&&D(r[0]).blocks.splice(i,0,e)}function Qn(t,e,r){t.blocks.forEach(function(n){var a;switch(k0(r,n),n.blockType){case"BlockGroup":n.blockGroupType=="ListItem"&&(D(n).formatHolder.format=hl(r,e,n.formatHolder.format)),Qn(n,e,r);break;case"Table":n.rows.forEach(function(s){return s.cells.forEach(function(l){Qn(l,e,r)})});break;case"Paragraph":var i=((a=n.decorator)===null||a===void 0?void 0:a.format)||{},o=D(n);o.segments.forEach(function(s){s.segmentType=="General"&&Qn(s,e,r),s.format=hl(r,e,C(C({},i),s.format)),s.link&&(s.link.format=_0(r,e,s.link.format))}),r==="keepSourceEmphasisFormat"&&delete o.decorator;break}})}function k0(t,e){t=="keepSourceEmphasisFormat"&&e.format.backgroundColor&&delete D(e).format.backgroundColor}function qa(t){var e={};return t.backgroundColor&&(e.backgroundColor=t.backgroundColor),t.underline&&(e.underline=t.underline),e}function _0(t,e,r){switch(t){case"mergeAll":case"preferSource":return C(C({},qa(e)),r);case"keepSourceEmphasisFormat":return C(C(C(C({},ed(r)),qa(e)),$u(r)),D0(r));case"preferTarget":return C(C({},r),qa(e))}}function hl(t,e,r){switch(t){case"mergeAll":case"preferSource":return C(C({},e),r);case"preferTarget":return C(C({},r),e);case"keepSourceEmphasisFormat":return C(C(C({},ed(r)),e),$u(r))}}function $u(t){var e={},r=t.fontWeight,n=t.italic,a=t.underline;return r&&r!="normal"&&(e.fontWeight=r),n&&(e.italic=n),a&&(e.underline=a),e}function ed(t){var e=C({},t);return C0.forEach(function(r){return delete e[r]}),e}function D0(t){var e={};return t.textColor&&(e.textColor=t.textColor),e}var It=pa(!0),pl=Ar(!0),M0=Ia({widthPx:It,heightPx:It,leftPercent:It,rightPercent:It,topPercent:It,bottomPercent:It,angleRad:It,src:zu(),naturalHeight:It,naturalWidth:It,flippedHorizontal:pl,flippedVertical:pl});function O0(t){return Da(t,M0)}function L0(t,e,r,n,a,i,o){n===void 0&&(n="remove");var s,l,u=!0,d=!0,f=!0,v=void 0,c=C({},t.format);delete c.italic,delete c.underline,delete c.fontWeight,lt(t,function(h,p,m,b){if(P0(r,h,u,n),m&&(l?r.isMultilineSelection=!0:l=m),m?.blockType=="Paragraph"&&(F0(r,m,u,n),b?.forEach(function(T){var k,R,M,w;if(f||T.segmentType!="SelectionMarker"){var A=Object.assign({},m.format,(k=m.decorator)===null||k===void 0?void 0:k.format,T.format,(R=T.code)===null||R===void 0?void 0:R.format,(M=T.link)===null||M===void 0?void 0:M.format,e);B0(A)||(v||(v=(w=a?.getContainerFormat(i,o))!==null&&w!==void 0?w:c),A=Object.assign({},v,A)),R0(r,u,A,n),Ee(r,"isCodeInline",!!T?.code,u,n)}f=!1,r.canUnlink=r.canUnlink||!!T.link,r.canAddImageAltText=r.canAddImageAltText||b.some(function(N){return N.segmentType=="Image"}),u=!1,T.segmentType==="Image"&&(d?(N0(T,r),d=!1):(r.imageFormat=void 0,r.imageEditingMetadata=void 0))}),u=!1),p)if(s){var y=s.table,E=s.colIndex,S=s.rowIndex;p.table==y&&(p.colIndex!=E||p.rowIndex!=S)&&(r.canMergeTableCell=!0,r.isMultilineSelection=!0)}else A0(p,r),s=p},{includeListFormatHolder:"never"}),r.fontSize&&(r.fontSize=I0(r.fontSize))}function R0(t,e,r,n){var a,i;n===void 0&&(n="remove");var o=(i=(a=r.superOrSubScriptSequence)===null||a===void 0?void 0:a.split(" "))===null||i===void 0?void 0:i.pop();Ee(t,"isBold",Lu(r.fontWeight),e,n),Ee(t,"isItalic",r.italic,e,n),Ee(t,"isUnderline",r.underline,e,n),Ee(t,"isStrikeThrough",r.strikethrough,e,n),Ee(t,"isSuperscript",o=="super",e,n),Ee(t,"isSubscript",o=="sub",e,n),Ee(t,"letterSpacing",r.letterSpacing,e,n),Ee(t,"fontName",r.fontFamily,e,n),Ee(t,"fontSize",r.fontSize,e,n,function(s){return Je(s,void 0,"pt")+"pt"}),Ee(t,"backgroundColor",r.backgroundColor,e,n),Ee(t,"textColor",r.textColor,e,n),Ee(t,"fontWeight",r.fontWeight,e,n),Ee(t,"lineHeight",r.lineHeight,e,n)}function F0(t,e,r,n){var a;n===void 0&&(n="remove");var i=parseInt((((a=e.decorator)===null||a===void 0?void 0:a.tagName)||"").substring(1)),o=i>=1&&i<=6?i:void 0;Ee(t,"marginBottom",e.format.marginBottom,r,n),Ee(t,"marginTop",e.format.marginTop,r,n),Ee(t,"headingLevel",o,r,n),Ee(t,"textAlign",e.format.textAlign,r,n),Ee(t,"direction",e.format.direction,r,n)}function P0(t,e,r,n){var a,i;n===void 0&&(n="remove");var o=ot(e,["ListItem"],[]),s=ot(e,["FormatContainer"],[]);if(o>=0){var l=e[o],u=(a=l?.levels[l.levels.length-1])===null||a===void 0?void 0:a.listType;Ee(t,"isBullet",u=="UL",r,n),Ee(t,"isNumbering",u=="OL",r,n)}Ee(t,"isBlockQuote",s>=0&&((i=e[s])===null||i===void 0?void 0:i.tagName)=="blockquote",r,n)}function A0(t,e){var r=i0(t.table);e.isInTable=!0,e.tableHasHeader=t.table.rows.some(function(n){return n.cells.some(function(a){return a.isHeader})}),r&&(e.tableFormat=r)}function N0(t,e){var r=t.format,n="borderTop",a=Ru(r[n]),i=a.color,o=a.width,s=a.style;e.imageFormat={borderColor:i,borderWidth:o,borderStyle:s,boxShadow:r.boxShadow,borderRadius:r.borderRadius},e.imageEditingMetadata=O0(t)}function Ee(t,e,r,n,a,i){if(a===void 0&&(a="remove"),i===void 0&&(i=function(o){return o}),n)r!==void 0&&(t[e]=r);else if(i(r)!==i(t[e]))switch(a){case"remove":delete t[e];break;case"keepFirst":break;case"returnMultiple":typeof t[e]=="string"?t[e]="Multiple":delete t[e];break}}function I0(t){if(t){var e=t.indexOf("px");if(e!==-1&&e===t.length-2)return Math.round(parseFloat(t)*75+.05)/100+"pt"}return t}function B0(t){return!!t.fontFamily&&!!t.fontSize&&!!t.textColor}var ye,fo=(ye={},ye[x.Decimal]="decimal",ye[x.DecimalDash]='"${Number}- "',ye[x.DecimalParenthesis]='"${Number}) "',ye[x.DecimalDoubleParenthesis]='"(${Number}) "',ye[x.LowerAlpha]="lower-alpha",ye[x.LowerAlphaDash]='"${LowerAlpha}- "',ye[x.LowerAlphaParenthesis]='"${LowerAlpha}) "',ye[x.LowerAlphaDoubleParenthesis]='"(${LowerAlpha}) "',ye[x.UpperAlpha]="upper-alpha",ye[x.UpperAlphaDash]='"${UpperAlpha}- "',ye[x.UpperAlphaParenthesis]='"${UpperAlpha}) "',ye[x.UpperAlphaDoubleParenthesis]='"(${UpperAlpha}) "',ye[x.LowerRoman]="lower-roman",ye[x.LowerRomanDash]='"${LowerRoman}- "',ye[x.LowerRomanParenthesis]='"${LowerRoman}) "',ye[x.LowerRomanDoubleParenthesis]='"(${LowerRoman}) "',ye[x.UpperRoman]="upper-roman",ye[x.UpperRomanDash]='"${UpperRoman}- "',ye[x.UpperRomanParenthesis]='"${UpperRoman}) "',ye[x.UpperRomanDoubleParenthesis]='"(${UpperRoman}) "',ye),Qe,co=(Qe={},Qe[Se.Disc]="disc",Qe[Se.Square]="square",Qe[Se.Circle]="circle",Qe[Se.Dash]='"- "',Qe[Se.LongArrow]='"➔ "',Qe[Se.DoubleLongArrow]='"➔ "',Qe[Se.ShortArrow]='"➢ "',Qe[Se.UnfilledArrow]='"➪ "',Qe[Se.Hyphen]='"— "',Qe[Se.CheckMark]='"✔ "',Qe[Se.Xrhombus]='"❖ "',Qe[Se.BoxShadow]='"❑ "',Qe);function x0(t,e){var r=t=="OL"?fo:co,n=ie(r),a=n.find(function(i){return r[i]==e});return a&&(typeof a=="string"?parseInt(a):a)}var Ha=Ia({orderedStyleType:pa(!0,void 0,x.Min,x.Max),unorderedStyleType:pa(!0,void 0,Se.Min,Se.Max),applyListStyleFromLevel:Ar(!0)},!0,!0);function H0(t){return Da(t,Ha)}function ma(t,e){return Ma(t,e,Ha)}var Ve={AutoLink:"AutoLink",CreateLink:"CreateLink",Format:"Format",ImageResize:"ImageResize",Paste:"Paste",SetContent:"SetContent",Cut:"Cut",Drop:"Drop",InsertEntity:"InsertEntity",SwitchToDarkMode:"SwitchToDarkMode",SwitchToLightMode:"SwitchToLightMode",ListChain:"ListChain",Keyboard:"Keyboard",AutoFormat:"AutoFormat",Replace:"Replace"};function _i(t,e,r){var n,a,i=[],o;if(!t||!r.contains(t))return i;if(F(t,"TEXT_NODE")){for(o=t.parentNode;t.previousSibling&&F(t.previousSibling,"TEXT_NODE");)e+=((n=t.previousSibling.nodeValue)===null||n===void 0?void 0:n.length)||0,t=t.previousSibling;i.unshift(e)}else o=t,t=t.childNodes[e];do{e=0;for(var s=!1,l=o?.firstChild||null;l&&l!=t;l=l.nextSibling){if(F(l,"TEXT_NODE")){if(((a=l.nodeValue)===null||a===void 0?void 0:a.length)===0||s)continue;s=!0}else s=!1;e++}i.unshift(e),t=o,o=o?.parentNode||null}while(t&&t!=r);return i}function z0(t){var e=t.physicalRoot,r=t.api,n=r.getDOMSelection(t);if(n?.type=="range"){var a=n.range,i=a.startContainer,o=a.startOffset,s=a.endContainer,l=a.endOffset,u=gl(i,e);if(s!=i&&(u=gl(s,e)||u),u){var d=e.ownerDocument.createRange();d.setStart(i,o),d.setEnd(s,l),r.setDOMSelection(t,{type:"range",range:d,isReverted:!!n.isReverted},!0)}}switch(n?.type){case"image":return{type:"image",imageId:n.image.id};case"table":return{type:"table",tableId:n.table.id,firstColumn:n.firstColumn,lastColumn:n.lastColumn,firstRow:n.firstRow,lastRow:n.lastRow};case"range":var f=n.range;return{type:"range",start:_i(f.startContainer,f.startOffset,e),end:_i(f.endContainer,f.endOffset,e),isReverted:!!n.isReverted};default:return{type:"range",start:[],end:[],isReverted:!1}}}function gl(t,e){for(var r=t,n=!1;r&&e.contains(r);)F(r,"ELEMENT_NODE")&&re(r,"table")&&(n=U0(r)||n),r=r.parentNode;return n}function U0(t){for(var e,r=!1,n=null,a=t.firstChild;a;a=a.nextSibling){var i=F(a,"ELEMENT_NODE")?a.tagName:null;switch(i){case"TR":n||(n=t.ownerDocument.createElement("tbody"),t.insertBefore(n,a)),n.appendChild(a),a=n,r=!0;break;case"TBODY":n?(Ft(n,a,!0),(e=a.parentNode)===null||e===void 0||e.removeChild(a),a=n,r=!0):n=a;break;default:n=null;break}}var o=t.querySelectorAll("colgroup"),s=t.querySelector("thead");return s&&o.forEach(function(l){s.contains(l)||s.appendChild(l)}),r}var G0=function(t,e,r){var n=t.lifecycle,a=t.physicalRoot,i=t.logicalRoot,o=t.undo,s=null;if(!n.shadowEditFragment){var l={eventType:"beforeAddUndoSnapshot",additionalState:{}};t.api.triggerEvent(t,l,!1);var u=z0(t),d=a.innerHTML;if(i!==a){var f=Xi(i,t.domHelper);if(!r&&f){var v=hr(f);if(v.entityType&&v.id){var c={eventType:"entityOperation",operation:"snapshotEntityState",entity:{type:v.entityType,id:v.id,wrapper:f,isReadonly:v.isReadonly},state:void 0};t.api.triggerEvent(t,c,!1),c.state&&(r=[{type:v.entityType,id:v.id,state:c.state}])}}}s={html:d,additionalState:l.additionalState,entityStates:r,isDarkMode:!!n.isDarkMode,selection:u},i!==a&&(s.logicalRootPath=_i(i,0,a)),o.snapshotsManager.addSnapshot(s,!!e),o.snapshotsManager.hasNewContent=!1}return s};function td(t){var e=t.createElement("div");return e.style.clip="rect(0px, 0px, 0px, 0px)",e.style.clipPath="inset(100%)",e.style.height="1px",e.style.overflow="hidden",e.style.position="absolute",e.style.whiteSpace="nowrap",e.style.width="1px",e.ariaLive="assertive",t.body.appendChild(e),e}var K0=".",W0=function(t,e){var r=e.text,n=e.defaultStrings,a=e.formatStrings,i=a===void 0?[]:a,o=e.ariaLiveMode,s=o===void 0?"assertive":o,l=t.lifecycle.announcerStringGetter,u=n&&l?.(n),d=V0(u||r,i);if(t.lifecycle.announceContainer||(t.lifecycle.announceContainer=td(t.physicalRoot.ownerDocument)),d&&t.lifecycle.announceContainer){var f=t.lifecycle.announceContainer;f.ariaLive!=s&&(f.ariaLive=s),d==f.textContent&&(d+=K0),f&&(f.textContent=d)}};function V0(t,e){return t==null||(t=t.replace(/\{(\d+)\}/g,function(r,n){var a=parseInt(n),i=e[a];return i??""})),t}var j0=function(t,e){var r=ie(e||{}).map(function(n){var a=e[n],i=a.pluginEventType,o=a.beforeDispatch,s=a.capture,l=n,u=function(d){o&&o(d),i!=null&&t.api.triggerEvent(t,{eventType:i,rawEvent:d},!1)};return t.logicalRoot.addEventListener(l,u,{capture:s}),function(){t.logicalRoot.removeEventListener(l,u,{capture:s})}});return function(){return r.forEach(function(n){return n()})}};function ba(t,e,r){if(t.cachedModel=e,r?.type=="range"){var n=r.range,a=n.startContainer,i=n.startOffset,o=n.endContainer,s=n.endOffset,l=r.isReverted;t.cachedSelection={type:"range",isReverted:l,start:{node:a,offset:i},end:{node:o,offset:s}}}else t.cachedSelection=r??void 0}var q0=function(t,e,r){var n;(n=t.cache.textMutationObserver)===null||n===void 0||n.flushMutations();var a=!e||e.tryGetFromCache&&typeof e.recalculateTableSize>"u";if(!r&&a){var i=t.cache.cachedModel;if(i)return t.lifecycle.shadowEditFragment?pn(i,{includeCachedElement:!0}):i}var o=r=="none"?void 0:r||t.api.getDOMSelection(t)||void 0,s=!e&&!r,l=t.api.createEditorContext(t,s);l.recalculateTableSize=e?.recalculateTableSize;var u=t.environment.domToModelSettings,d=e?Dn(l,u.builtIn,u.customized,e):Mn(u.calculated,l);o&&(d.selection=o);var f=En(t.logicalRoot,d);return s&&ba(t.cache,f,o),f},X0=16;function rd(t){var e,r=(e=t.defaultView)===null||e===void 0?void 0:e.getComputedStyle(t.documentElement);return{rootFontSize:Je(r?.fontSize)||X0}}var Y0=function(t,e){var r,n,a=t.lifecycle,i=t.format,o=t.darkColorHandler,s=t.logicalRoot,l=t.cache,u=t.domHelper;e=e&&!t.lifecycle.shadowEditFragment;var d=C({isDarkMode:a.isDarkMode,defaultFormat:i.defaultFormat,pendingFormat:(r=i.pendingFormat)!==null&&r!==void 0?r:void 0,darkColorHandler:o,addDelimiterForEntity:!0,allowCacheElement:!0,domIndexer:e?l.domIndexer:void 0,zoomScale:u.calculateZoomScale(),experimentalFeatures:(n=t.experimentalFeatures)!==null&&n!==void 0?n:[],paragraphMap:t.cache.paragraphMap},rd(s.ownerDocument));return t.domHelper.isRightToLeft()&&(d.isRootRtl=!0),d},Z0=function(t){var e;if(!t.lifecycle.shadowEditFragment){var r=t.api,n=t.domHelper,a=t.selection;!n.hasFocus()&&((e=a.selection)===null||e===void 0?void 0:e.type)=="range"&&r.setDOMSelection(t,a.selection,!0),n.hasFocus()||t.logicalRoot.focus()}};function J0(t,e){var r=gp(t.physicalRoot.ownerDocument,e.type=="image"?{node:e.image,offset:0}:e.isReverted?{node:e.range.startContainer,offset:e.range.startOffset}:{node:e.range.endContainer,offset:e.range.endOffset}),n=t.api.getVisibleViewport(t),a=t.domEvent.scrollContainer;r&&n&&Gc(a,n,t.domHelper,r)}var Q0=function(t,e,r,n){var a,i,o=r||{},s=o.onNodeCreated,l=o.rawEvent,u=o.selectionOverride,d=o.scrollCaretIntoView,f=t.api.createContentModel(t,n,u),v={newEntities:[],deletedEntities:[],rawEvent:l,newImages:[],paragraphIndexer:t.cache.paragraphMap},c=t.domHelper.hasFocus(),h=e(f,v),p=v.skipUndoSnapshot,m=v.clearModelCache,b=v.entityStates,y=v.canUndoByBackspace;if(h){var E=t.undo.isNested,S=(!p||p=="DoNotSkip")&&!E,T=(p===!0||p=="MarkNewContent")&&!E,k=void 0;S&&(t.undo.isNested=!0,t.api.addUndoSnapshot(t,!!y,b));try{$0(t,v),k=(a=t.api.setContentModel(t,f,c?void 0:{ignoreSelection:!0},s))!==null&&a!==void 0?a:void 0,ml(t,v,k),d&&(k?.type=="range"||k?.type=="image")&&J0(t,k);var R={eventType:"contentChanged",contentModel:m?void 0:f,selection:m?void 0:k,source:r?.changeSource||Ve.Format,data:(i=r?.getChangeData)===null||i===void 0?void 0:i.call(r),formatApiName:r?.apiName,changedEntities:eg(v,l),skipUndo:!(T||S)||r?.changeSource==Ve.Keyboard};t.api.triggerEvent(t,R,!0),y&&k?.type=="range"&&(t.undo.autoCompleteInsertPoint={node:k.range.startContainer,offset:k.range.startOffset}),S&&t.api.addUndoSnapshot(t,!1,b),T&&(t.undo.snapshotsManager.hasNewContent=!0)}finally{E||(t.undo.isNested=!1)}}else m&&(t.cache.cachedModel=void 0,t.cache.cachedSelection=void 0),ml(t,v,t.api.getDOMSelection(t));v.announceData&&t.api.announce(t,v.announceData)};function $0(t,e){if(e.newImages.length>0){var r=t.domHelper.getClientWidth(),n=10,a=Math.max(r,n);e.newImages.forEach(function(i){i.format.maxWidth=a+"px"})}}function ml(t,e,r){var n,a,i=e.newPendingFormat=="preserve"?(n=t.format.pendingFormat)===null||n===void 0?void 0:n.format:e.newPendingFormat,o=e.newPendingParagraphFormat=="preserve"?(a=t.format.pendingFormat)===null||a===void 0?void 0:a.paragraphFormat:e.newPendingParagraphFormat;(i||o)&&r?.type=="range"&&r.range.collapsed&&(t.format.pendingFormat={format:i?C({},i):void 0,paragraphFormat:o?C({},o):void 0,insertPoint:{node:r.range.startContainer,offset:r.range.startOffset}})}function eg(t,e){return t.autoDetectChangedEntities?void 0:t.newEntities.map(function(r){return{entity:r,operation:"newEntity",rawEvent:e}}).concat(t.deletedEntities.map(function(r){return{entity:r.entity,operation:r.operation,rawEvent:e}}))}var tg=function(t){if(t.lifecycle.shadowEditFragment)return null;var e=t.selection.selection;return e&&(e.type!="range"||!t.domHelper.hasFocus())?e:rg(t)};function rg(t){var e,r=(e=t.logicalRoot.ownerDocument.defaultView)===null||e===void 0?void 0:e.getSelection(),n=r&&r.rangeCount>0?r.getRangeAt(0):null;return r&&n&&t.logicalRoot.contains(n.commonAncestorContainer)?{type:"range",range:n,isReverted:r.focusNode!=n.endContainer||r.focusOffset!=n.endOffset}:null}var ng=function(t){var e=t.domEvent.scrollContainer;return ag(e==t.physicalRoot?[e]:[e,t.physicalRoot])};function ag(t,e){e===void 0&&(e=[]);var r=t.map(function(a){return Le(a.getBoundingClientRect())}).concat(e).filter(function(a){return!!a}),n={top:Math.max.apply(Math,I([],L(r.map(function(a){return a.top})),!1)),bottom:Math.min.apply(Math,I([],L(r.map(function(a){return a.bottom})),!1)),left:Math.max.apply(Math,I([],L(r.map(function(a){return a.left})),!1)),right:Math.min.apply(Math,I([],L(r.map(function(a){return a.right})),!1))};return n.top<n.bottom&&n.left<n.right?n:null}function ig(t,e){var r=t.lifecycle.isDarkMode;t.darkColorHandler.updateKnownColor(r),!!e.isDarkMode!=!!r&&va(t.physicalRoot,!1,r?"lightToDark":"darkToLight",t.darkColorHandler)}function og(t,e){for(var r,n,a=t.physicalRoot,i=t.entity.entityMap,o=a.firstChild,s=t.domCreator.htmlToDOM(e.html).body,l=s.firstChild;l;){var u=l.nextSibling,d=bl(i,l);if(d){if(wn(d))for(var f=d.firstChild;f;f=f.nextSibling)F(f,"ELEMENT_NODE")&&Ut(f)&&((r=t.cache.domIndexer)===null||r===void 0||r.clearIndex(f));o=pr(a,d,o)}else if(a.insertBefore(l,o),F(l,"ELEMENT_NODE")){var v=du(l);v.forEach(function(c){var h,p=bl(i,c);if(p){if(p==o){var m=p.cloneNode();a.insertBefore(m,o),o=m}(h=c.parentNode)===null||h===void 0||h.replaceChild(p,c)}})}l=u}for(;o;){var u=o.nextSibling;(n=o.parentNode)===null||n===void 0||n.removeChild(o),o=u}}function bl(t,e){var r=null;if(F(e,"ELEMENT_NODE"))if(Ct(e)){var n=hr(e);r=nd(t,n.id)}else wn(e)&&(r=lg(e,t));return r}function lg(t,e){for(var r,n=t.firstChild;n;n=n.nextSibling)if(Ct(n)&&F(n,"ELEMENT_NODE")){var a=hr(n),i=(r=nd(e,a.id))===null||r===void 0?void 0:r.parentElement;return F(i,"ELEMENT_NODE")&&wn(i)?i:null}return null}function nd(t,e){var r=e?t[e]:void 0;return r?.canPersist?r.element:null}function Di(t,e){for(var r=0,n=0;n<e.length&&(r=e[n],n<e.length-1&&t&&F(t,"ELEMENT_NODE")&&t.childNodes.length>r);n++)t=t.childNodes[r];return{node:t,offset:r}}function sg(t,e){if(e.logicalRootPath&&e.logicalRootPath.length>0){var r=Di(t.physicalRoot,e.logicalRootPath).node;r!==t.logicalRoot&&t.api.setLogicalRoot(t,r)}}function ug(t,e){var r=e.selection,n=t.physicalRoot,a=null;try{if(r)switch(r.type){case"range":var i=Di(n,r.start),o=Di(n,r.end),s=n.ownerDocument.createRange();s.setStart(i.node,i.offset),s.setEnd(o.node,o.offset),a={type:"range",range:s,isReverted:r.isReverted};break;case"table":var l=n.querySelector(Ir(r.tableId));l&&(a={type:"table",table:l,firstColumn:r.firstColumn,firstRow:r.firstRow,lastColumn:r.lastColumn,lastRow:r.lastRow});break;case"image":var u=n.querySelector(Ir(r.imageId));u&&(a={type:"image",image:u});break}a&&t.api.setDOMSelection(t,a)}catch{}}var dg=function(t,e){t.api.triggerEvent(t,{eventType:"beforeSetContent",newContent:e.html},!0);try{t.undo.isRestoring=!0,t.api.setLogicalRoot(t,null),og(t,e),sg(t,e),ug(t,e),ig(t,e);var r={eventType:"contentChanged",additionalState:e.additionalState,entityStates:e.entityStates,source:Ve.SetContent};t.api.triggerEvent(t,r,!1)}finally{t.undo.isRestoring=!1}},fg=function(t,e,r,n,a){var i,o,s=t.api.createEditorContext(t,!0),l=r?Fa(s,t.environment.modelToDomSettings.builtIn,t.environment.modelToDomSettings.customized,r):$i(t.environment.modelToDomSettings.calculated,s);l.onNodeCreated=n,(i=t.onFixUpModel)===null||i===void 0||i.call(t,e);var u=zi(t.logicalRoot.ownerDocument,t.logicalRoot,e,l);return t.lifecycle.shadowEditFragment||((o=t.cache.textMutationObserver)===null||o===void 0||o.flushMutations(!0),ba(t.cache,e,u),!r?.ignoreSelection&&u?t.api.setDOMSelection(t,u):t.selection.selection=u),a?t.lifecycle.rewriteFromModel=l.rewriteFromModel:t.api.triggerEvent(t,C({eventType:"rewriteFromModel"},l.rewriteFromModel),!0),u};function ad(t,e){if(t==e)return!0;switch(t.type){case"image":return e.type=="image"&&e.image==t.image;case"table":return e.type=="table"&&hg(t,e);case"range":default:if(e.type=="range"){var r=t.range;if(pg(e)){var n=e.start,a=e.end;return r.startContainer==n.node&&r.endContainer==a.node&&r.startOffset==n.offset&&r.endOffset==a.offset}else return od(r,e.range)}else return!1}}function id(t,e,r){return r.every(function(n){return t[n]==e[n]})}var cg=["table","firstColumn","lastColumn","firstRow","lastRow"],vg=["startContainer","endContainer","startOffset","endOffset"];function hg(t,e){return id(t,e,cg)}function od(t,e){return id(t,e,vg)}function pg(t){return!!t.start}function ld(t,e,r){var n;r===void 0&&(r=!1);var a=(n=t.defaultView)===null||n===void 0?void 0:n.getSelection();if(a){var i=a.rangeCount>0&&a.getRangeAt(0);if(i&&od(i,e))return;a.removeAllRanges(),r?a.setBaseAndExtent(e.endContainer,e.endOffset,e.startContainer,e.startOffset):a.addRange(e)}}function Mi(t,e){e=t.id||e;for(var r=t.ownerDocument,n=0;!t.id||r.querySelectorAll(Ir(t.id)).length>1;)t.id=e+"_"+n++;return t.id}function gg(t,e){for(var r,n,a,i,o=e.row,s=e.col;o>=0&&s>=0&&o<t.length&&s<((n=(r=t[o])===null||r===void 0?void 0:r.length)!==null&&n!==void 0?n:0);){var l=(a=t[o])===null||a===void 0?void 0:a[s+1],u=(i=t[o+1])===null||i===void 0?void 0:i[s];if(l=="spanLeft"||l=="spanBoth")s++;else if(u=="spanTop"||u=="spanBoth")o++;else return{row:o,col:s}}return null}function $n(t,e){for(var r,n,a,i=e.row,o=e.col;i>=0&&o>=0&&i<t.length&&o<((n=(r=t[i])===null||r===void 0?void 0:r.length)!==null&&n!==void 0?n:0);){var s=(a=t[i])===null||a===void 0?void 0:a[o];if(s){if(typeof s=="object")return{cell:s,row:i,col:o};s=="spanLeft"||s=="spanBoth"?o--:i--}else break}return null}var mg="caret-color: transparent",bg="_DOMSelectionHideCursor";function ya(t,e){t.api.setEditorStyle(t,bg,e?mg:null)}var Xa="_DOMSelection",Ya="_DOMSelectionHideSelection",yg="image",Eg="table",yl="background-color: transparent !important;",El="*::selection",Cg="#DB626C",Sg=function(t,e,r){var n,a,i,o=t.api.getDOMSelection(t);if(!(o&&e&&ad(o,e))){var s=t.selection.skipReselectOnFocus,l=t.physicalRoot.ownerDocument,u=t.lifecycle.isDarkMode;t.selection.skipReselectOnFocus=!0,t.api.setEditorStyle(t,Xa,null),t.api.setEditorStyle(t,Ya,null),ya(t,!1);try{switch(e?.type){case"image":var d=e.image;t.selection.selection=e;var f=u?t.selection.imageSelectionBorderColorDark:t.selection.imageSelectionBorderColor;t.api.setEditorStyle(t,Xa,"outline-style:solid!important; outline-color:"+(f||Cg)+"!important;",[Ir(Mi(d,yg))]),t.api.setEditorStyle(t,Ya,yl,[El]),Cl(l,d,!1);break;case"table":var v=e.table,c=e.firstColumn,h=e.firstRow,p=e.lastColumn,m=e.lastRow,b=cn(e.table),y={row:Math.min(h,m),col:Math.min(c,p),cell:null},E={row:Math.max(h,m),col:Math.max(c,p)};if(y=$n(b,y)||y,E=gg(b,E)||E,isNaN(y.row)||isNaN(y.col)||isNaN(E.row)||isNaN(E.col))return;e={type:"table",table:v,firstRow:y.row,firstColumn:y.col,lastRow:E.row,lastColumn:E.col,tableSelectionInfo:e.tableSelectionInfo};var S=Mi(v,Eg),T=Ir(S),k=y.row==0&&y.col==0&&E.row==b.length-1&&E.col==((a=(n=b[E.row])===null||n===void 0?void 0:n.length)!==null&&a!==void 0?a:0)-1?[T,T+" *"]:Tg(b,T,v,y,E);t.selection.selection=e;var R=u?t.selection.tableCellSelectionBackgroundColorDark:t.selection.tableCellSelectionBackgroundColor;t.api.setEditorStyle(t,Xa,"background-color:"+R+"!important;",k),t.api.setEditorStyle(t,Ya,yl,[El]),ya(t,!0);var M=((i=y.cell)===null||i===void 0?void 0:i.firstElementChild)||y.cell;M&&Cl(l,M||void 0,!0);break;case"range":ld(l,e.range,e.isReverted),t.selection.selection=t.domHelper.hasFocus()?null:e;break;default:t.selection.selection=null;break}}finally{t.selection.skipReselectOnFocus=s}if(!r){var w={eventType:"selectionChanged",newSelection:e};t.api.triggerEvent(t,w,!0)}}};function Tg(t,e,r,n,a){var i=[],o=0,s=it(r.childNodes).filter(function(l){return["THEAD","TBODY","TFOOT"].indexOf(F(l,"ELEMENT_NODE")?l.tagName:"")>-1}).map(function(l){var u={el:l.tagName,start:o,end:l.childNodes.length+o};return o=u.end,u});return t.forEach(function(l,u){for(var d=0,f=s.filter(function(b){return b.start<=u&&b.end>u})[0],v=f?">"+f.el+">":">",c=f&&u+1>=f.start?u+1-f.start:u+1,h=0;h<l.length;h++){var p=l[h];if(typeof p=="object"&&(d++,u>=n.row&&u<=a.row&&h>=n.col&&h<=a.col)){var m=""+e+v+" tr:nth-child("+c+")>"+p.tagName+":nth-child("+d+")";i.push(m,m+" *")}}}),i}function Cl(t,e,r){var n;if(e&&t.contains(e)){var a=t.createRange(),i=void 0;if(a.selectNode(e),r)a.collapse();else{var o=(n=t.defaultView)===null||n===void 0?void 0:n.getSelection(),s=o&&o.rangeCount>0&&o.getRangeAt(0);o&&s&&(i=o.focusNode!=s.endContainer||o.focusOffset!=s.endOffset)}ld(t,a,i)}}var wg=9e3,kg="contentDiv",_g=function(t,e,r,n,a){a===void 0&&(a=wg);var i=t.lifecycle.styleElements[e];if(!i&&r){var o=t.physicalRoot.ownerDocument;i=o.createElement("style"),o.head.appendChild(i),i.dataset.roosterjsStyleKey=e,t.lifecycle.styleElements[e]=i}var s=i?.sheet;if(s){for(var l=s.cssRules.length-1;l>=0;l--)s.deleteRule(l);if(r){var u=Ir(Mi(t.physicalRoot,kg)),d=n?typeof n=="string"?[u+"::"+n]:Dg(u,n,a-r.length-3):[u];d.forEach(function(f){s.insertRule(f+" {"+r+"}")})}}};function Dg(t,e,r){var n=[],a=[],i=0;return e.forEach(function(o){i>=r&&(n.push(a.join(",")),a=[],i=0);var s=t+" "+o;i+=s.length+1,a.push(s)}),n.push(a.join(",")),n}var Mg=function(t,e){if(!e||t.physicalRoot.contains(e)){if(e||(e=t.physicalRoot),e!==t.logicalRoot){var r={eventType:"beforeLogicalRootChange",logicalRoot:t.logicalRoot};t.api.triggerEvent(t,r,!1),t.logicalRoot.contentEditable="false",e.contentEditable="true",t.logicalRoot=e,t.selection.selection=null,t.cache.cachedModel=void 0,t.cache.cachedSelection=void 0;var n={eventType:"logicalRootChanged",logicalRoot:e};t.api.triggerEvent(t,n,!1)}}else return null},Og=function(t,e){var r=t;if(e!=!!r.lifecycle.shadowEditFragment)if(e){var n=r.cache.cachedModel?null:r.api.createContentModel(r),a=r.logicalRoot.ownerDocument.createDocumentFragment(),i=r.logicalRoot.cloneNode(!0);Ft(a,i),r.api.triggerEvent(r,{eventType:"enteredShadowEdit"},!1),!r.cache.cachedModel&&n&&(r.cache.cachedModel=n),ya(r,!0),r.lifecycle.shadowEditFragment=a}else r.lifecycle.shadowEditFragment=null,ya(r,!1),r.api.triggerEvent(r,{eventType:"leavingShadowEdit"},!1),r.cache.cachedModel&&(lt(r.cache.cachedModel,function(){}),r.api.setContentModel(r,r.cache.cachedModel,{ignoreSelection:!0}))},Lg=["editorReady","beforeDispose","extractContentWithDom","zoomChanged"],Rg=function(t,e,r){(!t.lifecycle.shadowEditFragment||Lg.indexOf(e.eventType)>=0)&&(r||!t.plugins.some(function(n){return Fg(e,n)}))&&t.plugins.forEach(function(n){n.onPluginEvent&&n.onPluginEvent(e)})};function Fg(t,e){var r;return e.onPluginEvent&&(!((r=e.willHandleEventExclusively)===null||r===void 0)&&r.call(e,t))?(e.onPluginEvent(t),!0):!1}var Sl={createContentModel:q0,createEditorContext:Y0,formatContentModel:Q0,setContentModel:fg,setLogicalRoot:Mg,getDOMSelection:tg,setDOMSelection:Sg,focus:Z0,addUndoSnapshot:G0,restoreUndoSnapshot:dg,attachDomEvent:j0,triggerEvent:Rg,switchShadowEdit:Og,getVisibleViewport:ng,setEditorStyle:_g,announce:W0},Pg=(function(){function t(e,r,n,a){this.root=e,this.getDarkColor=r,this.knownColors=n,this.generateColorKey=a}return t.prototype.updateKnownColor=function(e,r,n){var a=this;r&&n?(this.knownColors[r]||(this.knownColors[r]=n),e&&this.root.style.setProperty(r,n.darkModeColor)):e&&Object.keys(this.knownColors).forEach(function(i){a.root.style.setProperty(i,a.knownColors[i].darkModeColor)})},t.prototype.reset=function(){var e=this;Object.keys(this.knownColors).forEach(function(r){e.root.style.removeProperty(r)})},t})();function Ag(t,e,r,n){return r===void 0&&(r={}),n===void 0&&(n=Iv),new Pg(t,e,r,n)}var Ng=function(t){return function(e){return t.htmlToDOM(e).body.innerHTML}};function Ig(t){return t&&sd(t)?t:xg(t)}function sd(t){return typeof t.htmlToDOM=="function"}var Bg=function(t){return t};function xg(t){var e=t||Bg;return{htmlToDOM:function(r){return new DOMParser().parseFromString(e(r),"text/html")},isBypassed:!t}}var Hg=(function(){function t(e,r){this.contentDiv=e,this.options=r}return t.prototype.queryElements=function(e){return it(this.contentDiv.querySelectorAll(e))},t.prototype.getTextContent=function(){return this.contentDiv.textContent||""},t.prototype.isNodeInEditor=function(e,r){return r&&e==this.contentDiv?!1:this.contentDiv.contains(e)},t.prototype.calculateZoomScale=function(){var e,r=((e=this.contentDiv.getBoundingClientRect())===null||e===void 0?void 0:e.width)||0,n=this.contentDiv.offsetWidth;return n>0&&r>0?Math.round(r/n*100)/100:1},t.prototype.setDomAttribute=function(e,r){r===null?this.contentDiv.removeAttribute(e):this.contentDiv.setAttribute(e,r)},t.prototype.getDomAttribute=function(e){return this.contentDiv.getAttribute(e)},t.prototype.getDomStyle=function(e){return this.contentDiv.style[e]},t.prototype.findClosestElementAncestor=function(e,r){var n=F(e,"ELEMENT_NODE")?e:e.parentElement,a=r?n?.closest(r):n;return a&&this.isNodeInEditor(a)&&a!=this.contentDiv?a:null},t.prototype.findClosestBlockElement=function(e){for(var r=e;r&&this.isNodeInEditor(r);){if(F(r,"ELEMENT_NODE")&&Xt(r))return r;r=r.parentElement}return this.contentDiv},t.prototype.hasFocus=function(){var e=this.contentDiv.ownerDocument.activeElement;return!!(e&&this.contentDiv.contains(e))},t.prototype.isRightToLeft=function(){var e,r=this.contentDiv,n=(e=r.ownerDocument.defaultView)===null||e===void 0?void 0:e.getComputedStyle(r);return n?.direction=="rtl"},t.prototype.getClientWidth=function(){var e,r=this.contentDiv,n=(e=r.ownerDocument.defaultView)===null||e===void 0?void 0:e.getComputedStyle(r),a=Je(n?.paddingLeft),i=Je(n?.paddingRight);return this.contentDiv.clientWidth-(a+i)},t.prototype.getClonedRoot=function(){if(this.options.cloneIndependentRoot){var e=this.contentDiv.ownerDocument.implementation.createHTMLDocument(),r=e.importNode(this.contentDiv,!0);return r}else return this.contentDiv.cloneNode(!0)},t.prototype.getContainerFormat=function(e,r){var n,a,i=this.contentDiv.ownerDocument.defaultView,o=i?.getComputedStyle(this.contentDiv);return o?{fontSize:o.fontSize,fontFamily:o.fontFamily,fontWeight:o.fontWeight,textColor:Br(this.contentDiv,!1,!!e,r,o.color),backgroundColor:Br(this.contentDiv,!0,!!e,r,o.backgroundColor),italic:o.fontStyle=="italic",letterSpacing:o.letterSpacing,lineHeight:o.lineHeight,strikethrough:(n=o.textDecoration)===null||n===void 0?void 0:n.includes("line-through"),superOrSubScriptSequence:o.verticalAlign,underline:(a=o.textDecoration)===null||a===void 0?void 0:a.includes("underline")}:{}},t.prototype.getRangesByText=function(e,r,n){return Ip(this.contentDiv,e,r,n)},t})();function ud(t,e){return e===void 0&&(e={}),new Hg(t,e)}var zg=/\$\{(\w+)\}/;function dd(t,e,r){if(t=="OL"){var n=to(e,r??1),a=fo[e];return a?a.replace(zg,n):void 0}else return co[e]}function fd(t,e){var r=e=="OL"?fo[t]:co[t];return r?.indexOf('"')>=0}var Ug={metadataDefinition:Ha,applierFunction:function(t,e,r){var n,a=r.listFormat.nodeStack.length-2;if(a>=0){var i=(n=r.listFormat.nodeStack[a+1].listType)!==null&&n!==void 0?n:"OL",o=ro(i,t??{},a);o!==void 0&&(fd(o,i)?e.listStyleType=dd(i,o,r.listFormat.threadItemCounts[a]):delete e.listStyleType)}}},Gg={metadataDefinition:Ha,applierFunction:function(t,e,r){var n,a=r.listFormat.nodeStack.length-2;if(a>=0){var i=(n=r.listFormat.nodeStack[a+1].listType)!==null&&n!==void 0?n:"OL",o=ro(i,t??{},a);if(o!==void 0)if(fd(o,i))delete e.listStyleType;else{var s=r.listFormat.threadItemCounts[a]>0?r.listFormat.threadItemCounts[a]:1,l=dd(i,o,s);l&&(e.listStyleType=l)}}}};function Kg(t){var e,r={},n=(e=t.defaultDomToModelOptions)!==null&&e!==void 0?e:{};return{builtIn:r,customized:n,calculated:Ou([r,n])}}function Wg(t){var e,r={metadataAppliers:{listItem:Ug,listLevel:Gg}},n=(e=t.defaultModelToDomOptions)!==null&&e!==void 0?e:{};return{builtIn:r,customized:n,calculated:Du([r,n])}}var Vg="paragraph",jg=(function(){function t(){this.nextId=0,this.paragraphMap={},t.prefixNum++}return t.prototype.assignMarkerToModel=function(e,r){var n=Pp(e),a=r;n?(a._marker=n,this.paragraphMap[n]=r):(a._marker=this.generateId(),this.applyMarkerToDom(e,r))},t.prototype.applyMarkerToDom=function(e,r){var n=r;n._marker||(n._marker=this.generateId());var a=n._marker;a&&(Ap(e,a),this.paragraphMap[a]=r)},t.prototype.getParagraphFromMarker=function(e){var r=e._marker;return r&&this.paragraphMap[r]||null},t.prototype.clear=function(){this.paragraphMap={}},t.prototype._reset=function(){t.prefixNum=0,this.nextId=0},t.prototype._getMap=function(){return this.paragraphMap},t.prototype.generateId=function(){return Vg+"_"+t.prefixNum+"_"+this.nextId++},t.prefixNum=0,t})();function qg(){return new jg}var Xg=(function(){function t(e,r){var n=this;this.contentDiv=e,this.onMutation=r,this.onMutationInternal=function(a){for(var i=!0,o=null,s=null,l=[],u=[],d=!1,f=new Set,v=new Set,c=0;c<a.length&&i;c++){var h=a[c],p=h.target;if(!f.has(p)){if(!v.has(p))if(Xi(p,n.domHelper)||uu(p,n.domHelper)){f.add(p);continue}else v.add(p);switch(h.type){case"attributes":n.domHelper.isNodeInEditor(p,!0)&&(h.attributeName=="id"&&F(p,"ELEMENT_NODE")?n.onMutation({type:"elementId",element:p}):i=!1);break;case"characterData":s&&s!=h.target?i=!1:(s=h.target,d=!0);break;case"childList":o?o!=h.target&&(i=!1):o=h.target,i&&(l=l.concat(Array.from(h.addedNodes)),u=u.concat(Array.from(h.removedNodes)));break}}}i?((l.length>0||u.length>0)&&n.onMutation({type:"childList",addedNodes:l,removedNodes:u}),d&&n.onMutation({type:"text"})):n.onMutation({type:"unknown"})},this.observer=new MutationObserver(this.onMutationInternal),this.domHelper=ud(e)}return t.prototype.startObserving=function(){this.observer.observe(this.contentDiv,{subtree:!0,childList:!0,attributes:!0,characterData:!0})},t.prototype.stopObserving=function(){this.observer.disconnect()},t.prototype.flushMutations=function(e){var r=this.observer.takeRecords();e||this.onMutationInternal(r)},t})();function Tl(t,e){return new Xg(t,e)}function Jt(t){var e,r=(e=t.__roosterjsContentModel)!==null&&e!==void 0?e:{},n=r.paragraph,a=r.segments;return n&&n.blockType=="Paragraph"&&Array.isArray(n.segments)&&Array.isArray(a)&&a.every(function(i){return n.segments.includes(i)})}function Yg(t){var e,r=(e=t.__roosterjsContentModel)!==null&&e!==void 0?e:{},n=r.entity,a=r.parent;return n?.blockType=="Entity"&&n.wrapper&&a?.blockGroupType&&Array.isArray(a.blocks)}function or(t){return t&&Jt(t)?t.__roosterjsContentModel:null}function wl(t){var e=t.__roosterjsContentModel,r=e?.table;return r?.blockType=="Table"&&Array.isArray(r.rows)&&r.rows.every(function(n){return Array.isArray(n?.cells)&&n.cells.every(function(a){return a?.blockGroupType=="TableCell"})})?e:null}function ea(t){delete t.__roosterjsContentModel}var Zg=(function(){function t(e){this.keepSelectionMarkerWhenEnteringTextNode=e}return t.prototype.onSegment=function(e,r,n){var a=e;a.__roosterjsContentModel={paragraph:r,segments:n}},t.prototype.onParagraph=function(e){for(var r=null,n=e.firstChild;n;n=n.nextSibling)if(F(n,"TEXT_NODE"))if(!r)r=n;else{var a=or(r);a&&Jt(n)&&(a.segments=a.segments.concat(n.__roosterjsContentModel.segments),n.__roosterjsContentModel.segments=[])}else F(n,"ELEMENT_NODE")?(r=null,this.onParagraph(n)):r=null},t.prototype.onTable=function(e,r){var n=e;n.__roosterjsContentModel={table:r}},t.prototype.onBlockEntity=function(e,r){this.onBlockEntityDelimiter(e.wrapper.previousSibling,e,r),this.onBlockEntityDelimiter(e.wrapper.nextSibling,e,r)},t.prototype.onMergeText=function(e,r){var n;Jt(e)&&Jt(r)?e.nextSibling==r&&((n=e.__roosterjsContentModel.segments).push.apply(n,I([],L(r.__roosterjsContentModel.segments),!1)),ea(r)):(ea(r),ea(e))},t.prototype.clearIndex=function(e){cd(e)},t.prototype.reconcileSelection=function(e,r,n){var a,i,o;if(n){var s=void 0;n.type=="range"&&this.isCollapsed(n)&&(s=n.start.node)&&F(s,"TEXT_NODE")&&Jt(s)&&s.__roosterjsContentModel.segments.length>0?this.reconcileTextSelection(s):(o=this.selectionMarkerToKeepWhenEnteringTextNode(n,r),Ot(e))}switch(r.type){case"image":var l=or(r.image),u=l?.segments[0];return u?(u.isSelected=!0,Ot(e,u),!0):!1;case"table":var d=wl(r.table);if(d){var f=(a=d.table.rows[r.firstRow])===null||a===void 0?void 0:a.cells[r.firstColumn],v=(i=d.table.rows[r.lastRow])===null||i===void 0?void 0:i.cells[r.lastColumn];if(f&&v)return Ot(e,f,v),!0}return!1;case"range":var c=r.range;if(c){var h=c.startContainer,p=c.startOffset,m=c.endContainer,b=c.endOffset,y=c.collapsed;if(delete e.hasRevertedRangeSelection,y)return!!this.reconcileNodeSelection(h,p,e.format);if(h==m&&F(h,"TEXT_NODE"))return r.isReverted&&(e.hasRevertedRangeSelection=!0),Jt(h)&&!!this.reconcileTextSelection(h,p,b,o);var E=this.reconcileNodeSelection(h,p),S=this.reconcileNodeSelection(m,b);return E&&S?(r.isReverted&&(e.hasRevertedRangeSelection=!0),Ot(e,E,S),!0):!1}break}return!1},t.prototype.reconcileChildList=function(e,r){var n=!0,a={segIndex:-1},i=e[0];e.length==1&&F(i,"TEXT_NODE")?n=this.reconcileAddedNode(i,a):e.length>0&&(n=!1);var o=r[0];return n&&r.length==1?n=this.reconcileRemovedNode(o,a):r.length>0&&(n=!1),n&&!a.pendingTextNode},t.prototype.reconcileElementId=function(e){var r;if(re(e,"img")){var n=or(e);return((r=n?.segments[0])===null||r===void 0?void 0:r.segmentType)=="Image"?(n.segments[0].format.id=e.id,!0):!1}else if(re(e,"table")){var a=wl(e);return a?(a.table.format.id=e.id,!0):!1}else return!1},t.prototype.onBlockEntityDelimiter=function(e,r,n){if(F(e,"ELEMENT_NODE")&&Ut(e)&&e.firstChild){var a=e.firstChild;a.__roosterjsContentModel={entity:r,parent:n}}},t.prototype.isCollapsed=function(e){var r=e.start,n=e.end;return r.node==n.node&&r.offset==n.offset},t.prototype.reconcileNodeSelection=function(e,r,n){return F(e,"TEXT_NODE")?Jt(e)?this.reconcileTextSelection(e,r):Yg(e)?this.reconcileDelimiterSelection(e,n):void 0:r>=e.childNodes.length?this.insertMarker(e.lastChild,!0):this.insertMarker(e.childNodes[r],!1)},t.prototype.insertMarker=function(e,r){var n,a=e&&or(e);if(a){var i=a.paragraph,o=a.segments,s=i.segments.indexOf(o[0]);if(s>=0){var l=!r&&i.segments[s-1]||i.segments[s];n=Ge(l.format),i.segments.splice(r?s+1:s,0,n)}}return n},t.prototype.reconcileTextSelection=function(e,r,n,a){var i,o,s,l,u,d,f,v=e.__roosterjsContentModel,c=v.paragraph,h=v.segments,p=h[0],m=h[h.length-1],b;if(p?.segmentType=="Text"&&m?.segmentType=="Text"){var y=[],E=e.nodeValue||"",S=[];if(r===void 0)p.text=E,y.push(p),S.push(p);else{if(r>0&&(p.text=E.substring(0,r),y.push(p),S.push(p)),n===void 0){var T=Ge((o=a?.format)!==null&&o!==void 0?o:p.format);y.push(T),r<((s=e.nodeValue)!==null&&s!==void 0?s:"").length&&(p.link&&Ui(T,p.link),p.code&&Gi(T,p.code)),b=T,n=r}else if(n>r){var k=We(E.substring(r,n),(l=a?.format)!==null&&l!==void 0?l:p.format,p.link,p.code);k.isSelected=!0,y.push(k),S.push(k),b=k}if(n<E.length){var R=We(E.substring(n),(u=a?.format)!==null&&u!==void 0?u:p.format,p.link,p.code);y.push(R),S.push(R)}}var M=c.segments.indexOf(p),w=c.segments.indexOf(m);if(M>=0&&w>=0){for(;M>0&&c.segments[M-1].segmentType=="SelectionMarker";)M--;for(;w<c.segments.length-1&&c.segments[w+1].segmentType=="SelectionMarker";)w++;(i=c.segments).splice.apply(i,I([M,w-M+1],L(y),!1))}this.onSegment(e,c,S)}else if(p?.segmentType=="Entity"&&p==m){var A=p.wrapper,N=c.segments.indexOf(p),J=e.parentElement,z=A.previousSibling==J,O=A.nextSibling==J;if(N>=0&&J&&Ut(J)&&(z||O)){var T=Ge((d=a?.format)!==null&&d!==void 0?d:((f=c.segments[O?N+1:N-1])!==null&&f!==void 0?f:p).format);c.segments.splice(O?N+1:N,0,T),b=T}}return b},t.prototype.reconcileDelimiterSelection=function(e,r){var n,a=e.__roosterjsContentModel,i=a.entity,o=a.parent,s=o.blocks.indexOf(i),l=e.parentElement,u=i.wrapper,d=u.previousSibling==l,f=u.nextSibling==l;if(s>=0&&l&&Ut(l)&&(d||f)){n=Ge(r);var v=je(!0,void 0,r);v.segments.push(n),o.blocks.splice(d?s:s+1,0,v)}return n},t.prototype.reconcileAddedNode=function(e,r){var n=null,a=-1,i,o=e.previousSibling,s=e.nextSibling;if((n=or(Jg(o)))&&(i=n.segments[n.segments.length-1])&&(a=n.paragraph.segments.indexOf(i))>=0)this.indexNode(n.paragraph,a+1,e,i.format);else if((n=or(Qg(s)))&&(i=n.segments[0])&&(a=n.paragraph.segments.indexOf(i))>=0)this.indexNode(n.paragraph,a,e,i.format);else if(r.paragraph&&r.segIndex>=0)this.indexNode(r.paragraph,r.segIndex,e,r.format);else if(r.pendingTextNode===void 0)r.pendingTextNode=e;else return!1;return!0},t.prototype.reconcileRemovedNode=function(e,r){var n=null,a;if(r.segIndex<0&&!r.paragraph&&(n=or(e))&&(a=n.segments[0])){if(r.format=a.format,r.paragraph=n.paragraph,r.segIndex=n.paragraph.segments.indexOf(n.segments[0]),r.segIndex<0)return!1;for(var i=0;i<n.segments.length;i++){var o=n.paragraph.segments.indexOf(n.segments[i]);o>=0&&n.paragraph.segments.splice(o,1)}return r.pendingTextNode&&(this.indexNode(r.paragraph,r.segIndex,r.pendingTextNode,n.segments[0].format),r.pendingTextNode=null),!0}else return!1},t.prototype.indexNode=function(e,r,n,a){var i,o=a?C({},a):void 0;o&&ie(o).forEach(function(l){lo[l]===void 0&&delete o[l]});var s=We((i=n.textContent)!==null&&i!==void 0?i:"",o);e.segments.splice(r,0,s),this.onSegment(n,e,[s])},t.prototype.selectionMarkerToKeepWhenEnteringTextNode=function(e,r){if(this.keepSelectionMarkerWhenEnteringTextNode&&e.type=="range"&&this.isCollapsed(e)&&r.type=="range"&&F(r.range.commonAncestorContainer,"TEXT_NODE")&&r.range.commonAncestorContainer.parentElement==e.start.node&&Jt(r.range.commonAncestorContainer)&&r.range.commonAncestorContainer.__roosterjsContentModel.paragraph.segments[0].segmentType=="SelectionMarker")return r.range.commonAncestorContainer.__roosterjsContentModel.paragraph.segments[0]},t})();function Jg(t){for(;t?.lastChild;)t=t.lastChild;return t}function Qg(t){for(;t?.firstChild;)t=t.firstChild;return t}function cd(t){ea(t);for(var e=t.firstChild;e;e=e.nextSibling)cd(e)}var $g=(function(){function t(e,r){var n=this;this.editor=null,this.onMutation=function(a){if(n.editor)switch(a.type){case"childList":n.state.domIndexer.reconcileChildList(a.addedNodes,a.removedNodes)||n.invalidateCache();break;case"text":n.updateCachedModel(n.editor,!0);break;case"elementId":var i=a.element;n.state.domIndexer.reconcileElementId(i)||n.invalidateCache();break;case"unknown":n.invalidateCache();break}},this.onNativeSelectionChange=function(){var a;!((a=n.editor)===null||a===void 0)&&a.hasFocus()&&n.updateCachedModel(n.editor)},this.state={domIndexer:new Zg(e.experimentalFeatures&&e.experimentalFeatures.indexOf("KeepSelectionMarkerWhenEnteringTextNode")>=0),textMutationObserver:Tl(r,this.onMutation)},e.enableParagraphMap&&(this.state.paragraphMap=qg())}return t.prototype.getName=function(){return"Cache"},t.prototype.initialize=function(e){this.editor=e,this.editor.getDocument().addEventListener("selectionchange",this.onNativeSelectionChange),this.state.textMutationObserver.startObserving()},t.prototype.dispose=function(){this.state.textMutationObserver.stopObserving(),this.editor&&(this.editor.getDocument().removeEventListener("selectionchange",this.onNativeSelectionChange),this.editor=null)},t.prototype.getState=function(){return this.state},t.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"logicalRootChanged":this.invalidateCache(),this.state.textMutationObserver.stopObserving(),this.state.textMutationObserver=Tl(e.logicalRoot,this.onMutation),this.state.textMutationObserver.startObserving();break;case"selectionChanged":this.updateCachedModel(this.editor);break;case"contentChanged":var r=e.contentModel,n=e.selection;r?ba(this.state,r,n):this.invalidateCache();break}},t.prototype.invalidateCache=function(){var e,r;!((e=this.editor)===null||e===void 0)&&e.isInShadowEdit()||(this.state.cachedModel=void 0,this.state.cachedSelection=void 0,(r=this.state.paragraphMap)===null||r===void 0||r.clear())},t.prototype.updateCachedModel=function(e,r){if(!e.isInShadowEdit()){var n=this.state.cachedSelection;this.state.cachedSelection=void 0;var a=e.getDOMSelection()||void 0,i=this.state.cachedModel,o=r||!n||!a||!ad(a,n);o?!i||!a||!this.state.domIndexer.reconcileSelection(i,a,n)?this.invalidateCache():ba(this.state,i,a):this.state.cachedSelection=n}},t})();function em(t,e){return new $g(t,e)}var tm=2,rm=(function(){function t(e){var r=this,n;this.editor=null,this.disposer=null,this.onContextMenuEvent=function(a){var i;if(r.editor){var o=[],s=a,l=a,u=s.button==tm?s.target:l?.pointerType==="touch"||l?.pointerType==="pen"?l.target:r.getFocusedNode(r.editor);u&&r.state.contextMenuProviders.forEach(function(d){var f,v=(f=d.getContextMenuItems(u,s))!==null&&f!==void 0?f:[];v?.length>0&&(o.length>0&&o.push(null),o.push.apply(o,I([],L(v),!1)))}),(i=r.editor)===null||i===void 0||i.triggerEvent("contextMenu",{rawEvent:s,items:o})}},this.state={contextMenuProviders:((n=e.plugins)===null||n===void 0?void 0:n.filter(nm))||[]}}return t.prototype.getName=function(){return"ContextMenu"},t.prototype.initialize=function(e){var r=this;this.editor=e;var n={contextmenu:{beforeDispatch:function(a){return r.onContextMenuEvent(a)}}};this.disposer=this.editor.attachDomEvent(n)},t.prototype.dispose=function(){var e;(e=this.disposer)===null||e===void 0||e.call(this),this.disposer=null,this.editor=null},t.prototype.getState=function(){return this.state},t.prototype.getFocusedNode=function(e){var r=e.getDOMSelection();return r?(r.type=="range"&&r.range.collapse(!0),Wi(r)||null):null},t})();function nm(t){var e;return!!(!((e=t)===null||e===void 0)&&e.getContextMenuItems)}function am(t){return new rm(t)}function vd(t){return t&&t.blockType=="Paragraph"?t.segments.every(function(e){return e.segmentType!=="SelectionMarker"&&e.segmentType=="Br"}):t&&t.blockType=="BlockGroup"?t.blocks.every(vd):!!t}var im=function(t){var e=t.insertPoint,r=t.deleteResult;if(r=="range"&&e?.path){var n=ot(e.path,["ListItem"],["TableCell"]),a=e.path[n];if(n>=0&&a&&a.blockGroupType=="ListItem"){var i=e.path[n+1].blocks.indexOf(a),o=i>-1?e.path[n+1].blocks[i-1]:void 0,s=i>-1?e.path[n+1].blocks[i+1]:void 0;ha(a)&&(!o||Aa(o))&&s&&vd(s)&&(D(a).levels=[])}}};function om(t,e){if(t.getEnvironment().isSafari&&e?.type=="image"){var r=new Range;r.setStartBefore(e.image),r.setEndAfter(e.image),t.setDOMSelection({range:r,type:"range",isReverted:!1})}}function lm(t){var e,r,n;lt(t,function(a,i,o,s){if(e)return i!=n&&r?.segments.includes(e)&&r.segments.splice(r.segments.indexOf(e),1),!0;var l=s?.find(function(u){return u.segmentType=="SelectionMarker"});return!e&&l&&(n=i,r=o?.blockType=="Paragraph"?o:void 0,e=l),!1})}var Oi="_EBlock",hd="100%",pd="inline-block",sm=function(t,e){var r=t;r&&r.wrapper&&r.blockType=="Entity"&&F(e,"ELEMENT_NODE")&&re(e,"div")&&!Xt(r.wrapper)&&r.wrapper.style.display==pd&&r.wrapper.style.width==hd&&(e.classList.add(Oi),e.style.display="block",e.style.width="")},um=function(t,e){e.classList.contains(Oi)&&(e.classList.remove(Oi),e.style.display=pd,e.style.width=hd)};function dm(t){var e=Tt(t);t.rows=t.rows.map(function(r){return C(C({},r),{cells:r.cells.filter(function(n){return n.isSelected})})}).filter(function(r){return r.cells.length>0}),delete t.format.width,t.widths=e?t.widths.filter(function(r,n){return n>=e?.firstColumn&&n<=e?.lastColumn}):[]}function gd(t){Li(t,!1),fm(t)}function Li(t,e){for(var r,n,a,i=t.blocks.length-1;i>=0;i--){var o=t.blocks[i];switch(o.blockType){case"BlockGroup":Li(o,e),(o.blockGroupType=="General"?o.blocks.length==0&&!o.isSelected:o.blocks.length==0)&&t.blocks.splice(i,1);break;case"Divider":case"Entity":o.isSelected?e=!0:t.blocks.splice(i,1);break;case"Paragraph":var s=[];try{for(var l=(r=void 0,Wt(o.segments)),u=l.next();!u.done;u=l.next()){var d=u.value;d.segmentType=="General"?(gd(d),(d.blocks.length>0||d.isSelected)&&s.push(d)):d.isSelected&&d.segmentType!="SelectionMarker"&&s.push(d)}}catch(y){r={error:y}}finally{try{u&&!u.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}o.segments=s,o.segments.length==0?t.blocks.splice(i,1):e=!0;break;case"Table":for(var f=[],v=0;v<o.rows.length;v++){for(var c=o.rows[v],h=0;h<c.cells.length;h++){var p=c.cells[h];p.isSelected?e=!0:Li(p,e)}for(var m=[],b=0;b<c.cells.length;b++){var p=c.cells[b];(p.isSelected||p.blocks.length>0)&&m.push(p)}c.cells=m,c.cells.length>0&&f.push(c)}if(!e&&f.length==1&&f[0].cells.length==1&&!f[0].cells[0].isSelected){var p=f[0].cells[0];(a=t.blocks).splice.apply(a,I([i,1],L(p.blocks),!1))}else f.length==0?t.blocks.splice(i,1):o.rows=f;break}}return e}function fm(t){var e=t.blocks[0];if(t.blocks.length==1){for(;e.blockType=="BlockGroup";)if(t.blocks=e.blocks,e=t.blocks[0],t.blocks.length>1)return;e.blockType=="Paragraph"&&(e.isImplicit=!0,e.format={},cm(e))}}function cm(t){var e=t.segmentFormat;if(e!==void 0)for(var r=0;r<t.segments.length;r++){var n=t.segments[r];n.format=C(C({},t.segmentFormat),n.format)}}var vm=function(t,e){F(e,"ELEMENT_NODE")&&re(e,"table")&&Sn(e.ownerDocument,e,"div"),F(e,"ELEMENT_NODE")&&!e.isContentEditable&&e.removeAttribute("contenteditable"),sm(t,e)};function hm(t,e,r){var n=t.getDOMSelection();if(om(t,n),n&&(n.type!="range"||!n.range.collapsed)){var a=t.getContentModelCopy("disconnected");gd(a),n.type==="table"?lt(a,function(f,v){return v?.table?(dm(v.table),!0):!1}):n.type==="range"&&lm(a);var i=Fa();i.onNodeCreated=vm;var o=t.getDocument(),s=o.createElement("div"),l=zi(o,s,a,i),u=l?pm(o,l):null;if(u){var d=t.triggerEvent("beforeCutCopy",{clonedRoot:s,range:u,rawEvent:r,isCut:e}).clonedRoot;return{htmlContent:d,textContent:pc(a)}}}return null}function pm(t,e){var r,n=null;if(e.type==="table"){var a=e.table,i=((r=a.parentElement)===null||r===void 0?void 0:r.childElementCount)==1?a.parentElement:a;n=t.createRange(),n.selectNode(i)}else e.type==="image"?(n=t.createRange(),n.selectNode(e.image)):n=e.range;return n}var gm="<!--",mm="<!--",bm="-->",xn="<style",ym="</style>",Em=/\W/;function Cm(t){for(var e,r=kl(t),n=r.styleIndex,a=r.styleEndIndex;n>-1;)t=Za(t,gm,a,n),t=Za(t,mm,a,n),t=Za(t,bm,a,n),e=kl(t,a+1),n=e.styleIndex,a=e.styleEndIndex;return t}function kl(t,e){e===void 0&&(e=0);for(var r=t.toLowerCase(),n=r.indexOf(xn,e),a=n+xn.length,i=t.substring(a,a+1);!Em.test(i)&&n>-1;)n=r.indexOf(xn,n+1),a=n+xn.length,i=t.substring(a,a+1);var o=r.indexOf(ym,e);return{styleIndex:n,styleEndIndex:o}}function Za(t,e,r,n){for(var a=t.indexOf(e,n);a>-1&&a<r;)t=t.substring(0,a)+t.substring(a+e.length),a=t.indexOf(e,a+1);return t}var Sm=function(t,e){(e.tagName=="DIV"||e.tagName=="P")&&(delete t.width,delete t.height)},md=["a","abbr","address","area","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","fieldset","figcaption","figure","font","footer","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","menu","menuitem","meter","nav","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","small","span","strike","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","tt","u","ul","var","wbr","xmp"],bd=["applet","audio","base","basefont","embed","frame","frameset","iframe","link","meta","noscript","object","param","script","slot","source","style","template","title","track","video"],Tm=/^\s*var\(\s*[a-zA-Z0-9-_]+\s*(,\s*(.*))?\)\s*$/,wm="var(",km=["accept","align","alt","checked","cite","class","color","cols","colspan","contextmenu","coords","datetime","default","dir","dirname","disabled","download","face","headers","height","hidden","high","href","hreflang","ismap","kind","label","lang","list","low","max","maxlength","media","min","multiple","open","optimum","pattern","placeholder","readonly","rel","required","reversed","rows","rowspan","scope","selected","shape","size","sizes","span","spellcheck","src","srclang","srcset","start","step","style","tabindex","target","title","translate","type","usemap","valign","value","width","wrap","bgColor"],_m={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none","font-style":"normal","font-variant-ligatures":"normal","font-variant-caps":"normal","font-weight":"400","letter-spacing":"normal",orphans:"2","text-align":"start","text-indent":"0px","text-transform":"none",widows:"2","word-spacing":"0px","white-space":"normal"};function yd(t,e,r,n,a){var i=t.tagName.toLowerCase(),o=r.indexOf(i)>=0?null:Ed(t.ownerDocument,e.indexOf(i)>=0?i:"span",t.attributes,n,a);if(o)for(var s=t.firstChild;s;s=s.nextSibling){var l=F(s,"ELEMENT_NODE")?yd(s,e,r,n,a):F(s,"TEXT_NODE")?s.cloneNode():null;l&&o?.appendChild(l)}return o}function Ed(t,e,r,n,a){for(var i=t.createElement(e),o=0;o<r.length;o++){var s=r[o],l=s.name.toLowerCase().trim(),u=s.value,d=a?.[l],f=l=="style"?Dm(e,u,n):typeof d=="function"?d(u,e):typeof d=="boolean"?d?u:null:km.indexOf(l)>=0||l.indexOf("data-")==0?u:null;f!=null&&!f.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)&&i.setAttribute(l,f)}return i}function Dm(t,e,r){var n=e.split(";"),a=[];return n.forEach(function(i){var o=i.indexOf(":"),s=i.slice(0,o).trim(),l=i.slice(o+1).trim();if(s&&l){Om(l)&&(l=Mm(l));var u=r?.[s],d=typeof u=="function"?u(l,t):u===!1?null:l;d&&d!="inherit"&&d!="initial"&&d.indexOf("expression")<0&&!s.startsWith("-")&&_m[s]!=d&&a.push(s+":"+d)}}),a.join(";")}function Mm(t){var e=Tm.exec(t);return e?.[2]||""}function Om(t){return t.indexOf(wm)==0}var Lm={position:!1};function Rm(t){var e=md.concat(t.additionalAllowedTags),r=bd.concat(t.additionalDisallowedTags),n=Object.assign({},Lm,t.styleSanitizers),a=t.attributeSanitizers;return function(i,o,s){var l=yd(o,e,r,n,a);l&&s.defaultElementProcessors.entity(i,l,s)}}var Fm=function(t){return t=="flex"?null:t},Pm={position:!1,display:Fm};function Am(t){var e=md.concat(t.additionalAllowedTags),r=bd.concat(t.additionalDisallowedTags),n=Object.assign({},Pm,t.styleSanitizers),a=t.attributeSanitizers;return function(i,o,s){var l=o.tagName.toLowerCase(),u=e.indexOf(l)>=0?function(d,f,v){var c,h,p=Ed(f.ownerDocument,f.tagName,f.attributes,n,a);Ft(p,f),(h=(c=v.defaultElementProcessors)["*"])===null||h===void 0||h.call(c,d,p,v)}:r.indexOf(l)>=0?void 0:s.defaultElementProcessors.span;u?.(i,o,s)}}var Nm=function(t,e){var r=e.style.display;r&&r!="flex"&&(t.display=r)},Im=function(t,e,r){var n,a,i=r.blockFormat.whiteSpace;yn(i)&&(e.nodeValue=(a=(n=e.nodeValue)===null||n===void 0?void 0:n.replace(/\u0020\u0020/g,"  "))!==null&&a!==void 0?a:""),r.defaultElementProcessors["#text"](t,e,r)},Bm="pre",xm=function(t,e,r,n){var a,i;e.style.whiteSpace!=Bm&&((i=(a=r.defaultFormatParsers).whiteSpace)===null||i===void 0||i.call(a,t,e,r,n))},Hm={processorOverride:{},formatParserOverride:{},additionalFormatParsers:{},additionalAllowedTags:[],additionalDisallowedTags:[],styleSanitizers:{},attributeSanitizers:{},processNonVisibleElements:!1};function zm(t,e,r,n){var a=C(C({},Hm),n);return Dn(C(C({defaultFormat:e},rd(t)),{experimentalFeatures:[]}),r,{processorOverride:{"#text":Im,entity:Rm(a),"*":Am(a)},formatParserOverride:{display:Nm,whiteSpace:xm},additionalFormatParsers:{container:[Sm],entity:[um]}},a)}var Um="rgb(0,0,0)",Gm={includeCachedElement:function(t,e){return e=="cache"?void 0:t}};function Cd(t){return pn(t,Gm)}function Km(t,e,r){var n=e.fragment,a=e.domToModelOption,i=e.customizedMerge,o=e.pasteType,s=e.clipboardData,l=e.containsBlockElements;t.formatContentModel(function(u,d){if(!r&&s.modelBeforePaste){var f=Cd(s.modelBeforePaste);u.blocks=f.blocks}var v=zm(t.getDocument(),void 0,t.getEnvironment().domToModelSettings.customized,a);v.segmentFormat=Wm(u,o);var c=En(n,v),h={mergeFormat:o=="mergeFormat"?"keepSourceEmphasisFormat":"none",mergeTable:Vm(c),addParagraphAfterMergedContent:l},p=i?i(u,c):so(u,c,d,h);return p&&(d.newPendingFormat=C(C(C({},lo),u.format),o=="normal"&&!l?jm(c):p.marker.format)),!0},{changeSource:Ve.Paste,getChangeData:function(){return s},scrollCaretIntoView:!0,apiName:"paste"})}function Wm(t,e){var r=Bp(t,!0)[0];if(r){var n=Ju(r);return e=="normal"&&(n.textColor=Um),n}return{}}function Vm(t){return t.blocks.length==2&&t.blocks[0].blockType==="Table"&&t.blocks[1].blockType==="Paragraph"&&t.blocks[1].segments.length===1&&t.blocks[1].segments[0].segmentType==="Br"&&t.blocks.splice(1),t.blocks.length===1&&t.blocks[0].blockType==="Table"}function jm(t){if(t.blocks.length==1){var e=L(t.blocks,1),r=e[0];if(r.blockType=="Paragraph"){var n=r.segments[r.segments.length-1];return C({},n.format)}}return{}}function qm(t){var e=/(?![^(]*\)),/;return t.split(e).map(function(r){return r.trim()})}function Xm(t){var e=it(t.querySelectorAll("style")),r=[];return e.forEach(function(n){var a,i=n.sheet;if(i)for(var o=0;o<i.cssRules.length;o++){var s=i.cssRules[o];s.type==CSSRule.STYLE_RULE&&s.selectorText&&r.push({selectors:qm(s.selectorText),text:s.style.cssText})}(a=n.parentNode)===null||a===void 0||a.removeChild(n)}),r}function Ym(t,e){for(var r=function(a){var i,o,s=e[a],l=s.selectors,u=s.text;try{for(var d=(i=void 0,Wt(l)),f=d.next();!f.done;f=d.next()){var v=f.value;if(!(!v||!v.trim())){var c=it(t.querySelectorAll(v));c.forEach(function(h){return h.setAttribute("style",u+(h.getAttribute("style")||""))})}}}catch(h){i={error:h}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}},n=e.length-1;n>=0;n--)r(n)}var Ja=" ",Zm=" ",_l=6;function Jm(t,e,r,n){!e.text&&r==="asPlainText"&&n&&(e.text=n.textContent||e.text);var a=e.imageDataUri,i=e.text,o=t.createDocumentFragment();if(r=="asImage"&&a||r!="asPlainText"&&!i&&a){var s=t.createElement("img");s.style.maxWidth="100%",s.src=a,o.appendChild(s)}else r!="asPlainText"&&n?Ft(o,n):i&&i.split(`
`).forEach(function(l,u,d){l=l.replace(/^ /g,Ja).replace(/ $/g,Ja).replace(/\r/g,"").replace(/ {2}/g," "+Ja),l.includes("	")&&(l=Qm(l));var f=t.createTextNode(l);d.length==2&&u==0?(o.appendChild(f),o.appendChild(t.createElement("br"))):u>0&&u<d.length-1?o.appendChild(Sn(t,l==""?t.createElement("br"):f,"div")):o.appendChild(f)});return o}function Qm(t,e){e===void 0&&(e=0);for(var r=t,n;(n=r.indexOf("	"))!=-1;){var a=r.slice(0,n),i=r.slice(n+1),o=_l-(a.length+e)%_l,s=Array(o).fill(Zm).join("");r=a+s+i}return r}function $m(t,e,r,n,a){var i,o,s={additionalAllowedTags:[],additionalDisallowedTags:[],additionalFormatParsers:{},formatParserOverride:{},processorOverride:{},styleSanitizers:{},attributeSanitizers:{},processNonVisibleElements:!!t.getEnvironment().domToModelSettings.customized.processNonVisibleElements},l={eventType:"beforePaste",clipboardData:e,fragment:r,htmlBefore:(i=n.htmlBefore)!==null&&i!==void 0?i:"",htmlAfter:(o=n.htmlAfter)!==null&&o!==void 0?o:"",htmlAttributes:n.metadata,pasteType:a,domToModelOption:s,containsBlockElements:!!n.containsBlockElements};return t.triggerEvent("beforePaste",l,!0)}var Qa="<!--StartFragment-->",Dl="<!--EndFragment-->";function eb(t,e){var r={metadata:{},globalCssRules:[]};return t&&(r=C(C({},nb(e)),{globalCssRules:Xm(t),metadata:rb(t),containsBlockElements:ab(t)}),e.htmlFirstLevelChildTags=tb(t)),r}function tb(t){for(var e,r=[],n=t.body.firstChild;n;n=n.nextSibling)if(F(n,"TEXT_NODE")){var a=(e=n.nodeValue)===null||e===void 0?void 0:e.replace(/(\r\n|\r|\n)/gm,"").trim();a&&r.push("")}else F(n,"ELEMENT_NODE")&&r.push(n.tagName);return r}function rb(t){var e,r={},n=(e=t.querySelector("html"))===null||e===void 0?void 0:e.attributes;return(n?it(n):[]).forEach(function(a){r[a.name]=a.value}),it(t.querySelectorAll("meta")).forEach(function(a){r[a.name]=a.content}),r}function nb(t){var e,r=(e=t.rawHtml)!==null&&e!==void 0?e:"",n=r.indexOf(Qa),a=r.lastIndexOf(Dl),i="",o="";return n>=0&&a>=n+Qa.length?(i=r.substring(0,n),o=r.substring(a+Dl.length),t.html=r.substring(n+Qa.length,a)):t.html=r,{htmlBefore:i,htmlAfter:o}}function ab(t){var e=it(t.body.querySelectorAll("*"));return e.some(function(r){return F(r,"ELEMENT_NODE")&&Xt(r)})}function ib(t,e,r){var n;r===void 0&&(r="normal"),t.focus();var a=!1;e.modelBeforePaste||(a=!0,t.formatContentModel(function(f){return e.modelBeforePaste=Cd(f),!1}));var i=t.getDOMCreator();!i.isBypassed&&e.rawHtml&&(e.rawHtml=Cm(e.rawHtml));var o=Ml(e.rawHtml,i),s=typeof r=="function"?r(o,e):r,l=eb(o,e),u=Jm(t.getDocument(),e,s,(n=e.rawHtml==e.html?o:Ml(e.html,i))===null||n===void 0?void 0:n.body),d=$m(t,e,u,l,s);Ym(d.fragment,l.globalCssRules),Km(t,d,a)}function Ml(t,e){return t?e.htmlToDOM(t):null}var ob=(function(){function t(e){var r=this;this.editor=null,this.disposer=null,this.onPaste=function(n){if(r.editor&&Ol(n)){var a=r.editor,i=n.clipboardData;lb(i,a)&&(n.preventDefault(),Op(it(i.items),r.state.allowedCustomPasteType).then(function(o){a.isDisposed()||ib(a,o,r.state.defaultPasteType)}))}},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[],tempDiv:null,defaultPasteType:e.defaultPasteType}}return t.prototype.getName=function(){return"CopyPaste"},t.prototype.initialize=function(e){var r=this;this.editor=e,this.disposer=this.editor.attachDomEvent({paste:{beforeDispatch:function(n){return r.onPaste(n)}},copy:{beforeDispatch:function(n){return r.onCutCopy(n,!1)}},cut:{beforeDispatch:function(n){return r.onCutCopy(n,!0)}}})},t.prototype.dispose=function(){var e;this.state.tempDiv&&((e=this.state.tempDiv.parentNode)===null||e===void 0||e.removeChild(this.state.tempDiv),this.state.tempDiv=null),this.disposer&&this.disposer(),this.disposer=null,this.editor=null},t.prototype.getState=function(){return this.state},t.prototype.onCutCopy=function(e,r){var n,a;if(!(!this.editor||!Ol(e))){var i=hm(this.editor,r,e);if(i){var o=i.htmlContent,s=i.textContent;e.preventDefault(),(n=e.clipboardData)===null||n===void 0||n.setData("text/html",o.innerHTML),(a=e.clipboardData)===null||a===void 0||a.setData("text/plain",s),r&&this.editor.formatContentModel(function(l,u){return Wr(l,[im],u).deleteResult=="range"&&Et(l),!0},{apiName:"cut",changeSource:Ve.Cut})}}},t})();function Ol(t){return!!t.clipboardData}function lb(t,e){return t?.items?e.getEnvironment().isAndroid?it(t.items).some(function(r){var n=r.type,a=r.kind==="file"&&n!=="",i=n.indexOf("text/")===0;return a||i}):!0:!1}function sb(t){return new ob(t)}var ub={keydown:"keyDown",keyup:"keyUp",keypress:"keyPress"},db=(function(){function t(e,r){var n=this;this.editor=null,this.disposer=null,this.pointerEvent=null,this.timer=0,this.onDragStart=function(a){var i=a,o=i.target,s=F(o,"ELEMENT_NODE")?o:o.parentElement;s&&!s.isContentEditable&&i.preventDefault()},this.onDrop=function(){var a,i,o=(a=n.editor)===null||a===void 0?void 0:a.getDocument();(i=o?.defaultView)===null||i===void 0||i.requestAnimationFrame(function(){n.editor&&(n.editor.takeSnapshot(),n.editor.triggerEvent("contentChanged",{source:Ve.Drop}))})},this.onScroll=function(a){var i;(i=n.editor)===null||i===void 0||i.triggerEvent("scroll",{rawEvent:a,scrollContainer:n.state.scrollContainer})},this.keyboardEventHandler={beforeDispatch:function(a){var i,o,s,l=ub[a.type];(Pa(a)||no(a))&&a.stopPropagation();var u=(s=(o=(i=n.editor)===null||i===void 0?void 0:i.getEnvironment())===null||o===void 0?void 0:o.isAndroid)!==null&&s!==void 0?s:!1,d=!u&&(a.isComposing||n.state.isInIME);n.editor&&l&&!d&&n.editor.triggerEvent(l,{rawEvent:a})}},this.inputEventHandler={beforeDispatch:function(a){var i,o,s;a.stopPropagation();var l=(s=(o=(i=n.editor)===null||i===void 0?void 0:i.getEnvironment())===null||o===void 0?void 0:o.isAndroid)!==null&&s!==void 0?s:!1,u=!l&&(a.isComposing||n.state.isInIME);n.editor&&!u&&n.editor.triggerEvent("input",{rawEvent:a})}},this.onMouseDown=function(a){n.editor&&(n.state.mouseUpEventListerAdded||(n.editor.getDocument().addEventListener("mouseup",n.onMouseUp,!0),n.state.mouseUpEventListerAdded=!0,n.state.mouseDownX=a.pageX,n.state.mouseDownY=a.pageY),n.editor.triggerEvent("mouseDown",{rawEvent:a}),a.defaultPrevented&&(n.pointerEvent=null),n.pointerEvent&&n.editor.triggerEvent("pointerDown",{rawEvent:n.pointerEvent,originalEvent:a}))},this.onMouseUp=function(a){n.editor&&(n.removeMouseUpEventListener(),n.editor.triggerEvent("mouseUp",{rawEvent:a,isClicking:n.state.mouseDownX==a.pageX&&n.state.mouseDownY==a.pageY})),n.pointerEvent&&(n.pointerEvent=null)},this.onDoubleClick=function(a){n.editor&&n.editor.triggerEvent("doubleClick",{rawEvent:a})},this.onCompositionStart=function(){n.state.isInIME=!0},this.onCompositionEnd=function(a){var i;n.state.isInIME=!1,(i=n.editor)===null||i===void 0||i.triggerEvent("compositionEnd",{rawEvent:a})},this.onPointerDown=function(a){(a.pointerType==="touch"||a.pointerType==="pen")&&(n.pointerEvent=a)},this.state={isInIME:!1,scrollContainer:e.scrollContainer||r,mouseDownX:null,mouseDownY:null,mouseUpEventListerAdded:!1}}return t.prototype.getName=function(){return"DOMEvent"},t.prototype.initialize=function(e){var r=this,n,a;this.editor=e;var i=this.editor.getDocument(),o={keypress:this.keyboardEventHandler,keydown:this.keyboardEventHandler,keyup:this.keyboardEventHandler,input:this.inputEventHandler,mousedown:{beforeDispatch:this.onMouseDown},dblclick:{beforeDispatch:function(s){return r.onDoubleClick(s)}},compositionstart:{beforeDispatch:this.onCompositionStart},compositionend:{beforeDispatch:this.onCompositionEnd},dragstart:{beforeDispatch:this.onDragStart},drop:{beforeDispatch:this.onDrop},pointerdown:{beforeDispatch:function(s){return r.onPointerDown(s)}}};this.disposer=this.editor.attachDomEvent(o),this.state.scrollContainer.addEventListener("scroll",this.onScroll),(n=i.defaultView)===null||n===void 0||n.addEventListener("scroll",this.onScroll),(a=i.defaultView)===null||a===void 0||a.addEventListener("resize",this.onScroll)},t.prototype.dispose=function(){var e,r,n,a,i;this.removeMouseUpEventListener();var o=(e=this.editor)===null||e===void 0?void 0:e.getDocument();(r=o?.defaultView)===null||r===void 0||r.removeEventListener("resize",this.onScroll),(n=o?.defaultView)===null||n===void 0||n.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),(a=this.disposer)===null||a===void 0||a.call(this),this.disposer=null,this.editor=null,this.pointerEvent=null,this.timer&&((i=o?.defaultView)===null||i===void 0||i.clearTimeout(this.timer),this.timer=0)},t.prototype.getState=function(){return this.state},t.prototype.removeMouseUpEventListener=function(){this.editor&&this.state.mouseUpEventListerAdded&&(this.state.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},t})();function fb(t,e){return new db(t,e)}function ta(t,e){t.blocks.forEach(function(r){switch(r.blockType){case"BlockGroup":ta(r,e);break;case"Entity":e.push({entity:r,operation:"newEntity"});break;case"Paragraph":r.segments.forEach(function(n){switch(n.segmentType){case"Entity":e.push({entity:n,operation:"newEntity"});break;case"General":ta(n,e);break}});break;case"Table":r.rows.forEach(function(n){return n.cells.forEach(function(a){return ta(a,e)})});break}})}function cb(t,e,r){var n,a=t.isDisposed()?null:t.getDOMSelection();if(!(!a||a.type!="range")){var i=a.range,o=a.isReverted,s=o?i.startContainer:i.endContainer,l=o?i.startOffset:i.endOffset,u=F(s,"ELEMENT_NODE")?s:s.parentElement,d=u&&((n=t.getDocument().defaultView)===null||n===void 0?void 0:n.getComputedStyle(u).direction)=="rtl",f=e=="ArrowLeft"!=!!d;u&&(Ut(u,!f)&&(f&&l==0||!f&&l==1)||wn(u))&&t.formatContentModel(function(v){var c,h,p=On(v,!1,!0),m=p[o?0:p.length-1],b=(h=(c=m?.[1])===null||c===void 0?void 0:c.segments.indexOf(m[0]))!==null&&h!==void 0?h:-1;if(m&&m[1]&&b>=0){var y=L(m,3),E=y[0],S=y[1],T=y[2],k=r&&!i.collapsed&&f!=!!o,R=k?E:S.segments[f?b-1:b+1],M=hb(R,T,S,f);if(M){var w=vb(i,k,f,M,r);t.setDOMSelection({type:"range",range:w,isReverted:w.collapsed?!1:o})}}return!1})}}function vb(t,e,r,n,a){var i=t.cloneRange();return e?r?i.setEndBefore(n):i.setStartAfter(n):(r?i.setStartBefore(n):i.setEndAfter(n),a||(r?i.setEndBefore(n):i.setStartAfter(n))),i}function hb(t,e,r,n){var a=null;if(t?.segmentType=="Entity")a=t;else{var i=e[0].blocks,o=i.indexOf(r),s=o>=0?i[n?o-1:o+1]:null;s?.blockType=="Entity"&&(a=s)}var l=a?n?a.wrapper.previousElementSibling:a.wrapper.nextElementSibling:null;return F(l,"ELEMENT_NODE")&&Ut(l,n)?l:null}var pb=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function ra(t,e){var r,n,a,i,o=F(t,"TEXT_NODE")?(n=(r=t.nodeValue)===null||r===void 0?void 0:r.length)!==null&&n!==void 0?n:0:t.childNodes.length;for(e=Math.max(Math.min(e,o),0);t?.lastChild;)if(e>=t.childNodes.length)t=t.lastChild,e=F(t,"TEXT_NODE")?(i=(a=t.nodeValue)===null||a===void 0?void 0:a.length)!==null&&i!==void 0?i:0:t.childNodes.length;else{var s=t.childNodes[e];if(F(s,"ELEMENT_NODE")&&pb.indexOf(s.tagName)>=0)break;t=t.childNodes[e],e=0}return{node:t,offset:e}}var vo="entityDelimiterBefore",mn="entityDelimiterAfter",Ea="."+mn+",."+vo,zr="​",gb="_Entity",mb="span."+gb;function Sd(t,e){var r=t.classList.contains(mn),n=r?t.previousElementSibling:t.nextElementSibling;n&&Ct(n)&&(Td([n.previousElementSibling,n.nextElementSibling].filter(function(a){return!!a})),e.formatContentModel(function(a,i){return lt(a,function(o,s,l,u){l?.blockType=="Paragraph"&&l.segments.forEach(function(d){d.segmentType=="Text"&&d.text.indexOf(zr)>=0&&vt(l,d,function(f){f.text=f.text.replace(zr,"")})})}),i.skipUndoSnapshot=!0,!0}))}function bb(t,e){if(t.length>0){var r=Fa();t.forEach(function(n){F(n,"ELEMENT_NODE")&&Ct(n)&&!n.isContentEditable&&Yi(n.ownerDocument,n,e,r)})}}function yb(t){var e;(e=t?.parentElement)===null||e===void 0||e.removeChild(t)}function Td(t){t.forEach(function(e){if(F(e,"ELEMENT_NODE"))if(Ut(e)){var r=e.classList.contains(vo)?e.nextElementSibling:e.previousElementSibling;F(r,"ELEMENT_NODE")&&Ct(r)||yb(e)}else Eb(e)})}function Eb(t,e){if(e===void 0&&(e=!0),!!t){var r=t.classList.contains(mn),n=r?t.previousElementSibling:t.nextElementSibling;e&&n&&Ct(n)||(t.classList.remove(mn,vo),t.normalize(),t.childNodes.forEach(function(a){var i,o,s=(o=(i=a.textContent)===null||i===void 0?void 0:i.indexOf(zr))!==null&&o!==void 0?o:-1;if(s>=0){var l=new Range;l.setStart(a,s),l.setEnd(a,s+1),l.deleteContents()}}))}}function wd(t,e){var r,n,a,i,o,s=t.range,l=t.isReverted,u=l?s.startContainer:s.endContainer,d=l?s.startOffset:s.endOffset;if(u){var f=ra(u,d);u=f.node,d=f.offset}if(F(u,"ELEMENT_NODE"))u=u.childNodes.length==d?u:u.childNodes.item(d);else{var v=e?zr+e:zr;u.textContent!=v&&(u.textContent||"").length==d?u=(a=(r=u.nextSibling)!==null&&r!==void 0?r:(n=u.parentElement)===null||n===void 0?void 0:n.closest(Ea))!==null&&a!==void 0?a:null:u=(o=(i=u?.parentElement)===null||i===void 0?void 0:i.closest(Ea))!==null&&o!==void 0?o:null}return u&&!u.hasChildNodes()&&(u=u.nextSibling),F(u,"ELEMENT_NODE")?u:null}function Cb(t){var e=t.getDOMHelper();Td(e.queryElements(Ea)),bb(e.queryElements(mb),t.getPendingFormat())}function Sb(t,e){var r=t.getDOMSelection();if(r?.type=="range"&&r.range.collapsed){var n=wd(r,e.rawEvent.data);n?.firstChild&&F(n.firstChild,"TEXT_NODE")&&n.matches(Ea)&&n.textContent==zr+e.rawEvent.data&&Sd(n,t)}}function Tb(t,e){var r,n=t.getDOMSelection();if(!(!n||n.type!="range")){var a=e.rawEvent,i=n.range,o=a.key;switch(o){case"Enter":var s=t.getDOMHelper(),l=Xi(i.startContainer,s);l&&F(l,"ELEMENT_NODE")&&s.isNodeInEditor(l)&&Db(t,l,a);break;case"ArrowLeft":case"ArrowRight":!a.altKey&&!a.ctrlKey&&!a.metaKey&&((r=t.getDocument().defaultView)===null||r===void 0||r.requestAnimationFrame(function(){cb(t,o,a.shiftKey)}));break;default:Pa(a)&&i.collapsed&&wb(t,i,wd(n),a);break}}}function wb(t,e,r,n){var a,i=t.getDOMHelper();if(r&&Ut(r)&&i.isNodeInEditor(r)){var o=uu(r,i),s=n.key==="Enter";if(o&&i.isNodeInEditor(o)){var l=r.classList.contains(mn);l?e.setStartAfter(o):e.setStartBefore(o),e.collapse(!0),s&&n.preventDefault(),t.formatContentModel(kb,{selectionOverride:{type:"range",isReverted:!1,range:e}})}else s?t.formatContentModel(function(u,d){var f=_b(u);return f&&n.preventDefault(),f}):(t.takeSnapshot(),(a=t.getDocument().defaultView)===null||a===void 0||a.requestAnimationFrame(function(){return Sd(r,t)}))}}var kb=function(t,e){return lt(t,function(r,n,a){if(a?.blockType=="Paragraph"){var i=D(a);delete i.isImplicit;var o=i.segments.find(function(s){return s.segmentType=="SelectionMarker"});o?.segmentType=="SelectionMarker"&&(i.segmentFormat=C({},o.format),e.newPendingFormat=C({},o.format)),i.segments.unshift(qt())}}),!0},_b=function(t){var e,r,n;if(lt(t,function(u,d,f){f?.blockType=="Paragraph"&&(r=f,n=u[0])}),n?.blockGroupType=="ListItem")return!1;if(r&&n){var a=r.segments.findIndex(function(u){return u.segmentType=="SelectionMarker"});if(a>=0){var i=D(r),o=i.segments.splice(a),s=je(!1,i.format,i.segmentFormat,i.decorator);(i.segments.every(function(u){return u.segmentType=="SelectionMarker"||u.segmentType=="Br"})||o.every(function(u){return u.segmentType=="SelectionMarker"}))&&s.segments.push(qt(i.format)),(e=s.segments).push.apply(e,I([],L(o),!1));var l=n.blocks.indexOf(i);l>=0&&D(n).blocks.splice(l+1,0,s)}}return!0},Db=function(t,e,r){var n=hr(e);n.id&&n.entityType&&!n.isFakeEntity&&t.triggerEvent("entityOperation",{operation:"click",entity:{id:n.id,type:n.entityType,isReadonly:!!n.isReadonly,wrapper:e},rawEvent:r})},Mb=/_(\d{1,8})$/,Ob=(function(){function t(){this.editor=null,this.state={entityMap:{}}}return t.prototype.getName=function(){return"Entity"},t.prototype.initialize=function(e){this.editor=e},t.prototype.dispose=function(){this.editor=null,this.state.entityMap={}},t.prototype.getState=function(){return this.state},t.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"mouseUp":this.handleMouseUpEvent(this.editor,e);break;case"contentChanged":this.handleContentChangedEvent(this.editor,e);break;case"keyDown":Tb(this.editor,e);break;case"compositionEnd":Sb(this.editor,e);break;case"editorReady":this.handleContentChangedEvent(this.editor);break;case"extractContentWithDom":this.handleExtractContentWithDomEvent(this.editor,e.clonedRoot);break}},t.prototype.handleMouseUpEvent=function(e,r){var n=r.rawEvent,a=r.isClicking,i=n.target;if(a&&this.editor)for(;i&&this.editor.getDOMHelper().isNodeInEditor(i);)if(Ct(i)){this.triggerEvent(e,i,"click",n);break}else i=i.parentNode},t.prototype.handleContentChangedEvent=function(e,r){var n=this,a,i=(a=r?.changedEntities)!==null&&a!==void 0?a:this.getChangedEntities(e),o=r?.entityStates;i.forEach(function(s){var l=s.entity,u=s.operation,d=s.rawEvent,f=l.entityFormat,v=f.id,c=f.entityType,h=f.isFakeEntity,p=l.wrapper;if(c&&!h){if(u=="newEntity"){l.entityFormat.id=n.ensureUniqueId(c,v??"",p),p.className=fu(l.entityFormat),l.entityFormat.isReadonly&&(p.contentEditable="false");var m=n.triggerEvent(e,p,u,d);n.state.entityMap[l.entityFormat.id]={element:p,canPersist:m?.shouldPersist},e.isDarkMode()&&va(p,!0,"lightToDark",e.getColorManager())}else if(v){var b=n.state.entityMap[v];b&&(b.isDeleted=!0),n.triggerEvent(e,p,u,d)}}}),o?.forEach(function(s){var l,u=s.id,d=s.state,f=(l=n.state.entityMap[u])===null||l===void 0?void 0:l.element;f&&n.triggerEvent(e,f,"updateEntityState",void 0,d)}),Cb(e)},t.prototype.getChangedEntities=function(e){var r=this,n=[];return e.formatContentModel(function(a){return ta(a,n),!1}),ie(this.state.entityMap).forEach(function(a){var i=r.state.entityMap[a];if(!i.isDeleted){var o=n.findIndex(function(u){return u.operation=="newEntity"&&u.entity.entityFormat.id==a&&u.entity.wrapper==i.element});if(o>=0)n.splice(o,1);else{var s=hr(i.element);if(!s.isFakeEntity){var l=nu(i.element,s.isReadonly,{},s.entityType,s.id);n.push({entity:l,operation:"overwrite"})}}}}),n},t.prototype.handleExtractContentWithDomEvent=function(e,r){var n=this;du(r).forEach(function(a){a.removeAttribute("contentEditable"),n.triggerEvent(e,a,"replaceTemporaryContent")})},t.prototype.triggerEvent=function(e,r,n,a,i){var o=hr(r);return o.id&&o.entityType&&!o.isFakeEntity?e.triggerEvent("entityOperation",{operation:n,rawEvent:a,entity:{id:o.id,type:o.entityType,isReadonly:!!o.isReadonly,wrapper:r},state:n=="updateEntityState"?i:void 0,shouldPersist:n=="newEntity"?!0:void 0}):null},t.prototype.ensureUniqueId=function(e,r,n){for(var a=Mb.exec(r),i=(a?r.substr(0,r.length-a[0].length):r)||e,o="",s=a&&parseInt(a[1])||0;;s++){o=s>0?i+"_"+s:i;var l=this.state.entityMap[o];if(!l||l.element==n)break}return o},t})();function Lb(){return new Ob}function Rb(t,e){var r=t.getDOMSelection();r?.type=="range"&&r.range.collapsed&&t.formatContentModel(function(n,a){return lt(n,function(i,o,s,l){var u=l?.[0];if(s?.blockType=="Paragraph"&&u?.segmentType=="SelectionMarker"){var d=i[0].blocks,f=d.length,v=d.indexOf(s);if(s.isImplicit&&s.segments.length==1&&s.segments[0]==u&&f>0&&v==f-1){var c=d[v-1];c?.blockType!="Paragraph"&&(a.newPendingFormat=Ll(t,e,u.format))}else s.segments.every(function(h){return h.segmentType!="Text"})&&(a.newPendingFormat=Ll(t,e,u.format))}return!0}),!1})}function Ll(t,e,r){return C(C(C({},e),t.getPendingFormat()),r)}var Rl=" ",Fl=" ";function Fb(t,e,r,n){var a=!1;t.formatContentModel(function(i,o){return lt(i,function(s,l,u,d){if(u?.blockType=="Paragraph"&&d?.length==1&&d[0].segmentType=="SelectionMarker"){var f=d[0],v=u.segments.indexOf(f),c=u.segments[v-1];if(c?.segmentType=="Text"){var h=c.text,p=h.substr(-e.length,e.length);if((p==e||e==Rl&&p==Fl)&&(r&&!Pl(c.format,r)&&(vt(u,c,function(b){b.text=h.substring(0,h.length-e.length)}),vt(u,f,function(b,y){b.format=C({},r);var E=We(e==Rl?Fl:e,C(C({},c.format),r));y.segments.splice(v,0,E),et(y)}),a=!0),n&&!Pl(u.format,n))){var m=D(u);Object.assign(m.format,n),a=!0}}}return!0}),a&&(Et(i),o.skipUndoSnapshot=!0),a},{apiName:"applyPendingFormat"})}function Pl(t,e){var r=ie(e),n=!0;return r.forEach(function(a){t[a]!==e[a]&&(n=!1)}),n}var Pb="Process",Ab="Unidentified",Al={backgroundColor:"backgroundColor",textColor:"color",fontFamily:"fontFamily",fontSize:"fontSize"},Nb=(function(){function t(e){var r=this;this.editor=null,this.lastCheckedNode=null,this.state={defaultFormat:C({},e.defaultSegmentFormat),pendingFormat:null};var n=this.state.defaultFormat;n.fontFamily&&(n.fontFamily=Mp(n.fontFamily)),this.defaultFormatKeys=new Set,ie(Al).forEach(function(a){r.state.defaultFormat[a]&&r.defaultFormatKeys.add(Al[a])})}return t.prototype.getName=function(){return"Format"},t.prototype.initialize=function(e){this.editor=e,this.state.defaultFormat=cp(this.state.defaultFormat,e.getEnvironment())},t.prototype.dispose=function(){this.editor=null},t.prototype.getState=function(){return this.state},t.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"input":this.checkAndApplyPendingFormat(e.rawEvent.data);break;case"compositionEnd":this.checkAndApplyPendingFormat(e.rawEvent.data);break;case"keyDown":var r=this.editor.getEnvironment().isAndroid&&e.rawEvent.key==Ab;no(e.rawEvent)?(this.clearPendingFormat(),this.lastCheckedNode=null):this.defaultFormatKeys.size>0&&(r||Pa(e.rawEvent)||e.rawEvent.key==Pb)&&this.shouldApplyDefaultFormat(this.editor)&&Rb(this.editor,this.state.defaultFormat);break;case"mouseUp":case"contentChanged":this.lastCheckedNode=null,this.canApplyPendingFormat()||this.clearPendingFormat();break}},t.prototype.checkAndApplyPendingFormat=function(e){this.editor&&e&&this.state.pendingFormat&&(Fb(this.editor,e,this.state.pendingFormat.format,this.state.pendingFormat.paragraphFormat),this.clearPendingFormat())},t.prototype.clearPendingFormat=function(){this.state.pendingFormat=null},t.prototype.canApplyPendingFormat=function(){var e=!1;if(this.state.pendingFormat&&this.editor){var r=this.editor.getDOMSelection(),n=r?.type=="range"&&r.range.collapsed?r.range:null,a=this.state.pendingFormat.insertPoint,i=a.node,o=a.offset;n&&n.startContainer==i&&n.startOffset==o&&(e=!0)}return e},t.prototype.shouldApplyDefaultFormat=function(e){var r,n,a=e.getDOMSelection(),i=a?.type=="range"?a.range:null,o=(r=i?.startContainer)!==null&&r!==void 0?r:null;if(o&&o!=this.lastCheckedNode){this.lastCheckedNode=o;for(var s=e.getDOMHelper(),l=F(o,"ELEMENT_NODE")?o:o.parentElement,u=new Set,d=function(){if(!((n=l.getAttribute)===null||n===void 0)&&n.call(l,"style")){var c=l.style;if(f.defaultFormatKeys.forEach(function(h){c[h]&&u.add(h)}),u.size==f.defaultFormatKeys.size)return{value:!1}}if(Xt(l))return"break";l=l.parentElement},f=this;l?.parentElement&&s.isNodeInEditor(l.parentElement);){var v=d();if(typeof v=="object")return v.value;if(v==="break")break}return!0}else return!1},t})();function Ib(t){return new Nb(t)}var Nl="contenteditable",Bb="#000000",xb="#ffffff",Hb=(function(){function t(e,r){var n=this;this.editor=null,this.initializer=null,this.disposer=null,r.getAttribute(Nl)===null&&(this.initializer=function(){r.contentEditable="true",r.style.userSelect="text"},this.disposer=function(){r.style.userSelect="",r.removeAttribute(Nl)}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){n.adjustContainerColor(r)},this.state={isDarkMode:!!e.inDarkMode,shadowEditFragment:null,styleElements:{},announcerStringGetter:e.announcerStringGetter}}return t.prototype.getName=function(){return"Lifecycle"},t.prototype.initialize=function(e){var r,n;this.editor=e,(r=this.initializer)===null||r===void 0||r.call(this),this.adjustColor();var a=(n=this.state.rewriteFromModel)!==null&&n!==void 0?n:{addedBlockElements:[],removedBlockElements:[]};this.editor.triggerEvent("editorReady",a,!0),delete this.state.rewriteFromModel,this.state.announceContainer=td(e.getDocument())},t.prototype.dispose=function(){var e=this,r,n;(r=this.editor)===null||r===void 0||r.triggerEvent("beforeDispose",{},!0),ie(this.state.styleElements).forEach(function(i){var o,s=e.state.styleElements[i];(o=s.parentElement)===null||o===void 0||o.removeChild(s),delete e.state.styleElements[i]});var a=this.state.announceContainer;a&&((n=a.parentElement)===null||n===void 0||n.removeChild(a),delete this.state.announceContainer),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},t.prototype.getState=function(){return this.state},t.prototype.onPluginEvent=function(e){e.eventType=="contentChanged"&&(e.source==Ve.SwitchToDarkMode||e.source==Ve.SwitchToLightMode)&&this.adjustColor()},t.prototype.adjustContainerColor=function(e){if(this.editor){var r=this.state.isDarkMode,n=this.editor.getColorManager();xr(e,Bb,!1,r,n),xr(e,xb,!0,r,n)}},t})();function zb(t,e){return new Hb(t,e)}var Ub="TH,TD";function Hn(t,e,r){var n=r.findClosestElementAncestor(e,Ub),a=null;return n&&t.some(function(i,o){var s=n?i.indexOf(n):-1;return a=s>=0?{row:o,col:s}:null}),a||t.some(function(i,o){var s=i.findIndex(function(l){return typeof l=="object"&&l.contains(e)});return a=s>=0?{row:o,col:s}:null}),a}function Gb(t){var e=Kb(t),r=e.startNode,n=e.endNode,a=e.startOffset,i=e.endOffset,o=Math.max(a,i),s=Math.min(a,i);if(r&&n&&r==n&&o-s==1){var l=r?.childNodes.item(s);if(F(l,"ELEMENT_NODE")&&re(l,"img"))return l}return null}function Kb(t){return Wb(t)?{startNode:t.anchorNode,endNode:t.focusNode,startOffset:t.anchorOffset,endOffset:t.focusOffset}:{startNode:t.startContainer,endNode:t.endContainer,startOffset:t.startOffset,endOffset:t.endOffset}}function Wb(t){return!!t.getRangeAt}var $a=0,Vb=2,lr="ArrowUp",zn="ArrowDown",Un="ArrowLeft",ei="ArrowRight",Il="Tab",Bl="#DB626C",xl="#C6C6C6",jb=(function(){function t(e){var r=this,n,a;this.editor=null,this.disposer=null,this.logicalRootDisposer=null,this.isSafari=!1,this.isMac=!1,this.scrollTopCache=0,this.onMouseMove=function(i){var o,s,l;if(r.editor&&r.state.tableSelection){var u=!!r.state.tableSelection.lastCo,d=i.target,f=r.editor.getDOMHelper(),v=r.editor.getDocument().createRange(),c=r.state.tableSelection.startNode,h=d.compareDocumentPosition(c)==Node.DOCUMENT_POSITION_FOLLOWING;h?(v.setStart(d,0),v.setEnd(c,F(c,"TEXT_NODE")?(s=(o=c.nodeValue)===null||o===void 0?void 0:o.length)!==null&&s!==void 0?s:0:c.childNodes.length)):(v.setStart(c,0),v.setEnd(d,0));var p=v.commonAncestorContainer,m=r.parseTableSelection(p,c,f);if(m){var b=Hn(m.parsedTable,d,f);m.table!=r.state.tableSelection.table&&(r.state.tableSelection=m,r.state.tableSelection.lastCo=b??void 0);var y=b&&r.updateTableSelection(b);(u||y)&&i.preventDefault()}else((l=r.editor.getDOMSelection())===null||l===void 0?void 0:l.type)=="table"&&r.setDOMSelection({type:"range",range:v,isReverted:h},r.state.tableSelection)}},this.onDrop=function(){r.detachMouseEvent()},this.getContainedTargetImage=function(i,o){if(!r.isMac||!o||o.type!=="image")return null;var s=i.target;return F(s,"ELEMENT_NODE")&&re(s,"span")&&s.firstChild===o.image?o.image:null},this.onFocus=function(){var i;if(!r.state.skipReselectOnFocus&&r.state.selection&&r.setDOMSelection(r.state.selection,r.state.tableSelection),((i=r.state.selection)===null||i===void 0?void 0:i.type)=="range"&&!r.isSafari&&(r.state.selection=null),r.scrollTopCache&&r.editor){var o=r.editor.getScrollContainer();o.scrollTop=r.scrollTopCache,r.scrollTopCache=0}},this.onBlur=function(){if(r.editor){r.state.selection||(r.state.selection=r.editor.getDOMSelection());var i=r.editor.getScrollContainer();r.scrollTopCache=i.scrollTop}},this.onSelectionChange=function(){var i;if(!((i=r.editor)===null||i===void 0)&&i.hasFocus()&&!r.editor.isInShadowEdit()){var o=r.editor.getDOMSelection(),s=r.editor.getDocument().getSelection();if(s&&s.focusNode){var l=Gb(s);if(o?.type=="image"&&!l){var u=s.getRangeAt(0);r.editor.setDOMSelection({type:"range",range:u,isReverted:s.focusNode!=u.endContainer||s.focusOffset!=u.endOffset})}else o?.type!=="image"&&l&&r.editor.setDOMSelection({type:"image",image:l})}o?.type=="range"&&r.isSafari&&(r.state.selection=o)}},this.state={selection:null,tableSelection:null,imageSelectionBorderColor:(n=e.imageSelectionBorderColor)!==null&&n!==void 0?n:Bl,imageSelectionBorderColorDark:e.imageSelectionBorderColor?void 0:Bl,tableCellSelectionBackgroundColor:(a=e.tableCellSelectionBackgroundColor)!==null&&a!==void 0?a:xl,tableCellSelectionBackgroundColorDark:e.tableCellSelectionBackgroundColor?void 0:xl}}return t.prototype.getName=function(){return"Selection"},t.prototype.initialize=function(e){this.editor=e,!this.state.imageSelectionBorderColorDark&&this.state.imageSelectionBorderColor&&(this.state.imageSelectionBorderColorDark=e.getColorManager().getDarkColor(this.state.imageSelectionBorderColor,void 0,"border")),!this.state.tableCellSelectionBackgroundColorDark&&this.state.tableCellSelectionBackgroundColor&&(this.state.tableCellSelectionBackgroundColorDark=e.getColorManager().getDarkColor(this.state.tableCellSelectionBackgroundColor,void 0,"background"));var r=this.editor.getEnvironment(),n=this.editor.getDocument();this.isSafari=!!r.isSafari,this.isMac=!!r.isMac,n.addEventListener("selectionchange",this.onSelectionChange),this.isSafari?this.disposer=this.editor.attachDomEvent({focus:{beforeDispatch:this.onFocus},drop:{beforeDispatch:this.onDrop}}):this.disposer=this.editor.attachDomEvent({focus:{beforeDispatch:this.onFocus},blur:{beforeDispatch:this.onBlur},drop:{beforeDispatch:this.onDrop}})},t.prototype.dispose=function(){var e,r;(e=this.editor)===null||e===void 0||e.getDocument().removeEventListener("selectionchange",this.onSelectionChange),this.disposer&&(this.disposer(),this.disposer=null),(r=this.logicalRootDisposer)===null||r===void 0||r.call(this),this.logicalRootDisposer=null,this.detachMouseEvent(),this.editor=null},t.prototype.getState=function(){return this.state},t.prototype.onPluginEvent=function(e){var r;if(this.editor)switch(e.eventType){case"mouseDown":this.onMouseDown(this.editor,e.rawEvent);break;case"mouseUp":this.onMouseUp();break;case"keyDown":this.onKeyDown(this.editor,e.rawEvent);break;case"contentChanged":this.state.tableSelection=null;break;case"scroll":this.editor.hasFocus()||(this.scrollTopCache=e.scrollContainer.scrollTop);break;case"logicalRootChanged":(r=this.logicalRootDisposer)===null||r===void 0||r.call(this),this.isSafari?this.logicalRootDisposer=this.editor.attachDomEvent({focus:{beforeDispatch:this.onFocus},drop:{beforeDispatch:this.onDrop}}):this.logicalRootDisposer=this.editor.attachDomEvent({focus:{beforeDispatch:this.onFocus},blur:{beforeDispatch:this.onBlur},drop:{beforeDispatch:this.onDrop}});break}},t.prototype.onMouseDown=function(e,r){var n,a,i,o=e.getDOMSelection(),s;if(o?.type=="image"&&(r.button==$a||r.button==Vb&&!this.getClickingImage(r)&&!this.getContainedTargetImage(r,o))&&this.setDOMSelection(null,null),(s=(n=this.getClickingImage(r))!==null&&n!==void 0?n:this.getContainedTargetImage(r,o))&&s.isContentEditable){this.setDOMSelection({type:"image",image:s},null);return}o?.type=="table"&&r.button==$a&&this.setDOMSelection(null,null);var l,u=r.target;if(u&&r.button==$a&&(l=this.parseTableSelection(u,u,e.getDOMHelper()))){if(this.state.tableSelection=l,r.detail>=3){var d=Hn(l.parsedTable,r.target,e.getDOMHelper());d&&(l.lastCo=d,this.updateTableSelection(d),r.preventDefault())}(i=(a=this.state).mouseDisposer)===null||i===void 0||i.call(a),this.state.mouseDisposer=e.attachDomEvent({mousemove:{beforeDispatch:this.onMouseMove}})}},t.prototype.onMouseUp=function(){this.detachMouseEvent()},t.prototype.onKeyDown=function(e,r){var n=this,a,i,o=r.key,s=e.getDOMSelection(),l=e.getDocument().defaultView;switch(s?.type){case"image":if(!Hr(r)&&!r.shiftKey&&s.image.parentNode&&(o==="Escape"?(this.selectBeforeOrAfterElement(e,s.image),r.stopPropagation()):o!=="Delete"&&o!=="Backspace"&&this.selectBeforeOrAfterElement(e,s.image)),(Hr(r)||r.shiftKey)&&s.image&&!this.isSafari){var u=s.image.ownerDocument.createRange();u.selectNode(s.image),this.setDOMSelection({type:"range",range:u,isReverted:!1},null)}break;case"range":if(o==lr||o==zn||o==Un||o==ei||o==Il){var d=s.range.startContainer;this.state.tableSelection=this.parseTableSelection(d,d,e.getDOMHelper()),this.state.tableSelection&&!r.defaultPrevented&&(o==Il?(this.handleSelectionInTable(this.getTabKey(r)),r.preventDefault()):l?.requestAnimationFrame(function(){return n.handleSelectionInTable(o)}))}break;case"table":if(this.state.tableSelection==null){var f=s.table,v=s.firstRow,c=s.firstColumn,h=s.lastRow,p=s.lastColumn,m=cn(f);if(m){var b={row:v,col:c},y={row:h,col:p};this.state.tableSelection={table:f,parsedTable:m,firstCo:b,lastCo:y,startNode:((a=$n(m,b))===null||a===void 0?void 0:a.cell)||f}}}if(!((i=this.state.tableSelection)===null||i===void 0)&&i.lastCo){var E=r.shiftKey,S=r.key;if(E&&(S==Un||S==ei)){var T=l?.getComputedStyle(this.state.tableSelection.table).direction=="rtl";this.updateTableSelectionFromKeyboard(0,(S==Un?-1:1)*(T?-1:1)),r.preventDefault()}else E&&(S==lr||S==zn)?(this.updateTableSelectionFromKeyboard(S==lr?-1:1,0),r.preventDefault()):S!="Shift"&&!Pa(r)&&(S==lr||S==zn||S==Un||S==ei)&&(this.setDOMSelection(null,this.state.tableSelection),l?.requestAnimationFrame(function(){return n.handleSelectionInTable(S)}))}break}},t.prototype.getTabKey=function(e){return e.shiftKey?"TabLeft":"TabRight"},t.prototype.handleSelectionInTable=function(e){var r,n,a,i,o,s;if(!(!this.editor||!this.state.tableSelection)){var l=this.editor.getDOMSelection(),u=this.editor.getDOMHelper();if(l?.type=="range"){var d=l.range,f=d.collapsed,v=d.startContainer,c=d.endContainer,h=d.commonAncestorContainer,p=l.isReverted,m=p?c:v,b=p?v:c,y=this.parseTableSelection(h,m,u);if(!y)return;var E=Hn(y?.parsedTable,b,u),S=!1,T=this.state.tableSelection,k=T.parsedTable,R=T.firstCo,M=T.table;if(E&&y.table==M){if(E.col!=R.col&&(e==lr||e==zn)){var w=e==lr?-1:1,A=(r=$n(k,R))===null||r===void 0?void 0:r.cell,N=null;for(E={row:R.row+w,col:R.col};E.row>=0&&E.row<k.length&&(N=((n=$n(k,E))===null||n===void 0?void 0:n.cell)||null,N==A);)E.row+=w;f&&N?this.setRangeSelectionInTable(N,e==lr?N.childNodes.length:0,this.editor):!N&&(E.row==-1||E.row<=k.length)&&this.selectBeforeOrAfterElement(this.editor,M,w==1,w!=1)}else if(e=="TabLeft"||e=="TabRight")for(var J=e=="TabLeft",z=J?-1:1,O=(a=E.row)!==null&&a!==void 0?a:0,V=((i=E.col)!==null&&i!==void 0?i:0)+z;;V+=z){if(V<0||V>=k[O].length){if(O+=z,O<0){this.selectBeforeOrAfterElement(this.editor,y.table);break}else if(O>=k.length){this.selectBeforeOrAfterElement(this.editor,y.table,!0);break}V=J?k[O].length-1:0}var ne=k[O][V];if(typeof ne!="string"){S=!0,this.setRangeSelectionInTable(ne,0,this.editor,!0),E.row=O,E.col=V;break}}else this.state.tableSelection=null;f&&(E.col!=R.col||E.row!=R.row)&&E.row>=0&&E.row==k.length-1&&E.col==((o=k[E.row])===null||o===void 0?void 0:o.length)-1&&((s=this.editor)===null||s===void 0||s.announce({defaultStrings:"announceOnFocusLastCell"}))}!f&&E&&!S&&(this.state.tableSelection=y,this.updateTableSelection(E))}}},t.prototype.setRangeSelectionInTable=function(e,r,n,a){var i=n.getDocument().createRange();if(a&&e.firstChild&&e.lastChild){var o=e.firstChild,s=e.lastChild,l=ra(o,0),u=ra(s,s.childNodes.length);i.setStart(l.node,l.offset),i.setEnd(u.node,u.offset),i.toString()===""&&i.collapse(!0)}else{var d=ra(e,r),f=d.node,v=d.offset;i.setStart(f,v),i.collapse(!0)}this.setDOMSelection({type:"range",range:i,isReverted:!1},null)},t.prototype.updateTableSelectionFromKeyboard=function(e,r){var n;if(!((n=this.state.tableSelection)===null||n===void 0)&&n.lastCo&&this.editor){var a=this.state.tableSelection,i=a.lastCo,o=a.parsedTable,s=i.row+e,l=i.col+r;s>=0&&s<o.length&&l>=0&&l<o[s].length&&this.updateTableSelection({row:s,col:l})}},t.prototype.selectBeforeOrAfterElement=function(e,r,n,a){var i=e.getDocument(),o=r.parentNode,s=o&&it(o.childNodes).indexOf(r),l;if(o&&s!==null&&s>=0){var u=i.createRange();a&&(l=n?r.nextElementSibling:r.previousElementSibling)&&F(l,"ELEMENT_NODE")?(u.selectNodeContents(l),u.collapse(!1)):(u.setStart(o,s+(n?1:0)),u.collapse()),this.setDOMSelection({type:"range",range:u,isReverted:!1},null)}},t.prototype.getClickingImage=function(e){var r=e.target;return F(r,"ELEMENT_NODE")&&re(r,"img")?r:null},t.prototype.parseTableSelection=function(e,r,n){var a,i,o;return(a=n.findClosestElementAncestor(e,"table"))&&a.isContentEditable&&(i=cn(a))&&(o=Hn(i,r,n))?{table:a,parsedTable:i,firstCo:o,startNode:r}:null},t.prototype.updateTableSelection=function(e){if(this.state.tableSelection&&this.editor){var r=this.state.tableSelection,n=r.table,a=r.firstCo,i=r.parsedTable,o=r.startNode,s=r.lastCo;if(s||a.row!=e.row||a.col!=e.col)return this.state.tableSelection.lastCo=e,this.setDOMSelection({type:"table",table:n,firstRow:a.row,firstColumn:a.col,lastRow:e.row,lastColumn:e.col,tableSelectionInfo:this.state.tableSelection},{table:n,firstCo:a,lastCo:e,parsedTable:i,startNode:o}),!0}return!1},t.prototype.setDOMSelection=function(e,r){var n;(n=this.editor)===null||n===void 0||n.setDOMSelection(e),this.state.tableSelection=r},t.prototype.detachMouseEvent=function(){this.state.mouseDisposer&&(this.state.mouseDisposer(),this.state.mouseDisposer=void 0)},t})();function qb(t){return new jb(t)}var Xb=1e7,Yb=(function(){function t(e){this.hasNewContentValue=!1,this.snapshots=e??{snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:Xb}}return Object.defineProperty(t.prototype,"hasNewContent",{get:function(){return this.hasNewContentValue},set:function(e){this.hasNewContentValue=e},enumerable:!1,configurable:!0}),t.prototype.canMove=function(e){var r=this.snapshots.currentIndex+e;return r>=0&&r<this.snapshots.snapshots.length},t.prototype.move=function(e){var r,n,a=null;return this.canMove(e)&&(this.snapshots.currentIndex+=e,this.snapshots.autoCompleteIndex=-1,a=this.snapshots.snapshots[this.snapshots.currentIndex]),(n=(r=this.snapshots).onChanged)===null||n===void 0||n.call(r,"move"),a},t.prototype.addSnapshot=function(e,r){var n,a,i=this.snapshots.snapshots[this.snapshots.currentIndex],o=i&&i.html==e.html&&!i.additionalState&&!e.additionalState&&!i.entityStates&&!e.entityStates,s=!i||Jb(i,e);if(this.snapshots.currentIndex<0||s){this.clearRedo(),this.snapshots.snapshots.push(e),this.snapshots.currentIndex++,this.snapshots.totalSize+=this.getSnapshotLength(e);for(var l=0;l<this.snapshots.snapshots.length&&this.snapshots.totalSize>this.snapshots.maxSize;)this.snapshots.totalSize-=this.getSnapshotLength(this.snapshots.snapshots[l]),l++;l>0&&(this.snapshots.snapshots.splice(0,l),this.snapshots.currentIndex-=l,this.snapshots.autoCompleteIndex>=0&&(this.snapshots.autoCompleteIndex-=l)),r&&(this.snapshots.autoCompleteIndex=this.snapshots.currentIndex)}else o&&this.snapshots.snapshots.splice(this.snapshots.currentIndex,1,e);(a=(n=this.snapshots).onChanged)===null||a===void 0||a.call(n,"add")},t.prototype.clearRedo=function(){var e,r;if(this.canMove(1)){for(var n=0,a=this.snapshots.currentIndex+1;a<this.snapshots.snapshots.length;a++)n+=this.getSnapshotLength(this.snapshots.snapshots[a]);this.snapshots.snapshots.splice(this.snapshots.currentIndex+1),this.snapshots.totalSize-=n,this.snapshots.autoCompleteIndex=-1,(r=(e=this.snapshots).onChanged)===null||r===void 0||r.call(e,"clear")}},t.prototype.canUndoAutoComplete=function(){return this.snapshots.autoCompleteIndex>=0&&this.snapshots.currentIndex-this.snapshots.autoCompleteIndex==1},t.prototype.getSnapshotLength=function(e){var r,n;return(n=(r=e.html)===null||r===void 0?void 0:r.length)!==null&&n!==void 0?n:0},t})();function Zb(t){return new Yb(t)}function Jb(t,e){return t.html!==e.html||t.additionalState&&e.additionalState&&JSON.stringify(t.additionalState)!==JSON.stringify(e.additionalState)||!t.additionalState&&e.additionalState||t.entityStates&&e.entityStates&&t.entityStates!==e.entityStates||!t.entityStates&&e.entityStates}function ho(t){t.focus();var e=t.getSnapshotsManager();e.hasNewContent&&t.takeSnapshot();var r=e.move(-1);r&&t.restoreSnapshot(r)}var Gn="Backspace",Hl="Delete",zl="Enter",Qb=(function(){function t(e){this.editor=null,this.state={snapshotsManager:Zb(e.snapshots),isRestoring:!1,isNested:!1,autoCompleteInsertPoint:null,lastKeyPress:null}}return t.prototype.getName=function(){return"Undo"},t.prototype.initialize=function(e){this.editor=e},t.prototype.dispose=function(){this.editor=null},t.prototype.getState=function(){return this.state},t.prototype.willHandleEventExclusively=function(e){return!!this.editor&&e.eventType=="keyDown"&&e.rawEvent.key==Gn&&!e.rawEvent.ctrlKey&&this.canUndoAutoComplete(this.editor)},t.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"editorReady":var r=this.state.snapshotsManager,n=r.hasNewContent||r.canMove(-1),a=r.canMove(1);!n&&!a&&this.addUndoSnapshot();break;case"keyDown":this.onKeyDown(this.editor,e.rawEvent);break;case"keyPress":this.onKeyPress(this.editor,e.rawEvent);break;case"compositionEnd":this.clearRedoForInput(),this.addUndoSnapshot();break;case"contentChanged":this.onContentChanged(e);break;case"beforeKeyboardEditing":this.onBeforeKeyboardEditing(e.rawEvent);break;case"mouseDown":this.state.snapshotsManager.hasNewContent&&this.addUndoSnapshot();break}},t.prototype.onKeyDown=function(e,r){var n=this.state.snapshotsManager;if(r.key==Gn&&!r.altKey||r.key==Hl){if(r.key==Gn&&!r.ctrlKey&&this.canUndoAutoComplete(e))r.preventDefault(),ho(e),this.state.autoCompleteInsertPoint=null,this.state.lastKeyPress=r.key;else if(!r.defaultPrevented){var a=e.getDOMSelection();a&&(a.type!="range"||!a.range.collapsed||this.state.lastKeyPress!=r.key||this.isCtrlOrMetaPressed(e,r))&&this.addUndoSnapshot(),n.hasNewContent=!0,this.state.lastKeyPress=r.key}}else no(r)?(n.hasNewContent&&this.addUndoSnapshot(),this.state.lastKeyPress=null):(this.state.lastKeyPress==Gn||this.state.lastKeyPress==Hl)&&n.hasNewContent&&this.addUndoSnapshot()},t.prototype.onKeyPress=function(e,r){if(!r.metaKey){var n=e.getDOMSelection();n&&(n.type!="range"||!n.range.collapsed)||r.key==" "&&this.state.lastKeyPress!=" "||r.key==zl?(this.addUndoSnapshot(),r.key==zl&&(this.state.snapshotsManager.hasNewContent=!0)):this.clearRedoForInput(),this.state.lastKeyPress=r.key}},t.prototype.onBeforeKeyboardEditing=function(e){e.key!=this.state.lastKeyPress&&this.addUndoSnapshot(),this.state.lastKeyPress=e.key,this.state.snapshotsManager.hasNewContent=!0},t.prototype.onContentChanged=function(e){!this.state.isRestoring&&!e.skipUndo&&this.clearRedoForInput()},t.prototype.clearRedoForInput=function(){this.state.snapshotsManager.clearRedo(),this.state.lastKeyPress=null,this.state.snapshotsManager.hasNewContent=!0},t.prototype.canUndoAutoComplete=function(e){var r,n=e.getDOMSelection();return this.state.snapshotsManager.canUndoAutoComplete()&&n?.type=="range"&&n.range.collapsed&&n.range.startContainer==((r=this.state.autoCompleteInsertPoint)===null||r===void 0?void 0:r.node)&&n.range.startOffset==this.state.autoCompleteInsertPoint.offset},t.prototype.addUndoSnapshot=function(){var e;(e=this.editor)===null||e===void 0||e.takeSnapshot(),this.state.autoCompleteInsertPoint=null},t.prototype.isCtrlOrMetaPressed=function(e,r){var n=e.getEnvironment();return n.isMac?r.metaKey:r.ctrlKey},t})();function $b(t){return new Qb(t)}function ey(t,e){return{cache:em(t,e),format:Ib(t),copyPaste:sb(t),domEvent:fb(t,e),lifecycle:zb(t,e),entity:Lb(),selection:qb(t),contextMenu:am(t),undo:$b(t)}}function ty(t,e){var r,n,a,i=ey(e,t),o=Ig(e.trustedHTMLHandler);return C(C({physicalRoot:t,logicalRoot:t,api:C(C({},Sl),e.coreApiOverride),originalApi:C({},Sl),plugins:I(I([i.cache,i.format,i.copyPaste,i.domEvent,i.selection,i.entity],L(((r=e.plugins)!==null&&r!==void 0?r:[]).filter(function(s){return!!s})),!1),[i.undo,i.contextMenu,i.lifecycle],!1),environment:ry(t,e),darkColorHandler:Ag(t,(n=e.getDarkColor)!==null&&n!==void 0?n:iy,e.knownColors,e.generateColorKey),trustedHTMLHandler:e.trustedHTMLHandler&&!sd(e.trustedHTMLHandler)?e.trustedHTMLHandler:Ng(o),domCreator:o,domHelper:ud(t,{cloneIndependentRoot:(a=e.experimentalFeatures)===null||a===void 0?void 0:a.includes("CloneIndependentRoot")})},ay(i)),{disposeErrorHandler:e.disposeErrorHandler,onFixUpModel:e.onFixUpModel,experimentalFeatures:e.experimentalFeatures?I([],L(e.experimentalFeatures),!1):[]})}function ry(t,e){var r,n,a,i=(r=t.ownerDocument.defaultView)===null||r===void 0?void 0:r.navigator,o=(n=i?.userAgent)!==null&&n!==void 0?n:"",s=(a=i?.appVersion)!==null&&a!==void 0?a:"";return{domToModelSettings:Kg(e),modelToDomSettings:Wg(e),isMac:s.indexOf("Mac")!=-1,isAndroid:/android/i.test(o),isIOS:/iPad|iPhone/.test(o),isSafari:o.indexOf("Safari")>=0&&o.indexOf("Chrome")<0&&o.indexOf("Android")<0,isMobileOrTablet:ny(o)}}function ny(t){return!!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substring(0,4)))}function ay(t){return{domEvent:t.domEvent.getState(),copyPaste:t.copyPaste.getState(),cache:t.cache.getState(),format:t.format.getState(),lifecycle:t.lifecycle.getState(),entity:t.entity.getState(),selection:t.selection.getState(),contextMenu:t.contextMenu.getState(),undo:t.undo.getState()}}function iy(t){return t}var oy=(function(){function t(e,r){var n=this;r===void 0&&(r={});var a;this.core=null,this.cloneOptionCallback=function(o,s){if(s!="cache"){var l=o.cloneNode(!0);if(n.isDarkMode()){var u=n.getColorManager();va(l,!0,"darkToLight",u),l.style.color=l.style.color||"inherit",l.style.backgroundColor=l.style.backgroundColor||"inherit"}return l}},this.core=ty(e,r);var i=(a=r.initialModel)!==null&&a!==void 0?a:Xc(this.core.format.defaultFormat);this.core.api.setContentModel(this.core,i,{ignoreSelection:!0},void 0,!0),this.core.plugins.forEach(function(o){return o.initialize(n)})}return t.prototype.dispose=function(){for(var e,r=this.getCore(),n=r.plugins.length-1;n>=0;n--){var a=r.plugins[n];try{a.dispose()}catch(i){(e=r.disposeErrorHandler)===null||e===void 0||e.call(r,a,i)}}r.darkColorHandler.reset(),this.core=null},t.prototype.isDisposed=function(){return!this.core},t.prototype.getContentModelCopy=function(e){var r=this.getCore();switch(e){case"connected":case"disconnected":return pn(r.api.createContentModel(r,{tryGetFromCache:!1}),{includeCachedElement:this.cloneOptionCallback});case"clean":var n=Mn(r.environment.domToModelSettings.calculated,r.api.createEditorContext(r,!1));return pn(En(r.physicalRoot,n),{includeCachedElement:this.cloneOptionCallback})}},t.prototype.getEnvironment=function(){return this.getCore().environment},t.prototype.getDOMSelection=function(){var e=this.getCore();return e.api.getDOMSelection(e)},t.prototype.setDOMSelection=function(e){var r=this.getCore();r.api.setDOMSelection(r,e)},t.prototype.setLogicalRoot=function(e){var r=this.getCore();r.api.setLogicalRoot(r,e)},t.prototype.formatContentModel=function(e,r,n){var a=this.getCore();a.api.formatContentModel(a,e,r,n)},t.prototype.getPendingFormat=function(){var e,r;return(r=(e=this.getCore().format.pendingFormat)===null||e===void 0?void 0:e.format)!==null&&r!==void 0?r:null},t.prototype.getDOMHelper=function(){return this.getCore().domHelper},t.prototype.takeSnapshot=function(e){var r=this.getCore();return r.api.addUndoSnapshot(r,!1,e?[e]:void 0)},t.prototype.restoreSnapshot=function(e){var r=this.getCore();r.api.restoreUndoSnapshot(r,e)},t.prototype.getDocument=function(){return this.getCore().physicalRoot.ownerDocument},t.prototype.focus=function(){var e=this.getCore();e.api.focus(e)},t.prototype.hasFocus=function(){var e=this.getCore();return e.domHelper.hasFocus()},t.prototype.triggerEvent=function(e,r,n){n===void 0&&(n=!1);var a=this.getCore(),i=C({eventType:e},r);return a.api.triggerEvent(a,i,n),i},t.prototype.attachDomEvent=function(e){var r=this.getCore();return r.api.attachDomEvent(r,e)},t.prototype.getSnapshotsManager=function(){var e=this.getCore();return e.undo.snapshotsManager},t.prototype.isDarkMode=function(){return this.getCore().lifecycle.isDarkMode},t.prototype.setDarkModeState=function(e){var r=this.getCore();!!e!=r.lifecycle.isDarkMode&&(va(r.physicalRoot,!1,e?"lightToDark":"darkToLight",r.darkColorHandler),r.lifecycle.isDarkMode=!!e,r.api.triggerEvent(r,{eventType:"contentChanged",source:e?Ve.SwitchToDarkMode:Ve.SwitchToLightMode,skipUndo:!0},!0))},t.prototype.isInShadowEdit=function(){return!!this.getCore().lifecycle.shadowEditFragment},t.prototype.startShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!0)},t.prototype.stopShadowEdit=function(){var e=this.getCore();e.api.switchShadowEdit(e,!1)},t.prototype.getColorManager=function(){return this.getCore().darkColorHandler},t.prototype.getTrustedHTMLHandler=function(){return this.getCore().trustedHTMLHandler},t.prototype.getDOMCreator=function(){return this.getCore().domCreator},t.prototype.getScrollContainer=function(){return this.getCore().domEvent.scrollContainer},t.prototype.getVisibleViewport=function(){return this.getCore().api.getVisibleViewport(this.getCore())},t.prototype.setEditorStyle=function(e,r,n){var a=this.getCore();a.api.setEditorStyle(a,e,r,n)},t.prototype.announce=function(e){var r=this.getCore();r.api.announce(r,e)},t.prototype.isExperimentalFeatureEnabled=function(e){return this.getCore().experimentalFeatures.indexOf(e)>=0},t.prototype.getCore=function(){if(!this.core)throw new Error("Editor is already disposed");return this.core},t})();function po(t){t.focus();var e=t.getSnapshotsManager(),r=e.move(1);r&&t.restoreSnapshot(r)}function Vr(t,e){if(!t||!t.tag)return null;var r=t.tag,n=t.namespace,a=t.className,i=t.style,o=t.dataset,s=t.attributes,l=t.children,u=n?e.createElementNS(n,r):e.createElement(r);return i&&u.setAttribute("style",i),a&&(u.className=a),o&&F(u,"ELEMENT_NODE")&&ie(o).forEach(function(d){u.dataset[d]=o[d]}),s&&ie(s).forEach(function(d){u.setAttribute(d,s[d])}),l&&l.forEach(function(d){if(typeof d=="string")u.appendChild(e.createTextNode(d));else if(d){var f=Vr(d,e);f&&u.appendChild(f)}}),u}var ly=(function(){return{MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEUP:"mouseup",getPageXY:sy}})(),Ul=(function(){return{MOUSEDOWN:"touchstart",MOUSEMOVE:"touchmove",MOUSEUP:"touchend",getPageXY:uy}})();function sy(t){return[t.pageX,t.pageY]}function uy(t){var e=0,r=0;if(t.targetTouches&&t.targetTouches.length>0){var n=t.targetTouches[0];e=n.pageX,r=n.pageY}return[e,r]}var go=(function(){function t(e,r,n,a,i,o){var s=this;this.trigger=e,this.context=r,this.onSubmit=n,this.handler=a,this.zoomScale=i,this.initX=0,this.initY=0,this.initValue=void 0,this.onMouseDown=function(l){var u,d,f;l.preventDefault(),l.stopPropagation(),s.addDocumentEvents(),u=L(s.dndMouse.getPageXY(l),2),s.initX=u[0],s.initY=u[1],s.initValue=(f=(d=s.handler).onDragStart)===null||f===void 0?void 0:f.call(d,s.context,l)},this.onMouseMove=function(l){var u,d,f;l.preventDefault();var v=L(s.dndMouse.getPageXY(l),2),c=v[0],h=v[1],p=(c-s.initX)/s.zoomScale,m=(h-s.initY)/s.zoomScale;s.initValue&&(!((d=(u=s.handler).onDragging)===null||d===void 0)&&d.call(u,s.context,l,s.initValue,p,m))&&((f=s.onSubmit)===null||f===void 0||f.call(s,s.context,s.trigger))},this.onMouseUp=function(l){var u,d,f;l.preventDefault(),s.removeDocumentEvents(),!((d=(u=s.handler).onDragEnd)===null||d===void 0)&&d.call(u,s.context,l,s.initValue)&&((f=s.onSubmit)===null||f===void 0||f.call(s,s.context,s.trigger))},this.dndMouse=o?Ul:ly,e.addEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown)}return t.prototype.dispose=function(){this.trigger.removeEventListener(this.dndMouse.MOUSEDOWN,this.onMouseDown),this.removeDocumentEvents()},Object.defineProperty(t.prototype,"mouseType",{get:function(){return this.dndMouse==Ul?"touch":"mouse"},enumerable:!1,configurable:!0}),t.prototype.addDocumentEvents=function(){var e=this.trigger.ownerDocument;e.addEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.addEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},t.prototype.removeDocumentEvents=function(){var e=this.trigger.ownerDocument;e.removeEventListener(this.dndMouse.MOUSEMOVE,this.onMouseMove,!0),e.removeEventListener(this.dndMouse.MOUSEUP,this.onMouseUp,!0)},t})();function mo(t,e){var r=Gr(),n=Dn({zoomScale:t.getDOMHelper().calculateZoomScale(),recalculateTableSize:!0});n.elementProcessors.element(r,e,n);var a=r.blocks[0];return a?.blockType=="Table"?a:void 0}var Ca=4,dy="horizontalResizer",fy="verticalResizer";function Gl(t,e,r,n,a,i,o,s,l){var u=e.ownerDocument,d={tag:"div",style:"position: fixed; cursor: "+(a?"row":"col")+"-resize; user-select: none"},f=t.getDOMHelper().calculateZoomScale(),v=Vr(d,u);(s||u.body).appendChild(v);var c={editor:t,td:e,table:r,isRTL:n,zoomScale:f,onStart:i,originalWidth:Je(r.style.width)},h=a?gy:my;h(c,v);var p={onDragStart:vy,onDragging:a?hy:py,onDragEnd:o},m=new cy(v,c,h,p,f,t.getEnvironment().isMobileOrTablet,l);return{node:e,div:v,featureHandler:m}}var cy=(function(t){Ai(e,t);function e(r,n,a,i,o,s,l){var u=t.call(this,r,n,a,i,o,s)||this;return u.disposer=l?.("CellResizer",r),u}return e.prototype.dispose=function(){var r;(r=this.disposer)===null||r===void 0||r.call(this),this.disposer=void 0,t.prototype.dispose.call(this)},e})(go);function vy(t,e){var r=t.td,n=t.onStart,a=Le(r.getBoundingClientRect()),i=r.cellIndex,o=r.parentElement&&re(r.parentElement,"tr")?r.parentElement:void 0,s=o?.rowIndex;if(s==null)return{cmTable:void 0,anchorColumn:void 0,anchorRow:void 0,anchorRowHeight:-1,allWidths:[]};var l=t.editor,u=t.table,d=mo(l,u);return a&&d?(n(),{cmTable:d,anchorColumn:i,anchorRow:s,anchorRowHeight:d.rows[s].height,allWidths:I([],L(d.widths),!1)}):{cmTable:d,anchorColumn:void 0,anchorRow:void 0,anchorRowHeight:-1,allWidths:[]}}function hy(t,e,r,n,a){var i=t.table,o=r.cmTable,s=r.anchorRow,l=r.anchorRowHeight;if(o&&s!=null&&o.rows[s]!=null){D(o).rows[s].height=(l??0)+a;for(var u=Math.max(o.rows[s].height,gn),d=i.rows[s],f=0;f<d.cells.length;f++){var v=d.cells[f];v.style.height=u+"px",v.style.boxSizing="border-box"}return!0}else return!1}function py(t,e,r,n){var a=t.table,i=t.isRTL,o=r.cmTable,s=r.anchorColumn,l=r.allWidths;if(o&&s!=null){var u=D(o),d=s==o.widths.length-1,f=n*(i?-1:1);if(d){var v=Math.max(l[s]+f,un);u.widths[s]=v}else{var c=l[s]+f,h=l[s+1]-f;if(c<un||h<un)return!1;u.widths[s]=c,u.widths[s+1]=h}for(var p=0;p<a.rows.length;p++)for(var m=a.rows[p],b=0;b<m.cells.length;b++){var y=m.cells[b];y.style.width=o.widths[b]+"px",y.style.boxSizing="border-box"}if(t.originalWidth>0){var v=t.originalWidth+f+"px";u.format.width=v,a.style.width=v}return!0}else return!1}function gy(t,e){var r=t.td,n=Le(r.getBoundingClientRect());n&&(e.id=dy,e.style.top=n.bottom-Ca+"px",e.style.left=n.left+"px",e.style.width=n.right-n.left+"px",e.style.height=Ca+"px")}function my(t,e){var r=t.td,n=t.isRTL,a=Le(r.getBoundingClientRect());a&&(e.id=fy,e.style.top=a.top+"px",e.style.left=(n?a.left:a.right)-Ca+1+"px",e.style.width=Ca+"px",e.style.height=a.bottom-a.top+"px")}function by(t,e){e===void 0&&(e=[]);var r=t.map(function(a){return Le(a.getBoundingClientRect())}).concat(e).filter(function(a){return!!a}),n={top:Math.max.apply(Math,I([],L(r.map(function(a){return a.top})),!1)),bottom:Math.min.apply(Math,I([],L(r.map(function(a){return a.bottom})),!1)),left:Math.max.apply(Math,I([],L(r.map(function(a){return a.left})),!1)),right:Math.min.apply(Math,I([],L(r.map(function(a){return a.right})),!1))};return n.top<n.bottom&&n.left<n.right?n:null}var yy=" ",Ey=" ",Cy=" ",bn=40;function kd(t){var e=Sy(t),r=Math.floor(e/4);return r}function Sy(t){var e,r,n=0;try{for(var a=Wt(t),i=a.next();!i.done;i=a.next()){var o=i.value;if(o===yy||o===Cy||o==Ey)n++;else break}}catch(s){e={error:s}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return n}function Ty(t){var e=t.blocks[0];if(e.blockType=="Paragraph"&&e.segments.length>0&&e.segments[0].segmentType=="Text"){var r=kd(e.segments[0].text);r>0&&(vt(e,e.segments[0],function(n){n.text=n.text.substring(r*4)}),t.levels[0].format.marginLeft=r*bn+"px")}}function wy(t,e){var r=t.paragraph,n=t.marker,a=ky(r);a&&(t.paragraph.segments=[n],t.paragraph.format.direction=="rtl"?e.format.marginRight=a*bn+"px":e.format.marginLeft=a*bn+"px")}var ky=function(t){var e,r,n=0,a=t.segments,i=t.segments.every(function(d){return d.segmentType=="Text"&&d.text.trim().length==0||d.segmentType=="SelectionMarker"||d.segmentType=="Br"});if(i){var o=0;try{for(var s=Wt(a),l=s.next();!l.done;l=s.next()){var u=l.value;if(u.segmentType==="Text")n=n+kd(u.text),o++;else break}}catch(d){e={error:d}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}if(a.length-2<=o)return n}};function _y(t,e,r){var n=au(r);return Ke(t,n),n.rows.forEach(function(a){for(var i=0;i<e;i++){var o=Vt();a.cells.push(o)}}),n}function Dy(t,e,r,n){t.focus(),t.formatContentModel(function(a,i){var o,s,l,u=Wr(a,[],i).insertPoint;if(u){var d=Gr(),f=_y(d,e,r);xa(f,t.getPendingFormat()||u.marker.format),wy(u,f),n=n||{verticalAlign:"top"},Ba(f,n),so(a,d,i,{insertPosition:u,mergeFormat:"mergeAll"});var v=(s=(o=f.rows[0])===null||o===void 0?void 0:o.cells[0])===null||s===void 0?void 0:s.blocks[0];if(v?.blockType=="Paragraph"){var c=Ge((l=v.segments[0])===null||l===void 0?void 0:l.format);v.segments.unshift(c),Ot(a,c)}return!0}else return!1},{apiName:"insertTable"})}function _d(t,e){t.format.marginLeft=e=="alignLeft"?"":"auto",t.format.marginRight=e=="alignRight"?"":"auto"}function My(t){t.rows=[]}function Dd(t,e){var r,n=e.firstColumn,a=e.firstRow,i=(r=t[a])===null||r===void 0?void 0:r.cells[n];i&&ht(D(i),Ge())}function Oy(t){var e=Tt(t);if(e){for(var r=0;r<t.rows.length;r++){var n=t.rows[r].cells[e.lastColumn+1];n&&(D(n).spanLeft=n.spanLeft&&t.rows[r].cells[e.firstColumn].spanLeft),t.rows[r].cells.splice(e.firstColumn,e.lastColumn-e.firstColumn+1)}t.widths.splice(e.firstColumn,e.lastColumn-e.firstColumn+1),Dd(t.rows,e)}}function Ly(t){var e=Tt(t);e&&(t.rows[e.firstRow].cells.forEach(function(r,n){var a,i=(a=t.rows[e.lastRow+1])===null||a===void 0?void 0:a.cells[n];i&&(D(i).spanAbove=i.spanAbove&&r.spanAbove)}),t.rows.splice(e.firstRow,e.lastRow-e.firstRow+1),Dd(t.rows,e))}function Ry(t,e,r){var n,a,i,o=(n=r.rows.filter(function(d){return d.cells.length>0})[0])===null||n===void 0?void 0:n.cells[0];if(o)i=o.blocks.filter(function(d){return d.blockType=="Paragraph"})[0],i||(i=Kl(t),D(o).blocks.push(i));else{var s=r,l;for(i=Kl(t);l=e.shift();){var u=(a=l.blocks.indexOf(s))!==null&&a!==void 0?a:-1;if(l&&u>=0&&D(l).blocks.splice(u,1,i),l.blockGroupType=="FormatContainer"&&l.blocks.length==1&&l.blocks[0]==i)s=l;else break}}return i}function Kl(t){var e=je(!1,void 0,t.format),r=qt(t.format);return e.segments.push(r),e}function Md(t,e,r,n){t.focus(),t.formatContentModel(function(a){var i=L(vn(a),2),o=i[0],s=i[1];if(o){var l=D(o);if(r(l),!Aa(l)){var u=Ry(a,s,l);if(u){var d=Ge(a.format);u.segments.unshift(d),et(u),Ot(a,d)}}return xa(l,a.format),ou(l)&&Ba(l,void 0,!0),!0}else return!1},{apiName:e,selectionOverride:n},{recalculateTableSize:"selected"})}function bo(t,e){if(e.firstColumn>=0&&e.firstRow>=0&&e.lastRow<t.rows.length&&e.lastColumn<t.rows[e.lastRow].cells.length)for(var r=e.firstRow;r<=e.lastRow;r++)for(var n=t.rows[r],a=e.firstColumn;a<=e.lastColumn;a++){var i=n.cells[a];i&&(i.isSelected&&(D(i).isSelected=!1),Ot(i))}}function Od(t,e){var r=Tt(t),n=e=="insertLeft";if(r){bo(t,r);for(var a=r?.firstColumn;a<=r.lastColumn;a++)t.rows.forEach(function(i){var o=i.cells[n?r.firstColumn:r.lastColumn],s=Vt(o.spanLeft,o.spanAbove,o.isHeader,o.format,o.dataset);s.isSelected=!0,i.cells.splice(n?r.firstColumn:r.lastColumn+1,0,s)}),t.widths.splice(n?r.firstColumn:r.lastColumn+1,0,t.widths[n?r.firstColumn:r.lastColumn])}}function yo(t,e){var r=Tt(t),n=e=="insertAbove";if(r){bo(t,r);for(var a=r.firstRow;a<=r.lastRow;a++){var i=t.rows[n?r.firstRow:r.lastRow];t.rows.splice(n?r.firstRow:r.lastRow+1,0,{format:C({},i.format),cells:i.cells.map(function(o){var s=Vt(o.spanLeft,o.spanAbove,o.isHeader,o.format,o.dataset);return s.isSelected=!0,s}),height:i.height})}}}function Eo(t,e,r,n,a){var i=r==a||t[e].cells.every(function(u,d){return d<r||d>a||!u.spanAbove}),o=e==n||t.every(function(u,d){return d<e||d>n||!u.cells[r].spanLeft}),s=t[n].cells.map(function(u,d){return d>=r&&d<=a?Fy(t,n,d):-1}).every(function(u,d,f){return u<0||u==f[r]}),l=t.map(function(u,d){return d>=e&&d<=n?Py(t,d,a):-1}).every(function(u,d,f){return u<0||u==f[e]});return i&&o&&s&&l}function Fy(t,e,r){for(var n,a,i=0,o=e+1;o<t.length&&(!((a=(n=t[o])===null||n===void 0?void 0:n.cells[r])===null||a===void 0)&&a.spanAbove);o++)i++;return i}function Py(t,e,r){for(var n,a,i,o=0,s=r+1;s<((n=t[e])===null||n===void 0?void 0:n.cells.length)&&(!((i=(a=t[e])===null||a===void 0?void 0:a.cells[s])===null||i===void 0)&&i.spanLeft);s++)o++;return o}function Ay(t){var e=Tt(t);if(e&&Eo(t.rows,e.firstRow,e.firstColumn,e.lastRow,e.lastColumn))for(var r=e.firstRow;r<=e.lastRow;r++)for(var n=e.firstColumn;n<=e.lastColumn;n++){var a=t.rows[r].cells[n];if(a){var i=D(a);i.spanLeft=n>e.firstColumn,i.spanAbove=r>e.firstRow}}}function Ny(t,e){var r,n,a,i,o=Tt(t),s=e=="mergeLeft";if(o){var l=s?o.firstColumn:o.lastColumn+1;if(l>0&&l<t.rows[0].cells.length)for(var u=o.firstRow;u<=o.lastRow;u++){var d=(r=t.rows[u])===null||r===void 0?void 0:r.cells[l];if(d&&Eo(t.rows,u,l-1,u,l)){D(d).spanLeft=!0;for(var f=l;!((a=(n=t.rows[u])===null||n===void 0?void 0:n.cells[f])===null||a===void 0)&&a.spanLeft;)D(t.rows[u].cells[f]),f--;var v=(i=t.rows[u])===null||i===void 0?void 0:i.cells[f];v&&(D(v).isSelected=!0)}}}}function Iy(t,e){var r,n,a,i=Tt(t),o=e=="mergeAbove";if(i){var s=o?i.firstRow:i.lastRow+1;if(s>0&&s<t.rows.length)for(var l=i.firstColumn;l<=i.lastColumn;l++){var u=t.rows[s].cells[l];if(u&&Eo(t.rows,s-1,l,s,l)){D(u).spanAbove=!0;for(var d=s;!((n=(r=t.rows[d])===null||r===void 0?void 0:r.cells[l])===null||n===void 0)&&n.spanAbove;)D(t.rows[d].cells[l]),d--;var f=(a=t.rows[d])===null||a===void 0?void 0:a.cells[l];f&&(D(f).isSelected=!0)}}}}var By=30;function xy(t){var e=Tt(t);if(e)for(var r=function(a){if(t.rows.every(function(o,s){var l;return s<e.firstRow||s>e.lastRow||((l=o.cells[a+1])===null||l===void 0?void 0:l.spanLeft)}))t.rows.forEach(function(o,s){D(o.cells[a]),s>=e.firstRow&&s<=e.lastRow&&(D(o.cells[a+1]).spanLeft=!1)});else{t.rows.forEach(function(o,s){var l=o.cells[a];if(l){var u=D(l);delete u.format.width;var d=Vt(l.spanLeft,l.spanAbove,l.isHeader,u.format);d.dataset=C({},l.dataset),s<e.firstRow||s>e.lastRow?d.spanLeft=!0:d.isSelected=l.isSelected,o.cells.splice(a+1,0,d),D(o.cells[a])}});var i=Math.max(t.widths[a]/2,By);t.widths.splice(a,1,i,i)}},n=e.lastColumn;n>=e.firstColumn;n--)r(n)}var Hy=22;function zy(t){var e=Tt(t);if(e)for(var r=e.lastRow;r>=e.firstRow;r--){var n=t.rows[r],a=t.rows[r+1];if(n.cells.forEach(D),a?.cells.every(function(s,l){return l<e.firstColumn||l>e.lastColumn||s.spanAbove}))a.cells.forEach(function(s,l){l>=e.firstColumn&&l<=e.lastColumn&&(D(s).spanAbove=!1)});else{var i=Math.max(n.height/=2,Hy),o={format:C({},n.format),height:i,cells:n.cells.map(function(s,l){var u=D(s);delete u.format.height;var d=Vt(s.spanLeft,s.spanAbove,s.isHeader,u.format);return d.dataset=C({},s.dataset),l<e.firstColumn||l>e.lastColumn?d.spanAbove=!0:d.isSelected=s.isSelected,d})};n.height=i,t.rows.splice(r+1,0,o)}}}var Uy={alignCellLeft:"start",alignCellCenter:"center",alignCellRight:"end"},Gy={alignCellTop:"top",alignCellMiddle:"middle",alignCellBottom:"bottom"};function Ky(t,e){Ld(t,function(r){r.format.textAlign=Uy[e]})}function Wy(t,e){Ld(t,function(r){r.format.verticalAlign=Gy[e],oo(r,function(n){return n=n||{},n.vAlignOverride=!0,n})})}function Ld(t,e){var r,n=Tt(t);if(n)for(var a=n.firstRow;a<=n.lastRow;a++)for(var i=n.firstColumn;i<=n.lastColumn;i++){var o=(r=t.rows[a])===null||r===void 0?void 0:r.cells[i],s=o?.format;s&&(e(D(o)),o.blocks.forEach(function(l){l.blockType==="Paragraph"&&l.format.textAlign&&delete D(l).format.textAlign}))}}function Sr(t,e){t.focus(),Vy(t),Md(t,"editTable",function(r){switch(e){case"alignCellLeft":case"alignCellCenter":case"alignCellRight":Ky(r,e);break;case"alignCellTop":case"alignCellMiddle":case"alignCellBottom":Wy(r,e);break;case"alignCenter":case"alignLeft":case"alignRight":_d(r,e);break;case"deleteColumn":Oy(r);break;case"deleteRow":Ly(r);break;case"deleteTable":My(r);break;case"insertAbove":case"insertBelow":yo(r,e);break;case"insertLeft":case"insertRight":Od(r,e);break;case"mergeAbove":case"mergeBelow":Iy(r,e);break;case"mergeCells":Ay(r);break;case"mergeLeft":case"mergeRight":Ny(r,e);break;case"splitHorizontally":xy(r);break;case"splitVertically":zy(r);break}})}function Vy(t){if(t.getEnvironment().isSafari){var e=t.getDOMSelection();e?.type=="range"&&!e.range.collapsed&&(e.range.collapse(!0),t.setDOMSelection({type:"range",range:e.range,isReverted:!1}))}}function Co(t){var e,r,n,a,i,o=On(t,!1,!1);try{for(var s=Wt(o),l=s.next();!l.done;l=s.next()){var u=L(l.value,3),d=u[0],f=u[1],v=u[2];if(f?.segments.some(function(T){return T.segmentType=="Br"})){var c=Wl(f),h=!1,p=[],m=D(v[0]),b=m.blocks.indexOf(f);if(b>=0){try{for(var y=(n=void 0,Wt(D(f).segments)),E=y.next();!E.done;E=y.next()){var S=E.value;S.segmentType=="Br"?(h||c.segments.push(S),c.segments.length>0&&p.push(c),c=Wl(f),h=!1):(c.segments.push(S),S.segmentType!="SelectionMarker"&&(h=!0))}}catch(T){n={error:T}}finally{try{E&&!E.done&&(a=y.return)&&a.call(y)}finally{if(n)throw n.error}}c.segments.length>0&&p.push(c),(i=m.blocks).splice.apply(i,I([b,1],L(p),!1))}}}}catch(T){e={error:T}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}}function Wl(t){return je(!1,t.format,t.segmentFormat,t.decorator)}function Rd(t,e,r){r===void 0&&(r=!1),Co(t);var n=Ln(t,["ListItem"],[]),a=n.every(function(o){var s,l=o.block;return St(l,"ListItem")?((s=l.levels[l.levels.length-1])===null||s===void 0?void 0:s.listType)==e:Vl(l)}),i=[];return n.forEach(function(o,s){var l,u,d=o.block,f=o.parent;if(St(d,"ListItem")){var v=d.levels.pop();!a&&v?(v.listType=e,ma(v,function(E){return Object.assign({},E,{applyListStyleFromLevel:!0})}),d.levels.push(v)):d.blocks.length==1&&et(d.blocks[0]),a&&d.blocks.forEach(function(E){Pr(E.format,d.format,Ii)})}else{var c=f.blocks.indexOf(d);if(c>=0)if(n.length==1||!Vl(d)){var h=f.blocks[c-1],p=d.blockType=="Paragraph"&&((l=d.segments[0])===null||l===void 0?void 0:l.format)||{},m=kn([gr(e,{startNumberOverride:s>0||h?.blockType=="BlockGroup"&&h.blockGroupType=="ListItem"&&((u=h.levels[0])===null||u===void 0?void 0:u.listType)=="OL"?void 0:1,direction:d.format.direction,textAlign:d.format.textAlign,marginBottom:r?"0px":void 0,marginTop:r?"0px":void 0})],{fontFamily:p.fontFamily,fontSize:p.fontSize,textColor:p.textColor});d.blockType=="Paragraph"&&et(d);var b=D(d);m.blocks.push(b),Ty(m),Pr(m.format,b.format,Xs,!0),Pr(m.format,b.format,Ys),D(f).blocks.splice(c,1,m),i.push(m);var y=m.levels.length-1,v=D(m).levels[y];v&&ma(v,function(S){return Object.assign({},S,{applyListStyleFromLevel:!0})})}else i.forEach(function(E){return D(E).levels[0].format.marginBottom="0px"}),i=[]}}),Et(t),n.length>0}function Vl(t){switch(t.blockType){case"Table":return!1;case"Paragraph":return t.segments.every(function(e){return e.segmentType=="Br"||e.segmentType=="SelectionMarker"});default:return!0}}function Fd(t,e){e===void 0&&(e=!1),t.focus(),t.formatContentModel(function(r,n){return n.newPendingFormat="preserve",Rd(r,"UL",e)},{apiName:"toggleBullet"})}function Pd(t,e){e===void 0&&(e=!1),t.focus(),t.formatContentModel(function(r,n){return n.newPendingFormat="preserve",Rd(r,"OL",e)},{apiName:"toggleNumbering"})}function Ad(t,e){var r;lt(t,function(u,d,f,v){return f?.blockType=="Paragraph"&&v?.length==1&&v[0]==e&&(r=D(f)),!0});var n=r?I([],L(r.segments),!1):void 0;if(n&&r){for(var a=[],i=n.indexOf(e),o=i-1;o>=0;o--){var s=n[o];if(s.segmentType=="Text"){var l=jl(s,!1);if(l>-1){if(l==s.text.length)break;ql(n,s,o,l),a.push(n[o+1]);break}else a.push(n[o])}else break}if(i=n.indexOf(e),a.push(e),a.length<=1)return a;for(var o=i+1;o<n.length;o++){var s=n[o];if(s.segmentType=="Text"){var l=jl(s,!0);if(l>-1){if(l==0)break;ql(n,s,o,l),a.push(n[o]);break}else a.push(n[o])}else break}return a[a.length-1]==e?[e]:(r.segments=n,a)}else return[e]}function jl(t,e){var r=t.text,n=-1;if(e)for(var a=0;a<r.length;a++){var i=r[a];if(fa(i)||ca(i)){n=a;break}}else for(var a=r.length-1;a>=0;a--){var i=r[a];if(fa(i)||ca(i)){n=a+1;break}}return n}function ql(t,e,r,n){var a=e.text,i=We(a.substring(0,n),e.format,e.link,e.code),o=We(a.substring(n,a.length),e.format,e.link,e.code);t.splice(r,1,i,o)}function Nd(t,e){var r,n=t.getDOMHelper(),a={isDarkMode:t.isDarkMode(),defaultFormat:C({},e.format),darkColorHandler:t.getColorManager(),addDelimiterForEntity:!1,allowCacheElement:!1,domIndexer:void 0,zoomScale:n.calculateZoomScale(),experimentalFeatures:[]};return((r=t.getDocument().defaultView)===null||r===void 0?void 0:r.getComputedStyle(e.wrapper).direction)=="rtl"&&(a.isRootRtl=!0),a}function tr(t,e,r,n,a,i){t.formatContentModel(function(o,s){var l=On(o,!!a,!0,!0),u=l.length>=1&&l.every(function(p){return p[0].segmentType=="SelectionMarker"});if(u){var d=l[0][1],f=l[0][2];l=Ad(o,l[0][0]).map(function(p){return[p,d,f]}),l.length>1&&(u=!1)}var v=[],c=[];l.forEach(function(p){p[0].segmentType=="Entity"?jy(t,p[0],v,c):v.push([p[0].format,p[0],p[1]])});var h=n?v.every(function(p){var m=L(p,3),b=m[0],y=m[1],E=m[2];return n(b,y,E)}):!1;return v.forEach(function(p){var m=L(p,3),b=m[0],y=m[1],E=m[2];r(b,!h,y,E)}),i?.(o,h,s),v.forEach(function(p){var m=L(p,3);m[0],m[1];var b=m[2];b&&Yc(b)}),qy(t,c),u?(s.newPendingFormat=l[0][0].format,t.focus(),!1):v.length>0},{apiName:e})}function jy(t,e,r,n){var a=e.entityFormat,i=a.id,o=a.entityType,s=a.isReadonly;if(i&&o){var l=[],u={entity:{id:i,type:o,isReadonly:!!s,wrapper:e.wrapper},operation:"beforeFormat",formattableRoots:l};t.triggerEvent("entityOperation",u),l.forEach(function(d){if(e.wrapper.contains(d.element)){var f=Nd(t,e),v=Dn(f,d.domToModelOptions);v.isInSelection=!0;var c=En(d.element,v),h=On(c,!1,!1,!0);h.forEach(function(p){r.push([p[0].format,p[0],p[1]])}),n.push([e,d,c])}})}}function qy(t,e){e.forEach(function(r){var n=L(r,3),a=n[0],i=n[1],o=n[2],s=Nd(t,a),l=Fa(s,i.modelToDomOptions);zi(t.getDocument(),i.element,o,l)})}function Id(t,e){t.focus(),tr(t,"toggleBold",function(r,n){r.fontWeight=n?"bold":"normal"},function(r,n,a){var i;return Lu(typeof r.fontWeight>"u"?(i=a?.decorator)===null||i===void 0?void 0:i.format.fontWeight:r.fontWeight)},void 0,function(r,n,a){e?.announceFormatChange&&(a.announceData={defaultStrings:n?"announceBoldOff":"announceBoldOn"})})}function Bd(t,e){t.focus(),tr(t,"toggleItalic",function(r,n){r.italic=!!n},function(r){return!!r.italic},void 0,function(r,n,a){e?.announceFormatChange&&(a.announceData={defaultStrings:n?"announceItalicOff":"announceItalicOn"})})}function xd(t,e){t.focus(),tr(t,"toggleUnderline",function(r,n,a){r.underline=!!n,a?.link&&(a.link.format.underline=!!n)},function(r,n){var a,i;return!!r.underline||!!(!((i=(a=n?.link)===null||a===void 0?void 0:a.format)===null||i===void 0)&&i.underline)},!1,function(r,n,a){e?.announceFormatChange&&(a.announceData={defaultStrings:n?"announceUnderlineOff":"announceUnderlineOn"})})}function Xy(t){t.focus(),tr(t,"toggleStrikethrough",function(e,r){e.strikethrough=!!r},function(e){return!!e.strikethrough})}function Yy(t,e){t.focus();var r=null,n=-1;tr(t,"setBackgroundColor",function(a,i,o,s){e===null?delete a.backgroundColor:a.backgroundColor=e,o&&s&&o.segmentType!="SelectionMarker"&&(r=s,n=r.segments.indexOf(o))},void 0,void 0,function(a){var i;if(r&&n>=0){var o=Ge((i=r.segments[n])===null||i===void 0?void 0:i.format);r.segments.splice(n+1,0,o),Ot(a,o,o)}})}function Zy(t,e){t.focus(),tr(t,"setFontSize",function(r,n,a,i){return Hd(e,r,i)},void 0,!0)}function Hd(t,e,r){var n;if(e.fontSize=t,!((n=r?.segmentFormat)===null||n===void 0)&&n.fontSize){var a=r.segmentFormat.fontSize;r.segments.forEach(function(i){i.format.fontSize||(i.format.fontSize=a)}),delete r.segmentFormat.fontSize}}function Jy(t,e){t.focus(),tr(t,"setTextColor",e===null?function(r,n,a){delete r.textColor,a?.link&&delete a.link.format.textColor}:function(r,n,a){r.textColor=e,a?.link&&(a.link.format.textColor=e)},void 0,!0)}var Qy=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],$y=1,e1=1e3;function zd(t,e,r){r===void 0&&(r=Qy),t.focus(),tr(t,"changeFontSize",function(n,a,i,o){return t1(e,n,o,r)},void 0,!0)}function t1(t,e,r,n){if(e.fontSize){var a=Je(e.fontSize,void 0,"pt");if(a>0){var i=r1(a,t=="increase"?1:-1,n);Hd(i+"pt",e,r)}}}function r1(t,e,r){t=e==1?Math.floor(t):Math.ceil(t);var n=r[r.length-1];if(t<=r[0])t=Math.max(t+e,$y);else if(t>n||t==n&&e==1)t=t/10,t=e==1?Math.floor(t):Math.ceil(t),t=Math.min(Math.max((t+e)*10,n),e1);else if(e==1){for(var a=0;a<r.length;a++)if(t<r[a]){t=r[a];break}}else for(var a=r.length-1;a>=0;a--)if(t>r[a]){t=r[a];break}return t}function n1(t,e,r,n){var a,i=t.text,o=e.segments.indexOf(t),s=We(i.substring(r,n),t.format,t.link,t.code),l=[s];return r>0&&l.unshift(We(i.substring(0,r),t.format,t.link,t.code)),n<i.length&&l.push(We(i.substring(n),t.format,t.link,t.code)),l.forEach(function(u){return u.isSelected=t.isSelected}),(a=e.segments).splice.apply(a,I([o,1],L(l),!1)),s}function So(t,e){var r=[];return na(t,r),a1(r,e)}function na(t,e){t.blocks.forEach(function(r){switch(r.blockType){case"BlockGroup":r.blockGroupType=="ListItem"?e.push(r):(Tr(e),na(r,e),Tr(e));break;case"Paragraph":Tr(e),r.segments.forEach(function(n){n.segmentType=="General"&&na(n,e)}),Tr(e);break;case"Table":Tr(e),r.rows.forEach(function(n){return n.cells.forEach(function(a){na(a,e)})}),Tr(e);break}})}function Tr(t){var e=t[t.length-1];(!e||e!==null)&&t.push(null)}function a1(t,e){var r,n=[],a=t.indexOf(e),i=e.levels.length,o=((r=e.levels[i-1])===null||r===void 0?void 0:r.listType)=="OL";if(a>=0){for(var s=a;s>=0;s--){var l=t[s];if(!l){if(o)continue;break}var u=Yl(l,i);if(Xl(t,a,s)){if(n.unshift(l),o&&u)break}else if(!o||u||l.levels.length<e.levels.length)break}for(var s=a+1;s<t.length;s++){var l=t[s];if(!l){if(o)continue;break}var u=Yl(l,i);if(Xl(t,a,s)&&!u)n.push(l);else if(!o||u||l.levels.length<e.levels.length)break}}return n}function Xl(t,e,r){var n=t[e].levels,a=t[r].levels;return n.length<=a.length&&n.every(function(i,o){return i.listType==a[o].listType})}function Yl(t,e){return t.levels.slice(0,e).some(function(r){return r.format.startNumberOverride!==void 0})}function Ud(t){var e=ot(t,["ListItem"],["TableCell"]);if(e>=0){var r=t[e],n=r.levels[r.levels.length-1];if(!n||n.format.displayForDummyItem)return null;if(n.listType=="OL"){var a=i1(t,r),i=H0(n),o=ro("OL",i??{},r.levels.length-1,n.format.listStyleType);return o===void 0?null:{defaultStrings:"announceListItemNumbering",formatStrings:[to(o,a)]}}else return{defaultStrings:"announceListItemBullet"}}else return null}function i1(t,e){for(var r,n,a=So(t[t.length-1],e),i=0,o=0;o<a.length;o++){var s=a[o];if(i==0&&s.levels.length==e.levels.length&&(i=(n=(r=s.levels[s.levels.length-1])===null||r===void 0?void 0:r.format.startNumberOverride)!==null&&n!==void 0?n:1),s==e)break;if(s.levels.length<e.levels.length)i=0;else{if(s.levels.length>e.levels.length)continue;s.levels[s.levels.length-1].format.displayForDummyItem||i++}}return i}function jr(t,e,r,n){r===void 0&&(r=bn),Co(t);var a=Ln(t,["ListItem"],["TableCell"]),i=e=="indent",o=[];return a.forEach(function(s){var l=s.block,u=s.parent,d=s.path;if(St(l,"ListItem")){var f=So(t,l),v=f[0];if(Ri(v)&&v.levels.length==1){var c=l.levels[0],h=c.format,p=h.marginLeft,m=h.marginRight,b=Zl(h,i,r),y=h.direction=="rtl",E=Je(y?m:p);!i&&E==0?l.levels.pop():b!==null&&(y?c.format.marginRight=b+"px":c.format.marginLeft=b+"px")}else if(l.levels.length==1||!o1(t,l,u)){if(i){var S=f.indexOf(l),T=f[S-1],k=f[S+1],R=l.levels.length,M=l.levels[R-1],w=gr(M?.listType||"UL",M?.format,T&&T.levels.length>R?T.levels[R].dataset:k&&k.levels.length>R?k.levels[R].dataset:void 0);ma(w,function(z){return z=z||{},z.applyListStyleFromLevel=!0,z}),delete w.format.startNumberOverride,l.levels.push(w)}else l.levels.pop();l.levels.length>0&&n&&(n.announceData=Ud(I([l],L(d),!1)))}}else if(l)for(var A=l,N=u;N&&o.indexOf(A)<0;){var J=d.indexOf(N),h=D(A).format,b=Zl(h,i,r);if(b!==null){var y=h.direction=="rtl";y?h.marginRight=b+"px":h.marginLeft=b+"px",o.push(A);break}else if(N.blockGroupType=="FormatContainer"&&J>=0)D(N),A=N,N=d[J+1];else break}}),a.length>0}function Ri(t){return t.blocks.some(function(e){if(e.blockType=="Paragraph")return e.segments.some(function(r){return r.isSelected})})}function o1(t,e,r){for(var n=r.blocks.indexOf(e),a=n-1;a>=0;a--){var i=r.blocks[a];if(St(i,"ListItem")&&i.levels.length==1&&Ri(i)){var o=So(t,i)[0];return Ri(o)}if(!St(i,"ListItem"))return!1}return!1}function Zl(t,e,r){r===void 0&&(r=bn);var n=t.marginLeft,a=t.marginRight,i=t.direction,o=i=="rtl",s=Je(o?a:n),l=(e?Math.ceil:Math.floor)(s/r)*r;return l==s&&(l=Math.max(l+r*(e?1:-1),0)),l==s?null:l}var l1={left:{ltr:"start",rtl:"end"},center:{ltr:"center",rtl:"center"},right:{ltr:"end",rtl:"start"},justify:{ltr:"justify",rtl:"justify"}},s1={left:{ltr:"alignLeft",rtl:"alignRight"},center:{ltr:"alignCenter",rtl:"alignCenter"},right:{ltr:"alignRight",rtl:"alignLeft"}};function u1(t,e){Co(t);var r=Ln(t,["ListItem"],["TableCell"]);return r.forEach(function(n){var a=n.block,i=D(a),o=l1[e][i.format.direction=="rtl"?"rtl":"ltr"];if(i.blockType==="Table"&&e!=="justify")_d(i,s1[e][i.format.direction=="rtl"?"rtl":"ltr"]);else if(i){i.blockType==="BlockGroup"&&i.blockGroupType==="ListItem"&&i.blocks.forEach(function(l){var u=D(l).format;u.textAlign=o});var s=i.format;s.textAlign=o}}),r.length>0}function d1(t,e){t.focus(),t.formatContentModel(function(r){return u1(r,e)},{apiName:"setAlignment"})}function f1(t,e,r){if(!r.nodeStack){var n=Wi(r.selection);r.nodeStack=n?c1(e,n):[]}var a=r.nodeStack.pop();if(a){var i=L(Cn(r,e),2),o=i[0],s=i[1],l=o>=0||s>=0?v1(e,a):-1;l>=0&&oa(l,r,t,o,s),Ki(t,a,r),l>=0&&oa(l+1,r,t,o,s)}else r.defaultElementProcessors.child(t,e,r)}function c1(t,e){for(var r=[],n=e;n&&t!=n&&t.contains(n);)F(n,"ELEMENT_NODE")&&n.tagName=="TABLE"?r.splice(0,r.length,n):r.push(n),n=n.parentNode;return r}function v1(t,e){for(var r=0,n=t.firstChild;n&&n!=e;)r++,n=n.nextSibling;return r}function h1(t,e){e===void 0&&(e="remove");var r=t.getPendingFormat(),n=t.getSnapshotsManager(),a={canUndo:n.hasNewContent||n.canMove(-1),canRedo:n.canMove(1),isDarkMode:t.isDarkMode()};return t.formatContentModel(function(i){return L0(i,r,a,e,t.getDOMHelper(),t.isDarkMode(),t.getColorManager()),!1},void 0,{processorOverride:{child:f1},tryGetFromCache:!0}),a}function p1(t,e,r,n){var a=!1;lt(t,function(d,f,v,c){if(c)if(v?.blockType=="Paragraph"){var h=L(Bi(v,c),2),p=h[1];r.push.apply(r,I([],L(p),!1))}else d[0].blockGroupType=="ListItem"&&c.length==1&&d[0].formatHolder==c[0]&&r.push(D(d[0]).formatHolder);v?e.push([d,D(v)]):f&&b1(f,n)},{includeListFormatHolder:t.format?"never":"anySegment"});var i=r[0];if(e.length==1&&C1(e[0][1])&&e.length==1)r.splice.apply(r,I([0,r.length],L(Ad(t,i)),!1)),a=Jl(e[0][0])||a;else if(e.length>1||e.some(function(d){return S1(d[1])}))for(var o=e.length-1;o>=0;o--){var s=L(e[o],2),l=s[0],u=s[1];E1(l,u),a=Jl(l)||a,y1(l,u)}return m1(r,t.format),g1(n),a}function g1(t){t.forEach(function(e){var r=L(e,2),n=r[0],a=r[1];a&&(n.format={useBorderBox:n.format.useBorderBox,borderCollapse:n.format.borderCollapse},Xu(n,function(){return null})),Ba(n,void 0,!0)})}function m1(t,e){t.forEach(function(r){r.format=C({},e||{}),r.link&&delete r.link.format.textColor,delete r.code})}function b1(t,e){if(t){var r=t.table,n=t.colIndex,a=t.rowIndex,i=t.isWholeTableSelected,o=r.rows[a].cells[n];if(o.isSelected){var s=D(o);oo(s,function(){return null}),s.isHeader=!1,s.format={useBorderBox:o.format.useBorderBox}}e.find(function(l){return l[0]==r})||e.push([D(r),i])}}function y1(t,e){var r=ot(t,["FormatContainer"],["TableCell"]);if(r>=0&&r<t.length-1){var n=D(t[r]),a=t[r+1].blocks.indexOf(n),i=n.blocks.indexOf(e);if(i>=0&&a>=0){var o=Qi(n.tagName,n.format);n.blocks.splice(i,1),o.blocks=n.blocks.splice(i),D(t[r+1]).blocks.splice(a+1,0,e,o)}}}function Jl(t){var e=t[ot(t,["ListItem"],["TableCell"])];return e?(D(e).levels=[],!0):!1}function E1(t,e){if(e.blockType=="Divider"){var r=t[0].blocks.indexOf(e);r>=0&&D(t[0]).blocks.splice(r,1)}else e.blockType=="Paragraph"&&(e.format={},delete e.decorator)}function C1(t){var e=t.blockType=="Paragraph"?t.segments.filter(function(r){return r.isSelected}):[];return e.length==1&&e[0].segmentType=="SelectionMarker"}function S1(t){return t.isSelected||t.blockType=="Paragraph"&&t.segments.every(function(e){return e.isSelected})}var T1=3;function Gd(t){t.focus(),t.formatContentModel(function(e){for(var r=!1,n=!0,a=0;n&&a++<T1;){var i=[],o=[],s=[];n=p1(e,i,o,s),Et(e),r=r||i.length>0||o.length>0||s.length>0}return r},{apiName:"clearFormat"})}var Ql=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,$l="[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",w1="(?:"+$l+"\\.)*"+$l,k1=w1+"(?:\\:[0-9]+)?",Bt=k1+"(?:[\\/\\?]\\S*)?",es={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+Bt+"|www\\."+Bt,"i"),except:Ql,normalizeUrl:function(t){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(t)?t:"http://"+t}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+Bt,"i"),except:Ql},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+Bt+"|ftp\\."+Bt,"i"),normalizeUrl:function(t){return new RegExp("^ftp:\\/\\/","i").test(t)?t:"ftp://"+t}},news:{match:new RegExp("^news:(\\/\\/)?"+Bt,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+Bt,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+Bt,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+Bt,"i")}};function _1(t){var e,r;if(t)try{for(var n=Wt(ie(es)),a=n.next();!a.done;a=n.next()){var i=a.value,o=es[i],s=t.match(o.match);if(s&&s[0]==t&&(!o.except||!o.except.test(t)))return{scheme:i,originalUrl:t,normalizedUrl:o.normalizeUrl?o.normalizeUrl(t):t}}}catch(l){e={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return null}function D1(t,e,r,n){var a={input:e};t.formatContentModel(function(i,o){if(r(i,o,a.result),a?.result){var s=a.result,l=s.paragraph,u=s.marker,d=l.segments.indexOf(u);d>=0&&D(l).segments.splice(d,1)}return!0},n,{processorOverride:{child:M1(a),textWithSelection:O1(a)},tryGetFromCache:!1})}function M1(t){return function(e,r,n){var a=n;a.path=a.path||[];var i=!1;a.path[0]!=e&&(a.path.unshift(e),i=!0);for(var o=Kd(n,t,r),s=0,l=r.firstChild;l;l=l.nextSibling)ts(t,s,n,e,o,r),Ki(e,l,n),s++;ts(t,s,n,e,o,r),i&&a.path.shift()}}function ts(t,e,r,n,a,i){e==a[2]&&(e<=a[0]||a[0]<0)&&(e<a[1]||a[1]<0)&&(Fr(n,r,i,e,t),a[2]=-1),e==a[0]&&(r.isInSelection=!0,Fr(n,r,i,e)),e==a[2]&&(e<a[1]||a[1]<0)&&(Fr(n,r,i,e,t),a[2]=-1),e==a[1]&&(Fr(n,r,i,e),r.isInSelection=!1),e==a[2]&&Fr(n,r,i,e,t)}var O1=function(t){return function(e,r,n){var a=r.nodeValue||"",i=Kd(n,t,r),o=L(i,3),s=o[0],l=o[1],u=o[2],d=function(f,v,c){sn(e,a.substring(0,f),n),Fr(e,n,r,v,c),i[0]-=f,i[1]-=f,i[2]=c?-1:i[2]-f,a=a.substring(f)};i[2]>=0&&(i[2]<=i[0]||i[0]<0)&&(i[2]<i[1]||i[1]<0)&&d(i[2],u,t),i[0]>=0&&(d(i[0],s),n.isInSelection=!0),i[2]>=0&&i[2]>i[0]&&(i[2]<i[1]||i[1]<0)&&d(i[2],u,t),i[1]>=0&&(d(i[1],l),n.isInSelection=!1),i[2]>=0&&i[2]>=i[1]&&d(i[2],u,t),sn(e,a,n)}};function Fr(t,e,r,n,a){var i=ru(t,e,r,n);i.isSelected=!a;var o=ht(t,i,e.blockFormat,i.format);a&&e.path&&(a.result={path:I([],L(e.path),!1),paragraph:o,marker:i})}function Kd(t,e,r){var n=L(Cn(t,r),2),a=n[0],i=n[1],o=e.input.node==r?e.input.offset:-1;return[a,i,o]}var Wd="[s]*[a-zA-Z0-9+][s]*",L1="(T|t)el:"+Wd,R1="(M|m)ailto:"+Wd;function F1(t,e){var r,n=e??{},a=n.autoLink,i=n.autoMailto,o=n.autoTel,s=a?(r=_1(t))===null||r===void 0?void 0:r.normalizedUrl:void 0,l=o?P1(t):void 0,u=i?A1(t):void 0;return s||l||u}function P1(t){return t.match(L1)?t.toLocaleLowerCase():void 0}function A1(t){return t.match(R1)?t.toLocaleLowerCase():void 0}function N1(t,e,r){if(t.link)return null;var n=t.text.split(" ").pop(),a=n?.trim(),i=void 0;if(a&&n&&(i=F1(a,r))){var o=n1(t,e,t.text.length-n.trimLeft().length,t.text.trimRight().length);return o.link={format:{href:i,underline:!0},dataset:{}},o}return null}var I1="#4A4A4A",B1="white",Sa=12,Fi=1,x1="horizontalInserter",H1="verticalInserter";function z1(t,e,r,n,a,i,o,s,l){var u=Le(e.getBoundingClientRect()),d=t.getVisibleViewport(),f=r&&d?by([r],[d]):null;if(u&&f){var v=e.ownerDocument,c=G1(a,t.isDarkMode(),n,t.getDOMHelper().getDomStyle("backgroundColor")||"white"),h=Vr(c,v);a?(h.id=x1,h.style.left=(n?f.right:f.left-(Sa-1+2*Fi))+"px",h.style.top=u.bottom-8+"px",h.firstChild.style.width=f.right-f.left+"px"):(h.id=H1,h.style.left=(n?u.left-8:u.right-8)+"px",h.style.top=f.top-(Sa-1+2*Fi)+"px",h.firstChild.style.height=f.bottom-f.top+"px"),(s||v.body).appendChild(h);var p=new U1(h,e,r,a,t,i,o,l);return{div:h,featureHandler:p,node:e}}return null}var U1=(function(){function t(e,r,n,a,i,o,s,l){var u=this;this.div=e,this.td=r,this.table=n,this.isHorizontal=a,this.editor=i,this.onBeforeInsert=o,this.onAfterInsert=s,this.insertTd=function(){var d=u.td.cellIndex,f=u.td.parentElement&&re(u.td.parentElement,"tr")?u.td.parentElement:void 0,v=f&&f.rowIndex;f?.cells==null||v==null||(u.onBeforeInsert(),Md(u.editor,"editTablePlugin",function(c){u.isHorizontal?yo(c,"insertBelow"):Od(c,"insertRight")},{type:"table",firstColumn:d,firstRow:v,lastColumn:d,lastRow:v,table:u.table}),u.onAfterInsert())},this.div.addEventListener("click",this.insertTd),this.disposer=l?.(a?"HorizontalTableInserter":"VerticalTableInserter",e)}return t.prototype.dispose=function(){var e;this.div.removeEventListener("click",this.insertTd),(e=this.disposer)===null||e===void 0||e.call(this),this.disposer=void 0},t})();function G1(t,e,r,n){var a=e?B1:I1,i="position: fixed; width: "+Sa+"px; height: "+Sa+"px; font-size: 16px; color: black; line-height: 8px; vertical-align: middle; text-align: center; cursor: pointer; border: solid "+Fi+"px "+a+"; border-radius: 50%; background-color: "+n,o=r?"right":"left",s="position: absolute; box-sizing: border-box; background-color: "+n+";",l={tag:"div",style:s+(t?o+": 12px; top: 5px; height: 3px; border-top: 1px solid "+a+"; border-bottom: 1px solid "+a+"; border-right: 1px solid "+a+"; border-left: 0px;":"left: 5px; top: 12px; width: 3px; border-left: 1px solid "+a+"; border-right: 1px solid "+a+"; border-bottom: 1px solid "+a+"; border-top: 0px;")};return{tag:"div",style:i,children:[l,"+"]}}function Vd(t,e,r){var n=t.getDocument(),a=t.getDOMHelper();if("caretPositionFromPoint"in n){var i=n.caretPositionFromPoint(e,r);if(i&&a.isNodeInEditor(i.offsetNode))return{node:i.offsetNode,offset:i.offset}}if(n.caretRangeFromPoint){var o=n.caretRangeFromPoint(e,r);if(o&&a.isNodeInEditor(o.startContainer))return{node:o.startContainer,offset:o.startOffset}}if(n.elementFromPoint){var s=n.elementFromPoint(e,r);if(s&&a.isNodeInEditor(s))return{node:s,offset:0}}return null}var Ur=12,K1="_Table_Mover",W1="_TableMoverCursorStyle";function V1(t,e,r,n,a,i,o,s,l,u){var d=Le(t.getBoundingClientRect());if(!X1(e,d,o))return null;var f=e.getDOMHelper().calculateZoomScale(),v=t.ownerDocument,c={tag:"div",style:"position: fixed; cursor: move; user-select: none; border: 1px solid #808080"},h=Vr(c,v);h.id=K1,h.style.width=Ur+"px",h.style.height=Ur+"px",(s||v.body).appendChild(h);var p={table:t,zoomScale:f,rect:d,isRTL:r,editor:e,div:h,onFinishDragging:n,onStart:a,onEnd:i,disableMovement:u};q1(p,h);var m=new j1(h,p,function(){},u?{onDragEnd:rs}:{onDragStart:Y1,onDragging:Z1,onDragEnd:rs},p.zoomScale,l,e.getEnvironment().isMobileOrTablet);return{node:t,div:h,featureHandler:m}}var j1=(function(t){Ai(e,t);function e(r,n,a,i,o,s,l){var u=t.call(this,r,n,a,i,o,l)||this;return u.disposer=s?.("TableMover",r),u}return e.prototype.dispose=function(){var r;(r=this.disposer)===null||r===void 0||r.call(this),this.disposer=void 0,t.prototype.dispose.call(this)},e})(go);function q1(t,e){var r=t.rect;r&&(e.style.top=r.top-Ur+"px",e.style.left=r.left-Ur-2+"px")}function X1(t,e,r){var n=t.getVisibleViewport();if(F(r,"ELEMENT_NODE")&&n&&e){var a=Le(r.getBoundingClientRect());return!!a&&a.top<=e.top&&n.top<=e.top}return!0}function jd(t,e,r){var n;t?.setEditorStyle(W1,e?(n="cursor: "+r)!==null&&n!==void 0?n:"move":null)}function Y1(t){var e;t.onStart();var r=t.editor,n=t.table,a=t.div;jd(r,!0,"move");var i=n.getBoundingClientRect(),o={tag:"div",style:"position: fixed; user-select: none; border: 1px solid #808080"},s=Vr(o,document);s.style.width=i.width+"px",s.style.height=i.height+"px",s.style.top=i.top+"px",s.style.left=i.left+"px",(e=a.parentNode)===null||e===void 0||e.appendChild(s);var l=r.getDOMSelection(),u=mo(r,n);return{cmTable:u,initialSelection:l,tableRect:s}}function Z1(t,e,r){var n=r.tableRect,a=t.editor;n.style.top=e.clientY+Ur+"px",n.style.left=e.clientX+Ur+"px";var i=Vd(a,e.clientX,e.clientY);if(i){var o=a.getDocument().createRange();return o.setStart(i.node,i.offset),o.collapse(!0),a.setDOMSelection({type:"range",range:o,isReverted:!1}),!0}return!1}function rs(t,e,r){var n,a,i=t.editor,o=t.table,s=t.onFinishDragging,l=t.disableMovement,u=e.target;if(r?.tableRect.remove(),jd(i,!1),u==t.div)return s(o),t.onEnd(!1),!0;if(o.contains(u)||!i.getDOMHelper().isNodeInEditor(u)||l)return i.setDOMSelection((n=r?.initialSelection)!==null&&n!==void 0?n:null),t.onEnd(!0),!1;var d=!1,f=Vd(i,e.clientX,e.clientY);return f?D1(i,f,function(v,c,h){var p,m=L(vn(v),2),b=m[0],y=m[1];if(b){var E=y[0].blocks.indexOf(b);D(y[0]).blocks.splice(E,1)}if(h&&r?.cmTable){var S=Gr();if(S.blocks.push(b??D(r.cmTable)),d=!!so(v,pn(S),c,{mergeFormat:"none",insertPosition:h}),d){var T=(p=vn(v)[0])!==null&&p!==void 0?p:r.cmTable;if(T){var k=T.rows[0].cells[0],R=k?.blocks[0];if(R?.blockType=="Paragraph"){var M=Ge(v.format);D(R).segments.unshift(M),et(R),Ot(v,M)}}}return d}},{selectionOverride:{type:"table",firstColumn:0,firstRow:0,lastColumn:0,lastRow:0,table:o},apiName:"TableMover"}):i.setDOMSelection((a=r?.initialSelection)!==null&&a!==void 0?a:null),t.onEnd(!0),d}var Pi=12,J1="_Table_Resizer";function Q1(t,e,r,n,a,i,o,s){var l=Le(t.getBoundingClientRect());if(!Xd(e,l,i))return null;var u=t.ownerDocument,d=e.getDOMHelper().calculateZoomScale(),f={tag:"div",style:"position: fixed; cursor: "+(r?"ne":"nw")+"-resize; user-select: none; border: 1px solid #808080"},v=Vr(f,u);v.id=J1,v.style.width=Pi+"px",v.style.height=Pi+"px",(o||u.body).appendChild(v);var c={isRTL:r,table:t,zoomScale:d,onStart:n,onEnd:a,div:v,editor:e,contentDiv:i};qd(c,v);var h=new $1(v,c,nE,{onDragStart:eE,onDragging:tE,onDragEnd:rE},d,e.getEnvironment().isMobileOrTablet,s);return{node:t,div:v,featureHandler:h}}var $1=(function(t){Ai(e,t);function e(r,n,a,i,o,s,l){var u=t.call(this,r,n,a,i,o,s)||this;return u.disposer=l?.("TableResizer",r),u}return e.prototype.dispose=function(){var r;(r=this.disposer)===null||r===void 0||r.call(this),this.disposer=void 0,t.prototype.dispose.call(this)},e})(go);function eE(t,e){t.onStart();var r=t.editor,n=t.table,a=mo(r,n),i=[];a?.rows.forEach(function(s){i.push(s.height)});var o=[];return a?.widths.forEach(function(s){o.push(s)}),{originalRect:n.getBoundingClientRect(),cmTable:a,originalHeights:i??[],originalWidths:o??[]}}function tE(t,e,r,n,a){var i,o,s=t.isRTL,l=t.zoomScale,u=t.table,d=r.originalRect,f=r.originalHeights,v=r.originalWidths,c=r.cmTable,h=1+n/d.width*l*(s?-1:1),p=1+a/d.height*l,m=Math.abs(h-1)>.001,b=Math.abs(p-1)>.001;if(u.style.setProperty("width",null),u.style.setProperty("height",null),c&&c.rows&&(m||b)){for(var y=D(c),E=0;E<c.rows.length;E++)for(var S=0;S<c.rows[E].cells.length;S++){var T=c.rows[E].cells[S];T&&(m&&E==0&&(y.widths[S]=((i=v[S])!==null&&i!==void 0?i:0)*h),b&&S==0&&(y.rows[E].height=((o=f[E])!==null&&o!==void 0?o:0)*p))}for(var k=0;k<u.rows.length;k++){var R=u.rows[k];if(R.cells.length!=0)for(var M=Math.max(c.rows[k].height,gn),w=0;w<R.cells.length;w++){var A=R.cells[w],N=Math.max(c.widths[w],gn);A.style.width=N+"px",A.style.height=M+"px",A.style.boxSizing="border-box"}}return!0}else return!1}function rE(t,e,r){return t.editor.isDisposed()||(Xd(t.editor,Le(t.table.getBoundingClientRect()),t.contentDiv)&&(t.div.style.visibility="visible",qd(t,t.div)),t.onEnd()),!1}function qd(t,e){var r=t.table,n=t.isRTL,a=Le(r.getBoundingClientRect());a&&(e.style.top=a.bottom+"px",e.style.left=n?a.left-Pi-2+"px":a.right+"px")}function nE(t,e){e.style.visibility="hidden"}function Xd(t,e,r){var n=t.getVisibleViewport();if(F(r,"ELEMENT_NODE")&&n&&e){var a=Le(r.getBoundingClientRect());return!!a&&a.bottom>=e.bottom&&n.bottom>=e.bottom}return!0}function wr(t){var e,r,n;t&&((e=t.featureHandler)===null||e===void 0||e.dispose(),t.featureHandler=null,(n=(r=t.div)===null||r===void 0?void 0:r.parentNode)===null||n===void 0||n.removeChild(t.div),t.div=null)}var en=6,ns;(function(t){t[t.top=0]="top",t[t.side=1]="side"})(ns||(ns={}));var aE=(function(){function t(e,r,n,a,i,o,s,l){var u=this,d;this.editor=e,this.table=r,this.logicalRoot=n,this.onChanged=a,this.anchorContainer=i,this.contentDiv=o,this.onTableEditorCreated=s,this.disableFeatures=l,this.horizontalInserter=null,this.verticalInserter=null,this.horizontalResizer=null,this.verticalResizer=null,this.tableResizer=null,this.tableMover=null,this.range=null,this.onEditorCreated=function(f,v){var c,h=(c=u.onTableEditorCreated)===null||c===void 0?void 0:c.call(u,f,v),p=v&&u.getOnMouseOut(v);return p&&v.addEventListener("mouseout",p),function(){h?.(),p&&v.removeEventListener("mouseout",p)}},this.onFinishEditing=function(){return u.editor.focus(),u.range&&(u.editor.setDOMSelection({type:"range",range:u.range,isReverted:!1}),u.range=null),u.editor.takeSnapshot(),u.onChanged(),u.isCurrentlyEditing=!1,!1},this.onStartTableResize=function(){u.isCurrentlyEditing=!0,u.onStartResize()},this.onStartCellResize=function(){u.isCurrentlyEditing=!0,u.disposeTableResizer(),u.onStartResize()},this.onStartTableMove=function(){u.onBeforeEditTable(),u.isCurrentlyEditing=!0,u.disposeTableResizer(),u.disposeTableInserter(),u.disposeCellResizers()},this.onEndTableMove=function(f){return f&&u.disposeTableMover(),u.onFinishEditing()},this.onBeforeEditTable=function(){u.editor.setLogicalRoot(u.logicalRoot)},this.onAfterInsert=function(){u.disposeTableResizer(),u.onFinishEditing()},this.onSelect=function(f){var v,c;if(u.editor.focus(),f){var h=cn(f),p={table:f,firstRow:0,firstColumn:0,lastRow:h.length-1,lastColumn:((c=(v=h[0])===null||v===void 0?void 0:v.length)!==null&&c!==void 0?c:0)-1,type:"table"};u.editor.setDOMSelection(p)}},this.getOnMouseOut=function(f){return function(v){f&&v.relatedTarget!=f&&F(u.contentDiv,"ELEMENT_NODE")&&F(v.relatedTarget,"ELEMENT_NODE")&&u.contentDiv!=v.relatedTarget&&!u.isEditing()&&u.dispose()}},this.isRTL=((d=e.getDocument().defaultView)===null||d===void 0?void 0:d.getComputedStyle(r).direction)=="rtl",this.setEditorFeatures(),this.isCurrentlyEditing=!1}return t.prototype.dispose=function(){this.disposeTableResizer(),this.disposeCellResizers(),this.disposeTableInserter(),this.disposeTableMover()},t.prototype.isEditing=function(){return this.isCurrentlyEditing},t.prototype.isOwnedElement=function(e){return[this.tableResizer,this.tableMover,this.horizontalInserter,this.verticalInserter,this.horizontalResizer,this.verticalResizer].filter(function(r){return!!r?.div}).some(function(r){return r?.div==e})},t.prototype.onMouseMove=function(e,r){var n,a=Le(this.table.getBoundingClientRect());if(a){for(var i=r<=a.top+en?0:this.isRTL?e>=a.right-en?1:void 0:e<=a.left+en?1:void 0,o=i?1:0,s=0;s<this.table.rows.length;s++){for(var l=this.table.rows[s],u=0;u<l.cells.length;u++){var d=l.cells[u],f=Le(d.getBoundingClientRect());if(!(!f||!a)){var v=r<=f.bottom,c=this.isRTL?e<=f.right+en*o:e<=f.right,h=this.isRTL?e>=f.left:e>=f.left-en*o;if(v&&c&&h){if(s===0&&i==0){var p=(f.left+f.right)/2,m=this.isRTL?e<p:e>p;!this.isFeatureDisabled("VerticalTableInserter")&&this.setInserterTd(m?d:l.cells[u-1],!1)}else if(u===0&&i==1){var b=(n=this.table.rows[s-1])===null||n===void 0?void 0:n.cells[0],y=b?Le(b.getBoundingClientRect()):null,E=y?this.isRTL?y.right===f.right:y.left===f.left:null;!this.isFeatureDisabled("HorizontalTableInserter")&&this.setInserterTd(r<(f.top+f.bottom)/2&&E?b:d,!0)}else this.setInserterTd(null);!this.isFeatureDisabled("CellResizer")&&this.setResizingTd(d);break}}}if(u<l.cells.length)break}this.setEditorFeatures()}},t.prototype.setEditorFeatures=function(){var e=this.isFeatureDisabled("TableSelector"),r=this.isFeatureDisabled("TableMover");!this.tableMover&&!(e&&r)&&(this.tableMover=V1(this.table,this.editor,this.isRTL,e?function(){}:this.onSelect,this.onStartTableMove,this.onEndTableMove,this.contentDiv,this.anchorContainer,this.onEditorCreated,r)),!this.tableResizer&&!this.isFeatureDisabled("TableResizer")&&(this.tableResizer=Q1(this.table,this.editor,this.isRTL,this.onStartTableResize,this.onFinishEditing,this.contentDiv,this.anchorContainer,this.onTableEditorCreated))},t.prototype.setResizingTd=function(e){this.horizontalResizer&&this.horizontalResizer.node!=e&&this.disposeCellResizers(),!this.horizontalResizer&&e&&(this.horizontalResizer=Gl(this.editor,e,this.table,this.isRTL,!0,this.onStartCellResize,this.onFinishEditing,this.anchorContainer,this.onTableEditorCreated),this.verticalResizer=Gl(this.editor,e,this.table,this.isRTL,!1,this.onStartCellResize,this.onFinishEditing,this.anchorContainer,this.onTableEditorCreated))},t.prototype.setInserterTd=function(e,r){var n=r?this.horizontalInserter:this.verticalInserter;if((e===null||n&&n.node!=e)&&this.disposeTableInserter(),!this.horizontalInserter&&!this.verticalInserter&&e){var a=z1(this.editor,e,this.table,this.isRTL,!!r,this.onBeforeEditTable,this.onAfterInsert,this.anchorContainer,this.onEditorCreated);r?this.horizontalInserter=a:this.verticalInserter=a}},t.prototype.disposeTableResizer=function(){this.tableResizer&&(wr(this.tableResizer),this.tableResizer=null)},t.prototype.disposeTableInserter=function(){this.horizontalInserter&&(wr(this.horizontalInserter),this.horizontalInserter=null),this.verticalInserter&&(wr(this.verticalInserter),this.verticalInserter=null)},t.prototype.disposeCellResizers=function(){this.horizontalResizer&&(wr(this.horizontalResizer),this.horizontalResizer=null),this.verticalResizer&&(wr(this.verticalResizer),this.verticalResizer=null)},t.prototype.disposeTableMover=function(){this.tableMover&&(wr(this.tableMover),this.tableMover=null)},t.prototype.onStartResize=function(){this.onBeforeEditTable(),this.isCurrentlyEditing=!0;var e=this.editor.getDOMSelection();e&&e.type=="range"&&(this.range=e.range),this.editor.takeSnapshot()},t.prototype.isFeatureDisabled=function(e){var r;return(r=this.disableFeatures)===null||r===void 0?void 0:r.includes(e)},t})(),Kn=12,iE=(function(){function t(e,r,n,a){var i=this;a===void 0&&(a=oE),this.anchorContainerSelector=e,this.onTableEditorCreated=r,this.disableFeatures=n,this.tableSelector=a,this.editor=null,this.onMouseMoveDisposer=null,this.tableRectMap=null,this.tableEditor=null,this.onMouseOut=function(o){var s=o.relatedTarget,l=o.currentTarget,u=s,d=l;F(u,"ELEMENT_NODE")&&F(d,"ELEMENT_NODE")&&i.tableEditor&&!i.tableEditor.isOwnedElement(u)&&!d.contains(u)&&i.setTableEditor(null)},this.onMouseMove=function(o){var s,l=o;if(!(l.buttons>0||!i.editor)){i.ensureTableRects();var u=i.editor.getDocument().defaultView||window,d=l.pageX-u.scrollX,f=l.pageY-u.scrollY,v=null;if(i.tableRectMap)for(var c=i.tableRectMap.length-1;c>=0;c--){var h=i.tableRectMap[c],p=h.rect;if(d>=p.left-Kn&&d<=p.right+Kn&&f>=p.top-Kn&&f<=p.bottom+Kn){v=h;break}}i.setTableEditor(v,l),(s=i.tableEditor)===null||s===void 0||s.onMouseMove(d,f)}},this.invalidateTableRects=function(){i.tableRectMap=null}}return t.prototype.getName=function(){return"TableEdit"},t.prototype.initialize=function(e){this.editor=e,this.onMouseMoveDisposer=this.editor.attachDomEvent({mousemove:{beforeDispatch:this.onMouseMove}});var r=this.editor.getScrollContainer();r.addEventListener("mouseout",this.onMouseOut)},t.prototype.dispose=function(){var e,r,n=(e=this.editor)===null||e===void 0?void 0:e.getScrollContainer();n?.removeEventListener("mouseout",this.onMouseOut),(r=this.onMouseMoveDisposer)===null||r===void 0||r.call(this),this.invalidateTableRects(),this.disposeTableEditor(),this.editor=null,this.onMouseMoveDisposer=null,this.onTableEditorCreated=void 0},t.prototype.onPluginEvent=function(e){switch(e.eventType){case"input":case"contentChanged":case"scroll":case"zoomChanged":this.setTableEditor(null),this.invalidateTableRects();break}},t.prototype.setTableEditor=function(e,r){if(this.tableEditor&&!this.tableEditor.isEditing()&&e?.table!=this.tableEditor.table&&this.disposeTableEditor(),!this.tableEditor&&e&&this.editor&&e.table.rows.length>0){var n=this.anchorContainerSelector?this.editor.getDocument().querySelector(this.anchorContainerSelector):void 0;this.tableEditor=new aE(this.editor,e.table,e.logicalRoot,this.invalidateTableRects,F(n,"ELEMENT_NODE")?n:void 0,r?.currentTarget,this.onTableEditorCreated,this.disableFeatures)}},t.prototype.disposeTableEditor=function(){var e;(e=this.tableEditor)===null||e===void 0||e.dispose(),this.tableEditor=null},t.prototype.ensureTableRects=function(){var e=this;if(!this.tableRectMap&&this.editor){this.tableRectMap=[];var r=this.tableSelector(this.editor.getDOMHelper());r.forEach(function(n){var a=Le(n.table.getBoundingClientRect());a&&e.tableRectMap&&e.tableRectMap.push(C(C({},n),{rect:a}))})}},t})();function oE(t){return t.queryElements("table").filter(function(e){return e.isContentEditable}).map(function(e){return{table:e,logicalRoot:null}})}function we(t,e,r){var n;t.additionalFormatParsers||(t.additionalFormatParsers={}),t.additionalFormatParsers[e]||(t.additionalFormatParsers[e]=[]),(n=t.additionalFormatParsers[e])===null||n===void 0||n.push(r)}function as(t,e,r){var n=typeof r=="function"?r:function(i){return r?i:null};if(!t[e])t[e]=n;else{var a=t[e];t[e]=function(i,o){var s=typeof a=="function"?a(i,o):a?i:!1;return s?n(s,o):null}}}var lE={width:Wn,height:Wn,"inline-size":Wn,"block-size":Wn};function Wn(t,e){var r=e.toLowerCase();return r=="div"||r=="p"?null:t}var is=function(t){_n.forEach(function(e){var r=t[e],n="";if(r&&yu.some(function(i){return r.indexOf(i)>-1&&(n=i)})){var a=r.replace(n,"").trimRight();t[e]=a}})},Yd=["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle"],sE="BulletListStyle",uE="NumberListStyle",dE="WACImageBorder",fE="WACImageContainer",os="OutlineElement",cE="ListContainerWrapper",Zd="CommentHighlightRest",Jd="CommentHighlightClicked",vE=I(I([],L(Yd),!1),["ListMarkerWrappingSpan"],!1),Qd="span."+fE+",span."+dE+",."+Zd+",."+Jd+","+Yd.map(function(t){return'table div[class^="'+t+'"]'}).join(","),hE='ul[class^="'+sE+'"]>.'+os+',ol[class^="'+uE+'"]>.'+os+","+Qd,pE=function(t){var e=t.fragment;return!!e.querySelector(hE)},er={GOOGLE_SHEET_NODE_NAME:"google-sheets-html-origin",PROG_ID_NAME:"ProgId",EXCEL_DESKTOP_ATTRIBUTE_NAME:"xmlns:x"},gE="urn:schemas-microsoft-com:office:excel",mE=function(t){var e=t.htmlAttributes;return e[er.EXCEL_DESKTOP_ATTRIBUTE_NAME]==gE},bE="web data/shadow-workbook",yE=function(t){var e,r=t.clipboardData;return r.types.includes(bE)&&((e=r.htmlFirstLevelChildTags)===null||e===void 0?void 0:e.length)==1&&r.htmlFirstLevelChildTags[0]=="TABLE"},EE="Excel.Sheet",CE=function(t){var e=t.htmlAttributes;return e[er.PROG_ID_NAME]==EE&&e[er.EXCEL_DESKTOP_ATTRIBUTE_NAME]==null},SE=function(t){var e=t.fragment;return!!e.querySelector(er.GOOGLE_SHEET_NODE_NAME)},TE="OneNote.File",wE=function(t){var e=t.htmlAttributes;return e[er.PROG_ID_NAME]==TE},kE="PowerPoint.Slide",_E=function(t){return t.htmlAttributes[er.PROG_ID_NAME]==kE},ls="xmlns:w",ss="urn:schemas-microsoft-com:office:word",DE="Word.Document",ME=function(t){var e,r=t.htmlAttributes,n=t.clipboardData,a=t.environment;return r[ls]==ss||r[er.PROG_ID_NAME]==DE||!!(a.isSafari&&n.rawHtml&&((e=n.rawHtml)===null||e===void 0?void 0:e.replace(/ /g,"").indexOf(ls+'="'+ss))>-1)},OE=function(t){var e,r=t.shouldConvertSingleImage,n=t.clipboardData;return r&&((e=n.htmlFirstLevelChildTags)===null||e===void 0?void 0:e.length)==1&&n.htmlFirstLevelChildTags[0]=="IMG"},LE=new Map([["wordDesktop",ME],["excelDesktop",mE],["excelOnline",CE],["powerPointDesktop",_E],["wacComponents",pE],["googleSheets",SE],["singleImage",OE],["excelNonNativeEvent",yE],["oneNoteDesktop",wE]]);function RE(t,e,r){var n=t.htmlAttributes,a=t.clipboardData,i=t.fragment,o=null,s={htmlAttributes:n,fragment:i,shouldConvertSingleImage:e,clipboardData:a,environment:r};return LE.forEach(function(l,u){!o&&l(s)&&(o=u)}),o??"default"}var FE=["http:","https:","notes:","mailto:","onenote:"],PE=/^file:\/\/\/[a-zA-Z\/]/i,AE=function(t,e){if(re(e,"a")){var r;try{r=new URL(e.href)}catch{r=void 0}(r&&FE.indexOf(r.protocol)===-1||PE.test(e.href))&&(e.removeAttribute("href"),t.href="")}},NE=function(t,e,r){var n={};U(e,r.formatParsers.segment,n,r),$d(t,e,r,n)};function $d(t,e,r,n){if(e.nodeType===Node.TEXT_NODE){var a=We(e.nodeValue||"",n);ht(t,a)}else if(F(e,"ELEMENT_NODE")){var i=C({},n);U(e,r.formatParsers.segment,i,r);for(var o=0;o<e.childNodes.length;o++)$d(t,e.childNodes[o],r,i)}}function Kt(t,e,r){t.processorOverride||(t.processorOverride={}),t.processorOverride[e]=r}var IE=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,BE=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,xE=/<tr[^>]*>[^<]*/i,HE=/<table[^>]*>[^<]*/i,us="table",Vn="solid 1px #d4d4d4";function zE(t,e,r,n){var a=t.fragment,i=t.htmlBefore,o=t.htmlAfter,s=t.clipboardData;n&&UE(a,e,i,s,o);var l=a.firstChild;if(F(l,"ELEMENT_NODE")&&l.tagName=="div"&&l.firstChild){var u=Array.from(l.childNodes).every(function(d){var f=F(d,"ELEMENT_NODE")&&d.tagName;return f=="META"?!0:f=="TABLE"?d==l.lastChild:!1});u&&l.lastChild&&t.fragment.replaceChildren(l.lastChild)}KE(t,r,n)}function UE(t,e,r,n,a){var i=!t.querySelector(us)&&e.htmlToDOM(r+n.html+a);if(i&&i.querySelector(us))Ft(t,i?.body);else{var o=n.html?GE(n.html,r):void 0;if(o&&n.html!=o){var s=e.htmlToDOM(o);Ft(t,s?.body)}}}function GE(t,e){try{if(t.match(IE)){var r=e.match(xE),n=r?r[0]:"<TR>";t=n+t+"</TR>"}if(t.match(BE)){var a=e.match(HE),i=a?a[0]:"<TABLE>";t=i+t+"</TABLE>"}}finally{return t}}function KE(t,e,r){we(t.domToModelOption,"tableCell",function(n,a){!e&&(a.style.borderStyle==="none"||!r&&a.style.borderStyle=="")&&(n.borderBottom=Vn,n.borderLeft=Vn,n.borderRight=Vn,n.borderTop=Vn)}),Kt(t.domToModelOption,"child",WE)}var WE=function(t,e,r){var n=C({},r.segmentFormat);t.blockGroupType==="TableCell"&&t.format.textColor&&!r.segmentFormat.textColor&&(r.segmentFormat.textColor=t.format.textColor),r.defaultElementProcessors.child(t,e,r),t.blockGroupType==="TableCell"&&t.format.textColor&&(r.segmentFormat=n,delete t.format.textColor)},VE={1:"decimal",a:"lower-alpha",A:"upper-alpha",i:"lower-roman",I:"upper-roman"},jE={disc:"disc",circle:"circle",square:"square"};function qE(t){Kt(t.domToModelOption,"ol",XE),Kt(t.domToModelOption,"ul",YE),Kt(t.domToModelOption,"li",ZE)}var XE=function(t,e,r){var n,a,i=To(r);if(i.oneNoteListContext){var o=e.getAttribute("type");if(o){var s=VE[o],l=parseInt(e.getAttribute("start")||"1")||1;i.oneNoteListContext.listStyleType=s,i.oneNoteListContext.startNumberOverride=l}}(a=(n=i.defaultElementProcessors).ol)===null||a===void 0||a.call(n,t,e,i)},YE=function(t,e,r){var n,a,i=To(r);if(i.oneNoteListContext){var o=e.getAttribute("type");if(o){var s=jE[o];i.oneNoteListContext.listStyleType=s}}(a=(n=i.defaultElementProcessors).ul)===null||a===void 0||a.call(n,t,e,i)},ZE=function(t,e,r){var n,a,i=To(r),o=!1;if(i.oneNoteListContext){var s=i.oneNoteListContext,l=s.listStyleType,u=s.startNumberOverride;if(l){var d=i.listFormat.levels[i.listFormat.levels.length-1];d.format.listStyleType=l,u&&(o=!0,d.format.startNumberOverride=u,delete i.oneNoteListContext.startNumberOverride),delete i.oneNoteListContext.listStyleType}}(a=(n=i.defaultElementProcessors).li)===null||a===void 0||a.call(n,t,e,i),o&&delete i.listFormat.levels[i.listFormat.levels.length-1].format.startNumberOverride};function To(t){var e=t;return e.oneNoteListContext||(e.oneNoteListContext={}),e}var wo=function(t){var e;!((e=t.textIndent)===null||e===void 0)&&e.startsWith("-")&&delete t.textIndent},JE=function(t){delete t.marginLeft};function ef(t,e,r,n,a,i,o){o===void 0&&(o=[]);var s=gr(t);if(U(e,r.formatParsers.listLevel,s.format,r),U(e,o.concat(JE),s.format,r),n>a.levels.length)for(;n!=a.levels.length;)a.levels.push(s);else a.levels.splice(n,a.levels.length-1),a.levels[n-1]=s;a.listParent=i}function tf(t,e,r,n,a,i){var o=t.listFormat,s=o.levels[o.levels.length-1];n&&s&&ma(s,function(d){return Object.assign({},d,n)});var l=kn(o.levels,t.segmentFormat);if(U(e,t.formatParsers.segmentOnBlock,t.segmentFormat,t),U(e,t.formatParsers.listItemElement,l.format,t),U(e,[wo,QE],l.format,t),a){var u=C({},t.segmentFormat);U(a,t.formatParsers.segmentOnBlock,u,t),l.formatHolder.format=u}i?.(l),t.elementProcessors.child(l,e,t),Ke(r,l)}var QE=function(t,e,r,n){re(e,"li")||Object.keys(n).forEach(function(a){var i=a,o=a;i!="display"&&t[o]!=null&&t[o]==n[i]&&delete t[o]})},$E="* > span > span[style*=mso-special-format]",eC="mso-special-format",rf="style",tC=/mso-special-format:\s*([^;]*)/,ti=function(t){delete t.textAlign,delete t.marginLeft,delete t.paddingLeft};function rC(t,e){var r=t.fragment,n=t.clipboardData,a=t.domToModelOption;if(n.html&&!n.text&&n.image){var i=e.htmlToDOM(n.html);Ft(r,i?.body)}we(a,"block",wo),Kt(a,"element",function(o,s,l){var u,d,f=s.getAttribute(rf)||"";if(!(f.includes(eC)&&l.listFormat.levels.length>0)){var v=s.querySelector($E);if(v){var c=nC(s,v),h=c.depth,p=c.unorderedBulletType,m=c.orderedBulletType,b=c.startNumberOverrideOrBullet,y=c.isOrderedList,E=c.isNewList;ef(y?"OL":"UL",s,l,h,l.listFormat,o,[ti]);var S={unorderedStyleType:!y&&p?Se[p]:void 0,orderedStyleType:y&&m?x[m]:void 0};tf(l,s,o,S,v,function(T){E&&(T.levels[T.levels.length-1].format.startNumberOverride=parseInt(b)),ti(T.levels[T.levels.length-1].format),ti(T.format)})}else(d=(u=l.defaultElementProcessors).element)===null||d===void 0||d.call(u,o,s,l)}})}function nC(t,e){var r=t.className.substring(1)||"0",n=parseInt(r)+1,a=e.getAttribute(rf)||"",i=a.match(tC),o=L(i?.[1].replace('"',"").split("\\,")||[],2),s=o[0],l=o[1],u=ds.has(s),d=aC.get(e.innerText),f=ds.get(s);return{depth:n,unorderedBulletType:d,orderedBulletType:f,startNumberOverrideOrBullet:l,isOrderedList:u,isNewList:u&&!!f&&e.innerText===iC(f,l)}}var aC=new Map([["•","Disc"],["o","Circle"],["§","Square"],["q","BoxShadow"],["v","Xrhombus"],["Ø","ShortArrow"],["ü","CheckMark"]]),ds=new Map([["numbullet1","UpperAlpha"],["numbullet2","DecimalParenthesis"],["numbullet3","Decimal"],["numbullet7","UpperRoman"],["numbullet9","LowerAlphaParenthesis"],["numbullet0","LowerAlpha"],["numbullet6","LowerRoman"]]);function iC(t,e){var r=to(x[t],parseInt(e));switch(t){case"Decimal":case"UpperAlpha":case"LowerAlpha":case"UpperRoman":case"LowerRoman":return r+".";case"DecimalParenthesis":case"LowerAlphaParenthesis":return r+")";default:return}}var ri=/[\n\t'{}"]+/g,on="<style",oC="</style>",lC=/\W/;function sC(t){for(var e,r=[],n=fs(t),a=n.styleIndex,i=n.styleEndIndex;a>=0&&i>=0;){var o=t.substring(a+on.length,i).trim();r.push(o),e=fs(t,i+1),a=e.styleIndex,i=e.styleEndIndex}return r}function fs(t,e){e===void 0&&(e=0);for(var r=t.toLowerCase(),n=r.indexOf(on,e),a=n+on.length,i=t.substring(a,a+1);!lC.test(i)&&n>-1;)n=r.indexOf(on,n+1),a=n+on.length,i=t.substring(a,a+1);var o=r.indexOf(oC,e);return{styleIndex:n,styleEndIndex:o}}function uC(t){var e=new Map,r=sC(t.htmlBefore||t.clipboardData.rawHtml||"");return r.forEach(function(n){for(var a=0,i=function(){var o=n.indexOf("@",a+1),s=n.indexOf("}",o),l=n.indexOf("{",o);a=o;var u=n.substring(o+1,l).replace(ri,"").replace("list","").trimRight().trimLeft(),d=n.substring(l,s+1).trimLeft().trimRight(),f={},v=d.split(";");v.forEach(function(h){var p=L(h.split(":"),2),m=p[0],b=p[1];if(m&&b){var y=m.replace(ri,"").trimRight().trimLeft(),E=b.replace(ri,"").trimRight().trimLeft();f[y]=E}});var c={"mso-level-number-format":f["mso-level-number-format"],"mso-level-start-at":f["mso-level-start-at"]||"1","mso-level-text":f["mso-level-text"]};ie(c).some(function(h){return!!c[h]})&&e.set(u,c)};a>=0;)i()}),e}function nf(t){var e={},r=t?.getAttribute("style")||"";return r.split(";").forEach(function(n){var a=n.indexOf(":"),i=n.slice(0,a),o=n.slice(a+1);i&&o&&(e[i.trim()]=o.trim())}),e}var dC=/#_msocom_/,fC="mso-special-character",cC="comment",vC="mso-element",hC="comment-list";function pC(t,e){return t[fC]==cC||re(e,"a")&&dC.test(e.href)||t[vC]==hC}var af="mso-list",of="ignore",gC="l0",mC=/%[0-9a-zA-Z]+/g,bC="bullet";function yC(t,e,r,n,a){var i,o=n.listFormat;o.wordKnownLevels||(o.wordKnownLevels=new Map);var s=t[af]||"";if(s.toLowerCase()===of)return!0;var l=L(s.split(" "),2),u=l[0],d=l[1];if(o.wordLevel=d&&parseInt(d.substr(5)),o.wordList=u||gC,o.levels.length==0&&(o.levels=o.wordList&&o.wordKnownLevels.get(o.wordList)||[]),s&&e&&typeof o.wordLevel=="number"){var f=o.wordLevel,v=o.wordList,c=a.get(u+":"+d),h=((i=c?.["mso-level-number-format"])===null||i===void 0?void 0:i.toLowerCase())!=bC?"OL":"UL";ef(h,r,n,f,o,e,[TC]),o.levels[o.levels.length-1].format.wordList=v;var p=EC(c,h),m=p?{unorderedStyleType:h=="UL"?p:void 0,orderedStyleType:h=="OL"?p:void 0}:void 0;return tf(n,r,e,m,wC(r),function(b){h=="OL"&&CC(b,n,c,r)}),o.levels.length>0&&o.wordKnownLevels.get(v)!=o.levels&&o.wordKnownLevels.set(v,I([],L(o.levels),!1)),!0}return!1}function EC(t,e){var r=t?.["mso-level-number-format"]||"decimal",n;if(t?.["mso-level-text"]){var a="";switch(r){case"alpha-upper":a="UpperAlpha";break;case"alpha-lower":a="LowerAlpha";break;case"roman-lower":a="LowerRoman";break;case"roman-upper":a="UpperRoman";break;default:a="Number";break}var i=(t["mso-level-text"]||"").replace("\\","").replace('"',"").replace(mC,"${"+a+"}");n='"'+i+' "'}else switch(r){case"alpha-lower":n="lower-alpha";break;case"roman-lower":n="lower-roman";break;case"roman-upper":n="upper-roman";break;default:n="decimal";break}return x0(e,n)}function CC(t,e,r,n){var a,i,o=e.listFormat,s=o.listParent,l=o.wordList,u=o.wordKnownLevels,d=o.wordLevel,f=o.levels,v=SC(s);if((v?.blockType!="BlockGroup"||v.blockGroupType!="ListItem"||d&&((i=(a=v.levels[d])===null||a===void 0?void 0:a.format)===null||i===void 0?void 0:i.wordList)!=l)&&l){var c=r?.["mso-level-start-at"]?parseInt(r["mso-level-start-at"]):NaN,h=u?.get(l)||[];c!=null&&!isNaN(c)&&h.length!=f.length?t.levels[t.levels.length-1].format.startNumberOverride=c:re(n,"li")&&F(n.parentElement,"ELEMENT_NODE")&&re(n.parentElement,"ol")&&n.parentElement.firstElementChild==n&&h.length!=n.parentElement.start&&(t.levels[t.levels.length-1].format.startNumberOverride=n.parentElement.start)}}function SC(t){for(var e=(t?.blocks.length||0)-1;e>0;e--){var r=t?.blocks[e];if(r&&!Xf(r))return r}}function TC(t,e){e.style.marginLeft&&parseInt(e.style.marginLeft)!=0&&(t.paddingLeft="0px"),e.style.marginRight&&parseInt(e.style.marginRight)!=0&&(t.paddingRight="0px")}function wC(t){var e=t.firstElementChild,r=!1;if(e)for(var n=0;n<e.childNodes.length;n++){var a=e.childNodes[n];if(F(a,"ELEMENT_NODE")){var i=nf(a),o=i[af]||"";if(o.toLowerCase()===of){r=!0;break}}}return e&&r?e:void 0}var kC=/%/,_C=1.2;function DC(t){var e=uC(t);Kt(t.domToModelOption,"element",MC(e)),we(t.domToModelOption,"block",OC),we(t.domToModelOption,"block",wo),we(t.domToModelOption,"listLevel",LC),we(t.domToModelOption,"container",cs),we(t.domToModelOption,"table",cs)}var MC=function(t){return function(e,r,n){var a=nf(r);yC(a,e,r,n,t)||pC(a,r)||n.defaultElementProcessors.element(e,r,n)}};function OC(t,e){var r;kC.test(e.style.lineHeight)&&!isNaN(r=parseInt(e.style.lineHeight))&&(t.lineHeight=(_C*(r/100)).toString())}var LC=function(t,e,r,n){e.style.marginLeft!=""&&(t.marginLeft=n.marginLeft),t.marginBottom=void 0},cs=function(t,e){var r;!((r=t.marginLeft)===null||r===void 0)&&r.startsWith("-")&&delete t.marginLeft,t.htmlAlign&&delete t.htmlAlign},lf=["UL","OL","LI"],RC=lf.join(","),FC=function(t,e){var r=e.style.verticalAlign;r==="super"&&(t.superOrSubScriptSequence="super"),r==="sub"&&(t.superOrSubScriptSequence="sub")},PC=function(t,e,r){var n=e.tagName;if(e.matches(Qd)&&(e.style.removeProperty("display"),e.style.removeProperty("margin")),e.classList.contains(cE)){r.elementProcessors.child(t,e,r);return}if(!vE.some(function(i){return e.classList.contains(i)})){if(IC(n,e,r)){var a=r.listFormat;a.levels=[],a.listParent=void 0}r.defaultElementProcessors.element(t,e,r)}},AC=function(t,e,r){var n,a,i,o,s,l=parseInt((n=e.getAttribute("data-aria-level"))!==null&&n!==void 0?n:""),u=r.listFormat,d=((a=u.levels[r.listFormat.levels.length-1])===null||a===void 0?void 0:a.listType)||((i=e.closest("ol,ul"))===null||i===void 0?void 0:i.tagName.toUpperCase()),f=gr(d,r.blockFormat);if(U(e,r.formatParsers.listLevelThread,f.format,r),U(e,r.formatParsers.listLevel,f.format,r),r.listFormat.levels=u.currentListLevels||r.listFormat.levels,l>0)if(l>r.listFormat.levels.length)for(;l!=r.listFormat.levels.length;)r.listFormat.levels.push(f);else r.listFormat.levels.splice(l,r.listFormat.levels.length-1),r.listFormat.levels[l-1]=f;(s=(o=r.defaultElementProcessors).li)===null||s===void 0||s.call(o,t,e,r);var v=u.listParent;if(v){var c=v.blocks[v.blocks.length-1];if(c.blockType=="BlockGroup"&&c.blockGroupType=="ListItem"){var h=c.levels[c.levels.length-1];HC(h,e,r)}}var p=[];u.levels.forEach(function(m){var b={dataset:C({},m.dataset),format:C({},m.format),listType:m.listType};p.push(b)}),u.currentListLevels=p,u.levels=[]},vs=function(t,e){e.style.display==="block"&&(t.displayForDummyItem=void 0),t.marginLeft=void 0,t.marginRight=void 0},NC=function(t){t.marginLeft=void 0,t.paddingLeft=void 0};function IC(t,e,r){return r.listFormat.levels.length>0&&lf.every(function(n){return n!=t})&&!e.closest(RC)}var BC=function(t,e){(e.className.includes(Zd)||e.className.includes(Jd))&&delete t.backgroundColor};function xC(t){we(t.domToModelOption,"segment",FC),we(t.domToModelOption,"listItemThread",vs),we(t.domToModelOption,"listItemElement",vs),we(t.domToModelOption,"listLevel",NC),we(t.domToModelOption,"container",hs),we(t.domToModelOption,"table",hs),we(t.domToModelOption,"segment",BC),Kt(t.domToModelOption,"element",PC),Kt(t.domToModelOption,"li",AC)}var hs=function(t,e){e.style.marginLeft.startsWith("-")&&delete t.marginLeft};function HC(t,e,r){if(!(!t||t.listType=="UL")){var n=e.closest("ol"),a=r.listFormat,i=L(zC(n,e),2),o=i[0],s=i[1];a.listItemThread||(a.listItemThread=[]);var l=a.listItemThread[s];l&&o-l!=1&&(t.format.startNumberOverride=o),a.listItemThread[s]=o}}function zC(t,e){var r=e&&Array.from(t?.querySelectorAll("li")||[]).indexOf(e),n=parseInt(t?.getAttribute("start")||"1")+(r&&r>0?r:0),a=parseInt(e?.getAttribute("data-aria-level")||"");return[n,a]}var UC=(function(){function t(e,r){r===void 0&&(r={styleSanitizers:lE,additionalAllowedTags:[],additionalDisallowedTags:[],attributeSanitizers:{}}),this.allowExcelNoBorderTable=e,this.domToModelForSanitizing=r,this.editor=null}return t.prototype.getName=function(){return"Paste"},t.prototype.initialize=function(e){this.editor=e},t.prototype.dispose=function(){this.editor=null},t.prototype.onPluginEvent=function(e){if(!(!this.editor||e.eventType!="beforePaste")&&e.domToModelOption){var r=RE(e,!1,this.editor.getEnvironment()),n=e.pasteType;switch(r){case"wordDesktop":DC(e);break;case"wacComponents":xC(e);break;case"excelOnline":case"excelDesktop":case"excelNonNativeEvent":(n==="normal"||n==="mergeFormat")&&zE(e,this.editor.getDOMCreator(),!!this.allowExcelNoBorderTable,r!="excelNonNativeEvent");break;case"googleSheets":e.domToModelOption.additionalAllowedTags.push(er.GOOGLE_SHEET_NODE_NAME);break;case"powerPointDesktop":rC(e,this.editor.getDOMCreator());break;case"oneNoteDesktop":qE(e);break}we(e.domToModelOption,"link",AE),we(e.domToModelOption,"tableCell",is),we(e.domToModelOption,"tableCell",KC),we(e.domToModelOption,"table",is),Kt(e.domToModelOption,"button",NE),n==="mergeFormat"&&(we(e.domToModelOption,"block",ps),we(e.domToModelOption,"listLevel",ps)),this.setEventSanitizers(e)}},t.prototype.setEventSanitizers=function(e){var r,n;if(this.domToModelForSanitizing){var a=this.domToModelForSanitizing,i=a.styleSanitizers,o=a.attributeSanitizers,s=a.additionalAllowedTags,l=a.additionalDisallowedTags;ie(i).forEach(function(u){return as(e.domToModelOption.styleSanitizers,u,i[u])}),ie(o).forEach(function(u){return as(e.domToModelOption.attributeSanitizers,u,o[u])}),(r=e.domToModelOption.additionalAllowedTags).push.apply(r,I([],L(s),!1)),(n=e.domToModelOption.additionalDisallowedTags).push.apply(n,I([],L(l),!1))}},t})(),ps=function(t,e){e.style.backgroundColor&&delete t.backgroundColor},GC=new Map([["borderTop",{w:"borderTopWidth",s:"borderTopStyle",c:"borderTopColor"}],["borderRight",{w:"borderRightWidth",s:"borderRightStyle",c:"borderRightColor"}],["borderBottom",{w:"borderBottomWidth",s:"borderBottomStyle",c:"borderBottomColor"}],["borderLeft",{w:"borderLeftWidth",s:"borderLeftStyle",c:"borderLeftColor"}]]);function KC(t,e){_n.forEach(function(r){if(!t[r]){var n=GC.get(r);n&&e.style[n.w]&&e.style[n.s]&&!e.style[n.c]&&(t[r]=e.style[n.w]+" "+e.style[n.s])}})}var WC=function(t){if(t.deleteResult=="notDeleted")for(var e=t.insertPoint,r=e.paragraph,n=e.marker,a=r.segments.indexOf(n),i=D(r),o=a-1;o>=0;o--){var s=i.segments[o];s.isSelected=!0,ga(r,s,t.formatContext)&&(t.deleteResult="range")}},sf=function(t){var e=t.deleteResult;if(e=="nothingToDelete"||e=="notDeleted"||e=="range"){var r=t.insertPoint,n=t.formatContext,a=r.path,i=r.paragraph,o=n?.rawEvent,s=ot(a,["FormatContainer"],["TableCell","ListItem"]),l=a[s];if(l&&l.blockGroupType==="FormatContainer"&&l.tagName=="blockquote"){var u=a[s+1],d=u.blocks.indexOf(l);VC(l)?(Hi(u,l),o?.preventDefault(),t.deleteResult="range"):o?.key==="Enter"&&l.blocks.indexOf(i)>=0&&uf(i)&&(jC(D(l),u,d,i),o?.preventDefault(),t.deleteResult="range")}}},VC=function(t){return t.blocks.length===1&&t.blocks[0].blockType==="Paragraph"&&uf(t.blocks[0])},uf=function(t){return t.segments.every(function(e){return e.segmentType==="SelectionMarker"||e.segmentType==="Br"})},jC=function(t,e,r,n){var a,i=t.blocks.indexOf(n);if(i>=0){var o=D(e);if(i<t.blocks.length-1){var s=Qi(t.tagName,t.format);(a=s.blocks).push.apply(a,I([],L(t.blocks.splice(i+1,t.blocks.length-i-1)),!1)),o.blocks.splice(r+1,0,s)}o.blocks.splice(r+1,0,n),t.blocks.splice(i,1),t.blocks.length==0&&o.blocks.splice(r,0)}},qC=function(t){if(t.deleteResult=="notDeleted"){var e=t.insertPoint,r=e.paragraph,n=e.marker,a=e.path;if(r.segments[0]==n){var i=ot(a,["ListItem"],["TableCell","FormatContainer"]),o=a[i],s=o?.levels[o.levels.length-1];s&&o?.blocks[0]==r&&(s.format.displayForDummyItem=="block"?o.levels.pop():s.format.displayForDummyItem="block",t.deleteResult="range")}}},XC=function(t){if(t.deleteResult==="nothingToDelete"){var e=t.insertPoint,r=e.paragraph,n=e.path,a=n[0],i=n[1];r.segments.every(function(o){return o.segmentType==="SelectionMarker"||o.segmentType==="Br"})&&r.segments.filter(function(o){return o.segmentType==="Br"}).length<=1&&(Object.keys(r.format).length>0?(r.format={},t.deleteResult="range"):a.blocks.length==1&&a.blocks[0]==r&&i&&(a.blockGroupType=="FormatContainer"||a.blockGroupType=="ListItem"||a.blockGroupType=="General")&&(Hi(i,a),n.shift(),t.deleteResult="range"))}};function YC(t,e,r){for(var n,a=I([],L(t),!1),i=function(){var s=a[0],l=s.blocks.indexOf(e);if(l<0)return"break";var u=s.blocks[l+(r?1:-1)];if(u){for(;u.blockType=="BlockGroup";){var d=u.blocks[r?0:u.blocks.length-1];if(d){if(d.blockType!="BlockGroup")return a.unshift(u),{value:{block:d,path:a}};a.unshift(u),u=d}else return{value:{block:u,path:a}}}return{value:{block:u,path:a}}}else if(pu(s)){a.shift();var f=-1,v=s,c=(n=a[0])===null||n===void 0?void 0:n.blocks.find(function(p){return p.blockType=="Paragraph"&&(f=p.segments.indexOf(v))>=0});if(c){var h=c.segments[f+(r?1:-1)];if(h)return{value:{block:c,path:a,siblingSegment:h}};e=c}else return"break"}else if(s.blockGroupType!="Document"&&s.blockGroupType!="TableCell")a.shift(),e=s;else return"break"};a.length>0;){var o=i();if(typeof o=="object")return o.value;if(o==="break")break}return null}function df(t,e,r){if(t&&t.length){var n=e.format,a=r.format;t.forEach(function(i){var o=n[i];o!==void 0&&(a[i]=o)})}}function ZC(t,e){return function(r){var n;if(r.deleteResult=="notDeleted"){var a=t=="forward",i=r.insertPoint,o=i.paragraph,s=i.marker,l=i.path,u=i.tableContext,d=o.segments;$C(o);var f=d.indexOf(s)+(a?1:-1),v=d[f],c,h;if(v)ga(o,v,r.formatContext,t)&&(r.deleteResult="singleChar",et(o));else if(QC(a,d,o,l)&&(h=JC(l)))jr(h,"outdent"),r.deleteResult="range";else if(c=YC(l,o,a)){var p=c.block,m=c.path,b=c.siblingSegment;if(p.blockType=="Paragraph"){var y=D(p);b?ga(y,b,r.formatContext,t)&&(r.deleteResult="range"):(a?r.lastParagraph=y:(((n=y.segments[y.segments.length-1])===null||n===void 0?void 0:n.segmentType)=="Br"&&D(y).segments.pop(),r.insertPoint={marker:s,paragraph:y,path:m,tableContext:u},r.lastParagraph=o),df(e.formatsToPreserveOnMerge,r.insertPoint.paragraph,r.lastParagraph),r.deleteResult="range"),r.lastTableContext=u}else Zu(D(m[0]).blocks,p,void 0,r.formatContext,t)&&(r.deleteResult="range")}else r.deleteResult="nothingToDelete"}}}function JC(t){var e=t[t.length-1];return e.blockGroupType=="Document"?e:null}function QC(t,e,r,n){return!t&&e.length==1&&e[0].segmentType=="SelectionMarker"&&r.format.marginLeft&&parseInt(r.format.marginLeft)&&ot(n,["Document","TableCell"],["ListItem"])>-1}function $C(t){var e,r,n=t.segments;if(((e=n[n.length-1])===null||e===void 0?void 0:e.segmentType)=="Br"){var a=n.filter(function(i){return i.segmentType!="SelectionMarker"});((r=a[a.length-2])===null||r===void 0?void 0:r.segmentType)!="Br"&&D(t).segments.pop()}}function e2(t,e,r,n,a){switch(a.skipUndoSnapshot=!0,a.clearModelCache=!1,n){case"notDeleted":return a.clearModelCache=!0,!1;case"nothingToDelete":return r.preventDefault(),!1;case"range":case"singleChar":return r.preventDefault(),Et(e),ff(e),n=="range"&&(a.skipUndoSnapshot=!1),t.triggerEvent("beforeKeyboardEditing",{rawEvent:r}),!0}}function t2(t,e){return e&&t.altKey&&!t.metaKey||!e&&t.ctrlKey&&!t.altKey}function r2(t){return t.metaKey&&!t.altKey}function ff(t){for(var e=!1,r=t.blocks.length-1;r>=0;r--){var n=t.blocks[r];n.blockType=="BlockGroup"&&(ff(n),n.blocks.length==0&&(D(t).blocks.splice(r,1),e=!0))}e&&t.blocks.forEach(et)}var gs;(function(t){t[t.Start=0]="Start",t[t.Punctuation=1]="Punctuation",t[t.Text=2]="Text",t[t.NonText=3]="NonText",t[t.Space=4]="Space",t[t.End=5]="End"})(gs||(gs={}));function cf(t){return function(e){if(e.deleteResult=="notDeleted")for(var r=e.insertPoint,n=r.marker,a=r.paragraph,i=a.segments.indexOf(n),o=t=="forward",s=n2(D(a),i,o,e),l=s.next(),u=0;u!=5&&!l.done;){var d=l.value,f=d.punctuation,v=d.space,c=d.text;switch(u){case 0:u=v?4:f?1:2,l=s.next(!0);break;case 1:o&&v?(u=3,l=s.next(!0)):f?l=s.next(!0):u=5;break;case 2:o&&v?(u=3,l=s.next(!0)):c?l=s.next(!0):u=5;break;case 3:f||!v?u=5:l=s.next(!0);break;case 4:v?l=s.next(!0):f?(u=o?3:1,l=s.next(!0)):u=o?5:2;break}}}}function n2(t,e,r,n){var a,i,o,s,l,u,d,f,v,c,h,p;return qf(this,function(m){switch(m.label){case 0:a=r?1:-1,i=t.segments,o=yn(t.format.whiteSpace),s=e+a,m.label=1;case 1:if(!(s>=0&&s<i.length))return[3,12];switch(l=i[s],u=l.segmentType,u){case"Text":return[3,2];case"Image":return[3,7];case"SelectionMarker":return[3,9]}return[3,10];case 2:d=r?0:l.text.length-1,m.label=3;case 3:return d>=0&&d<l.text.length?(f=l.text[d],v=fa(f),c=ca(f),h=!v&&!c,[4,{punctuation:v,space:c,text:h}]):[3,6];case 4:if(m.sent())if(p=l.text,p=p.substring(0,d)+p.substring(d+1),o||(p=Pu(p,r)),n.deleteResult="range",p)l.text=p,a>0&&(d-=a);else return i.splice(s,1),a>0&&(s-=a),[3,6];m.label=5;case 5:return d+=a,[3,3];case 6:return[3,11];case 7:return[4,{punctuation:!0,space:!1,text:!1}];case 8:return m.sent()&&(i.splice(s,1),a>0&&(s-=a),n.deleteResult="range"),[3,11];case 9:return[3,11];case 10:return[2,null];case 11:return s+=a,[3,1];case 12:return[2,null]}})}var a2=cf("forward"),i2=cf("backward");function jn(t,e,r){var n=!1,a=t.getDOMSelection(),i=r.handleExpandedSelectionOnDelete;return l2(a,e,!!i)&&t.formatContentModel(function(o,s){var l=Wr(o,o2(e,!!t.getEnvironment().isMac,r),s).deleteResult;return n=e2(t,o,e,l,s),n},{rawEvent:e,changeSource:Ve.Keyboard,getChangeData:function(){return e.which},scrollCaretIntoView:!0,apiName:e.key=="Delete"?"handleDeleteKey":"handleBackspaceKey"}),n}function o2(t,e,r){var n=t.key=="Delete",a=r2(t)&&!n?WC:null,i=t2(t,e)?n?a2:i2:null,o=ZC(n?"forward":"backward",r),s=n?null:sf;return[a,i,n?null:qC,o,s,XC]}function l2(t,e,r){var n,a;if(t){if(t.type!="range")return!0;if(t.range.collapsed){var i=t.range,s=i.startContainer,d=i.startOffset;return!(F(s,"TEXT_NODE")&&!Hr(e)&&(s2(e,s,d)||u2(e,s,d)))}else{if(r)return!0;var i=t.range,o=t.range,s=o.startContainer,l=o.endContainer,u=s===l&&F(s,"TEXT_NODE");return!(u&&!Hr(e)&&i.endOffset-i.startOffset<((a=(n=s.nodeValue)===null||n===void 0?void 0:n.length)!==null&&a!==void 0?a:0))}}else return!1}function s2(t,e,r){var n,a;if(t.key!="Backspace"||r<=1)return!1;var i=(a=(n=e.nodeValue)===null||n===void 0?void 0:n.length)!==null&&a!==void 0?a:0;if(r==i){var o=e.nextSibling,s=F(o,"ELEMENT_NODE")&&re(o,"a")&&vu(o)&&!o.firstChild;return!s}else return!0}function u2(t,e,r){var n,a;return t.key=="Delete"&&r<((a=(n=e.nodeValue)===null||n===void 0?void 0:n.length)!==null&&a!==void 0?a:0)-1}var d2=function(t){var e=t.deleteResult,r=t.insertPoint;if(e=="notDeleted"||e=="nothingToDelete"){var n=r.marker,a=r.paragraph,i=a.segments.indexOf(n),o=i>0?a.segments[i-1]:null;o?.segmentType=="Text"&&N1(o,a,{autoLink:!0})&&t.formatContext&&(t.formatContext.canUndoByBackspace=!0)}};function vf(t,e,r){var n;e===void 0&&(e=!0),r===void 0&&(r=[]);var a=t.paragraph,i=t.marker,o=je(!1,{},a.segmentFormat);Pr(o.format,a.format,Qf),df(r,a,o);var s=a.segments.indexOf(i),l=a.segments.splice(s,a.segments.length-s);(n=o.segments).push.apply(n,I([],L(l),!1));var u=a.segments.length==0,d=!a.isImplicit||!e;return u&&d?a.segments.push(qt(i.format)):u||et(a),t.paragraph=o,tu(a),o}var f2=function(t){var e=t.deleteResult,r=t.insertPoint;if(e=="notDeleted"||e=="nothingToDelete"){var n=r.path,a=ot(n,["ListItem"],["TableCell","FormatContainer"]),i=n[a],o=n[a+1];if(i?.blockGroupType==="ListItem"&&o){var s=D(i);c2(s)?s.levels.pop():(s=h2(t,s,o),t.formatContext&&(t.formatContext.announceData=Ud(I([s],L(n.slice(a+1)),!1))));var l=o.blocks.indexOf(s),u=o.blocks[l+1];if(u&&St(u,"ListItem")&&u.levels[0]&&(u.levels.forEach(function(f){f.format.startNumberOverride!==1&&(f.format.startNumberOverride=void 0)}),s.levels.length==0)){var d=g2(o.blocks,u.levels.length);u.levels[u.levels.length-1].format.startNumberOverride=d}t.deleteResult="range"}}},c2=function(t){return t.blocks.length===1&&v2(t.blocks[0])},v2=function(t){return t.blockType==="Paragraph"&&t.segments.length===2&&t.segments[0].segmentType==="SelectionMarker"&&t.segments[1].segmentType==="Br"},h2=function(t,e,r){var n,a=t.insertPoint,i=r.blocks.indexOf(e),o=a.paragraph,s=e.blocks.indexOf(o),l=vf(a),u=p2(e),d=kn(u,e.formatHolder.format);d.blocks.push(l),Pr(d.format,e.format,Ii);var f=e.blocks.length-s-1;return s>=0&&f>0&&(n=d.blocks).push.apply(n,I([],L(D(e).blocks.splice(s+1,f)),!1)),a.paragraph=l,D(r).blocks.splice(i+1,0,d),t.lastParagraph==o&&(t.lastParagraph=l),d},p2=function(t){return t.levels.map(function(e){return gr(e.listType,C(C({},e.format),{startNumberOverride:void 0,displayForDummyItem:void 0}),e.dataset)})},g2=function(t,e){for(var r=1,n=0;n<t.length;n++){var a=t[n];if(St(a,"ListItem")&&a.levels.length===e)r++;else if(St(a,"ListItem")&&a.levels.length==0)return r}return r},m2=function(t){return function(e){var r,n,a=e.insertPoint,i=a.paragraph,o=a.path,s=(n=(r=o[0])===null||r===void 0?void 0:r.blocks.indexOf(i))!==null&&n!==void 0?n:-1;if(e.deleteResult=="notDeleted"&&s>=0){var l=vf(e.insertPoint,!1,t);D(o[0]).blocks.splice(s+1,0,l),e.deleteResult="range",e.lastParagraph=l,e.insertPoint.paragraph=l}}};function b2(t,e,r,n){n===void 0&&(n=[]);var a=t.getDOMSelection();t.formatContentModel(function(i,o){var s,l,u=Wr(i,[],o);if(a&&a.type!="table"){u.deleteResult="notDeleted";var d=e.shiftKey?[]:[d2,f2,sf];(r||y2((s=u.insertPoint)===null||s===void 0?void 0:s.paragraph))&&d.push(m2(n)),Qu(d,u)}return u.deleteResult=="range"?(o.newPendingFormat=(l=u.insertPoint)===null||l===void 0?void 0:l.marker.format,Et(i),e.preventDefault(),!0):!1},{rawEvent:e,scrollCaretIntoView:!0,changeSource:Ve.Keyboard,getChangeData:function(){return e.which},apiName:"handleEnterKey"})}function y2(t){return t&&(t.isImplicit||t.segments.some(function(e){return e.segmentType=="Entity"}))}var E2="​",C2=function(t){if(t.deleteResult=="range"){var e=t.insertPoint,r=e.marker,n=e.paragraph,a=n.segments.indexOf(r);if(a>=0){var i=We(E2,r.format,r.link,r.code);i.isSelected=!0,n.segments.splice(a,0,i)}}};function S2(t,e){var r=t.getDOMSelection();if(T2(r,e))return t.takeSnapshot(),t.formatContentModel(function(n,a){var i,o=Wr(n,[C2],a);return a.skipUndoSnapshot=!0,o.deleteResult=="range"?(a.newPendingFormat=(i=o.insertPoint)===null||i===void 0?void 0:i.marker.format,Et(n),!0):!1},{scrollCaretIntoView:!0,rawEvent:e,changeSource:Ve.Keyboard,getChangeData:function(){return e.which},apiName:"handleInputKey"}),!0}function T2(t,e){return t&&!Hr(e)&&e.key&&(e.key=="Space"||e.key.length==1)?t.type!="range"||!t.range.collapsed:!1}var tn="    ",w2=" ";function hf(t,e,r,n){var a=e.segments.filter(function(k){return k.isSelected}),i=a.length===1&&a[0].segmentType==="SelectionMarker",o=e.segments.every(function(k){return k.isSelected||k.segmentType=="Text"&&k.text.trim().length==0});if(o){var s=e.format,l=s.marginLeft,u=s.marginRight,d=s.direction,f=d==="rtl";if(r.shiftKey&&(!f&&(!l||l=="0px")||f&&(!u||u=="0px")))return!1;jr(t,r.shiftKey?"outdent":"indent",void 0,n)}else if(i){var b=e.segments.findIndex(function(k){return k.segmentType==="SelectionMarker"});if(r.shiftKey){if(b<=0)return!1;var E=e.segments[b-1],S=tn.length;if(E.segmentType=="Text"){var T=E.text.length-S;if(E.text===tn)D(e).segments.splice(b-1,1);else if(E.text.substring(T)===tn)vt(e,E,function(R){R.text=R.text.substring(0,T)});else return!1}}else{var y=e.segments[b].format,E=We(tn,y);D(e).segments.splice(b,0,E)}}else{var v=void 0,c=void 0;if(e.segments.forEach(function(k,R){k.isSelected&&(v||(v=R),c=R)}),v&&c){var h=e.segments[v],p=We(r.shiftKey?tn:w2,h.format),m=Ge(h.format);D(e).segments.splice(v,c-v+1,p,m)}else return!1}return r.preventDefault(),!0}function k2(t,e,r,n){var a=D2(e);return!_2(e)&&a.length==1&&a[0].blockType==="Paragraph"?hf(t,a[0],r,n):(jr(t,r.shiftKey?"outdent":"indent",void 0,n),r.preventDefault(),!0)}function _2(t){return t.blocks[0].blockType=="Paragraph"&&t.blocks[0].segments[0].segmentType=="SelectionMarker"}function D2(t){return t.blocks.filter(function(e){return e.blockType=="Paragraph"&&e.segments.some(function(r){return r.isSelected})})}function M2(t,e){var r=vn(t)[0];return r&&O2(r)?(jr(t,e.shiftKey?"outdent":"indent"),e.preventDefault(),!0):!1}function O2(t){var e,r,n=t.rows[t.rows.length-1],a=n?.cells[n.cells.length-1];return((r=(e=t.rows[0])===null||e===void 0?void 0:e.cells[0])===null||r===void 0?void 0:r.isSelected)&&a?.isSelected}function L2(t,e,r){var n,a,i=vn(t)[0];if(i){var o=i.rows[i.rows.length-1],s=o?o.cells.length-1:-1,l=o?.cells[s];if(!r.shiftKey&&l&&l===e){var u=D(i);yo(u,"insertBelow"),bo(u,{firstRow:u.rows.length-1,firstColumn:0,lastRow:u.rows.length-1,lastColumn:s}),xa(u,t.format);var d=(a=(n=u.rows[u.rows.length-1])===null||n===void 0?void 0:n.cells[0])===null||a===void 0?void 0:a.blocks[0];if(d.blockType=="Paragraph"){var f=Ge(t.format);D(d).segments.unshift(f),et(d),Ot(u.rows[u.rows.length-1].cells[0],f)}return r.preventDefault(),!0}}return!1}function R2(t,e){var r=t.getDOMSelection();switch(r?.type){case"range":return t.formatContentModel(function(n,a){return F2(n,e,a)},{apiName:"handleTabKey",rawEvent:e,changeSource:Ve.Keyboard,getChangeData:function(){return e.which}}),!0;case"table":return t.formatContentModel(function(n){return M2(n,e)},{apiName:"handleTabKey",rawEvent:e,changeSource:Ve.Keyboard,getChangeData:function(){return e.which}}),!0}}function F2(t,e,r){var n=Ln(t,["ListItem","TableCell"],[]),a=n.length>0?n[0].block:void 0;return n.length>1?(jr(t,e.shiftKey?"outdent":"indent"),e.preventDefault(),!0):St(a,"TableCell")?L2(t,a,e):a?.blockType==="Paragraph"?hf(t,a,e,r):St(a,"ListItem")?k2(t,a,e,r):!1}var ms=8,bs=46,P2=229,ys={handleTabKey:!0,handleExpandedSelectionOnDelete:!0},A2=(function(){function t(e){e===void 0&&(e=ys),this.options=e,this.editor=null,this.disposer=null,this.shouldHandleNextInputEvent=!1,this.selectionAfterDelete=null,this.handleNormalEnter=function(){return!1},this.options=C(C({},ys),e)}return t.prototype.createNormalEnterChecker=function(e){return e?function(){return!0}:function(){return!1}},t.prototype.getHandleNormalEnter=function(e){switch(typeof this.options.shouldHandleEnterKey){case"function":return this.options.shouldHandleEnterKey;case"boolean":return this.createNormalEnterChecker(this.options.shouldHandleEnterKey);default:return this.createNormalEnterChecker(e.isExperimentalFeatureEnabled("HandleEnterKey"))}},t.prototype.getName=function(){return"Edit"},t.prototype.initialize=function(e){var r=this;this.editor=e,this.handleNormalEnter=this.getHandleNormalEnter(e),e.getEnvironment().isAndroid&&(this.disposer=this.editor.attachDomEvent({beforeinput:{beforeDispatch:function(n){return r.handleBeforeInputEvent(e,n)}}}))},t.prototype.dispose=function(){var e;this.editor=null,(e=this.disposer)===null||e===void 0||e.call(this),this.disposer=null},t.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case"keyDown":this.handleKeyDownEvent(this.editor,e);break;case"keyUp":this.selectionAfterDelete&&(this.editor.setDOMSelection(this.selectionAfterDelete),this.selectionAfterDelete=null);break}},t.prototype.willHandleEventExclusively=function(e){if(this.editor&&this.options.handleTabKey&&e.eventType=="keyDown"&&e.rawEvent.key=="Tab"&&!e.rawEvent.shiftKey){var r=this.editor.getDOMSelection(),n=r?.type=="range"?r.range.startContainer:null,a=n?this.editor.getDOMHelper().findClosestElementAncestor(n,"table"):null,i=a&&cn(a);if(i){var o=i[i.length-1],s=o&&o[o.length-1];if(typeof s=="object"&&s.contains(n))return!0}}return!1},t.prototype.handleKeyDownEvent=function(e,r){var n=r.rawEvent,a=n.ctrlKey||n.metaKey;if(!n.defaultPrevented&&!r.handledByEditFeature)switch(n.key){case"Backspace":this.shouldBrowserHandleBackspace(e)||jn(e,n,this.options);break;case"Delete":r.rawEvent.shiftKey||jn(e,n,this.options);break;case"Tab":this.options.handleTabKey&&!a&&R2(e,n);break;case"Unidentified":e.getEnvironment().isAndroid&&(this.shouldHandleNextInputEvent=!0);break;case"Enter":!a&&!r.rawEvent.isComposing&&r.rawEvent.keyCode!==P2&&b2(e,n,this.handleNormalEnter(e),this.options.formatsToPreserveOnMerge);break;default:S2(e,n);break}},t.prototype.handleBeforeInputEvent=function(e,r){if(!(!this.shouldHandleNextInputEvent||!(r instanceof InputEvent)||r.defaultPrevented)){this.shouldHandleNextInputEvent=!1;var n=!1;switch(r.inputType){case"deleteContentBackward":this.shouldBrowserHandleBackspace(e)||(n=jn(e,new KeyboardEvent("keydown",{key:"Backspace",keyCode:ms,which:ms}),this.options));break;case"deleteContentForward":n=jn(e,new KeyboardEvent("keydown",{key:"Delete",keyCode:bs,which:bs}),this.options);break}n&&(r.preventDefault(),this.selectionAfterDelete=e.getDOMSelection())}},t.prototype.shouldBrowserHandleBackspace=function(e){var r=this.options.shouldHandleBackspaceKey;switch(typeof r){case"function":return r(e);case"boolean":return r;default:return!1}},t})(),kr={width:"98%",display:"inline-block"};C({borderTop:"1px none",borderRight:"1px none",borderBottom:"1px solid",borderLeft:"1px none"},kr),C({borderTop:"3pt double",borderRight:"3pt none",borderBottom:"3pt none",borderLeft:"3pt none"},kr),C({borderTop:"1px solid",borderRight:"1px none",borderBottom:"1px solid",borderLeft:"1px none"},kr),C({borderTop:"1px none",borderRight:"1px none",borderBottom:"3px dotted",borderLeft:"1px none"},kr),C({borderTop:"1px none",borderRight:"1px none",borderBottom:"1px solid",borderLeft:"1px none"},kr),C({borderTop:"3pt double",borderRight:"3pt none",borderBottom:"3pt double",borderLeft:"3pt none"},kr);var sr,_r,Dr,Mr,Or,Lr,Es;(function(t){t[t.Decimal=1]="Decimal",t[t.LowerAlpha=2]="LowerAlpha",t[t.UpperAlpha=3]="UpperAlpha",t[t.LowerRoman=4]="LowerRoman",t[t.UpperRoman=5]="UpperRoman"})(Es||(Es={}));var Cs;(function(t){t[t.Dot=1]="Dot",t[t.Dash=2]="Dash",t[t.Parenthesis=3]="Parenthesis",t[t.DoubleParenthesis=4]="DoubleParenthesis"})(Cs||(Cs={}));sr={},sr[1]=function(t){return H2[t]||void 0},sr[2]=function(t){return x2[t]||void 0},sr[3]=function(t){return B2[t]||void 0},sr[4]=function(t){return I2[t]||void 0},sr[5]=function(t){return N2[t]||void 0};var N2=(_r={},_r[1]=x.UpperRoman,_r[2]=x.UpperRomanDash,_r[3]=x.UpperRomanParenthesis,_r[4]=x.UpperRomanDoubleParenthesis,_r),I2=(Dr={},Dr[1]=x.LowerRoman,Dr[2]=x.LowerRomanDash,Dr[3]=x.LowerRomanParenthesis,Dr[4]=x.LowerRomanDoubleParenthesis,Dr),B2=(Mr={},Mr[1]=x.UpperAlpha,Mr[2]=x.UpperAlphaDash,Mr[3]=x.UpperAlphaParenthesis,Mr[4]=x.UpperAlphaDoubleParenthesis,Mr),x2=(Or={},Or[1]=x.LowerAlpha,Or[2]=x.LowerAlphaDash,Or[3]=x.LowerAlphaParenthesis,Or[4]=x.LowerAlphaDoubleParenthesis,Or),H2=(Lr={},Lr[1]=x.Decimal,Lr[2]=x.DecimalDash,Lr[3]=x.DecimalParenthesis,Lr[4]=x.DecimalDoubleParenthesis,Lr);function pf(t,e){t.formatContentModel(function(r,n){var a=xp(r);return a&&a.blocks[0].blockType=="Paragraph"&&a.blocks[0].segments[0].segmentType=="SelectionMarker"?(jr(r,e,void 0,n),!0):!1})}var Ss;(function(t){t[t.BACKSPACE=8]="BACKSPACE",t[t.SPACE=32]="SPACE",t[t.B=66]="B",t[t.I=73]="I",t[t.U=85]="U",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.COMMA=188]="COMMA",t[t.PERIOD=190]="PERIOD",t[t.FORWARD_SLASH=191]="FORWARD_SLASH",t[t.ArrowRight=39]="ArrowRight",t[t.ArrowLeft=37]="ArrowLeft"})(Ss||(Ss={}));var z2={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:66},onClick:function(t){return Id(t,{announceFormatChange:!0})}},U2={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:73},onClick:function(t){return Bd(t,{announceFormatChange:!0})}},G2={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:85},onClick:function(t){return xd(t,{announceFormatChange:!0})}},K2={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:32},onClick:function(t){return Gd(t)}},W2={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:90},onClick:function(t){return ho(t)}},V2={shortcutKey:{modifierKey:"alt",shiftKey:!1,which:8},onClick:function(t){return ho(t)},environment:"nonMac"},j2={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:89},onClick:function(t){return po(t)},environment:"nonMac"},q2={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:90},onClick:function(t){return po(t)},environment:"mac"},X2={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:90},onClick:function(t){return po(t)}},Y2={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:190},onClick:function(t){return Fd(t)}},Z2={shortcutKey:{modifierKey:"ctrl",shiftKey:!1,which:191},onClick:function(t){return Pd(t)}},J2={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:190},onClick:function(t){return zd(t,"increase")}},Q2={shortcutKey:{modifierKey:"ctrl",shiftKey:!0,which:188},onClick:function(t){return zd(t,"decrease")}},$2={shortcutKey:{modifierKey:"alt",shiftKey:!0,which:39},onClick:function(t){pf(t,"indent")},environment:"nonMac"},eS={shortcutKey:{modifierKey:"alt",shiftKey:!0,which:37},onClick:function(t){pf(t,"outdent")},environment:"nonMac"},tS=[z2,U2,G2,K2,W2,V2,j2,X2,q2,Y2,Z2,J2,Q2,$2,eS],rS="__ShortcutCommandCache",nS=(function(){function t(e){e===void 0&&(e=tS),this.shortcuts=e,this.editor=null,this.isMac=!1}return t.prototype.getName=function(){return"Shortcut"},t.prototype.initialize=function(e){this.editor=e,this.isMac=!!this.editor.getEnvironment().isMac},t.prototype.dispose=function(){this.editor=null},t.prototype.willHandleEventExclusively=function(e){return e.eventType=="keyDown"&&(e.rawEvent.ctrlKey||e.rawEvent.altKey||e.rawEvent.metaKey)&&!!this.cacheGetCommand(e)},t.prototype.onPluginEvent=function(e){if(this.editor&&e.eventType=="keyDown"){var r=this.cacheGetCommand(e);r&&(r.onClick(this.editor),e.rawEvent.preventDefault())}},t.prototype.cacheGetCommand=function(e){var r=this;return Fp(e,rS,function(n){var a=r.editor,i=n.rawEvent,o=i.ctrlKey,s=i.metaKey;return o&&s?null:a&&r.shortcuts.filter(function(l){return r.matchOS(l.environment)&&r.matchShortcut(l.shortcutKey,n.rawEvent)})[0]})},t.prototype.matchOS=function(e){switch(e){case"mac":return this.isMac;case"nonMac":return!this.isMac;default:return!0}},t.prototype.matchShortcut=function(e,r){var n=r.ctrlKey,a=r.altKey,i=r.shiftKey,o=r.which,s=r.metaKey,l=this.isMac?s:n,u=e.modifierKey=="ctrl"&&l&&!a||e.modifierKey=="alt"&&a&&!l;return u&&i==e.shiftKey&&e.which==o},t})(),aS=["widthPx","heightPx"],iS=["angleRad"],oS=["leftPercent","rightPercent","topPercent","bottomPercent"],lS=I(I([],L(iS),!1),L(oS),!1);I(I([],L(lS),!1),L(aS),!1);var Ts;(function(t){t.ResizeHandle="r_resizeH",t.RotateHandle="r_rotateH",t.RotateCenter="r_rotateC",t.CropOverlay="r_cropO",t.CropContainer="r_cropC",t.CropHandle="r_cropH"})(Ts||(Ts={}));function sS(t,e,r){var n=I([new UC,new A2,new nS],L(e??[]),!1),a={plugins:n,initialModel:r,defaultSegmentFormat:{fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000"}};return new oy(t,a)}var ni={},qn={},ai={exports:{}},ii,ws;function uS(){return ws||(ws=1,ii={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),ii}var oi={exports:{}},li,ks;function dS(){return ks||(ks=1,li=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")}),li}var _s;function fS(){if(_s)return oi.exports;_s=1;var t=dS(),e=Array.prototype.concat,r=Array.prototype.slice,n=oi.exports=function(i){for(var o=[],s=0,l=i.length;s<l;s++){var u=i[s];t(u)?o=e.call(o,r.call(u)):o.push(u)}return o};return n.wrap=function(a){return function(){return a(n(arguments))}},oi.exports}var Ds;function cS(){if(Ds)return ai.exports;Ds=1;var t=uS(),e=fS(),r=Object.hasOwnProperty,n=Object.create(null);for(var a in t)r.call(t,a)&&(n[t[a]]=a);var i=ai.exports={to:{},get:{}};i.get=function(l){var u=l.substring(0,3).toLowerCase(),d,f;switch(u){case"hsl":d=i.get.hsl(l),f="hsl";break;case"hwb":d=i.get.hwb(l),f="hwb";break;default:d=i.get.rgb(l),f="rgb";break}return d?{model:f,value:d}:null},i.get.rgb=function(l){if(!l)return null;var u=/^#([a-f0-9]{3,4})$/i,d=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,f=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,v=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,c=/^(\w+)$/,h=[0,0,0,1],p,m,b;if(p=l.match(d)){for(b=p[2],p=p[1],m=0;m<3;m++){var y=m*2;h[m]=parseInt(p.slice(y,y+2),16)}b&&(h[3]=parseInt(b,16)/255)}else if(p=l.match(u)){for(p=p[1],b=p[3],m=0;m<3;m++)h[m]=parseInt(p[m]+p[m],16);b&&(h[3]=parseInt(b+b,16)/255)}else if(p=l.match(f)){for(m=0;m<3;m++)h[m]=parseInt(p[m+1],0);p[4]&&(p[5]?h[3]=parseFloat(p[4])*.01:h[3]=parseFloat(p[4]))}else if(p=l.match(v)){for(m=0;m<3;m++)h[m]=Math.round(parseFloat(p[m+1])*2.55);p[4]&&(p[5]?h[3]=parseFloat(p[4])*.01:h[3]=parseFloat(p[4]))}else return(p=l.match(c))?p[1]==="transparent"?[0,0,0,0]:r.call(t,p[1])?(h=t[p[1]],h[3]=1,h):null:null;for(m=0;m<3;m++)h[m]=o(h[m],0,255);return h[3]=o(h[3],0,1),h},i.get.hsl=function(l){if(!l)return null;var u=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,d=l.match(u);if(d){var f=parseFloat(d[4]),v=(parseFloat(d[1])%360+360)%360,c=o(parseFloat(d[2]),0,100),h=o(parseFloat(d[3]),0,100),p=o(isNaN(f)?1:f,0,1);return[v,c,h,p]}return null},i.get.hwb=function(l){if(!l)return null;var u=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,d=l.match(u);if(d){var f=parseFloat(d[4]),v=(parseFloat(d[1])%360+360)%360,c=o(parseFloat(d[2]),0,100),h=o(parseFloat(d[3]),0,100),p=o(isNaN(f)?1:f,0,1);return[v,c,h,p]}return null},i.to.hex=function(){var l=e(arguments);return"#"+s(l[0])+s(l[1])+s(l[2])+(l[3]<1?s(Math.round(l[3]*255)):"")},i.to.rgb=function(){var l=e(arguments);return l.length<4||l[3]===1?"rgb("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+")":"rgba("+Math.round(l[0])+", "+Math.round(l[1])+", "+Math.round(l[2])+", "+l[3]+")"},i.to.rgb.percent=function(){var l=e(arguments),u=Math.round(l[0]/255*100),d=Math.round(l[1]/255*100),f=Math.round(l[2]/255*100);return l.length<4||l[3]===1?"rgb("+u+"%, "+d+"%, "+f+"%)":"rgba("+u+"%, "+d+"%, "+f+"%, "+l[3]+")"},i.to.hsl=function(){var l=e(arguments);return l.length<4||l[3]===1?"hsl("+l[0]+", "+l[1]+"%, "+l[2]+"%)":"hsla("+l[0]+", "+l[1]+"%, "+l[2]+"%, "+l[3]+")"},i.to.hwb=function(){var l=e(arguments),u="";return l.length>=4&&l[3]!==1&&(u=", "+l[3]),"hwb("+l[0]+", "+l[1]+"%, "+l[2]+"%"+u+")"},i.to.keyword=function(l){return n[l.slice(0,3)]};function o(l,u,d){return Math.min(Math.max(u,l),d)}function s(l){var u=Math.round(l).toString(16).toUpperCase();return u.length<2?"0"+u:u}return ai.exports}var si={exports:{}},ui,Ms;function vS(){return Ms||(Ms=1,ui={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),ui}var Os;function gf(){if(Os)return si.exports;Os=1;var t=vS(),e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);var n=si.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var a in n)if(n.hasOwnProperty(a)){if(!("channels"in n[a]))throw new Error("missing channels property: "+a);if(!("labels"in n[a]))throw new Error("missing channel labels property: "+a);if(n[a].labels.length!==n[a].channels)throw new Error("channel and label counts mismatch: "+a);var i=n[a].channels,o=n[a].labels;delete n[a].channels,delete n[a].labels,Object.defineProperty(n[a],"channels",{value:i}),Object.defineProperty(n[a],"labels",{value:o})}n.rgb.hsl=function(l){var u=l[0]/255,d=l[1]/255,f=l[2]/255,v=Math.min(u,d,f),c=Math.max(u,d,f),h=c-v,p,m,b;return c===v?p=0:u===c?p=(d-f)/h:d===c?p=2+(f-u)/h:f===c&&(p=4+(u-d)/h),p=Math.min(p*60,360),p<0&&(p+=360),b=(v+c)/2,c===v?m=0:b<=.5?m=h/(c+v):m=h/(2-c-v),[p,m*100,b*100]},n.rgb.hsv=function(l){var u,d,f,v,c,h=l[0]/255,p=l[1]/255,m=l[2]/255,b=Math.max(h,p,m),y=b-Math.min(h,p,m),E=function(S){return(b-S)/6/y+1/2};return y===0?v=c=0:(c=y/b,u=E(h),d=E(p),f=E(m),h===b?v=f-d:p===b?v=1/3+u-f:m===b&&(v=2/3+d-u),v<0?v+=1:v>1&&(v-=1)),[v*360,c*100,b*100]},n.rgb.hwb=function(l){var u=l[0],d=l[1],f=l[2],v=n.rgb.hsl(l)[0],c=1/255*Math.min(u,Math.min(d,f));return f=1-1/255*Math.max(u,Math.max(d,f)),[v,c*100,f*100]},n.rgb.cmyk=function(l){var u=l[0]/255,d=l[1]/255,f=l[2]/255,v,c,h,p;return p=Math.min(1-u,1-d,1-f),v=(1-u-p)/(1-p)||0,c=(1-d-p)/(1-p)||0,h=(1-f-p)/(1-p)||0,[v*100,c*100,h*100,p*100]};function s(l,u){return Math.pow(l[0]-u[0],2)+Math.pow(l[1]-u[1],2)+Math.pow(l[2]-u[2],2)}return n.rgb.keyword=function(l){var u=e[l];if(u)return u;var d=1/0,f;for(var v in t)if(t.hasOwnProperty(v)){var c=t[v],h=s(l,c);h<d&&(d=h,f=v)}return f},n.keyword.rgb=function(l){return t[l]},n.rgb.xyz=function(l){var u=l[0]/255,d=l[1]/255,f=l[2]/255;u=u>.04045?Math.pow((u+.055)/1.055,2.4):u/12.92,d=d>.04045?Math.pow((d+.055)/1.055,2.4):d/12.92,f=f>.04045?Math.pow((f+.055)/1.055,2.4):f/12.92;var v=u*.4124+d*.3576+f*.1805,c=u*.2126+d*.7152+f*.0722,h=u*.0193+d*.1192+f*.9505;return[v*100,c*100,h*100]},n.rgb.lab=function(l){var u=n.rgb.xyz(l),d=u[0],f=u[1],v=u[2],c,h,p;return d/=95.047,f/=100,v/=108.883,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,v=v>.008856?Math.pow(v,1/3):7.787*v+16/116,c=116*f-16,h=500*(d-f),p=200*(f-v),[c,h,p]},n.hsl.rgb=function(l){var u=l[0]/360,d=l[1]/100,f=l[2]/100,v,c,h,p,m;if(d===0)return m=f*255,[m,m,m];f<.5?c=f*(1+d):c=f+d-f*d,v=2*f-c,p=[0,0,0];for(var b=0;b<3;b++)h=u+1/3*-(b-1),h<0&&h++,h>1&&h--,6*h<1?m=v+(c-v)*6*h:2*h<1?m=c:3*h<2?m=v+(c-v)*(2/3-h)*6:m=v,p[b]=m*255;return p},n.hsl.hsv=function(l){var u=l[0],d=l[1]/100,f=l[2]/100,v=d,c=Math.max(f,.01),h,p;return f*=2,d*=f<=1?f:2-f,v*=c<=1?c:2-c,p=(f+d)/2,h=f===0?2*v/(c+v):2*d/(f+d),[u,h*100,p*100]},n.hsv.rgb=function(l){var u=l[0]/60,d=l[1]/100,f=l[2]/100,v=Math.floor(u)%6,c=u-Math.floor(u),h=255*f*(1-d),p=255*f*(1-d*c),m=255*f*(1-d*(1-c));switch(f*=255,v){case 0:return[f,m,h];case 1:return[p,f,h];case 2:return[h,f,m];case 3:return[h,p,f];case 4:return[m,h,f];case 5:return[f,h,p]}},n.hsv.hsl=function(l){var u=l[0],d=l[1]/100,f=l[2]/100,v=Math.max(f,.01),c,h,p;return p=(2-d)*f,c=(2-d)*v,h=d*v,h/=c<=1?c:2-c,h=h||0,p/=2,[u,h*100,p*100]},n.hwb.rgb=function(l){var u=l[0]/360,d=l[1]/100,f=l[2]/100,v=d+f,c,h,p,m;v>1&&(d/=v,f/=v),c=Math.floor(6*u),h=1-f,p=6*u-c,(c&1)!==0&&(p=1-p),m=d+p*(h-d);var b,y,E;switch(c){default:case 6:case 0:b=h,y=m,E=d;break;case 1:b=m,y=h,E=d;break;case 2:b=d,y=h,E=m;break;case 3:b=d,y=m,E=h;break;case 4:b=m,y=d,E=h;break;case 5:b=h,y=d,E=m;break}return[b*255,y*255,E*255]},n.cmyk.rgb=function(l){var u=l[0]/100,d=l[1]/100,f=l[2]/100,v=l[3]/100,c,h,p;return c=1-Math.min(1,u*(1-v)+v),h=1-Math.min(1,d*(1-v)+v),p=1-Math.min(1,f*(1-v)+v),[c*255,h*255,p*255]},n.xyz.rgb=function(l){var u=l[0]/100,d=l[1]/100,f=l[2]/100,v,c,h;return v=u*3.2406+d*-1.5372+f*-.4986,c=u*-.9689+d*1.8758+f*.0415,h=u*.0557+d*-.204+f*1.057,v=v>.0031308?1.055*Math.pow(v,1/2.4)-.055:v*12.92,c=c>.0031308?1.055*Math.pow(c,1/2.4)-.055:c*12.92,h=h>.0031308?1.055*Math.pow(h,1/2.4)-.055:h*12.92,v=Math.min(Math.max(0,v),1),c=Math.min(Math.max(0,c),1),h=Math.min(Math.max(0,h),1),[v*255,c*255,h*255]},n.xyz.lab=function(l){var u=l[0],d=l[1],f=l[2],v,c,h;return u/=95.047,d/=100,f/=108.883,u=u>.008856?Math.pow(u,1/3):7.787*u+16/116,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,f=f>.008856?Math.pow(f,1/3):7.787*f+16/116,v=116*d-16,c=500*(u-d),h=200*(d-f),[v,c,h]},n.lab.xyz=function(l){var u=l[0],d=l[1],f=l[2],v,c,h;c=(u+16)/116,v=d/500+c,h=c-f/200;var p=Math.pow(c,3),m=Math.pow(v,3),b=Math.pow(h,3);return c=p>.008856?p:(c-16/116)/7.787,v=m>.008856?m:(v-16/116)/7.787,h=b>.008856?b:(h-16/116)/7.787,v*=95.047,c*=100,h*=108.883,[v,c,h]},n.lab.lch=function(l){var u=l[0],d=l[1],f=l[2],v,c,h;return v=Math.atan2(f,d),c=v*360/2/Math.PI,c<0&&(c+=360),h=Math.sqrt(d*d+f*f),[u,h,c]},n.lch.lab=function(l){var u=l[0],d=l[1],f=l[2],v,c,h;return h=f/360*2*Math.PI,v=d*Math.cos(h),c=d*Math.sin(h),[u,v,c]},n.rgb.ansi16=function(l){var u=l[0],d=l[1],f=l[2],v=1 in arguments?arguments[1]:n.rgb.hsv(l)[2];if(v=Math.round(v/50),v===0)return 30;var c=30+(Math.round(f/255)<<2|Math.round(d/255)<<1|Math.round(u/255));return v===2&&(c+=60),c},n.hsv.ansi16=function(l){return n.rgb.ansi16(n.hsv.rgb(l),l[2])},n.rgb.ansi256=function(l){var u=l[0],d=l[1],f=l[2];if(u===d&&d===f)return u<8?16:u>248?231:Math.round((u-8)/247*24)+232;var v=16+36*Math.round(u/255*5)+6*Math.round(d/255*5)+Math.round(f/255*5);return v},n.ansi16.rgb=function(l){var u=l%10;if(u===0||u===7)return l>50&&(u+=3.5),u=u/10.5*255,[u,u,u];var d=(~~(l>50)+1)*.5,f=(u&1)*d*255,v=(u>>1&1)*d*255,c=(u>>2&1)*d*255;return[f,v,c]},n.ansi256.rgb=function(l){if(l>=232){var u=(l-232)*10+8;return[u,u,u]}l-=16;var d,f=Math.floor(l/36)/5*255,v=Math.floor((d=l%36)/6)/5*255,c=d%6/5*255;return[f,v,c]},n.rgb.hex=function(l){var u=((Math.round(l[0])&255)<<16)+((Math.round(l[1])&255)<<8)+(Math.round(l[2])&255),d=u.toString(16).toUpperCase();return"000000".substring(d.length)+d},n.hex.rgb=function(l){var u=l.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!u)return[0,0,0];var d=u[0];u[0].length===3&&(d=d.split("").map(function(p){return p+p}).join(""));var f=parseInt(d,16),v=f>>16&255,c=f>>8&255,h=f&255;return[v,c,h]},n.rgb.hcg=function(l){var u=l[0]/255,d=l[1]/255,f=l[2]/255,v=Math.max(Math.max(u,d),f),c=Math.min(Math.min(u,d),f),h=v-c,p,m;return h<1?p=c/(1-h):p=0,h<=0?m=0:v===u?m=(d-f)/h%6:v===d?m=2+(f-u)/h:m=4+(u-d)/h+4,m/=6,m%=1,[m*360,h*100,p*100]},n.hsl.hcg=function(l){var u=l[1]/100,d=l[2]/100,f=1,v=0;return d<.5?f=2*u*d:f=2*u*(1-d),f<1&&(v=(d-.5*f)/(1-f)),[l[0],f*100,v*100]},n.hsv.hcg=function(l){var u=l[1]/100,d=l[2]/100,f=u*d,v=0;return f<1&&(v=(d-f)/(1-f)),[l[0],f*100,v*100]},n.hcg.rgb=function(l){var u=l[0]/360,d=l[1]/100,f=l[2]/100;if(d===0)return[f*255,f*255,f*255];var v=[0,0,0],c=u%1*6,h=c%1,p=1-h,m=0;switch(Math.floor(c)){case 0:v[0]=1,v[1]=h,v[2]=0;break;case 1:v[0]=p,v[1]=1,v[2]=0;break;case 2:v[0]=0,v[1]=1,v[2]=h;break;case 3:v[0]=0,v[1]=p,v[2]=1;break;case 4:v[0]=h,v[1]=0,v[2]=1;break;default:v[0]=1,v[1]=0,v[2]=p}return m=(1-d)*f,[(d*v[0]+m)*255,(d*v[1]+m)*255,(d*v[2]+m)*255]},n.hcg.hsv=function(l){var u=l[1]/100,d=l[2]/100,f=u+d*(1-u),v=0;return f>0&&(v=u/f),[l[0],v*100,f*100]},n.hcg.hsl=function(l){var u=l[1]/100,d=l[2]/100,f=d*(1-u)+.5*u,v=0;return f>0&&f<.5?v=u/(2*f):f>=.5&&f<1&&(v=u/(2*(1-f))),[l[0],v*100,f*100]},n.hcg.hwb=function(l){var u=l[1]/100,d=l[2]/100,f=u+d*(1-u);return[l[0],(f-u)*100,(1-f)*100]},n.hwb.hcg=function(l){var u=l[1]/100,d=l[2]/100,f=1-d,v=f-u,c=0;return v<1&&(c=(f-v)/(1-v)),[l[0],v*100,c*100]},n.apple.rgb=function(l){return[l[0]/65535*255,l[1]/65535*255,l[2]/65535*255]},n.rgb.apple=function(l){return[l[0]/255*65535,l[1]/255*65535,l[2]/255*65535]},n.gray.rgb=function(l){return[l[0]/100*255,l[0]/100*255,l[0]/100*255]},n.gray.hsl=n.gray.hsv=function(l){return[0,0,l[0]]},n.gray.hwb=function(l){return[0,100,l[0]]},n.gray.cmyk=function(l){return[0,0,0,l[0]]},n.gray.lab=function(l){return[l[0],0,0]},n.gray.hex=function(l){var u=Math.round(l[0]/100*255)&255,d=(u<<16)+(u<<8)+u,f=d.toString(16).toUpperCase();return"000000".substring(f.length)+f},n.rgb.gray=function(l){var u=(l[0]+l[1]+l[2])/3;return[u/255*100]},si.exports}var di,Ls;function hS(){if(Ls)return di;Ls=1;var t=gf();function e(){for(var i={},o=Object.keys(t),s=o.length,l=0;l<s;l++)i[o[l]]={distance:-1,parent:null};return i}function r(i){var o=e(),s=[i];for(o[i].distance=0;s.length;)for(var l=s.pop(),u=Object.keys(t[l]),d=u.length,f=0;f<d;f++){var v=u[f],c=o[v];c.distance===-1&&(c.distance=o[l].distance+1,c.parent=l,s.unshift(v))}return o}function n(i,o){return function(s){return o(i(s))}}function a(i,o){for(var s=[o[i].parent,i],l=t[o[i].parent][i],u=o[i].parent;o[u].parent;)s.unshift(o[u].parent),l=n(t[o[u].parent][u],l),u=o[u].parent;return l.conversion=s,l}return di=function(i){for(var o=r(i),s={},l=Object.keys(o),u=l.length,d=0;d<u;d++){var f=l[d],v=o[f];v.parent!==null&&(s[f]=a(f,o))}return s},di}var fi,Rs;function pS(){if(Rs)return fi;Rs=1;var t=gf(),e=hS(),r={},n=Object.keys(t);function a(o){var s=function(l){return l==null?l:(arguments.length>1&&(l=Array.prototype.slice.call(arguments)),o(l))};return"conversion"in o&&(s.conversion=o.conversion),s}function i(o){var s=function(l){if(l==null)return l;arguments.length>1&&(l=Array.prototype.slice.call(arguments));var u=o(l);if(typeof u=="object")for(var d=u.length,f=0;f<d;f++)u[f]=Math.round(u[f]);return u};return"conversion"in o&&(s.conversion=o.conversion),s}return n.forEach(function(o){r[o]={},Object.defineProperty(r[o],"channels",{value:t[o].channels}),Object.defineProperty(r[o],"labels",{value:t[o].labels});var s=e(o),l=Object.keys(s);l.forEach(function(u){var d=s[u];r[o][u]=i(d),r[o][u].raw=a(d)})}),fi=r,fi}var ci,Fs;function gS(){if(Fs)return ci;Fs=1;var t=cS(),e=pS(),r=[].slice,n=["keyword","gray","hex"],a={};Object.keys(e).forEach(function(c){a[r.call(e[c].labels).sort().join("")]=c});var i={};function o(c,h){if(!(this instanceof o))return new o(c,h);if(h&&h in n&&(h=null),h&&!(h in e))throw new Error("Unknown model: "+h);var p,m;if(c==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(c instanceof o)this.model=c.model,this.color=c.color.slice(),this.valpha=c.valpha;else if(typeof c=="string"){var b=t.get(c);if(b===null)throw new Error("Unable to parse color from string: "+c);this.model=b.model,m=e[this.model].channels,this.color=b.value.slice(0,m),this.valpha=typeof b.value[m]=="number"?b.value[m]:1}else if(c.length){this.model=h||"rgb",m=e[this.model].channels;var y=r.call(c,0,m);this.color=v(y,m),this.valpha=typeof c[m]=="number"?c[m]:1}else if(typeof c=="number")c&=16777215,this.model="rgb",this.color=[c>>16&255,c>>8&255,c&255],this.valpha=1;else{this.valpha=1;var E=Object.keys(c);"alpha"in c&&(E.splice(E.indexOf("alpha"),1),this.valpha=typeof c.alpha=="number"?c.alpha:0);var S=E.sort().join("");if(!(S in a))throw new Error("Unable to parse color from object: "+JSON.stringify(c));this.model=a[S];var T=e[this.model].labels,k=[];for(p=0;p<T.length;p++)k.push(c[T[p]]);this.color=v(k)}if(i[this.model])for(m=e[this.model].channels,p=0;p<m;p++){var R=i[this.model][p];R&&(this.color[p]=R(this.color[p]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}o.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(c){var h=this.model in t.to?this:this.rgb();h=h.round(typeof c=="number"?c:1);var p=h.valpha===1?h.color:h.color.concat(this.valpha);return t.to[h.model](p)},percentString:function(c){var h=this.rgb().round(typeof c=="number"?c:1),p=h.valpha===1?h.color:h.color.concat(this.valpha);return t.to.rgb.percent(p)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var c={},h=e[this.model].channels,p=e[this.model].labels,m=0;m<h;m++)c[p[m]]=this.color[m];return this.valpha!==1&&(c.alpha=this.valpha),c},unitArray:function(){var c=this.rgb().color;return c[0]/=255,c[1]/=255,c[2]/=255,this.valpha!==1&&c.push(this.valpha),c},unitObject:function(){var c=this.rgb().object();return c.r/=255,c.g/=255,c.b/=255,this.valpha!==1&&(c.alpha=this.valpha),c},round:function(c){return c=Math.max(c||0,0),new o(this.color.map(l(c)).concat(this.valpha),this.model)},alpha:function(c){return arguments.length?new o(this.color.concat(Math.max(0,Math.min(1,c))),this.model):this.valpha},red:u("rgb",0,d(255)),green:u("rgb",1,d(255)),blue:u("rgb",2,d(255)),hue:u(["hsl","hsv","hsl","hwb","hcg"],0,function(c){return(c%360+360)%360}),saturationl:u("hsl",1,d(100)),lightness:u("hsl",2,d(100)),saturationv:u("hsv",1,d(100)),value:u("hsv",2,d(100)),chroma:u("hcg",1,d(100)),gray:u("hcg",2,d(100)),white:u("hwb",1,d(100)),wblack:u("hwb",2,d(100)),cyan:u("cmyk",0,d(100)),magenta:u("cmyk",1,d(100)),yellow:u("cmyk",2,d(100)),black:u("cmyk",3,d(100)),x:u("xyz",0,d(100)),y:u("xyz",1,d(100)),z:u("xyz",2,d(100)),l:u("lab",0,d(100)),a:u("lab",1),b:u("lab",2),keyword:function(c){return arguments.length?new o(c):e[this.model].keyword(this.color)},hex:function(c){return arguments.length?new o(c):t.to.hex(this.rgb().round().color)},rgbNumber:function(){var c=this.rgb().color;return(c[0]&255)<<16|(c[1]&255)<<8|c[2]&255},luminosity:function(){for(var c=this.rgb().color,h=[],p=0;p<c.length;p++){var m=c[p]/255;h[p]=m<=.03928?m/12.92:Math.pow((m+.055)/1.055,2.4)}return .2126*h[0]+.7152*h[1]+.0722*h[2]},contrast:function(c){var h=this.luminosity(),p=c.luminosity();return h>p?(h+.05)/(p+.05):(p+.05)/(h+.05)},level:function(c){var h=this.contrast(c);return h>=7.1?"AAA":h>=4.5?"AA":""},isDark:function(){var c=this.rgb().color,h=(c[0]*299+c[1]*587+c[2]*114)/1e3;return h<128},isLight:function(){return!this.isDark()},negate:function(){for(var c=this.rgb(),h=0;h<3;h++)c.color[h]=255-c.color[h];return c},lighten:function(c){var h=this.hsl();return h.color[2]+=h.color[2]*c,h},darken:function(c){var h=this.hsl();return h.color[2]-=h.color[2]*c,h},saturate:function(c){var h=this.hsl();return h.color[1]+=h.color[1]*c,h},desaturate:function(c){var h=this.hsl();return h.color[1]-=h.color[1]*c,h},whiten:function(c){var h=this.hwb();return h.color[1]+=h.color[1]*c,h},blacken:function(c){var h=this.hwb();return h.color[2]+=h.color[2]*c,h},grayscale:function(){var c=this.rgb().color,h=c[0]*.3+c[1]*.59+c[2]*.11;return o.rgb(h,h,h)},fade:function(c){return this.alpha(this.valpha-this.valpha*c)},opaquer:function(c){return this.alpha(this.valpha+this.valpha*c)},rotate:function(c){var h=this.hsl(),p=h.color[0];return p=(p+c)%360,p=p<0?360+p:p,h.color[0]=p,h},mix:function(c,h){if(!c||!c.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof c);var p=c.rgb(),m=this.rgb(),b=h===void 0?.5:h,y=2*b-1,E=p.alpha()-m.alpha(),S=((y*E===-1?y:(y+E)/(1+y*E))+1)/2,T=1-S;return o.rgb(S*p.red()+T*m.red(),S*p.green()+T*m.green(),S*p.blue()+T*m.blue(),p.alpha()*b+m.alpha()*(1-b))}},Object.keys(e).forEach(function(c){if(n.indexOf(c)===-1){var h=e[c].channels;o.prototype[c]=function(){if(this.model===c)return new o(this);if(arguments.length)return new o(arguments,c);var p=typeof arguments[h]=="number"?h:this.valpha;return new o(f(e[this.model][c].raw(this.color)).concat(p),c)},o[c]=function(p){return typeof p=="number"&&(p=v(r.call(arguments),h)),new o(p,c)}}});function s(c,h){return Number(c.toFixed(h))}function l(c){return function(h){return s(h,c)}}function u(c,h,p){return c=Array.isArray(c)?c:[c],c.forEach(function(m){(i[m]||(i[m]=[]))[h]=p}),c=c[0],function(m){var b;return arguments.length?(p&&(m=p(m)),b=this[c](),b.color[h]=m,b):(b=this[c]().color[h],p&&(b=p(b)),b)}}function d(c){return function(h){return Math.max(0,Math.min(c,h))}}function f(c){return Array.isArray(c)?c:[c]}function v(c,h){for(var p=0;p<h;p++)typeof c[p]!="number"&&(c[p]=0);return c}return ci=o,ci}var Ps;function mS(){if(Ps)return qn;Ps=1,Object.defineProperty(qn,"__esModule",{value:!0});var t=gS(),e=21.247;function r(n,a){a===void 0&&(a=e);try{var i=t(n||void 0),o=i.lab().array(),s=(100-o[0])*((100-a)/100)+a;n=t.lab(s,o[1],o[2]).rgb().alpha(i.alpha()).toString()}catch{}return n}return qn.default=r,qn}var As;function bS(){return As||(As=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkColor=void 0;var e=mS();Object.defineProperty(t,"getDarkColor",{enumerable:!0,get:function(){return e.default}})})(ni)),ni}bS();var yS=Y('<button type="button"><!></button>'),ES=Y('<button type="button"> </button>'),CS=Y('<button type="button"> </button>'),SS=Y('<div class="svelte-1yn45nn"><div class="flex items-start flex-col md:flex-row md:items-center svelte-1yn45nn"><div class="w-80 text-sm font-semibold text-slate-600 mb-8 svelte-1yn45nn">Columnas</div> <div class="flex flex-wrap items-center svelte-1yn45nn"></div></div> <div class="flex items-start flex-col md:flex-row md:items-center svelte-1yn45nn"><div class="w-80 text-sm font-semibold text-slate-600 mb-8 svelte-1yn45nn">Filas</div> <div class="flex flex-wrap items-center svelte-1yn45nn"></div></div></div>'),TS=Y('<div class="h-20 w-32 m-4 border border-black/60 cursor-pointer hover:outline hover:outline-1 hover:outline-black/70 svelte-1yn45nn"></div>'),wS=Y('<div class="flex flex-wrap w-full svelte-1yn45nn"></div>'),kS=Y('<button type="button" class="px-12 py-4 hover:bg-slate-100 rounded border border-slate-200"> </button>'),_S=Y('<div class="flex flex-wrap w-full gap-8 svelte-1yn45nn"></div>'),DS=Y('<div class="absolute top-[47px] w-[calc(100%-20px)] left-[10px] border border-[#ab9efc] min-h-[60px] bg-white rounded-lg z-50 shadow-lg p-12 _10 svelte-1yn45nn" role="dialog" aria-label="Editor popup" tabindex="-1"><input type="text" inputmode="none" autocomplete="off" class="opacity-0 h-2 w-1 absolute z-[-1]"/> <!> <!> <!></div>'),MS=Y('<button type="button" class="_4 svelte-1yn45nn"> </button>'),OS=Y('<div class="flex flex-wrap gap-2 items-center p-6 border border-slate-200 rounded-t-[6px] bg-slate-50 relative svelte-1yn45nn" role="toolbar" aria-label="Editor toolbar" tabindex="-1"><!> <!> <!></div> <div class="border border-slate-200 rounded-b-[6px] bg-white min-h-[14rem] shadow-inner svelte-1yn45nn" style="position: relative;"><div class="rooster-editor min-h-[14rem] p-16 text-base leading-relaxed text-slate-900 outline-none empty:before:content-[attr(data-placeholder)] empty:before:text-slate-400 empty:before:pointer-events-none svelte-1yn45nn" role="textbox" aria-label="Rich text editor" aria-multiline="true" contenteditable="true" data-placeholder="Empieza a escribir contenido enriquecido…"></div></div>',1),LS=Y("<div><!></div>");function RS(t,e){tt(e,!0);const r=q(e,"saveOn",7),n=()=>r()&&e.save&&(r()[e.save]??"")||"";let a=Z(null),i=Z(null),o=Z(null),s=Z(Ze(n())),l=Z(Ze({})),u=Z(!1),d=Z(Ze(["8pt","9pt","10pt","11pt","12pt","14pt","16pt","18pt","20pt","24pt","28pt","32pt"])),f=Z("16pt"),v=Z(0),c=Z("#000000"),h=Z("#ffffff"),p=Z("Arial"),m=n(),b=null,y=Z(!1),E=Z(!1),S=Z(!1),T=Z(!1),k=Z(0),R=Z(0);const M=()=>g(o)?.core,w=_=>{_&&(g(d).includes(_)||P(d,[...g(d),_],!0))},A=(_,H)=>{const X=_?.trim()?_:"<p></p>",ve=new DOMParser().parseFromString(X,"text/html").body;if(!ve)return;const me=H?Mn(H.environment.domToModelSettings.calculated,H.api.createEditorContext(H,!1)):Dn();return En(ve,me)};let N=Z(void 0),J=!1;const z=_=>{const X=new DOMParser().parseFromString(_,"text/html"),ce=(te,ve)=>{te.forEach(me=>ve.forEach(At=>me.style.removeProperty(At)))};return ce(X.querySelectorAll("div"),["margin-top","margin-bottom","font-family"]),ce(X.querySelectorAll("td, th"),["width","height","border-width","border-style","border-color"]),X.body.innerHTML},O=_=>{const H=M();if(!H)return;const X=z(_),ce=A(X,H);ce&&(H.api.setContentModel(H,ce,{ignoreSelection:!0}),H.api.triggerEvent(H,{eventType:"contentChanged",source:Ve.SetContent},!0),setTimeout(()=>{g(a)&&V(g(a))},0))},V=_=>{const H=(X,ce)=>{X.forEach(te=>ce.forEach(ve=>te.style.removeProperty(ve)))};H(_.querySelectorAll("div"),["margin-top","margin-bottom","font-family","font-size","color"]),H(_.querySelectorAll("td, th"),["width","height","border-width","border-style","border-color"])},ne=()=>{if(!g(a))return;V(g(a));const _=g(a).innerHTML;_!==g(s)&&P(s,_,!0)},oe=()=>{if(!g(o)||!g(a)){P(u,!1);return}const _=g(o).getDOMSelection();if(!_){P(u,!1);return}if(_.type==="table"){P(u,!0);return}if(_.type==="range"){const H=_.range,X=[H.startContainer,H.commonAncestorContainer];for(const ce of X){let te=ce;for(;te&&te!==g(a);){if(te.nodeType===Node.ELEMENT_NODE){const ve=te.tagName?.toUpperCase();if(["TABLE","TD","TH","TR","TBODY","THEAD","TFOOT"].includes(ve)){P(u,!0);return}}te=te.parentNode}}}P(u,!1)},he=()=>{if(!g(o)){P(l,{},!0),P(u,!1);return}P(l,h1(g(o))??{},!0),g(l).fontSize&&(w(g(l).fontSize),P(f,g(l).fontSize,!0)),P(v,g(l).headingLevel??0,!0),g(l).fontName&&P(p,g(l).fontName,!0),oe()},Re=()=>{b!==null&&cancelAnimationFrame(b),b=requestAnimationFrame(()=>{b=null,he()})},Te=()=>{let _=null,H=null;return{getName:()=>"svelte-sync",initialize:X=>{_=X,P(o,X,!0),ne(),he(),g(a)&&Lf&&(H=new MutationObserver(ce=>{ce.forEach(te=>{te.addedNodes.forEach(ve=>{if(ve.nodeType===Node.ELEMENT_NODE){const me=ve;V(me),me.tagName==="DIV"?(me.style.removeProperty("margin-top"),me.style.removeProperty("margin-bottom"),me.style.removeProperty("font-family")):(me.tagName==="TD"||me.tagName==="TH")&&(me.style.removeProperty("width"),me.style.removeProperty("height"),me.style.removeProperty("border-width"),me.style.removeProperty("border-style"),me.style.removeProperty("border-color"))}})})}),H.observe(g(a),{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style"]}))},dispose:()=>{H&&(H.disconnect(),H=null),_&&g(o)===_&&P(o,null),_=null},onPluginEvent:X=>{X.eventType==="contentChanged"&&(ne(),g(a)&&setTimeout(()=>V(g(a)),0)),(X.eventType==="contentChanged"||X.eventType==="selectionChanged")&&(X.eventType==="selectionChanged"&&oe(),Re())}}},ee=_=>{g(o)&&(g(o).focus(),_(g(o)),Re())},le=_=>{ee(H=>d1(H,_))},Zt=_=>{P(f,_,!0),ee(H=>Zy(H,_))},pt=()=>{g(k)>0&&g(R)>0&&(ee(_=>Dy(_,g(R),g(k))),P(y,!1),P(k,0),P(R,0))},pe=_=>{P(k,_,!0),g(k)>0&&g(R)>0&&pt()},Ie=_=>{P(R,_,!0),g(k)>0&&g(R)>0&&pt()},ke=()=>{P(y,!1),P(k,0),P(R,0)},qe=()=>{if(g(o)){const _=M();_&&_.api.insertNode(_,document.createElement("hr"))}},Be=_=>{P(c,_,!0),ee(H=>Jy(H,_))},ze=_=>{P(h,_,!0),ee(H=>Yy(H,_))};Mf(()=>{if(!g(a))return;const _=A(g(s)),H=Te(),X=new iE,ce=sS(g(a),[H,X],_);P(o,ce,!0);const te=()=>setTimeout(oe,0);return g(a).addEventListener("click",te),g(a).addEventListener("focus",te),()=>{b!==null&&(cancelAnimationFrame(b),b=null),g(a)?.removeEventListener("click",te),g(a)?.removeEventListener("focus",te),ce.dispose(),P(o,null)}});const Xe=W(()=>g(y)||g(E)||g(S)||g(T));Lt(()=>{g(Xe)&&g(N)?.focus()}),Lt(()=>{!r()||!e.save||g(s)!==m&&(m=g(s),r()[e.save]=g(s))}),Lt(()=>{if(!r()||!e.save)return;const _=(r()[e.save]??"")||"";_!==g(s)&&(m=_,P(s,_,!0),g(o)&&O(_))});const st=W(()=>[{label:"Bold",icon:"<strong>B</strong>",action:()=>ee(Id),active:!!g(l).isBold},{label:"Italic",icon:"<em>I</em>",action:()=>ee(Bd),active:!!g(l).isItalic},{label:"Text Size",icon:`<img class="h-24 w-24" src="${Ga(Wf)}" alt="" />`,action:()=>{P(T,!g(T))},active:g(T),isLayer:!0},{label:"Insert table",icon:"⊞",action:()=>{P(y,!g(y))},active:g(y),isLayer:!0},{label:"Text color",html:`<img class="h-20 w-20 ml-4" src="${Ga(Vf)}" alt="" />
             <div class="absolute bottom-2 left-2 w-[calc(100%-4px)] h-12 border border-black/70 rounded-[2px]" style="background-color: ${g(c)};"></div>`,action:()=>{P(E,!g(E))},active:g(E),isLayer:!0,className:"pb-12"},{label:"Background color",html:`<img class="h-20 w-20" src="${Ga(jf)}" alt="" />
             <div class="absolute bottom-2 left-2 w-[calc(100%-4px)] h-12 border border-black/70 rounded-[2px]" style="background-color: ${g(h)};"></div>`,action:()=>{P(S,!g(S))},active:g(S),isLayer:!0,className:"pb-12"},{label:"Align left",icon:"⬅",action:()=>le("left"),active:g(l).textAlign==="left"||!g(l).textAlign},{label:"Align center",icon:"⬍",action:()=>le("center"),active:g(l).textAlign==="center"},{label:"Align right",icon:"➡",action:()=>le("right"),active:g(l).textAlign==="right"},{label:"Underline",icon:"<u>U</u>",action:()=>ee(xd),active:!!g(l).isUnderline},{label:"Strikethrough",icon:"<s>S</s>",action:()=>ee(Xy),active:!!g(l).isStrikeThrough},{label:"Justify",icon:"☰",action:()=>le("justify"),active:g(l).textAlign==="justify"},{label:"Bulleted list",icon:"••",action:()=>ee(Fd),active:!!g(l).isBullet},{label:"Numbered list",icon:"1.",action:()=>ee(Pd),active:!!g(l).isNumbering},{label:"Insert horizontal rule",icon:"─",action:qe},{label:"Clear format",icon:"Clear",action:()=>ee(Gd)},{label:"Undo",icon:"↶",action:()=>{g(o)&&M()&&(M()?.api.undo(M()),Re())}},{label:"Redo",icon:"↷",action:()=>{g(o)&&M()&&(M()?.api.redo(M()),Re())}}]),rr=[{label:"Add row above",icon:"⬆ Row",action:()=>ee(_=>Sr(_,"insertAbove"))},{label:"Add row below",icon:"⬇ Row",action:()=>ee(_=>Sr(_,"insertBelow"))},{label:"Add column left",icon:"⬅ Col",action:()=>ee(_=>Sr(_,"insertLeft"))},{label:"Add column right",icon:"➡ Col",action:()=>ee(_=>Sr(_,"insertRight"))},{label:"Delete row",icon:"🗑 Row",action:()=>ee(_=>Sr(_,"deleteRow"))},{label:"Delete column",icon:"🗑 Col",action:()=>ee(_=>Sr(_,"deleteColumn"))}];var Pt=LS(),br=j(Pt);{var yr=_=>{var H=OS(),X=Me(H);X.__click=ae=>{g(y)&&ae.target.closest("._10")},X.__keydown=ae=>{ae.key==="Escape"&&g(y)};var ce=j(X);Dt(ce,17,()=>g(st),Ht,(ae,de)=>{var Fe=yS();let Nt;Fe.__click=function(...nt){g(de).action?.apply(this,nt)};var kt=j(Fe);Of(kt,()=>g(de).html||g(de).icon),G(Fe),se(()=>{Fe.disabled=!g(o),Nt=$e(Fe,1,`_4 ${g(de).active?"bg-blue-100 border-blue-500 text-blue-700":""} ${g(de).className??""??""}`,"svelte-1yn45nn",Nt,{_6:g(de).isLayer&&g(de).active}),fe(Fe,"aria-label",g(de).label)}),K(ae,Fe)});var te=B(ce,2);{var ve=ae=>{var de=DS();de.__mousedown=()=>J=!0,de.__click=Q=>Q.stopPropagation(),de.__keydown=Q=>{Q.key==="Escape"&&ke()};var Fe=j(de);Rt(Fe,Q=>P(N,Q),()=>g(N));var Nt=B(Fe,2);{var kt=Q=>{var be=SS(),_e=j(be),De=B(j(_e),2);Dt(De,20,()=>Array(12),Ht,(Zr,za,_t)=>{const gt=W(()=>_t+1);var at=ES();let Jr;at.__click=()=>Ie(g(gt));var Ua=j(at,!0);G(at),se(()=>{Jr=$e(at,1,`mr-4 mb-4 w-32 h-28 flex items-center justify-center rounded bg-indigo-100/50 cursor-pointer text-[13px] text-slate-900 transition-all hover:not(.selected):bg-indigo-100 hover:not(.selected):border-indigo-500 hover:not(.selected):text-indigo-700 ${g(R)>=g(gt)?"bg-indigo-500 text-white font-semibold":""}`,"svelte-1yn45nn",Jr,{selected:g(R)>=g(gt)}),fe(at,"aria-label",`Select ${g(gt)??""} columns`),ft(Ua,g(gt))}),K(Zr,at)}),G(De),G(_e);var Ce=B(_e,2),Ue=B(j(Ce),2);Dt(Ue,20,()=>Array(12),Ht,(Zr,za,_t)=>{const gt=W(()=>_t+1);var at=CS();let Jr;at.__click=()=>pe(g(gt));var Ua=j(at,!0);G(at),se(()=>{Jr=$e(at,1,`mr-4 mb-4 w-32 h-28 flex items-center justify-center rounded bg-indigo-100/50 cursor-pointer text-[13px] text-slate-900 transition-all hover:not(.selected):bg-indigo-100 hover:not(.selected):border-indigo-500 hover:not(.selected):text-indigo-700 ${g(k)>=g(gt)?"bg-indigo-500 text-white font-semibold":""}`,"svelte-1yn45nn",Jr,{selected:g(k)>=g(gt)}),fe(at,"aria-label",`Select ${g(gt)??""} rows`),ft(Ua,g(gt))}),K(Zr,at)}),G(Ue),G(Ce),G(be),K(Q,be)};ue(Nt,Q=>{g(y)&&Q(kt)})}var nt=B(Nt,2);{var Xr=Q=>{const be=W(()=>g(S)?Gf:Uf);var _e=wS();Dt(_e,21,()=>g(be),Ht,(De,Ce)=>{var Ue=TS();Ue.__click=()=>{g(S)?ze(g(Ce)):Be(g(Ce))},se(()=>yt(Ue,`background-color: ${g(Ce)??""};`)),K(De,Ue)}),G(_e),K(Q,_e)};ue(nt,Q=>{(g(S)||g(E))&&Q(Xr)})}var Yr=B(nt,2);{var ge=Q=>{var be=_S();Dt(be,21,()=>Kf,Ht,(_e,De)=>{var Ce=kS();Ce.__click=()=>{Zt(`${g(De).id}px`),P(T,!1)};var Ue=j(Ce,!0);G(Ce),se(()=>ft(Ue,g(De).name)),K(_e,Ce)}),G(be),K(Q,be)};ue(Yr,Q=>{g(T)&&Q(ge)})}G(de),Qt("blur",Fe,Q=>{if(J){J=!1,Q.target.focus();return}P(y,!1),P(E,!1),P(S,!1),P(T,!1)}),K(ae,de)};ue(te,ae=>{g(Xe)&&ae(ve)})}var me=B(te,2);{var At=ae=>{var de=zt(),Fe=Me(de);Dt(Fe,17,()=>rr,Ht,(Nt,kt)=>{var nt=MS();nt.__click=function(...Yr){g(kt).action?.apply(this,Yr)};var Xr=j(nt,!0);G(nt),se(()=>{nt.disabled=!g(o),fe(nt,"aria-label",g(kt).label),ft(Xr,g(kt).icon)}),K(Nt,nt)}),K(ae,de)};ue(me,ae=>{g(u)&&ae(At)})}G(X);var wt=B(X,2),qr=j(wt);Rt(qr,ae=>P(a,ae),()=>g(a)),G(wt),Rt(wt,ae=>P(i,ae),()=>g(i)),K(_,H)};ue(br,_=>{_(yr)})}G(Pt),se(()=>$e(Pt,1,`flex flex-col ${e.css??""}`,"svelte-1yn45nn")),K(t,Pt),rt()}jt(["click","keydown","mousedown"]);const Xn={label:{h:"hue channel",s:"saturation channel",v:"brightness channel",r:"red channel",g:"green channel",b:"blue channel",a:"alpha channel",hex:"hex color",withoutColor:"without color"},color:{rgb:"rgb",hsv:"hsv",hex:"hex"},changeTo:"change to ",swatch:{ariaTitle:"saved colors",ariaLabel:t=>`select color: ${t}`}},mf="a[href], area[href], input:not([type='hidden']):not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]";function FS(t){return function(e){if(e.target===window)return;const r=e.target;if(!t.contains(r))return;const n=t.querySelectorAll(mf),a=n[0],i=n[n.length-1];function o(l){return l.code==="Tab"&&!l.shiftKey}function s(l){return l.code==="Tab"&&l.shiftKey}o(e)&&e.target===i?(e.preventDefault(),a.focus()):s(e)&&e.target===a&&(e.preventDefault(),i.focus())}}const PS=t=>{const e=t.querySelector(mf);e&&e.focus();const r=FS(t);return document.addEventListener("keydown",r),{destroy(){document.removeEventListener("keydown",r)}}};var AS={grad:.9,turn:360,rad:360/(2*Math.PI)},xt=function(t){return typeof t=="string"?t.length>0:typeof t=="number"},Ae=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=Math.pow(10,e)),Math.round(r*t)/r+0},ct=function(t,e,r){return e===void 0&&(e=0),r===void 0&&(r=1),t>r?r:t>e?t:e},bf=function(t){return(t=isFinite(t)?t%360:0)>0?t:t+360},Ns=function(t){return{r:ct(t.r,0,255),g:ct(t.g,0,255),b:ct(t.b,0,255),a:ct(t.a)}},vi=function(t){return{r:Ae(t.r),g:Ae(t.g),b:Ae(t.b),a:Ae(t.a,3)}},NS=/^#([0-9a-f]{3,8})$/i,Yn=function(t){var e=t.toString(16);return e.length<2?"0"+e:e},yf=function(t){var e=t.r,r=t.g,n=t.b,a=t.a,i=Math.max(e,r,n),o=i-Math.min(e,r,n),s=o?i===e?(r-n)/o:i===r?2+(n-e)/o:4+(e-r)/o:0;return{h:60*(s<0?s+6:s),s:i?o/i*100:0,v:i/255*100,a}},Ef=function(t){var e=t.h,r=t.s,n=t.v,a=t.a;e=e/360*6,r/=100,n/=100;var i=Math.floor(e),o=n*(1-r),s=n*(1-(e-i)*r),l=n*(1-(1-e+i)*r),u=i%6;return{r:255*[n,s,o,o,l,n][u],g:255*[l,n,n,s,o,o][u],b:255*[o,o,l,n,n,s][u],a}},Is=function(t){return{h:bf(t.h),s:ct(t.s,0,100),l:ct(t.l,0,100),a:ct(t.a)}},Bs=function(t){return{h:Ae(t.h),s:Ae(t.s),l:Ae(t.l),a:Ae(t.a,3)}},xs=function(t){return Ef((r=(e=t).s,{h:e.h,s:(r*=((n=e.l)<50?n:100-n)/100)>0?2*r/(n+r)*100:0,v:n+r,a:e.a}));var e,r,n},dn=function(t){return{h:(e=yf(t)).h,s:(a=(200-(r=e.s))*(n=e.v)/100)>0&&a<200?r*n/100/(a<=100?a:200-a)*100:0,l:a/2,a:e.a};var e,r,n,a},IS=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,BS=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,xS=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,HS=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Hs={string:[[function(t){var e=NS.exec(t);return e?(t=e[1]).length<=4?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?Ae(parseInt(t[3]+t[3],16)/255,2):1}:t.length===6||t.length===8?{r:parseInt(t.substr(0,2),16),g:parseInt(t.substr(2,2),16),b:parseInt(t.substr(4,2),16),a:t.length===8?Ae(parseInt(t.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(t){var e=xS.exec(t)||HS.exec(t);return e?e[2]!==e[4]||e[4]!==e[6]?null:Ns({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(t){var e=IS.exec(t)||BS.exec(t);if(!e)return null;var r,n,a=Is({h:(r=e[1],n=e[2],n===void 0&&(n="deg"),Number(r)*(AS[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return xs(a)},"hsl"]],object:[[function(t){var e=t.r,r=t.g,n=t.b,a=t.a,i=a===void 0?1:a;return xt(e)&&xt(r)&&xt(n)?Ns({r:Number(e),g:Number(r),b:Number(n),a:Number(i)}):null},"rgb"],[function(t){var e=t.h,r=t.s,n=t.l,a=t.a,i=a===void 0?1:a;if(!xt(e)||!xt(r)||!xt(n))return null;var o=Is({h:Number(e),s:Number(r),l:Number(n),a:Number(i)});return xs(o)},"hsl"],[function(t){var e=t.h,r=t.s,n=t.v,a=t.a,i=a===void 0?1:a;if(!xt(e)||!xt(r)||!xt(n))return null;var o=(function(s){return{h:bf(s.h),s:ct(s.s,0,100),v:ct(s.v,0,100),a:ct(s.a)}})({h:Number(e),s:Number(r),v:Number(n),a:Number(i)});return Ef(o)},"hsv"]]},zs=function(t,e){for(var r=0;r<e.length;r++){var n=e[r][0](t);if(n)return[n,e[r][1]]}return[null,void 0]},zS=function(t){return typeof t=="string"?zs(t.trim(),Hs.string):typeof t=="object"&&t!==null?zs(t,Hs.object):[null,void 0]},hi=function(t,e){var r=dn(t);return{h:r.h,s:ct(r.s+100*e,0,100),l:r.l,a:r.a}},pi=function(t){return(299*t.r+587*t.g+114*t.b)/1e3/255},Us=function(t,e){var r=dn(t);return{h:r.h,s:r.s,l:ct(r.l+100*e,0,100),a:r.a}},Gs=(function(){function t(e){this.parsed=zS(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return t.prototype.isValid=function(){return this.parsed!==null},t.prototype.brightness=function(){return Ae(pi(this.rgba),2)},t.prototype.isDark=function(){return pi(this.rgba)<.5},t.prototype.isLight=function(){return pi(this.rgba)>=.5},t.prototype.toHex=function(){return e=vi(this.rgba),r=e.r,n=e.g,a=e.b,o=(i=e.a)<1?Yn(Ae(255*i)):"","#"+Yn(r)+Yn(n)+Yn(a)+o;var e,r,n,a,i,o},t.prototype.toRgb=function(){return vi(this.rgba)},t.prototype.toRgbString=function(){return e=vi(this.rgba),r=e.r,n=e.g,a=e.b,(i=e.a)<1?"rgba("+r+", "+n+", "+a+", "+i+")":"rgb("+r+", "+n+", "+a+")";var e,r,n,a,i},t.prototype.toHsl=function(){return Bs(dn(this.rgba))},t.prototype.toHslString=function(){return e=Bs(dn(this.rgba)),r=e.h,n=e.s,a=e.l,(i=e.a)<1?"hsla("+r+", "+n+"%, "+a+"%, "+i+")":"hsl("+r+", "+n+"%, "+a+"%)";var e,r,n,a,i},t.prototype.toHsv=function(){return e=yf(this.rgba),{h:Ae(e.h),s:Ae(e.s),v:Ae(e.v),a:Ae(e.a,3)};var e},t.prototype.invert=function(){return Ye({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},t.prototype.saturate=function(e){return e===void 0&&(e=.1),Ye(hi(this.rgba,e))},t.prototype.desaturate=function(e){return e===void 0&&(e=.1),Ye(hi(this.rgba,-e))},t.prototype.grayscale=function(){return Ye(hi(this.rgba,-1))},t.prototype.lighten=function(e){return e===void 0&&(e=.1),Ye(Us(this.rgba,e))},t.prototype.darken=function(e){return e===void 0&&(e=.1),Ye(Us(this.rgba,-e))},t.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},t.prototype.alpha=function(e){return typeof e=="number"?Ye({r:(r=this.rgba).r,g:r.g,b:r.b,a:e}):Ae(this.rgba.a,3);var r},t.prototype.hue=function(e){var r=dn(this.rgba);return typeof e=="number"?Ye({h:e,s:r.s,l:r.l,a:r.a}):Ae(r.h)},t.prototype.isEqual=function(e){return this.toHex()===Ye(e).toHex()},t})(),Ye=function(t){return t instanceof Gs?t:new Gs(t)},US=Y('<input type="hidden"/>'),GS=Y('<div role="slider" tabindex="0"><div class="track svelte-m7z2z3"></div> <div class="thumb svelte-m7z2z3"></div></div> <!>',1);function Ta(t,e){tt(e,!0);let r=q(e,"min",3,0),n=q(e,"max",3,100),a=q(e,"step",3,1),i=q(e,"value",15,50),o=q(e,"ariaValueText",3,O=>O.toString()),s=q(e,"direction",3,"horizontal"),l=q(e,"reverse",3,!1),u=q(e,"keyboardOnly",3,!1),d=q(e,"slider",7),f=q(e,"isDragging",7,!1);const v=W(()=>typeof r()=="string"?parseFloat(r()):r()),c=W(()=>typeof n()=="string"?parseFloat(n()):n()),h=W(()=>typeof a()=="string"?parseFloat(a()):a());function p(O){const V=1/g(h),ne=Math.round(O*V)/V;return Math.max(g(v),Math.min(g(c),ne))}function m(O){const V=O.shiftKey?g(h)*10:g(h);O.key==="ArrowUp"||O.key==="ArrowRight"?(i(i()+V),O.preventDefault()):O.key==="ArrowDown"||O.key==="ArrowLeft"?(i(i()-V),O.preventDefault()):O.key==="Home"?(i(g(v)),O.preventDefault()):O.key==="End"?(i(g(c)),O.preventDefault()):O.key==="PageUp"?(i(i()+g(h)*10),O.preventDefault()):O.key==="PageDown"&&(i(i()-g(h)*10),O.preventDefault()),i(p(i())),e.onInput?.(i())}const b={horizontal:{clientSize:"clientWidth",offset:"left",client:"clientX"},vertical:{clientSize:"clientHeight",offset:"top",client:"clientY"}};function y(O){const V=d()?.[b[s()].clientSize]||120,ne=d()?.getBoundingClientRect()[b[s()].offset]||0;let oe=O[b[s()].client]-ne;s()==="vertical"&&(oe=-1*oe+V),l()?i(g(c)-oe/V*(g(c)-g(v))):i(oe/V*(g(c)-g(v))+g(v)),i(p(i())),e.onInput?.(i())}function E(O){y(O),f(!0)}function S(O){f()&&y(O)}function T(){f(!1)}function k(O){O.preventDefault(),y({clientX:O.changedTouches[0].clientX,clientY:O.changedTouches[0].clientY})}const R=W(()=>((i()-g(v))/(g(c)-g(v))*1).toFixed(4));var M=GS();Qt("mousemove",fr,S),Qt("mouseup",fr,T);var w=Me(M);let A;w.__keydown=m,w.__mousedown=function(...O){(u()?void 0:E)?.apply(this,O)},w.__touchstart=function(...O){(u()?void 0:k)?.apply(this,O)},w.__touchmove=function(...O){(u()?void 0:k)?.apply(this,O)},w.__touchend=function(...O){(u()?void 0:k)?.apply(this,O)};let N;Rt(w,O=>d(O),()=>d());var J=B(w,2);{var z=O=>{var V=US();dt(V),se(()=>{fe(V,"name",e.name),bt(V,i())}),K(O,V)};ue(J,O=>{e.name&&O(z)})}se(O=>{A=$e(w,1,"slider svelte-m7z2z3",null,A,{reverse:l()}),fe(w,"aria-orientation",s()),fe(w,"aria-valuemax",g(c)),fe(w,"aria-valuemin",g(v)),fe(w,"aria-valuenow",i()),fe(w,"aria-valuetext",O),fe(w,"aria-label",e.ariaLabel),fe(w,"aria-labelledby",e.ariaLabelledBy),fe(w,"aria-controls",e.ariaControls),N=yt(w,"",N,{"--position":g(R)})},[()=>o()(i())]),K(t,M),rt()}jt(["keydown","mousedown","touchstart","touchmove","touchend"]);var KS=Y('<div class="picker svelte-1m1c4f4"><!> <div class="s svelte-1m1c4f4"><!></div> <div class="v svelte-1m1c4f4"><!></div></div>');function WS(t,e){tt(e,!0);let r=q(e,"s",15),n=q(e,"v",15),a=Z(void 0),i=!1,o=Z(Ze({x:100,y:0})),s=W(()=>Ye({h:e.h,s:100,v:100,a:1}).toHex());function l(M,w,A){return Math.min(Math.max(w,M),A)}function u(M){if(!g(a))return;const{width:w,left:A,height:N,top:J}=g(a).getBoundingClientRect(),z={x:l(M.clientX-A,0,w),y:l(M.clientY-J,0,N)};r(l(z.x/w,0,1)*100),n(l((N-z.y)/N,0,1)*100),h()}function d(M){M.preventDefault(),M.button===0&&(i=!0,u(M))}function f(){i=!1}function v(M){i&&u(M)}function c(M){M.preventDefault(),u(M.changedTouches[0])}Lt(()=>{typeof r()=="number"&&typeof n()=="number"&&g(a)&&P(o,{x:r(),y:100-n()},!0)});function h(M={}){e.onInput({s:r(),v:n(),...M})}var p=KS();Qt("mouseup",fr,f),Qt("mousemove",fr,v),p.__mousedown=d,p.__touchstart=c,p.__touchmove=c,p.__touchend=c;let m;var b=j(p);Rr(b,()=>e.components.pickerIndicator,(M,w)=>{w(M,{get pos(){return g(o)},get isDark(){return e.isDark}})});var y=B(b,2);let E;var S=j(y);Ta(S,{get value(){return r()},onInput:M=>h({s:M}),keyboardOnly:!0,ariaValueText:M=>`${M}%`,get ariaLabel(){return e.texts.label.s}}),G(y);var T=B(y,2);let k;var R=j(T);Ta(R,{get value(){return n()},onInput:M=>h({v:M}),keyboardOnly:!0,ariaValueText:M=>`${M}%`,direction:"vertical",get ariaLabel(){return e.texts.label.v}}),G(T),G(p),Rt(p,M=>P(a,M),()=>g(a)),se(()=>{m=yt(p,"",m,{"--picker-color-bg":g(s)}),E=yt(y,"",E,{"--pos-y":g(o).y}),k=yt(T,"",k,{"--pos-x":g(o).x})}),K(t,p),rt()}jt(["mousedown","touchstart","touchmove","touchend"]);var VS=Y('<label class="svelte-xlsvaq"><div class="container svelte-xlsvaq"><input type="color" aria-haspopup="dialog" class="svelte-xlsvaq"/> <div class="alpha svelte-xlsvaq"></div> <div class="color svelte-xlsvaq"></div></div> </label>');function jS(t,e){tt(e,!0);let r=q(e,"labelElement",15),n=q(e,"name",3,void 0);function a(f){f.preventDefault()}var i=VS();i.__click=a,i.__mousedown=a;var o=j(i),s=j(o);dt(s),s.__click=a,s.__mousedown=a;var l=B(s,4);let u;G(o);var d=B(o);G(i),Rt(i,f=>r(f),()=>r()),se(()=>{fe(i,"dir",e.dir),fe(s,"name",n()),bt(s,e.hex),u=yt(l,"",u,{background:e.hex}),ft(d,` ${e.label??""}`),i.dir=i.dir}),K(t,i),rt()}jt(["click","mousedown"]);var qS=Y('<label class="nullability-checkbox svelte-xzf52y"><div class="svelte-xzf52y"><input type="checkbox" class="svelte-xzf52y"/> <span class="svelte-xzf52y"></span></div> </label>');function XS(t,e){tt(e,!0);let r=q(e,"isUndefined",15);var n=qS(),a=j(n),i=j(a);dt(i),Ws(2),G(a);var o=B(a);G(n),se(()=>ft(o,` ${e.texts.label.withoutColor??""}`)),_f(i,r),K(t,n),rt()}var YS=Y('<div class="picker-indicator svelte-ke6rtv"></div>');function ZS(t,e){tt(e,!0);var r=YS();let n;se(()=>n=yt(r,"",n,{"--pos-x":e.pos.x,"--pos-y":e.pos.y})),K(t,r),rt()}var JS=Y('<button type="button" class="swatch svelte-1x1q0n6"></button>'),QS=Y('<div class="swatches svelte-1x1q0n6"></div>');function $S(t,e){tt(e,!0);var r=zt(),n=Me(r);{var a=i=>{var o=QS();Dt(o,20,()=>e.swatches,s=>s,(s,l)=>{var u=JS();u.__click=()=>e.selectSwatch(l),se(d=>{yt(u,`background: ${l??""}`),fe(u,"aria-label",d)},[()=>e.texts.swatch.ariaLabel(l)]),K(s,u)}),G(o),se(()=>fe(o,"aria-label",e.texts.swatch.ariaTitle)),K(i,o)};ue(n,i=>{e.swatches&&i(a)})}K(t,r),rt()}jt(["click"]);var eT=Y('<input class="svelte-n07acl"/>'),tT=Y('<input type="number" min="0" max="255" class="svelte-n07acl"/> <input type="number" min="0" max="255" class="svelte-n07acl"/> <input type="number" min="0" max="255" class="svelte-n07acl"/>',1),rT=Y('<input type="number" min="0" max="360" class="svelte-n07acl"/> <input type="number" min="0" max="100" class="svelte-n07acl"/> <input type="number" min="0" max="100" class="svelte-n07acl"/>',1),nT=Y('<input type="number" min="0" max="1" step="0.01" class="svelte-n07acl"/>'),aT=Y('<button type="button" class="svelte-n07acl"><span class="disappear svelte-n07acl" aria-hidden="true"> </span> <span class="appear svelte-n07acl"> </span></button>'),iT=Y('<div class="button-like svelte-n07acl"> </div>'),oT=Y('<div class="text-input svelte-n07acl"><div class="input-container svelte-n07acl"><!> <!></div> <!></div>');function lT(t,e){tt(e,!0);let r=q(e,"rgb",15),n=q(e,"hsv",15),a=q(e,"hex",15);const i=/^#?([A-F0-9]{6}|[A-F0-9]{8})$/i;let o=Z(Ze(e.textInputModes[0]||"hex")),s=W(()=>e.textInputModes[(e.textInputModes.indexOf(g(o))+1)%e.textInputModes.length]),l=W(()=>Math.round(n().h)),u=W(()=>Math.round(n().s)),d=W(()=>Math.round(n().v)),f=W(()=>n().a===void 0?1:Math.round(n().a*100)/100);function v(w){const A=w.target;i.test(A.value)&&(a(A.value),e.onInput({hex:a()}))}function c(w){return function(A){let N=parseFloat(A.target.value);r({...r(),[w]:isNaN(N)?0:N}),e.onInput({rgb:r()})}}function h(w){return function(A){let N=parseFloat(A.target.value);n({...n(),[w]:isNaN(N)?0:N}),e.onInput({hsv:n()})}}var p=oT(),m=j(p),b=j(m);{var y=w=>{var A=eT();dt(A),A.__input=v,yt(A,"",{},{flex:3}),se(()=>{fe(A,"aria-label",e.texts.label.hex),bt(A,a())}),K(w,A)},E=w=>{var A=zt(),N=Me(A);{var J=O=>{var V=tT(),ne=Me(V);dt(ne);var oe=W(()=>c("r"));ne.__input=function(...le){g(oe)?.apply(this,le)};var he=B(ne,2);dt(he);var Re=W(()=>c("g"));he.__input=function(...le){g(Re)?.apply(this,le)};var Te=B(he,2);dt(Te);var ee=W(()=>c("b"));Te.__input=function(...le){g(ee)?.apply(this,le)},se(()=>{fe(ne,"aria-label",e.texts.label.r),bt(ne,r().r),fe(he,"aria-label",e.texts.label.g),bt(he,r().g),fe(Te,"aria-label",e.texts.label.b),bt(Te,r().b)}),K(O,V)},z=O=>{var V=rT(),ne=Me(V);dt(ne);var oe=W(()=>h("h"));ne.__input=function(...le){g(oe)?.apply(this,le)};var he=B(ne,2);dt(he);var Re=W(()=>h("s"));he.__input=function(...le){g(Re)?.apply(this,le)};var Te=B(he,2);dt(Te);var ee=W(()=>h("v"));Te.__input=function(...le){g(ee)?.apply(this,le)},se(()=>{fe(ne,"aria-label",e.texts.label.h),bt(ne,g(l)),fe(he,"aria-label",e.texts.label.s),bt(he,g(u)),fe(Te,"aria-label",e.texts.label.v),bt(Te,g(d))}),K(O,V)};ue(N,O=>{g(o)==="rgb"?O(J):O(z,!1)},!0)}K(w,A)};ue(b,w=>{g(o)==="hex"?w(y):w(E,!1)})}var S=B(b,2);{var T=w=>{var A=nT();dt(A);var N=W(()=>g(o)==="hsv"?h("a"):c("a"));A.__input=function(...J){g(N)?.apply(this,J)},se(()=>{fe(A,"aria-label",e.texts.label.a),bt(A,g(f))}),K(w,A)};ue(S,w=>{e.isAlpha&&w(T)})}G(m);var k=B(m,2);{var R=w=>{var A=aT();A.__click=()=>P(o,g(s),!0);var N=j(A),J=j(N,!0);G(N);var z=B(N,2),O=j(z);G(z),G(A),se(()=>{ft(J,e.texts.color[g(o)]),ft(O,`${e.texts.changeTo??""} ${e.texts.color[g(s)]??""}`)}),K(w,A)},M=w=>{var A=iT(),N=j(A,!0);G(A),se(()=>ft(N,e.texts.color[g(o)])),K(w,A)};ue(k,w=>{e.textInputModes.length>1?w(R):w(M,!1)})}G(p),K(t,p),rt()}jt(["input","click"]);var sT=Y('<div aria-label="color picker"><!></div>');function uT(t,e){tt(e,!0);let r=q(e,"wrapper",15);var n=sT();let a;var i=j(n);kf(i,()=>e.children),G(n),Rt(n,o=>r(o),()=>r()),se(()=>{a=$e(n,1,"wrapper svelte-1alzfar",null,a,{"is-open":e.isOpen}),fe(n,"role",e.isDialog?"dialog":void 0)}),K(t,n),rt()}var dT=Y('<input type="hidden"/>'),fT=Y('<div class="a svelte-blvwft"><!></div>'),cT=Y('<!> <!> <div class="h svelte-blvwft"><!></div> <!> <!> <!> <!>',1),vT=Y("<span><!> <!></span>");function hT(t,e){tt(e,!0);let r=q(e,"components",19,()=>({})),n=q(e,"label",3,"Choose a color"),a=q(e,"name",3,void 0),i=q(e,"nullable",3,!1),o=q(e,"rgb",31,()=>Ze(i()?null:{r:255,g:0,b:0,a:1})),s=q(e,"hsv",31,()=>Ze(i()?null:{h:0,s:100,v:100,a:1})),l=q(e,"hex",31,()=>Ze(i()?null:"#ff0000")),u=q(e,"color",15,null),d=q(e,"isDark",15,!1),f=q(e,"isAlpha",3,!0),v=q(e,"isDialog",3,!0),c=q(e,"isOpen",31,()=>!v()),h=q(e,"position",3,"responsive"),p=q(e,"dir",3,"ltr"),m=q(e,"isTextInput",3,!0),b=q(e,"textInputModes",19,()=>["hex","rgb","hsv"]),y=q(e,"sliderDirection",3,"vertical"),E=q(e,"disableCloseClickOutside",3,!1),S=q(e,"a11yColors",19,()=>[{bgHex:"#ffffff"}]),T=q(e,"a11yLevel",3,"AA"),k=q(e,"texts",3,void 0),R=q(e,"a11yTexts",3,void 0),M=Z(Ze({r:255,g:0,b:0,a:1})),w=Z(Ze({h:0,s:100,v:100,a:1})),A=Z("#ff0000"),N=Z(!1),J=Z(Ze(g(N))),z=Z(void 0),O=Z(void 0),V=Z(void 0),ne,oe=Z(1080),he=Z(720);const Re=12,Te={pickerIndicator:ZS,textInput:lT,input:jS,nullabilityCheckbox:XS,wrapper:uT};function ee(){return{...Te,...r()}}function le(){return{label:{...Xn.label,...k()?.label},color:{...Xn.color,...k()?.color},changeTo:k()?.changeTo??Xn.changeTo,swatch:{...k()?.swatch,...Xn.swatch}}}function Zt({target:_}){v()&&(g(O)?.contains(_)||g(O)?.isSameNode(_)?c(!c()):c()&&!g(V)?.contains(_)&&!E()&&c(!1))}function pt({key:_,target:H}){!v()||!g(O)||!g(z)||(_==="Enter"&&g(O).contains(H)?(c(!c()),setTimeout(()=>{g(V)&&(ne=PS(g(V)))})):_==="Escape"&&c()&&(c(!1),g(z).contains(H)&&(g(O)?.focus(),ne?.destroy())))}function pe(_){l(_),s(Ye(_).toHsv()),o(Ye(_).toRgb()),P(N,!1),ke()}function Ie(){return!(s()&&o()&&s().h===g(w).h&&s().s===g(w).s&&s().v===g(w).v&&s().a===g(w).a&&o().r===g(M).r&&o().g===g(M).g&&o().b===g(M).b&&o().a===g(M).a&&l()===g(A))}function ke(){if(g(N)&&!g(J)){P(J,!0),s(null),o(null),l(null),e.onInput?.({color:u(),hsv:s(),rgb:o(),hex:l()});return}else if(g(J)&&!g(N)){P(J,!1),s(Ne(g(w))),o(Ne(g(M))),l(Ne(g(A))),e.onInput?.({color:u(),hsv:s(),rgb:o(),hex:l()});return}else if(!s()&&!o()&&!l()){P(N,P(J,!0),!0),e.onInput?.({color:null,hsv:s(),rgb:o(),hex:l()});return}else if(!Ie())return;P(N,!1),s()&&s().a===void 0&&s({...s(),a:1}),g(w).a===void 0&&P(w,{...g(w),a:1},!0),o()&&o().a===void 0&&o({...o(),a:1}),g(M).a===void 0&&P(M,{...g(M),a:1},!0),l()?.substring(7)==="ff"&&l(l().substring(0,7)),g(A)?.substring(7)==="ff"&&P(A,g(A).substring(0,7),!0),s()&&(s().h!==g(w).h||s().s!==g(w).s||s().v!==g(w).v||s().a!==g(w).a||!o()&&!l())?(u(Ye(s())),o(u().toRgb()),l(u().toHex())):o()&&(o().r!==g(M).r||o().g!==g(M).g||o().b!==g(M).b||o().a!==g(M).a||!s()&&!l())?(u(Ye(o())),l(u().toHex()),s(u().toHsv())):l()&&(l()!==g(A)||!s()&&!o())&&(u(Ye(l())),o(u().toRgb()),s(u().toHsv())),u()&&d(u().isDark()),!(!l()||!s()||!o())&&(P(w,Ne(s()),!0),P(M,Ne(o()),!0),P(A,l(),!0),P(J,g(N),!0),e.onInput?.({color:u(),hsv:s(),rgb:o(),hex:l()}))}Lt(()=>{(s()||o()||l())&&ke()}),Lt(()=>{g(N),ke()});function qe(_){return H=>{s()||(P(N,!1),P(J,!1),s(Ne(g(w)))),s({...s(),[_]:H})}}function Be(_){return H=>{s()||(P(N,!1),P(J,!1),s(Ne(g(w)))),s({...s(),...Object.fromEntries(_.map(X=>[X,H[X]]))})}}async function ze(){if(await Tf(),h()==="fixed"||!c()||!v()||!g(O)||!g(V))return;const _=g(V).getBoundingClientRect(),H=g(O).getBoundingClientRect();if((h()==="responsive"||h()==="responsive-y")&&(H.top+_.height+Re>g(he)?g(V).style.top=`-${_.height+Re}px`:g(V).style.top=`${H.height+Re}px`),h()==="responsive"||h()==="responsive-x")if(p()==="rtl"){const X=H.left+H.width-_.width<0;console.log(X,H.left-_.width,H.left,_.width),X?g(V).style.left="0px":g(V).style.left=`${H.width-_.width}px`}else H.left+_.width>g(oe)?g(V).style.left=`${H.width-_.width}px`:g(V).style.left="0px"}Lt(()=>{g(oe)&&g(he)&&c()&&ze()});const Xe=W(ee);var st=vT();Qt("mousedown",fr,Zt),Qt("keyup",fr,pt),Qt("scroll",fr,ze);var rr=j(st);{var Pt=_=>{var H=zt(),X=Me(H);Rr(X,()=>g(Xe).input,(ce,te)=>{te(ce,{get hex(){return l()},get label(){return n()},get name(){return a()},get dir(){return p()},get labelElement(){return g(O)},set labelElement(ve){P(O,ve,!0)}})}),K(_,H)},br=_=>{var H=zt(),X=Me(H);{var ce=te=>{var ve=dT();dt(ve),se(()=>{bt(ve,l()),fe(ve,"name",a())}),K(te,ve)};ue(X,te=>{a()&&te(ce)},!0)}K(_,H)};ue(rr,_=>{v()?_(Pt):_(br,!1)})}var yr=B(rr,2);Rr(yr,()=>g(Xe).wrapper,(_,H)=>{H(_,{get isOpen(){return c()},get isDialog(){return v()},get wrapper(){return g(V)},set wrapper(X){P(V,X,!0)},children:(X,ce)=>{var te=cT(),ve=Me(te);{var me=ge=>{var Q=zt(),be=Me(Q);{let _e=W(le);Rr(be,()=>g(Xe).nullabilityCheckbox,(De,Ce)=>{Ce(De,{get texts(){return g(_e)},get isUndefined(){return g(N)},set isUndefined(Ue){P(N,Ue,!0)}})})}K(ge,Q)};ue(ve,ge=>{i()&&ge(me)})}var At=B(ve,2);{let ge=W(ee),Q=W(()=>s()?.h??g(w).h),be=W(()=>s()?.s??g(w).s),_e=W(()=>s()?.v??g(w).v),De=W(()=>Be(["s","v"])),Ce=W(le);WS(At,{get components(){return g(ge)},get h(){return g(Q)},get s(){return g(be)},get v(){return g(_e)},get onInput(){return g(De)},get isDark(){return d()},get texts(){return g(Ce)}})}var wt=B(At,2),qr=j(wt);{let ge=W(()=>s()?.h??g(w).h),Q=W(()=>qe("h")),be=W(()=>y()==="vertical");Ta(qr,{min:0,max:360,step:1,get value(){return g(ge)},get onInput(){return g(Q)},get direction(){return y()},get reverse(){return g(be)},get ariaLabel(){return le().label.h}})}G(wt);var ae=B(wt,2);{var de=ge=>{var Q=fT();let be;var _e=j(Q);{let De=W(()=>s()?.a??g(w).a),Ce=W(()=>qe("a")),Ue=W(()=>y()==="vertical");Ta(_e,{min:0,max:1,step:.01,get value(){return g(De)},get onInput(){return g(Ce)},get direction(){return y()},get reverse(){return g(Ue)},get ariaLabel(){return le().label.a}})}G(Q),se(De=>be=yt(Q,"",be,De),[()=>({"--alphaless-color":(l()?l():g(A)).substring(0,7)})]),K(ge,Q)};ue(ae,ge=>{f()&&ge(de)})}var Fe=B(ae,2);{var Nt=ge=>{{let Q=W(le);$S(ge,{get swatches(){return e.swatches},selectSwatch:pe,get texts(){return g(Q)}})}};ue(Fe,ge=>{e.swatches&&e.swatches.length>0&&ge(Nt)})}var kt=B(Fe,2);{var nt=ge=>{var Q=zt(),be=Me(Q);{let _e=W(()=>l()??g(A)),De=W(()=>o()??g(M)),Ce=W(()=>s()??g(w)),Ue=W(le);Rr(be,()=>g(Xe).textInput,(Zr,za)=>{za(Zr,{get hex(){return g(_e)},get rgb(){return g(De)},get hsv(){return g(Ce)},onInput:_t=>{_t.hsv?s(_t.hsv):_t.rgb?o(_t.rgb):_t.hex&&l(_t.hex)},get isAlpha(){return f()},get textInputModes(){return b()},get texts(){return g(Ue)}})})}K(ge,Q)};ue(kt,ge=>{m()&&ge(nt)})}var Xr=B(kt,2);{var Yr=ge=>{var Q=zt(),be=Me(Q);{let _e=W(ee),De=W(()=>l()||"#00000000");Rr(be,()=>g(Xe).a11yNotice,(Ce,Ue)=>{Ue(Ce,{get components(){return g(_e)},get a11yColors(){return S()},get hex(){return g(De)},get a11yTexts(){return R()},get a11yLevel(){return T()}})})}K(ge,Q)};ue(Xr,ge=>{ee().a11yNotice&&ge(Yr)})}K(X,te)},$$slots:{default:!0}})}),G(st),Rt(st,_=>P(z,_),()=>g(z)),se(()=>$e(st,1,`color-picker ${y()??""}`,"svelte-blvwft")),Lo("innerWidth",_=>P(oe,_,!0)),Lo("innerHeight",_=>P(he,_,!0)),K(t,st),rt()}var pT=Y("<div><div></div></div> <div> </div> <div><div></div></div>",1),gT=Y('<div><!> <div><div></div></div> <div><div><div></div></div> <div class="w-full flex items-center justify-center"><!></div></div></div>');function mT(t,e){tt(e,!0);let r=q(e,"saveOn",15);q(e,"contentClass",3,"");let n=W(()=>`${nr.input} p-rel`+(e.css?" "+e.css:"")),a=Z("#FFFFFF"),i=!1;const o=p=>{r()&&e.save&&r(r()[e.save]=p,!0),p&&P(a,p,!0)};Lt(()=>{(r()||e.save)&&(console.log("change save on:",Ne(r())),wf(()=>{P(a,r()[e.save]||"#FFFFFF",!0)}),i=!0)});var s=gT(),l=j(s);{var u=p=>{var m=pT(),b=Me(m),y=B(b,2),E=j(y,!0);G(y);var S=B(y,2);se(()=>{$e(b,1,Er(nr.input_lab_cell_left),"svelte-1lddz1q"),$e(y,1,Er(nr.input_lab),"svelte-1lddz1q"),ft(E,e.label),$e(S,1,Er(nr.input_lab_cell_right),"svelte-1lddz1q")}),K(p,m)};ue(l,p=>{e.label&&p(u)})}var d=B(l,2),f=B(d,2),v=j(f),c=B(v,2),h=j(c);hT(h,{isAlpha:!1,textInputModes:[],position:"responsive",get hex(){return g(a)},onInput:p=>{i&&(console.log("Setting color:",p.hex),o(p.hex))}}),G(c),G(f),G(s),se(()=>{$e(s,1,Er(g(n)),"svelte-1lddz1q"),$e(d,1,Er(nr.input_shadow_layer),"svelte-1lddz1q"),$e(f,1,`_1 ${nr.input_div} flex items-center justify-center w-full`,"svelte-1lddz1q"),$e(v,1,Er(nr.input_div_1),"svelte-1lddz1q")}),K(t,s),rt()}var bT=Y('<div class="flex justify-center w-full"><div class="_1 h-24 w-36 svelte-1mis18k"></div></div>'),yT=Y('<div class="grid grid-cols-24 gap-10 p-4"><!> <!> <!> <!> <div class="col-span-12"><!></div> <div class="mt-12 col-span-24 fs15"><i class="icon-attention"></i> La información se guardará cuando se guarde el producto.</div></div>'),ET=Y('<div class="flex justify-between mt-4"><div></div> <button class="bx-green s1"><i class="icon-plus"></i></button></div> <!> <!>',1);function CT(t,e){tt(e,!0);const r=new Map(Oo.map(c=>[c.id,c]));let n=q(e,"producto",15),a=Z(Ze({})),i=-1;const o=[{header:"Atributo",getValue:c=>r.get(c.at)?.name||""},{header:"Nombre",getValue:c=>c.nm},{header:"Precio",getValue:c=>c.pc?ia(c.pc/100,2):""},{header:"Diff. Precio",getValue:c=>c.pd?ia(c.pd/100,2):""},{header:"Color",id:"color",getValue:c=>c.cl},{header:"...",cellCss:"px-6 py-1",headerCss:"w-42",buttonEditHandler(c){P(a,{...c},!0),aa(3)}}],s=W(()=>(n().Presentaciones||[]).filter(c=>c.ss));var l=ET(),u=Me(l),d=B(j(u),2);d.__click=()=>{P(a,{at:n().AtributosIDs?.[0],id:i,ss:1},!0),i--,console.log("presentacionForm",g(a)),aa(3)},G(u);var f=B(u,2);Vs(f,{get columns(){return o},css:"mt-6",get data(){return g(s)},onRowClick:h=>{P(a,{...h},!0)},cellRenderer:(h,p=ko,m=ko)=>{var b=zt(),y=Me(b);{var E=S=>{var T=bT(),k=j(T);G(T),se(()=>yt(k,`background-color:${p().cl??""}`)),K(S,T)};ue(y,S=>{m().id==="color"&&p().cl&&S(E)})}K(h,b)},$$slots:{cellRenderer:!0}});var v=B(f,2);js(v,{title:"Producto Presentación",id:3,size:4,saveButtonLabel:"Agregar",saveIcon:"icon-ok",onSave:()=>{n(n().Presentaciones=n().Presentaciones||[],!0);const c=n().Presentaciones.find(h=>h.id===g(a).id);c?Object.assign(c,g(a)):n().Presentaciones.push(g(a)),n(n().Presentaciones=[...n().Presentaciones],!0),gi()},onDelete:()=>{const c=n().Presentaciones.find(h=>h.id===g(a).id);c&&g(a).id>0?c.ss=0:n(n().Presentaciones=n().Presentaciones.filter(h=>h.id!==g(a).id),!0),n(n().Presentaciones=[...n().Presentaciones],!0),gi()},children:(c,h)=>{var p=yT(),m=j(p);Jn(m,{label:"Atributo",get saveOn(){return g(a)},css:"col-span-12",save:"at",keyId:"id",keyName:"name",get options(){return Oo}});var b=B(m,2);He(b,{label:"Nombre",get saveOn(){return g(a)},css:"col-span-12",save:"nm"});var y=B(b,2);He(y,{label:"Precio",get saveOn(){return g(a)},css:"col-span-12",save:"pc",type:"number",baseDecimals:2});var E=B(y,2);He(E,{label:"Diferencia Precio",get saveOn(){return g(a)},css:"col-span-12",save:"pd",type:"number",baseDecimals:2});var S=B(E,2),T=j(S);mT(T,{label:"Color",get saveOn(){return g(a)},save:"cl"}),G(S),Ws(2),G(p),K(c,p)},$$slots:{default:!0}}),K(t,l),rt()}jt(["click"]);var ST=Y('<div class="_1 px-12 py-10 w-250 min-h-140 svelte-u9lhhq" role="button" tabindex="0"><div class="min-h-70 _2 mb-2 svelte-u9lhhq"></div> <div class="fs17 ff-semibold"> </div> <div class="fs15"> </div></div>'),TT=Y('<div class="grid grid-cols-12 gap-10 p-6"><!> <!> <!></div>'),wT=Y('<div class="w-full flex flex-wrap gap-12"></div> <!>',1);function Ks(t,e){tt(e,!0);const r=q(e,"listas",7),n=W(()=>(console.log("listas getted:",Ne(r())),r().ListaRecordsMap.get(e.origin)||[]));let a=Z(Ze({}));const i=[151,152,153];let o=Z(Ze([{_id:151},{_id:152},{_id:153}]));const s=async h=>{if(console.log("form a enviar 1::",Ne(g(a)),h),(g(a).Nombre||"").length<4||!g(a).ListaID){ln.failure("Debe colocar un nombre de al menos 4 caracteres.");return}Mt.standard("Guardando categoría..."),g(a).Images=g(a).Images||[],g(a).ss=h?0:1;for(let y=0;y<i.length;y++){const E=i[y];if(_o.has(E)){Mt.change(`Guardando Imagen ${y+1}`);let T=(await _o.get(E)?.())?.imageName||"";T.includes("/")&&(T=T.split("/")[1]),g(a).Images[y]=T}else g(a).Images[y]=g(a).Images?.[y]||""}console.log("form a enviar 2::",Ne(g(a))),Mt.change("Guardando categoría...");let p;try{p=await Bf([g(a)])}catch(y){ln.failure(y);return}const m=g(n).find(y=>y.ID===g(a).ID);let b=[...g(n)];m&&h?b=b.filter(y=>y.ID!==g(a).ID):m?Object.assign(m,g(a)):(g(a).ID=p[0].NewID,b.push(g(a)),r().RecordsMap.set(g(a).ID,g(a))),console.log("newCategorias",b.length,"|",g(n).length),r().ListaRecordsMap.set(e.origin,b),r().ListaRecordsMap=new Map(r().ListaRecordsMap),gi(),Mt.remove()},l=()=>{P(a,{ListaID:e.origin},!0),aa(2)};Lt(()=>{console.log("form a enviar::",Ne(g(a)))});const u=h=>{P(a,{...h},!0),P(o,i.map((p,m)=>({_id:p,src:(g(a).Images||[])[m]||""})),!0),console.log("categoría getted:",Ne(g(a)),Ne(g(o))),aa(2)};var d={newRecord:l},f=wT(),v=Me(f);Dt(v,21,()=>g(n),Ht,(h,p)=>{var m=ST();m.__keydown=T=>{T.stopPropagation(),(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),u(g(p)))},m.__click=T=>{T.stopPropagation(),u(g(p))};var b=B(j(m),2),y=j(b,!0);G(b);var E=B(b,2),S=j(E,!0);G(E),G(m),se(()=>{ft(y,g(p).Nombre),ft(S,g(p).Descripcion)}),K(h,m)}),G(v);var c=B(v,2);{let h=W(()=>g(a).ID>0?()=>{s(!0)}:void 0);js(c,{title:"CATEGORÍA",id:2,size:6,onClose:()=>{Rf(2)},onSave:()=>{s()},get onDelete(){return g(h)},children:(p,m)=>{var b=TT(),y=j(b);He(y,{label:"Nombre",css:"col-span-12",get saveOn(){return g(a)},save:"Nombre",required:!0});var E=B(y,2);He(E,{label:"Descripción",css:"col-span-12 mb-16",get saveOn(){return g(a)},save:"Descripcion"});var S=B(E,2);Dt(S,17,()=>g(o),Ht,(T,k,R)=>{Zn(T,{clearOnUpload:!0,get id(){return g(k)._id},folder:"img-public",get src(){return g(k).src},size:2,cardCss:"w-full h-180 p-4 col-span-4",types:["avif","webp"],saveAPI:"producto-categoria-image",hideUploadButton:!0,hideForm:!0,onChange:M=>{Object.assign(g(k),M)},setDataToSend:M=>{M.Order=R+1}})}),G(b),K(p,b)},$$slots:{default:!0}})}return K(t,f),rt(d)}jt(["keydown","click"]);var kT=Y('<div class="grid grid-cols-24 items-start gap-x-10 gap-y-10 mt-6 md:mt-16"><!> <div class="col-span-24 md:col-span-9 md:row-span-4"><!></div> <!> <!> <!> <!> <!> <!> <!> <!> <div class="col-span-24 md:col-span-14"><!></div> <!> <!> <div class="ff-bold h3 col-span-24 ml-8">Sub-Unidades</div> <!> <!> <!> <!> <!></div>'),_T=Y('<div class="mt-16 w-full"><!></div>'),DT=Y('<div class="grid grid-cols-2 md:grid-cols-4 items-start gap-x-10 gap-y-10 mt-16"><!> <!></div>'),MT=Y("<!> <!> <!> <!>",1),OT=Y('<div class="grid grid-cols-12 md:flex md:flex-row items-center mb-8"><!> <div class="i-search w-full md:w-200 md:ml-12 col-span-5"><div><i class="icon-search"></i></div> <input type="text"/></div> <button class="bx-green ml-auto col-span-7"><i class="icon-plus"></i><span class="hidden md:block">Nuevo</span></button></div> <!> <!> <!> <!>',1);function nw(t,e){tt(e,!0);let r=Z("");const n=new xf,a=new Hf([1,2]);let i=Z(1),o=Z(1),s=Z(Ze({})),l=null,u=null,d=[{header:"ID",css:"c-blue text-center",headerCss:"w-48",getValue:h=>h.ID},{header:"Producto",highlight:!0,getValue:h=>h.Nombre},{header:"Categorías",highlight:!0,getValue:h=>{const p=[];for(const m of h.CategoriasIDs){const b=a.get(m)?.Nombre||`Categoría-${m}`;p.push(b)}return p.join(", ")}},{header:"Precio",css:"text-right",getValue:h=>ia(h.Precio/100,2)},{header:"Descuento",css:"text-right",getValue:h=>h.Descuento?String(h.Descuento)+"%":""},{header:"Precio Final",css:"text-right",getValue:h=>ia(h.PrecioFinal/100,2)},{header:"Sub Unidades",css:"text-right",getValue:h=>h.SbnUnidad?`${h.SbnCantidad} x ${h.SbnUnidad}`:""}];const f=W(()=>a.ListaRecordsMap.get(1)||[]),v=async h=>{if((g(s).Nombre?.length||0)<4){ln.failure("El nombre debe tener al menos 4 caracteres.");return}console.log("productor a enviar:",Ne(g(s))),h&&(g(s).ss=0),Mt.standard("Guardando producto...");try{var p=await zf([g(s)])}catch(b){ln.failure(b),Mt.remove();return}Mt.remove();const m=n.productos.find(b=>b.ID===g(s).ID);m&&h?n.productos=n.productos.filter(b=>b.ID!==g(s).ID):m?Object.assign(m,g(s)):(g(s).ID=p[0].ID,n.productos.unshift(g(s)),n.productos=[...n.productos]),Pn.openSideLayer(0)};Lt(()=>{console.log("productor form:",Ne(g(s)))});const c=async h=>{Mt.standard("Eliminando Imagen...");try{await Ff({data:{ProductoID:g(s).ID,ImageToDelete:h},route:"producto-image",refreshRoutes:["productos"]})}catch(p){ln.failure(`Error al eliminar imagen: ${p}`),Mt.remove();return}Mt.remove(),g(s).Images=(g(s).Images||[]).filter(p=>p.n!==h)};Af(t,{sideLayerSize:780,title:"Productos",children:(h,p)=>{var m=OT(),b=Me(m),y=j(b);Pf(y,{get selected(){return g(i)},css:"col-span-12 mb-6 md:mb-0",options:[[1,"Productos"],[2,"Categorías"],[3,"Marcas"]],useMobileGrid:!0,onSelect:z=>{Pn.openSideLayer(0),P(s,{ID:0},!0),P(i,z[0],!0)}});var E=B(y,2),S=B(j(E),2);S.__keyup=z=>{const O=String(z.target.value||"");If(()=>{P(r,O,!0)},150)},G(E);var T=B(E,2);T.__click=z=>{z.stopPropagation(),g(i)===2?l?.newRecord():g(i)===3?u?.newRecord():Pn.openSideLayer(1)},G(b);var k=B(b,2);{var R=z=>{Mo(z,{type:"content",children:(O,V)=>{{let ne=W(()=>g(s)?.ID);Vs(O,{get columns(){return d},get data(){return n.productos},get filterText(){return g(r)},get selected(){return g(ne)},isSelected:(oe,he)=>oe.ID===he,getFilterContent:oe=>oe.Nombre,onRowClick:oe=>{P(s,{...oe},!0),g(s).CategoriasIDs=[...oe.CategoriasIDs||[]],g(s).Propiedades=[...oe.Propiedades||[]],Pn.openSideLayer(1)}})}},$$slots:{default:!0}})};ue(k,z=>{g(i)===1&&z(R)})}var M=B(k,2);{let z=W(()=>g(s)?.Nombre||"");Mo(M,{type:"side",css:"px-8 py-8 md:px-14 md:py-10",get title(){return g(z)},titleCss:"h2 mb-6",contentCss:"px-0 md:px-0",id:1,onClose:()=>{P(s,{},!0)},onSave:()=>{v()},onDelete:()=>{Do("Eliminar Producto",`¿Está seguro que desea eliminar "${g(s).Nombre}"?`,"SI","NO",()=>{v(!0)})},options:[[1,"Información",["Informa-","ción"]],[2,"Ficha"],[3,"Presentaciones",["Presenta-","ciones"]],[4,"Fotos"]],get selected(){return g(o)},set selected(O){P(o,O,!0)},children:(O,V)=>{var ne=MT(),oe=Me(ne);{var he=pe=>{var Ie=kT(),ke=j(Ie);He(ke,{label:"Nombre",get saveOn(){return g(s)},css:"col-span-24",required:!0,save:"Nombre"});var qe=B(ke,2),Be=j(qe);{let ae=W(()=>g(s).Image?.n);Zn(Be,{saveAPI:"producto-image",useConvertAvif:!0,clearOnUpload:!0,types:["avif","webp"],folder:"img-productos",size:2,get src(){return g(ae)},cardCss:"w-full h-180 p-4",setDataToSend:de=>{de.ProductoID=g(s).ID},onUploaded:(de,Fe)=>{de.includes("/")&&(de=de.split("/")[1]),g(s).Image={n:de,d:Fe},g(s).Images=g(s).Images||[],g(s).Images.unshift(g(s).Image)}})}G(qe);var ze=B(qe,2);He(ze,{label:"Precio Base",get saveOn(){return g(s)},css:"col-span-12 md:col-span-5",save:"Precio",type:"number",baseDecimals:2,get dependencyValue(){return g(s).Precio},onChange:()=>{console.log("productoForm",Ne(g(s))),g(s).PrecioFinal=Math.round(g(s).Precio*(100-(g(s).Descuento||0))/100)}});var Xe=B(ze,2);He(Xe,{label:"Descuento",get saveOn(){return g(s)},css:"col-span-12 md:col-span-5",save:"Descuento",postValue:"%",type:"number",validator:ae=>!ae||ae<100});var st=B(Xe,2);He(st,{label:"Precio Final",get saveOn(){return g(s)},css:"col-span-12 md:col-span-5",get dependencyValue(){return g(s).PrecioFinal},save:"PrecioFinal",type:"number",baseDecimals:2,onChange:()=>{console.log("productoForm",Ne(g(s))),g(s).Precio=Math.round(g(s).PrecioFinal/(100-(g(s).Descuento||0))*100)}});var rr=B(st,2);Jn(rr,{label:"Moneda",get saveOn(){return g(s)},css:"col-span-12 md:col-span-5",save:"MonedaID",keyId:"i",keyName:"v",options:[{i:1,v:"PEN (S/.)"},{i:2,v:"USD ($)"}]});var Pt=B(rr,2);He(Pt,{label:"Peso",get saveOn(){return g(s)},css:"col-span-12 md:col-span-5",save:"Peso",type:"number"});var br=B(Pt,2);Jn(br,{label:"Unidad",get saveOn(){return g(s)},css:"col-span-12 md:col-span-5",save:"UnidadID",keyId:"i",keyName:"v",options:[{i:1,v:"Kg"},{i:2,v:"g"},{i:3,v:"Libras"}]});var yr=B(br,2);He(yr,{label:"Volumen",get saveOn(){return g(s)},css:"col-span-12 md:col-span-5",save:"Volumen",type:"number"});var _=B(yr,2);{let ae=W(()=>a.ListaRecordsMap.get(2)||[]);Jn(_,{label:"Marca",get saveOn(){return g(s)},css:"col-span-12 md:col-span-10 mb-2",save:"MarcaID",keyId:"ID",keyName:"Nombre",get options(){return g(ae)}})}var H=B(_,2),X=j(H);Df(X,{save:"Params",get saveOn(){return g(s)},type:"multiple",options:[{i:1,v:"SKU Individual"}],keyId:"i",keyName:"v"}),G(H);var ce=B(H,2);He(ce,{get saveOn(){return g(s)},save:"Descripcion",css:"col-span-24 mb-4",label:"Descripción Corta"});var te=B(ce,2);Nf(te,{css:"col-span-24 flex items-start",label:"CATEGORÍAS ::",get options(){return g(f)},keyId:"ID",keyName:"Nombre",cardCss:"grow",inputCss:"w-[35%] md:w-180",save:"CategoriasIDs",optionsCss:"w-280",get saveOn(){return g(s)},set saveOn(ae){P(s,ae,!0)}});var ve=B(te,4);He(ve,{get saveOn(){return g(s)},save:"SbnUnidad",css:"col-span-12 md:col-span-6",label:"Nombre"});var me=B(ve,2);He(me,{save:"SbnPrecio",baseDecimals:2,css:"col-span-12 md:col-span-6",label:"Precio Base",type:"number",onChange:()=>{console.log(),g(s).PrecioFinal=Math.round(g(s).Precio*(100-(g(s).Descuento||0))/100),P(s,{...g(s)},!0)},get saveOn(){return g(s)},set saveOn(ae){P(s,ae,!0)}});var At=B(me,2);He(At,{get saveOn(){return g(s)},save:"SbnDescuento",postValue:"%",css:"col-span-12 md:col-span-6",label:"Descuento",type:"number"});var wt=B(At,2);He(wt,{get saveOn(){return g(s)},save:"SbnPreciFinal",baseDecimals:2,css:"col-span-12 md:col-span-6",label:"Precio Final",type:"number"});var qr=B(wt,2);He(qr,{get saveOn(){return g(s)},save:"SbnCantidad",css:"col-span-12 md:col-span-6",label:"Cantidad",type:"number"}),G(Ie),K(pe,Ie)};ue(oe,pe=>{g(o)===1&&pe(he)})}var Re=B(oe,2);{var Te=pe=>{RS(pe,{get saveOn(){return g(s)},save:"ContentHTML",css:"mt-12"})};ue(Re,pe=>{g(o)===2&&pe(Te)})}var ee=B(Re,2);{var le=pe=>{var Ie=_T(),ke=j(Ie);CT(ke,{get producto(){return g(s)},set producto(qe){P(s,qe,!0)}}),G(Ie),K(pe,Ie)};ue(ee,pe=>{g(o)===3&&pe(le)})}var Zt=B(ee,2);{var pt=pe=>{var Ie=DT(),ke=j(Ie);Zn(ke,{saveAPI:"producto-image",useConvertAvif:!0,clearOnUpload:!0,types:["avif","webp"],folder:"img-productos",cardCss:"w-full h-170 p-4",setDataToSend:Be=>{Be.ProductoID=g(s).ID},onUploaded:(Be,ze)=>{Be.includes("/")&&(Be=Be.split("/")[1]),g(s).Image={n:Be,d:ze},g(s).Images=g(s).Images||[],g(s).Images.unshift(g(s).Image)}});var qe=B(ke,2);Dt(qe,17,()=>g(s).Images||[],Ht,(Be,ze)=>{{let Xe=W(()=>g(ze)?.n);Zn(Be,{saveAPI:"producto-image",size:2,clearOnUpload:!0,types:["avif","webp"],folder:"img-productos",cardCss:"w-full h-170 p-4",get src(){return g(Xe)},useConvertAvif:!0,onDelete:()=>{Do("ELIMINAR IMAGEN",`Eliminar la imagen ${g(ze).d?`"${g(ze).d}"`:"seleccionada"}`,"SI","NO",()=>{c(g(ze).n)})}})}}),G(Ie),K(pe,Ie)};ue(Zt,pe=>{g(o)===4&&pe(pt)})}K(O,ne)},$$slots:{default:!0}})}var w=B(M,2);{var A=z=>{Rt(Ks(z,{get listas(){return a},origin:1}),O=>l=O,()=>l)};ue(w,z=>{g(i)===2&&z(A)})}var N=B(w,2);{var J=z=>{Rt(Ks(z,{get listas(){return a},origin:2}),O=>u=O,()=>u)};ue(N,z=>{g(i)===3&&z(J)})}K(h,m)},$$slots:{default:!0}}),rt()}jt(["keyup","click"]);export{nw as component};
